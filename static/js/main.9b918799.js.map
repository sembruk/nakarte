{"version":3,"sources":["webpack:///static/js/main.9b918799.js","webpack:///./src/lib/logging/index.js","webpack:///./src/lib/xhr-promise/index.js","webpack:///./src/lib/leaflet.control.commons/index.js","webpack:///./src/config.js","webpack:///./src/lib/notifications/index.js","webpack:///./src/lib/binary-strings/index.js","webpack:///./src/lib/contextmenu/index.js","webpack:///./src/lib/CORSProxy/index.js","webpack:///./src/lib/leaflet.hashState/leaflet.hashState.js","webpack:///./src/lib/leaflet.layer.canvasMarkers/index.js","webpack:///./src/lib/safe-localstorage/index.js","webpack:///./src/lib/clipboardCopy/index.js","webpack:///./src/lib/leaflet.control.printPages/decorations.js","webpack:///./src/lib/leaflet.control.track-list/lib/geo_file_formats.js","webpack:///./src/lib/leaflet.control.track-list/track-list.js","webpack:///./src/lib/tiled-data-loader/index.js","webpack:///./src/lib/googleMapsApi/index.js","webpack:///./src/lib/iconFromBackgroundImage/index.js","webpack:///./src/lib/knockout.component.progress/progress.js","webpack:///./src/lib/leaflet.control.elevation-profile/index.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/index.js","webpack:///./src/lib/leaflet.control.layers.top-row/index.js","webpack:///./src/lib/leaflet.hashState/hashState.js","webpack:///./src/lib/leaflet.layer.bing/index.js","webpack:///./src/lib/leaflet.layer.google/index.js","webpack:///./src/lib/leaflet.layer.rasterize/CanvasMarkers.js","webpack:///./src/lib/leaflet.layer.rasterize/TileLayer.js","webpack:///./src/lib/leaflet.layer.rasterize/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPassesMarkers.js","webpack:///./src/lib/leaflet.layer.yandex/index.js","webpack:///./src/lib/leaflet.polyline-measure/index.js","webpack:///./src/lib/magnetic-declination/index.js","webpack:///./src/lib/popup-window/index.js","webpack:///./src/App.js","webpack:///./src/index.js","webpack:///./src/layers.js","webpack:///./src/lib/cache/index.js","webpack:///./src/lib/file-read/index.js","webpack:///./src/lib/leaflet.control.azimuth/index.js","webpack:///./src/lib/leaflet.control.caption/index.js","webpack:///./src/lib/leaflet.control.coordinates/index.js","webpack:///./src/lib/leaflet.control.jnx/binary-stream.js","webpack:///./src/lib/leaflet.control.jnx/hash-state.js","webpack:///./src/lib/leaflet.control.jnx/index.js","webpack:///./src/lib/leaflet.control.jnx/jnx-encoder.js","webpack:///./src/lib/leaflet.control.jnx/jnx-maker.js","webpack:///./src/lib/leaflet.control.jnx/selector.js","webpack:///./src/lib/leaflet.control.layers.adaptive-height/index.js","webpack:///./src/lib/leaflet.control.layers.configure/index.js","webpack:///./src/lib/leaflet.control.layers.events/index.js","webpack:///./src/lib/leaflet.control.layers.minimize/index.js","webpack:///./src/lib/leaflet.control.panoramas/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/google/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-loader.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mvt.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/vector_tile_proto.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/index.js","webpack:///./src/lib/leaflet.control.printPages/control.js","webpack:///./src/lib/leaflet.control.printPages/decoration.grid.js","webpack:///./src/lib/leaflet.control.printPages/decoration.magnetic-meridians.js","webpack:///./src/lib/leaflet.control.printPages/decoration.scale.js","webpack:///./src/lib/leaflet.control.printPages/map-render.js","webpack:///./src/lib/leaflet.control.printPages/pageFeature.js","webpack:///./src/lib/leaflet.control.printPages/pdf.js","webpack:///./src/lib/leaflet.control.track-list/control-ruler.js","webpack:///./src/lib/leaflet.control.track-list/lib/geo_file_exporters.js","webpack:///./src/lib/leaflet.control.track-list/lib/gpsies.js","webpack:///./src/lib/leaflet.control.track-list/track-list.hash-state.js","webpack:///./src/lib/leaflet.control.track-list/track-list.localstorage.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/index.js","webpack:///./src/lib/leaflet.fixes/index.js","webpack:///./src/lib/leaflet.hashState/Leaflet.Control.Layers.js","webpack:///./src/lib/leaflet.hashState/Leaflet.Map.js","webpack:///./src/lib/leaflet.layer.geojson-ajax/index.js","webpack:///./src/lib/leaflet.layer.nordeskart/index.js","webpack:///./src/lib/leaflet.layer.rasterize/Bing.js","webpack:///./src/lib/leaflet.layer.rasterize/Google.js","webpack:///./src/lib/leaflet.layer.rasterize/MeasuredLine.js","webpack:///./src/lib/leaflet.layer.rasterize/WestraPasses.js","webpack:///./src/lib/leaflet.layer.rasterize/Yandex.js","webpack:///./src/lib/leaflet.layer.rasterize/imgFromDataString.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/index.js","webpack:///./src/lib/leaflet.layer.wikimapia/index.js","webpack:///./src/lib/leaflet.layer.wikimapia/wikimapia-loader.js","webpack:///./src/lib/leaflet.layer.wikimapia/wm-utils.js","webpack:///./src/lib/leaflet.lineutil.simplifyLatLngs/index.js","webpack:///./src/lib/leaflet.polyline-edit/index.js","webpack:///./src/lib/stripBom/index.js","webpack:///./src/secrets.js","webpack:///./src/lib/magnetic-declination/declination.json","webpack:///./src/lib/leaflet.control.azimuth/control.html","webpack:///./src/lib/leaflet.control.printPages/form.html","webpack:///./src/lib/leaflet.control.azimuth/pointer-end.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer-start.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer.svg"],"names":["webpackJsonp","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","captureException","e","options","_ravenJs2","captureMessage","msg","captureMessageWithUrl","extra","url","window","location","toString","setExtraContext","data","captureBreadcrumb","crumb","captureBreadcrumbWithUrl","Object","assign","defineProperty","value","_ravenJs","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","successIfStatus200","xhr","status","retryIfNetworkErrorOrServerError","fetch","promise","XMLHttpRequestPromise","send","XHRQueue","undefined","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","length","err","Array","isArray","_createClass","defineProperties","target","props","descriptor","key","protoProps","staticProps","_binaryStrings","XMLHttpRequestPromiseError","_Error","this","_this","getPrototypeOf","name","message","Error","_this2","_ref","arguments","_ref$method","method","_ref$data","_ref$responseType","responseType","_ref$timeout","timeout","_ref$maxTries","maxTries","_ref$retryTimeWait","retryTimeWait","_ref$isResponseSucces","isResponseSuccess","_ref$responseNeedsRet","responseNeedsRetry","_ref$headers","headers","Promise","resolve","reject","_resolve","_reject","then","bind","catch","postData","_isResponseSuccess","_responseNeedsRetry","_retryTimeWait","triesLeft","XMLHttpRequest","onreadystatechange","_onreadystatechange","_open","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_step$value","k","v","setRequestHeader","return","open","_this3","readyState","_aborted","responseBinaryText","response","byteLength","arrayBufferToString","responseJSON","JSON","parse","_timerId","setTimeout","clearTimeout","abort","maxSimultaneousRequests","_maxConnections","_queue","_activeCount","_this4","_originalAbort","_abortPromise","_processQueue","_this5","indexOf","splice","_this6","shift","_onRequestReady","_this7","_leaflet","_leaflet2","Control","include","_stopContainerEvents","container","_container","DomEvent","disableClickPropagation","disableScrollPropagation","on","stop","_secrets","_secrets2","email","googleApiUrl","westraDataBaseUrl","CORSProxyUrl","elevationsServer","newsUrl","wikimediaCommonsCoverageUrl","notify","level","alert","prompt","arBuf","Uint8Array","s","chunk","subarray","String","fromCharCode","apply","join","stringToArrayBuffer","buf","ArrayBuffer","charCodeAt","blobFromString","Blob","isDescendant","parent","child","parentNode","Contextmenu","items","onKeyDown","keyCode","hide","onMouseDown","originalEvent","preventDefault","returnValue","x","clientX","y","clientY","document","createElement","body","appendChild","className","style","zIndex","addEventListener","createItems","item","setPosition","removeChild","removeEventListener","window_width","innerWidth","window_height","innerHeight","menu_width","offsetWidth","menu_height","offsetHeight","left","top","regeneratorRuntime","mark","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","itemOptions","wrap","_context","prev","separator","createSeparator","createItem","t0","finish","el","disabled","header","innerHTML","text","callback","onItemClick","stopPropagation","urlViaCorsProxy","_config2","replace","_config","_hashState","_hashState2","_logging","_logging2","Mixin","HashState","enableHashState","defaultInitialState","_hashStateKey","eventSource","stateChangeEventsSource","stateChangeEvents","forEach","event","_onControlStateChanged","state","_onExternalStateChanged","getState","_ignoreStateChange","unserializeState","updateState","serializeState","_asyncToGenerator","fn","gen","step","arg","info","error","calcIntersectionSum","rect","rects","sum","right","bottom","rect2","Math","max","minX","min","maxX","minY","maxY","_rbush","_rbush2","_imagePromise","_imagePromise2","Layer","CanvasMarkers","GridLayer","extend","async","labelFontName","labelFontSize","iconScale","pane","updateWhenZooming","Browser","mobile","iconsOpacity","initialize","markers","rtree","_regions","_iconPositions","_labelPositions","_labelPositionsZoom","addMarkers","_images","_tileQueue","_hoverMarker","onMarkerEnter","onMarkerLeave","load","resetLabels","redraw","addMarker","marker","insert","removeMarker","removeMarkers","remove","updateMarkers","updateMarker","setMarkerPosition","latlng","getMarkers","all","findLabelPosition","iconCenter","iconSize","textWidth","textHeight","pixelExtents","verticalPadding","xPositions","yPositions","minIntersectionSum","Infinity","bestX","bestY","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","tileW","tileE","tileN","tileS","intersectionSum","search","preloadIcons","urls","newUrls","filter","images","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","image","src","createTile","coords","canvas","DomUtil","width","tileSize","height","Util","requestAnimFrame","drawTile","selectMarkersForDraw","zoom","withoutPadding","_map","iconsHorPad","iconsVertPad","labelsHorPad","labelsVertPad","iconsBounds","latLngBounds","unproject","point","labelsBounds","iconUrls","markerJobs","pointsForMarkers","getWest","getSouth","getEast","getNorth","pointsForLabels","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","p","project","icon","markerId","stamp","projectedXY","drawSelectedMarkers","limitLabelsToImage","ctx","getContext","font","template","size","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","entries","_step6$value","job","img","imgW","round","imgH","center","isLabel","_iconPositions$marker","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","label","measureText","_p","regionsInTile","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","region","textBaseline","shadowColor","strokeStyle","fillStyle","lineWidth","shadowBlur","strokeText","fillText","globalAlpha","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","drawImage","_x4","_x5","_ref2","_callee","_selectMarkersForDraw","z","abrupt","clear","findMarkerFromMouseEvent","onMouseMove","fire","showTooltip","tooltip","toolTip","latLngToLayerPoint","addClass","cursor","removeClass","onMouseOut","onClick","clickLocked","onRightClick","onAdd","map","getPane","createPane","getPanes","markerPane","onRemove","off","localStorageWorks","localStorage","setItem","getItem","storage","_storage","n","keys","removeItem","showNotification","mouseEvent","w","h","copyToClipboard","ta","select","execCommand","description","PrintStaticLayer","_layerDummy","_printProgressWeight","getTilesInfo","_x","_callee2","printOptions","_context2","iterateTilePromises","tilePromise","draw","_drawRaster","isOverlay","overlaySolid","abortLoading","count","_toConsumableArray","arr2","from","xmlGetNodeText","node","slice","childNodes","nodeValue","parseGpx","txt","preferNameFromFile","getSegmentPoints","segment_element","points_elements","getElementsByTagName","points","point_element","lat","parseFloat","getAttribute","lng","isNaN","getTrackSegments","xml","segments","segments_elements","segment_points","getWaypoints","waypoint_elements","waypoints","waypoint_element","waypoint","_utf","decode","symbol_name","_stripBom2","dom","DOMParser","parseFromString","documentElement","nodeName","concat","trk","trkName","tracks","parseOziPlt","lines","split","expected_points_num","parseInt","current_segment","total_points_num","line","trim","fields","lon","is_start_of_segment","decodeCP1251","c","s2","parseOziWpt","pointName","parseKml","getPoints","placemarks","coord","pointObjs","coordinates_element","coordinates_string","points_strings","parseKmz","uncompressed","unzipper","_jsUnzip2","geodata","hasDocKml","isZipFile","readEntries","entry","fileName","match","compressionMethod","_rawinflate2","inflate","parseYandexRulerString","last_lat","last_lng","points_str","parseYandexRulerUrl","re","m","exec","res","parseZip","geodata_array","file_name","parseGeoFile","decodeUrlSafeBase64","decoded","atob","unpackNumber","position","PackedStreamReader","_string","parseStringified","oldVersion","segment","segmentsCount","pointsCount","version","midX","midY","waypointName","color","measureTicksShown","arcUnit","wayPoints","trackHidden","readNumber","readString","geoData","parseTrackUrl","substring","parseNakarteUrl","geodataArray","parsers","parsed","_jsUnzip","_rawinflate","_stripBom","_knockout","_knockout2","_contextmenu","_contextmenu2","_fileRead","_geo_file_formats","_CORSProxy","_CORSProxy2","_xhrPromise","_geo_file_exporters","_geo_file_exporters2","_clipboardCopy","_clipboardCopy2","_browserFilesaver","_iconFromBackgroundImage","_iconFromBackgroundImage2","_leafletControl","_notifications","_gpsies","TrackSegment","MeasuredLine","includes","Polyline","EditMixin","weight","lineCap","opacity","mergeOptions","EditMixinOptions","TrackList","Events","colors","observableArray","observable","readingFiles","readProgressRange","readProgressDone","_lastTrackColor","trackListHeight","isPlacingPoint","trackAddingPoint","removeAll","applyBindings","addListener","getContainer","onFileDragDrop","onFileDraging","menu","copyAllTracks","copyVisibleTracks","deleteAllTracks","deleteHiddenTracks","_markerLayer","print","scaleDependent","printTransparent","addTo","onMarkerClick","_setAdaptiveHeight","onFileInputRightClick","_","mapHeight","getSize","maxHeight","offsetTop","setExpanded","setMinimized","dataTransfer","dropEffect","files","loadFilesFromFilesObject","onEnterPressedInInput","this_","loadFilesFromUrl","getTrackPolylines","track","feature","getLayers","layer","getTrackPoints","addNewTrack","addTrack","addTrackSegment","startEditTrackSegement","startDrawingLine","readFiles","fileDataArray","fileData","filename","reduce","addTracksFromGeodataArray","loadFilesFromDisk","selectFiles","decodeURIComponent","pop","url_for_request","xhrOptions","isGpsiesUrl","_gpsiesXhrOptions","gpsiesXhrOptions","_gpsiesXhrOptions2","hasData","messages","data_empty","LineUtil","simplifyLatlngs","error_messages","CORRUPT","UNSUPPORTED","NETWORK","onTrackColorChanged","polyline","setStyle","setMarkerIcon","onTrackVisibilityChanged","visible","addLayer","removeLayer","stopPlacingPoint","onTrackLengthChanged","getLength","formatLength","digits","toFixed","setTrackMeasureTicksVisibility","setMeasureTicksVisible","switchMeasureTicksVisibility","onColorSelectorClicked","show","setViewToTrack","bounds","l","getLatLngs","getBounds","isValid","fitBounds","flyToBounds","attachColorSelector","index","attachActionsMenu","renameTrack","duplicateTrack","reverseTrack","showElevationProfileForTrack","removeTrack","saveTrackAsFile","saveGpx","saveKml","copyLinkToClipboard","_actionsMenu","addSegmentAndEdit","j","reverseTrackSegment","trackSegment","stopDrawingLine","latlngs","ll","reverse","isEdited","_editedLine","deleteTrackSegment","newTrackSegment","_parentTrack","stopActiveDraw","trackToString","exporter","extension","lastIndexOf","fileText","saveAs","newName","showTrackMenu","showMenu","stopEditLine","stopLineJoinSelection","stopEdit","onTrackSegmentClick","_lineJoinCursor","joinTrackSegments","startEdit","once","onLineEditEnd","onAddPointClicked","beginPointCreate","_beginPointEdit","stopPlacingPointOnEscPressed","beginPointMove","_movingMarker","movePoint","createNewPoint","parentTrack","_pointAutoInc","addPoint","renamePoint","newSegment","originalSegment","latngs2","_lineJoinToStart","_lineJoinFromStart","unshift","userCancelled","sourcePoints","onNodeRightClickShowMenu","onSegmentRightClickShowMenu","onMouseMoveOnSegmentUpdateLineJoinCursor","nodeIndex","splitTrackSegment","startLineJoinSelection","newTrackFromSegment","showElevationProfileForSegment","interactive","dashArray","onMouseMoveUpdateLineJoinCursor","onEscPressedStopLineJoinSelection","preventStopEdit","distToStart","distanceTo","distToEnd","cursorEnd","tagName","toLowerCase","latlngs1","latlngs2","p1","p2","pnew","closestPointOnSegment","segment1","srcNodes","newNodes","featureGroup","subscribe","symbol","colorInd","setMarkerLabel","srcPoint","latLng","removePoint","newLabel","forceVisible","saveToString","serialized","exportTracks","minTicksIntervalMeters","capturedTrack","pl","capturedBounds","measureTicks","getTicksPositions","hideElevationProfile","_elevationControl","ElevationProfile","samplingInterval","calcSamplingInterval","path","removeFrom","hasTracks","TiledDataLoader","_cache","cacheSize","Cache","_pendingRequests","_xhrQueue","dataTileCoords","makeTileKey","get","layerTileCoords","originalDataTileCoords","multiplier","offsetX","offsetY","layerTileToDataTileCoords","getFromCache","found","dataPromise","tileData","adjustment","calcAdjustment","dataTileKey","_makeRequestData","makeRequestData","fetchPromise","put","processResponse","pendingRequest","refCount","getGoogle","_google","_pending","_loadScript2","google","_loadScript","cached","f","cache","iconFromBackgroundImage","st","getComputedStyle","backgroundImage","offsetLeft","components","register","viewModel","params","progress","pureComputed","range","progressRange","progressDone","targetPointsN","maxPointsN","samplingIntgerval","createSvg","attributes","element","createElementNS","setAttribute","pointOnSegmentAtDistance","dist","q","gradientToAngle","g","atan","PI","pathRegularSamples","segmentLength","samples","lastSampleDist","lastPointDistance","nextPointDistance","offestFromEvent","getBoundingClientRect","offestY","movementFromEvents","e1","e2","movementX","movementY","DragEvents","Class","dragTolerance","dragButtons","eventsSource","eventsTarget","setOptions","dragStartPos","prevEvent","isDragging","onMouseUp","onMouseLeave","button","_offset","disableImageDrag","disableTextSelection","enableImageDrag","enableTextSelection","dragButton","origEvent","exceedsTolerance","tolerance","abs","startEvent","sightLine","horizZoom","dragStart","_getElevation","values","_addTo","_controlContainer","setupContainerLayout","updateGraph","trackMarker","clickable","divIcon","onLineMouseMove","onLineMouseEnter","onLineMouseLeave","polyLineSelection","propsContainer","leftAxisLables","closeButton","onCloseButtonClick","drawingContainer","graphCursor","graphCursorLabel","graphSelection","svgWidth","clientWidth","svgHeight","clientHeight","svg","onSvgMouseMove","onSvgEnter","onSvgLeave","onSvgMouseWheel","svgDragEvents","onSvgDragStart","onSvgDragEnd","onSvgDrag","onSvgClick","onSvgDblClick","bringToBack","xToIndex","updateGraphSelection","selStart","selEnd","selStartInd","selEndInd","cursorShow","stats","calcProfileStats","updatePropsDisplay","scrollLeft","setLatLngs","setMapPositionAtIndex","ind","panTo","oldHorizZoom","getWheelDelta","newScrollLeft","setupGraph","cursorHide","setCursorPosition","ascentAngleStr","angleAvgAscent","avg","angleMaxAscent","descentAngleStr","angleAvgDescent","angleMaxDescent","start","end","finalAscent","ascent","descent","distance","calcGridValues","minValue","maxValue","ticksN","tickStep","tick1","tick2","ticksNs","tickSteps","ticks","matchFound","floor","ceil","filterElevations","filtered","scanStart","scanEnd","linearValue","linearDelta","maxError","maxErrorInd","queue","partial","a","b","gradient","ascents","descents","gradientAvgAscent","gradientMinAscent","gradientMaxAscent","gradientAvgDescent","gradientMinDescent","gradientMaxDescent","angleMinAscent","angleMinDescent","delta","filterTolerance","angle","indInt","elevation","ele","grad","markerPos","indFrac","setLatLng","html","setIcon","sqrDist","latlng1","latlng2","dx","dy","sampleLatlng","di","nearestInd","minDist","mouseLatlng","prevDist","prevSampleDist","nextDist","nextSampleDist","hasChildNodes","lastChild","horizStep","verticalMultiplier","gridValues","paddingBottom","paddingTop","gridStep","x1","x2","d","stroke-width","stroke","fill","stroke-opacity","valueToSvgCoord","startNewSegment","y1","y2","parseResponse","req","xhrPromise","responseText","extendLayerName","code","enableHotKeys","control","originalOnAdd","originalOnRemove","originalAddItem","_addItem","_hotKeysEnabled","result","_addHotketEvents","_onHotkeyUp","_addHotKetEvents","altKey","ctrlKey","shiftKey","_keyDown","pressedKey","targetTag","type","_layers","layerId","toUpperCase","inputs","_form","input","click","_update","enableTopRow","_topRowEnabled","__injectTopRow","_topRow","insertBefore","arrayItemsEqual","l1","l2","hashState","_listeners","_state","_saveStateToHash","_parseHash","hash","args","substr","pair","_m","_m2","stateItems","onHashChanged","newState","changedKeys","BingLayer","TileLayer","subdomains","attribution","culture","_key","_url","_providers","metaRequested","tile2quad","quad","digit","mask","getTileUrl","tilePoint","_getZoomForUrl","loadMetadata","cbid","meta","getElementById","errorDetails","initMetadata","urlScheme","protocol","script","id","r","resourceSets","resources","imageUrlSubdomains","imageUrl","imageryProviders","coverageAreas","coverage","zoomMin","zoomMax","active","LatLngBounds","LatLng","bbox","attrib","_update_attribution","getSouthWest","getNorthEast","getZoom","intersects","attributionControl","addAttribution","removeAttribution","bingLayer","_googleMapsApi","_googleMapsApi2","Google","mapType","_clearTiles","_googleMapContainer","visibility","pointerEvents","getCenter","maps","_googleMap","Map","tilt","mapTypeId","MapTypeId","disableDefaultUI","keyboardShortcuts","draggable","disableDoubleClickZoom","scrollwheel","streetViewControl","clickableIcons","_onTilesLoaded","_syncPosition","viewreset","resize","_onResize","move","zoomanim","_onZoom","clearInstanceListeners","_pendingTiles","_readyTiles","trigger","googleCenter","setCenter","setZoom","_roadRegexp","_satRegexp","_collectMapImageElements","_fullfillPendingTiles","tiles","_tileCoordsToKey","_step2$value","cb","_tileOnLoad","_tileOnError","alt","tile","ielt9","cloneMarkers","cloneMarker","markersCopy","cloneForPrint","printIconsOpacity","scale","crs","dummyMap","resolution","pixelBounds","destPixelSize","getTopRight","getBottomLeft","CRS","EPSG3857","latLngToPoint","pointToLatLng","noop","CanvasLayerGrabMixin","GridLayerGrabMixin","TileLayerGrabMixin","_imgFromDataString","tileImagePromiseFromCoords","waitTilesReadyToGrab","tileRange","topLeft","tilePromiseIterator","_context3","_pxBoundsToTileRange","_loop","_ret","tilePos","coordsPlusOne","tilePlusOne","_tileImagePromiseFrom","Point","_tileZoom","_isValidTile","_getTilePos","add","subtract","_level","origin","_wrapCoords","delegateYield","tileLayer","noCors","xhrQueue","rawData","imgFromDataString","getCanvasFromTile","getTempMap","fullSize","divideBy","fadeAnimation","zoomAnimation","inertia","maxZoom","setView","disposeMap","_westraPassesMarkers","WestraPasses","fileRegions1","fileRegions2","baseUrl","WestraPassesMarkers","regions1","GeoJSONAjax","onEachFeature","_setRegionLabel","regions2","layerName","zoomToRegion","latlon","properties","labelMarker","setLayersVisibility","newZoom","zoomFinished","loadData","_popupWindow","_escapeHtml","_escapeHtml2","filePasses","showPassDescription","_baseUrl","_downloadStarted","_loadMarkers","_makeTooltip","grade","is_summit","_passToGpx","gpx","_passToKml","kml","_makeIcon","grade_eng","features","_dataLoaded","altnames","connects","comments","comment","user","content","slopes","author","openPopup","maxWidth","onclick","openPopupWindow","yandexCrs","EPSG3395","Yandex","retina","yandexScale","_mapType","tilePosLatLng","scaleBy","getTileSize","bounds2","Bounds","coordsBelow","_adjustHeight","_initTile","sinCosFromLatLonSegment","len","sqrt","sin","cos","minTicksIntervalMm","_ticks","updateTicks","updateTicksLater","_clearTicks","tick","_addTick","transformMatrixString","transformMatrix","_icon","transform","labelText","distanceValue","keyboard","addTick","contains","sinCos","steps","nextPointMeasure","lastTickMeasure","lastPointMeasure","_latlngs","points_n","pad","rad","dpi","mercatorMetersPerPixel","referencePoint","realMetersPerPixel","mapScale","oldTicks","oldMarker","measuredLine","mod","ar1","_declination2","array","ar2","Float32Array","valueScale","offset","valueOffset","getArrayValue","row","col","colsCount","rowsCount","getDeclination","minLat","maxLat","row1","row2","dlat","col1","col2","dlon","a1","a2","v1","v2","_declination","uniqName","screenLeft","screen","availLeft","bordersWidth","screenX","outerWidth","availWidth","screenY","focus","setUp","_leaflet3","fixAll","zoomControl","inertiaMaxSpeed","worldCopyJump","tracklist","Caption","Scale","imperial","Ruler","panoramas","Panoramas","hashStateUpgrader","Coordinates","azimuthControl","Azimuth","layersControl","layers","collapsed","_leafletControlLayers2","_leafletControlLayers4","_leafletControlLayers6","_leafletControlLayers8","_layers2","printControl","PrintPages","hasPages","JNX","loadTracksFromStorage","_leafletControls2","saveTracksToStorage","setEnabled","hideProfile","_leafletControlLayers","_leafletControlLayers3","_leafletControlLayers5","_leafletControlLayers7","_leafletControls","_App","_App2","sentryDSN","config","release","install","oldOnunhandledrejection","onunhandledrejection","console","reason","log","group","title","order","isDefault","jnx","maxNativeZoom","bingKey","tms","SovietTopoGrid","Wikimapia","thunderforestKey","minZoom","minNativeZoom","Nordeskart","codes","orders","maxSize","_maxSize","_store","_size","readFile","file","reader","FileReader","onload","readAsArrayBuffer","fileInput","multiple","display","_defineProperty","radians","degrees","calcAzimuth","lat1","lat2","lng1","lng2","brng","atan2","calcAngle","Projection","SphericalMercator","roundAzimuth","_control","_control2","_magneticDeclination","_pointer","_pointer2","_pointerStart","_pointerStart2","_pointerEnd","_pointerEnd2","_enabled","trueAzimuth","magneticAzimuth","iconSingle","iconUrl","iconStart","iconEnd","single","which","onMarkerDrag","rotationOrigin","onMarkerDragEnd","azimuthLine","onMinimizeButtonClick","setPoints","getLatLng","elevationControl","showProfile","expanded","isExpanded","enabled","isEnabled","onMapClick","onEnableButtonClick","hasClass","setRotationAngle","updateValuesDisplay","azimuth","declination","onProfileButtonClick","onReverseButtonClick","contents","_contents","setContents","zeroes","normalizeLongitude","_safeLocalstorage","_safeLocalstorage2","formatNames","D","DM","DMS","_field_lat","_field_lon","prepareForClickOnMap","onMenuSelect","loadStateFromStorage","fmt","leafletCoordinatesActive","leafletCoordinatesFmt","setFormat","saveStateToStorage","formatCoodinate","isLat","_e$latlng","onMapRightClick","strLat","strLng","BinStream","_utf2","littlEndian","dv","DataView","_pos","old_buffer","buffer","newAr","oldAr","grow","newPos","checkSize","setUint8","setInt8","setInt16","setUint16","setInt32","setUint32","zeroTerminated","encode","writeUint8","pos","_selector","validateFloat","south","west","north","east","removeSelector","addSelector","_jnxMaker","_layersControl","makingJnx","downloadProgressRange","downloadProgressDone","contextMenu","makeMenuItems","getLayerForJnx","selectedLayer","layerRec","hasLayer","estimateTilesCount","tilesCount","topLeftTile","getNorthWest","bottomRightTile","getSouthEast","_getLayerForJnx","maxLevel","minLevel","equatorLength","metersPerPixel","pow","fileSizeMb","itemClass","resolutionString","sizeString","makeJnx","notifyProgress","sanitizedLayerName","makeJnxFromLayer","RectangleSelect","onButtonClicked","jnxCoordinates","extents","toJnx","JnxWriter","_binaryStream","productName","productId","zOrder","addTile","getJnx","HEADER_SIZE","LEVEL_INFO_SIZE","TILE_INFO_SIZE","totalTilesCount","levelTiles","levels_n","stream","writeInt32","writeUint32","seek","writeString","writeInt16","tileDescriptorOffset","tell","jnxScale","tileDataOffset","blob","getBuffer","imageFromarrayBuffer","dataUrl","btoa","Image","onerror","ensureImageJpg","convertToJpeg","dataURL","sent","toDataURL","srcLayer","maxZoomLevel","jnxProductId","jnxZOrder","writer","doStop","minZoomLevel","progressWeight","promises","tempMap","_ref3","tilePromiseRec","imageRec","_jnxEncoder","_leafletLayer","_rasterizeNeedsFullSizeMap","defaultXHROptions","t1","t2","promiseRec","_x2","_x3","_x6","Rectangle","fillOpacity","fillColor","drag","dragend","placeMarkers","topLeftPixel","bottomRightPixel","marginLeft","marginTop","setBoundsFromMarkers","setBounds","enableAdaptiveHeight","_adaptiveHeightEnabled","__setupResizeEventsHandler","__setAdaptiveHeight","enableConfig","originalUnserializeState","_configEnabled","_allLayersGroups","_allLayers","_customLayers","__injectConfigButton","configButton","_onConfigButtonClick","newCustomLayerButton","onCustomLayerCreateClicked","_initializeLayersState","storedLayersEnabled","localstorage.layersEnabled","loadCustomLayerFromString","checked","updateEnabledLayers","showLayersSelectWindow","_initLayersSelectWindow","_configWindow","_configWindowVisible","hideSelectWindow","onSelectWindowCancelClicked","onSelectWindowResetClicked","onSelectWindowOkClicked","showCustomLayerForm","caption","fieldValues","onCustomLayerAddClicked","onCustomLayerCancelClicked","disabledLayers","hasBaselayerOnMap","enabledLayers","sort","addOverlay","addBaseLayer","storeEnabledLayers","layersState","_arr2","_i2","isCustom","stringify","newCode","_arr3","_i3","buttons","buttonClicked","form","querySelector","_customLayerWindow","customLayerWindow","buttonsHtml","overlay","_step3$value","buttonEl","__customLayer","editButton","children","onCustomLayerEditClicked","serializeCustomLayer","encodeUrlSafeBase64","customLayerExists","ignoreLayer","checkCustomLayerValues","duplicateLayer","createCustomLayer","hideCustomLayerForm","ignoreExists","customLayer","onCustomLayerChangeClicked","onCustomLayerDeletelClicked","newFieldValues","layerPos","newLayer","originalLayerOnAdd","Layers","originalZoomOnAdd","Zoom","enableMinimize","_minimizeEnabled","__injectMinimizeButtons","contentsWrapper","minimizeButton","expandButton","fireRefreshEventOnWindow","evt","createEvent","initEvent","dispatchEvent","_google2","_mapillary","_mapillary2","_wikimedia","_wikimedia2","PanoMarker","Marker","zIndexOffset","getIcon","markerIcon","getElement","setHeading","setType","markerType","slim","normal","getProviders","provider","layerOptions","selected","mapMarkerType","panoramaContainer","_panoramaContainer","providers","updateCoverageVisibility","nearbyPoints","onButtonClick","controlEnabled","disableControl","enableControl","notifyChanged","hidePanoViewer","coverageLayer","getCoverageLayer","showPanoramaContainer","panoramaVisible","setupNearbyPoints","hidePano","viewer","deactivate","showPano","otherProvider","getViewer","setupViewerEvents","activate","change","onPanoramaChangeView","closeclick","onPanoramaCloseClick","hideMarker","placeMarker","heading","searchRadiusPx","searchRadiusMeters","_step9$value","_provider","searchResult","getPanoramaAtPos","coverageCode","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","viewerState","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_step11","_iterator11","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_step12","success","setState","_iterator12","panoramasControl","oldState","upgradedState","getStreetViewService","StreetViewService","service","getPanorama","radius","preference","StreetViewPreference","NEAREST","StreetViewStatus","OK","_ref4","_callee3","Viewer","Evented","panorama","StreetViewPanorama","enableCloseButton","imageDateControl","onCloseClick","_active","getPosition","pov","getPov","pitch","setVisible","setPov","_mapillaryCoverageLayer","MapillaryCoverage","getMapillary","formatDateTime","ts","Date","months","getDate","getMonth","getFullYear","resp","mapillary","component","cover","bearing","onNodeChanged","onBearingChanged","dateLabel","_bearing","_zoom","_center","moveToKey","updateZoomAndCenter","_node","fireChangeEvenet","capturedAt","getBearingCorrection","computedCA","originalCA","originalLatLon","_pitch","activateCover","_updateHandler","clearInterval","getBearing","deactivateCover","setInterval","_node$originalLatLon","center0","center1","moveCloseTo","_mapillaryLoader","updateWhenIdle","loader","MapillaryLoader","onTileUnload","_abortLoading","_tileData","_adjustment","drawOverview","_canvas$_adjustment","canvasCtx","geometry","beginPath","coordinates","arc","drawSequences","lineJoin","lineI","moveTo","lineTo","pointI","drawImages","_loader$requestTileDa","requestTileData","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","getter","_tiledDataLoader","_mvt","_TiledDataLoader","_temp","_len","z2","_processResponse","decodeMvt","decodeCoordinate","parseGeometry","geometryType","ints","coordinatesScale","_vector_tile_proto","Tile","GeomType","POINT","LINESTRING","POLYGON","lineStrings","cmd","cmdRepeat","cmdN","parseFeatures","ar","tileExtent","pbf","_pbf2","read","parsedLayers","extent","_pbf","readFields","_readField","tag","readVarint","UNKNOWN","Feature","tags","readPackedVarint","WikimediaVectorCoverage","MultiLayer","WikimediaLoader","urlTemplate","Uint16Array","dataOffset","dataExtent","pixelScale","_coverageLayer","parseSearchResponse","query","pages","page","iinfo","imageinfo","imageDescription","extmetadata","ImageDescription","objectDescription","ObjectName","test","Artist","descriptionurl","thumburl","timeOriginal","DateTimeOriginal","time","DateTime","pageUrl","pageId","pageid","isCloser","d1","d2","dateStr","_m$slice","_m$slice2","year","month","day","clusterSize","photos","photo","mapContainer","pageButtonContainer","maxBoundsViscosity","Simple","zoomSnap","notifyChange","infoLabel","prevPhotoButton","nextPhotoButton","switchPhoto","_imageIdx","setupPageButtons","_buttons","imageIdx","imagePos","imageLayer","mapSize","log2","southWest","northEast","setMaxZoom","setMaxBounds","animate","imageOverlay","setUrl","_showPano","_step4$value","savePagesPdf","imagesInfo","pdf","_pdf","makePdf","savePageJpg","_pageFeature","_pageFeature2","_mapRender","_form2","_decoration","_decoration2","_decoration3","extenders","checkNumberRange","write","newValue","notifySubscribers","pageSizes","zoomLevel","pageWidth","pageHeight","settingsExpanded","makingPdf","marginRight","marginBottom","autoZoomLevels","printSize","_printSize","onPageSizeChanged","pageSizeDescription","_displayPageSize","pagesNum","pagesNumLabel","_pagesNumLabel","gridOn","magneticMerisiansdOn","updateFormZooms","addPage","isLandsacape","_printSize2","_rotated","cm","makePageContexmenuItems","rotatePage","addLandscapePage","addPortraitPage","removePage","setLabel","removePages","onSavePdfClicked","savePdf","zoomForPrint","suggestZooms","mapZoom","satZoom","incrementProgress","inc","getLatLngBounds","getPrintSize","getLabel","decorationLayers","Grid","MagneticMeridians","OverlayScale","renderPages","zooms","progressCallback","pageNumber","_printSize3","_printSize4","setSize","renumberPage","rotate","newIndex","oldIndex","referenceLat","absLats","targetMetersPerPixel","mapUnitsPerPixel","LN2","flags","rotated","_decorations","_PrintStaticLayer","minGridIntervalMm","fontSizeMm","paddingMm","intervals","minGridIntervalM","intervalM","unit","metersPerDegree","R","pixelsPerMm","getGridInterval","mercatorBounds","canvasToMercatorScale","unscaleBy","rows","yMerc","yMerc2","lineWidthMm","lineWidthPx","_arr$_i","pageCanvasCenterX","direction","colN","firstRow","hasPointInPage","formatDistance","fontSize","padding","fillRect","_drawGrid","_drawLabel","lineThicknessMm","lineIntervalMm","samplingIntervalMm","projectedBounds","pixel","drawLine","directionDown","maxSegments","toLatLng","samplingPx","_makeCanvasToLatLngTransformer","intervalPx","pageDiagonal","maxLines","pageScaleRange","pageSize","southLen","northLen","nScale","sScale","formatScale","nominalScale","scaleRange","threshold","pagesCount","pageLabel","getLayersForPrint","getZIndex","compare","i1","i2","compareLayersOrder","layer1","layer2","compareArrays","getLayerZOrder","_path","eachLayer","blendMultiplyCanvas","dest","s_data","getImageData","sr","sg","sb","sa","sa1","dr","dg","db","d_image_data","d_data","data_length","putImageData","_asyncGenerator","AwaitValue","AsyncGenerator","request","back","front","resume","settle","_invoke","asyncIterator","throw","await","iterateLayersTiles","layerPromises","_loop2","_ret2","progressInc","tileInfo","_x7","_x8","promiseQueueBuffer","source","maxActive","_ref5","_value","_done","_ref6","_context4","_x9","_x10","_ref7","_ref8","_layer","pageImagesInfo","_pixelBounds","composer","tilesIterator","queuedTilesIterator","_ref9","_tilePromise","_context5","multiplyBy","PageComposer","putTile","getDataUrl","_x11","destSize","pixelBoundsAtZoom24","currentCanvas","currentZoom","targetCanvas","createCanvas","mergeCurrentCanvas","setupCurrentCanvas","bottomRight","PageFeature","centerLatLng","paperSize","updateView","rectangle","_getLatLngBounds","centerMerc","mercatorScale","Earth","mercatorPageSize","sw","ne","_animateZoom","pixel_sw","pixel_ne","pixel_center","pixel_width","pixel_height","lineHeight","eof","recCatalog","recPages","kidsIds","recPage","serialNum","pageRecId","contentRecId","imageRecId","recContent","recImage","widthPixels","heightPixels","recTrailer","recOffsets","currentOffset","trailer","addRec","skipOffset","offsets","_step2$value$","widthPoints","heightPoints","trackList","_trackList","packNumber","bytes","stringified","deltaX","deltaY","lastX","lastY","urlEncode","encodeURIComponent","trackId","newUrl","fileId","speed","dataType","filetype","submitButton","inappropriate","href","notEmpty","maxLocalStorageSessions","maxKey","raiseControlsOnFocus","raise","elements","cornerDiv","selectors","querySelectorAll","fixPanAnimationBug","fixTouchDetection","fixMapKeypressEvent","chrome","PosAnimation","__panAnimationFixed","originalStep","touch","navigator","pointerEnabled","ie","maxTouchPoints","originalHandleDOMEvent","_handleDOMEvent","_fireDOMEvent","k1","k2","hasBaselayer","precision","GeoJSON","requestTimeout","_loadStarted","addData","token","getToken","tokenUpdateInterval","__url","baatTokenUpToDate","nextUpdate","now","storeBaatToken","periodicTokenUpdate","baatToken","_TileLayer","GooglePrint","_dummyTile","_waitTilesReadyToGrab","_tilesReadyToGrab","printWidthMm","clone","_makelatLngToCanvasPixelTransformer","tickFontSizeMm","ticksPixelSize","setTransform","addInitHook","waitDataReady","blobUrl","URL","createObjectURL","revokeObjectURL","zeroPad","num","bigLetterReplacers","1","2","3","4","Nomenclature","getQuadName1m","column","getQuadName500k","name1","subquad","name2","names","replacer","name3","getQuadName100k","subRow","subColumn","getQuadName050k","_getQuads","row_height","column_width","name_factory","quads","min_lat","max_lat","min_row","joined_quads","row_south","row_north","min_lon","max_lon","min_column","column_west","column_east","quad_bounds","getQuads1m","getQuads500k","getQuads100k","getQuads050k","LayerGroup","renderer","_quads","_updateRenderer","throttle","_reset","_cleanupQuads","_addQuad","titles","rect_options","smoothFactor","noClip","objects","_showContextMenu","scaleString","1m","500k","100k","050k","_removeQuad","_addQuads","_addGrid","map_bbox","reset","clearLayers","quad_id","isPointInPolygon","polygon","inside","prevNode","_wikimapiaLoader","WikimapiaLoader","highlightedPlace","places","place","localPolygon","polygon2","_tileCoordsFromEvent","layerPoint","getPixelOrigin","getPlaceAtMousePos","tileCoords","_tiles","getPlaceAtLatlng","setContent","boundsWESN","_wmUtils","_wmUtils2","projectObj","_projectObj","exactMatch","hasChildren","makeTileUrl","parseTile","getTileId","tileId","urlPath","tileIdToCoords","getWikimapiaTileCoords","viewTileSize","decodeTitles","langCode","chooseTitle","popularLanguages","decodePolygon","makeCoordsLocal","tileX","tileY","tileZ","x0","y0","localCoords","asap","simplifyPolygon","tileHasChildren","p0","pixelDegSize","simplify","prevTime","curTime","_fields","placeId","latlngToXy","xyToLatlng","_nodeMarkersZOffset","_editing","_drawingDirection","setupMarkers","onMapEndDrag","onKeyPress","_storedStyle","_nodeMarker","_lineNode","_segmentOverlay","onNodeMarkerDragEnd","replaceNode","onNodeMarkerMovedChangeNode","onNodeMarkerDblClickedRemoveNode","removeNode","newNodeIndex","addNode","handler","dragging","_draggable","mousePos","_startPoint","_newPos","_startPos","mouseEventToLatLng","spliceLatLngs","onMouseMoveFollowEndNode","makeNodeMarker","onNodeMarkerClickStartStopDrawing","latlngs_n","makeSegmentOverlay","segmentOverlay","onSegmentMouseDownAddNode","Draggable","_dragging","finishDrag","_onDown","nodes","isAddingLeft","isAddingRight","oldNode","startNode","endNode","stripBom"],"mappings":"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AEAuB,QAAOE,eAAezB,EAAS,cAC3B0B,OAAO,IAEX1B,EAAQK,S6FjgjBL8kD,QAAS,mEACTI,iBAAkB,mCAClBnB,UAAW,GACXkd,UAAW,yD7FsgjBN,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CAET,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IAEA,IACS,CACA,CAEH,SAASvhE,EAAQC,G8F7xjBvBD,EAAAC,SACAogD,WACArtC,KAAA,EACAmtC,UAAA,GACAG,OAAA,GACAR,YAAA,GACAL,MAAA,mrgBACAS,UAAA,IACAN,WAAA,I9FmyjBS,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CAEH,SAAS5/C,EAAQC,G+FxzjBvBD,EAAAC,QAAA,ktC/F8zjBM,SAASD,EAAQC,GgG9zjBvBD,EAAAC,QAAA,mqKhGm0jBS,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CACA,CAEH,SAASD,EAAQC,GiGn1jBvBD,EAAAC,QAAA,syBjGy1jBM,SAASD,EAAQC,GkGz1jBvBD,EAAAC,QAAA,syBlG+1jBM,SAASD,EAAQC,GmG/1jBvBD,EAAAC,QAAA","file":"static/js/main.9b918799.js","sourcesContent":["webpackJsonp([2],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(233);\n\tmodule.exports = __webpack_require__(174);\n\n\n/***/ },\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _ravenJs = __webpack_require__(169);\n\t\n\tvar _ravenJs2 = _interopRequireDefault(_ravenJs);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction captureException(e, options) {\n\t    _ravenJs2.default.captureException(e, options);\n\t}\n\t\n\tfunction captureMessage(msg, options) {\n\t    _ravenJs2.default.captureMessage(msg, options);\n\t}\n\t\n\tfunction captureMessageWithUrl(msg) {\n\t    captureMessage(msg, { extra: { url: window.location.toString() } });\n\t}\n\t\n\tfunction setExtraContext(data) {\n\t    _ravenJs2.default.setExtraContext(data);\n\t}\n\t\n\tfunction captureBreadcrumb(crumb) {\n\t    _ravenJs2.default.captureBreadcrumb(crumb);\n\t}\n\t\n\tfunction captureBreadcrumbWithUrl(crumb) {\n\t    var data = Object.assign(crumb.data || {}, { 'url': window.location.toString() });\n\t    crumb = Object.assign({}, crumb, { data: data });\n\t    captureBreadcrumb(crumb);\n\t}\n\t\n\texports.default = { captureMessage: captureMessage, captureException: captureException, setExtraContext: setExtraContext, captureBreadcrumbWithUrl: captureBreadcrumbWithUrl, captureBreadcrumb: captureBreadcrumb, captureMessageWithUrl: captureMessageWithUrl };\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.XHRQueue = exports.fetch = undefined;\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _binaryStrings = __webpack_require__(50);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction successIfStatus200(xhr) {\n\t    return xhr.status >= 200 && xhr.status <= 299;\n\t}\n\t\n\tfunction retryIfNetworkErrorOrServerError(xhr) {\n\t    return xhr.status === 0 || xhr.status >= 500;\n\t}\n\t\n\tvar XMLHttpRequestPromiseError = function (_Error) {\n\t    _inherits(XMLHttpRequestPromiseError, _Error);\n\t\n\t    function XMLHttpRequestPromiseError(xhr) {\n\t        _classCallCheck(this, XMLHttpRequestPromiseError);\n\t\n\t        var _this = _possibleConstructorReturn(this, (XMLHttpRequestPromiseError.__proto__ || Object.getPrototypeOf(XMLHttpRequestPromiseError)).call(this));\n\t\n\t        _this.xhr = xhr;\n\t        _this.name = 'XMLHttpRequestPromiseError';\n\t\n\t        _this.message = xhr.status === 0 ? 'network error' : 'server response is ' + xhr.status;\n\t        return _this;\n\t    }\n\t\n\t    return XMLHttpRequestPromiseError;\n\t}(Error);\n\t\n\tvar XMLHttpRequestPromise = function () {\n\t    function XMLHttpRequestPromise(url) {\n\t        var _this2 = this;\n\t\n\t        var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n\t            _ref$method = _ref.method,\n\t            method = _ref$method === undefined ? 'GET' : _ref$method,\n\t            _ref$data = _ref.data,\n\t            data = _ref$data === undefined ? null : _ref$data,\n\t            _ref$responseType = _ref.responseType,\n\t            responseType = _ref$responseType === undefined ? '' : _ref$responseType,\n\t            _ref$timeout = _ref.timeout,\n\t            timeout = _ref$timeout === undefined ? 30000 : _ref$timeout,\n\t            _ref$maxTries = _ref.maxTries,\n\t            maxTries = _ref$maxTries === undefined ? 3 : _ref$maxTries,\n\t            _ref$retryTimeWait = _ref.retryTimeWait,\n\t            retryTimeWait = _ref$retryTimeWait === undefined ? 500 : _ref$retryTimeWait,\n\t            _ref$isResponseSucces = _ref.isResponseSuccess,\n\t            isResponseSuccess = _ref$isResponseSucces === undefined ? successIfStatus200 : _ref$isResponseSucces,\n\t            _ref$responseNeedsRet = _ref.responseNeedsRetry,\n\t            responseNeedsRetry = _ref$responseNeedsRet === undefined ? retryIfNetworkErrorOrServerError : _ref$responseNeedsRet,\n\t            _ref$headers = _ref.headers,\n\t            headers = _ref$headers === undefined ? null : _ref$headers;\n\t\n\t        _classCallCheck(this, XMLHttpRequestPromise);\n\t\n\t        // console.log('promise constructor', url);\n\t        var promise = new Promise(function (resolve, reject) {\n\t            _this2._resolve = resolve;\n\t            _this2._reject = reject;\n\t        });\n\t        this.then = promise.then.bind(promise);\n\t        this.catch = promise.catch.bind(promise);\n\t        this.method = method;\n\t        this.url = url;\n\t        this.responseType = responseType;\n\t        this.postData = data;\n\t        this._isResponseSuccess = isResponseSuccess;\n\t        this._responseNeedsRetry = responseNeedsRetry;\n\t        this._retryTimeWait = retryTimeWait;\n\t        this.triesLeft = maxTries;\n\t\n\t        var xhr = this.xhr = new XMLHttpRequest();\n\t        xhr.onreadystatechange = function () {\n\t            return _this2._onreadystatechange();\n\t        };\n\t        this._open();\n\t        xhr.timeout = timeout;\n\t        if (responseType === 'binarystring') {\n\t            xhr.responseType = 'arraybuffer';\n\t        } else {\n\t            xhr.responseType = responseType;\n\t        }\n\t        if (headers) {\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = headers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var _step$value = _slicedToArray(_step.value, 2),\n\t                        k = _step$value[0],\n\t                        v = _step$value[1];\n\t\n\t                    xhr.setRequestHeader(k, v);\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    }\n\t\n\t    _createClass(XMLHttpRequestPromise, [{\n\t        key: '_open',\n\t        value: function _open() {\n\t            // console.log('open', this.url);\n\t            this.xhr.open(this.method, this.url);\n\t        }\n\t    }, {\n\t        key: '_onreadystatechange',\n\t        value: function _onreadystatechange() {\n\t            var _this3 = this;\n\t\n\t            var xhr = this.xhr;\n\t            if (xhr.readyState === 4 && !this._aborted) {\n\t                // console.log('ready state 4', this.url);\n\t                xhr.responseBinaryText = '';\n\t                if (this.responseType === 'binarystring' && xhr.response && xhr.response.byteLength) {\n\t                    xhr.responseBinaryText = (0, _binaryStrings.arrayBufferToString)(xhr.response);\n\t                }\n\t                // IE doesnot support responseType=json\n\t                if (this.responseType === 'json' && typeof xhr.response === 'string') {\n\t                    try {\n\t                        // xhr.response is readonly\n\t                        xhr.responseJSON = JSON.parse(xhr.response);\n\t                    } catch (e) {}\n\t                } else {\n\t                    xhr.responseJSON = xhr.response;\n\t                }\n\t                if (this._isResponseSuccess(xhr)) {\n\t                    // console.log('success', this.url);\n\t                    this._resolve(xhr);\n\t                } else {\n\t                    if (this.triesLeft > 0 && this._responseNeedsRetry(xhr)) {\n\t                        // console.log('retry', this.url);\n\t                        this._open();\n\t                        this._timerId = setTimeout(function () {\n\t                            return _this3.send();\n\t                        }, this._retryTimeWait);\n\t                    } else {\n\t                        // console.log('failed', this.url);\n\t                        this._reject(new XMLHttpRequestPromiseError(xhr));\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'abort',\n\t        value: function abort() {\n\t            // console.log('abort', this.url);\n\t            this._aborted = true;\n\t            clearTimeout(this._timerId);\n\t            this.xhr.abort();\n\t        }\n\t    }, {\n\t        key: 'send',\n\t        value: function send() {\n\t            // console.log('send', this.url);\n\t            this.triesLeft -= 1;\n\t            this.xhr.send(this.postData);\n\t        }\n\t    }]);\n\t\n\t    return XMLHttpRequestPromise;\n\t}();\n\t\n\tvar XHRQueue = function () {\n\t    function XHRQueue() {\n\t        var maxSimultaneousRequests = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 6;\n\t\n\t        _classCallCheck(this, XHRQueue);\n\t\n\t        this._maxConnections = maxSimultaneousRequests;\n\t        this._queue = [];\n\t        this._activeCount = 0;\n\t    }\n\t\n\t    _createClass(XHRQueue, [{\n\t        key: 'put',\n\t        value: function put(url, options) {\n\t            var _this4 = this;\n\t\n\t            var promise = new XMLHttpRequestPromise(url, options);\n\t            promise._originalAbort = promise.abort;\n\t            promise.abort = function () {\n\t                return _this4._abortPromise(promise);\n\t            };\n\t            this._queue.push(promise);\n\t            this._processQueue();\n\t            return promise;\n\t        }\n\t    }, {\n\t        key: '_abortPromise',\n\t        value: function _abortPromise(promise) {\n\t            var _this5 = this;\n\t\n\t            var i = this._queue.indexOf(promise);\n\t            if (i > -1) {\n\t                // console.log('ABORT IN QUEUE');\n\t                this._queue.splice(i, 1);\n\t            } else {\n\t                if (promise.xhr.readyState === 4) {\n\t                    // console.log('ABORT COMPLETED');\n\t                } else {\n\t                    // console.log('ABORT ACTIVE');\n\t                    promise._originalAbort();\n\t                    this._activeCount -= 1;\n\t                    setTimeout(function () {\n\t                        return _this5._processQueue();\n\t                    }, 0);\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: '_processQueue',\n\t        value: function _processQueue() {\n\t            var _this6 = this;\n\t\n\t            if (this._activeCount >= this._maxConnections || this._queue.length === 0) {\n\t                return;\n\t            }\n\t            var promise = this._queue.shift();\n\t            promise.catch(function () {}).then(function () {\n\t                return _this6._onRequestReady(promise);\n\t            });\n\t            this._activeCount += 1;\n\t            promise.send();\n\t        }\n\t    }, {\n\t        key: '_onRequestReady',\n\t        value: function _onRequestReady(promise) {\n\t            var _this7 = this;\n\t\n\t            if (!promise._aborted) {\n\t                this._activeCount -= 1;\n\t            }\n\t            setTimeout(function () {\n\t                return _this7._processQueue();\n\t            }, 0);\n\t        }\n\t    }]);\n\t\n\t    return XHRQueue;\n\t}();\n\t\n\tfunction fetch(url, options) {\n\t    // console.log('fetch', url);\n\t    var promise = new XMLHttpRequestPromise(url, options);\n\t    promise.send();\n\t    return promise;\n\t}\n\t\n\texports.fetch = fetch;\n\texports.XHRQueue = XHRQueue;\n\n/***/ },\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.include({\n\t    _stopContainerEvents: function _stopContainerEvents() {\n\t        var container = this._container;\n\t        _leaflet2.default.DomEvent.disableClickPropagation(container);\n\t        _leaflet2.default.DomEvent.disableScrollPropagation(container);\n\t        _leaflet2.default.DomEvent.on(container, 'mousemove contextmenu', _leaflet2.default.DomEvent.stop);\n\t    }\n\t});\n\n/***/ },\n/* 32 */,\n/* 33 */,\n/* 34 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _secrets = __webpack_require__(231);\n\t\n\tvar _secrets2 = _interopRequireDefault(_secrets);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = Object.assign({\n\t    email: 'nakarte@nakarte.tk',\n\t    googleApiUrl: 'https://maps.googleapis.com/maps/api/js?key=AIzaSyDleuw7YtJifzC1OI2nSah74KJfGiziHXY#v=3',\n\t    westraDataBaseUrl: 'http://nakarte.tk/westraPasses/',\n\t    CORSProxyUrl: 'http://proxy.nakarte.tk/',\n\t    elevationsServer: 'http://elevation.nakarte.tk/',\n\t    newsUrl: 'http://about.nakarte.tk',\n\t    wikimediaCommonsCoverageUrl: 'http://tiles.nakarte.tk/wikimedia_commons_images/{z}/{x}/{y}'\n\t}, _secrets2.default);\n\n/***/ },\n/* 35 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tfunction notify(message, level) {\n\t    setTimeout(function () {\n\t        return window.alert(message);\n\t    }, 0);\n\t}\n\t\n\tfunction prompt(message, value) {\n\t    return window.prompt(message, value);\n\t}\n\t\n\texports.notify = notify;\n\texports.prompt = prompt;\n\n/***/ },\n/* 36 */,\n/* 37 */,\n/* 38 */\n437,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */,\n/* 45 */,\n/* 46 */,\n/* 47 */,\n/* 48 */,\n/* 49 */,\n/* 50 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tfunction arrayBufferToString(arBuf) {\n\t    var arr = new Uint8Array(arBuf),\n\t        s = [];\n\t    for (var i = 0; i < arr.length; i += 4096) {\n\t        var chunk = arr.subarray(i, i + 4096);\n\t        chunk = String.fromCharCode.apply(null, chunk);\n\t        s.push(chunk);\n\t    }\n\t    return s.join('');\n\t}\n\t\n\tfunction stringToArrayBuffer(s) {\n\t    var length = s.length,\n\t        buf = new ArrayBuffer(length),\n\t        arr = new Uint8Array(buf);\n\t    for (var i = 0; i < length; i++) {\n\t        arr[i] = s.charCodeAt(i);\n\t    }\n\t    return buf;\n\t}\n\t\n\tfunction blobFromString(s) {\n\t    var arr = stringToArrayBuffer(s);\n\t    return new Blob([arr]);\n\t}\n\t\n\texports.arrayBufferToString = arrayBufferToString;\n\texports.blobFromString = blobFromString;\n\texports.stringToArrayBuffer = stringToArrayBuffer;\n\n/***/ },\n/* 51 */,\n/* 52 */,\n/* 53 */,\n/* 54 */,\n/* 55 */,\n/* 56 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\t__webpack_require__(443);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t    items = [\n\t        {text: 'Hello', disabled: true},\n\t        '-',\n\t        {text: 'World', callback: fn},\n\t        {text: 'section', separator: true},\n\t    ]\n\t */\n\t\n\tfunction isDescendant(parent, child) {\n\t    if (!parent) {\n\t        return false;\n\t    }\n\t    while (child) {\n\t        if (child === parent) {\n\t            return true;\n\t        }\n\t        child = child.parentNode;\n\t    }\n\t}\n\t\n\tvar Contextmenu = function () {\n\t    function Contextmenu(items) {\n\t        var _this = this;\n\t\n\t        _classCallCheck(this, Contextmenu);\n\t\n\t        this.onKeyDown = function (e) {\n\t            if (e.keyCode === 27) {\n\t                _this.hide();\n\t            }\n\t        };\n\t\n\t        this.onMouseDown = function (e) {\n\t            if (!isDescendant(_this._container, e.target)) {\n\t                _this.hide();\n\t            }\n\t        };\n\t\n\t        this.items = items;\n\t    }\n\t\n\t    _createClass(Contextmenu, [{\n\t        key: 'show',\n\t        value: function show(e) {\n\t            if (this._container) {\n\t                return;\n\t            }\n\t            if (e.originalEvent) {\n\t                e = e.originalEvent;\n\t            }\n\t            if (e.preventDefault) {\n\t                e.preventDefault();\n\t            } else {\n\t                e.returnValue = false;\n\t            }\n\t\n\t            var _e = e,\n\t                x = _e.clientX,\n\t                y = _e.clientY;\n\t\n\t\n\t            var container = this._container = document.createElement('div');\n\t            document.body.appendChild(container);\n\t            container.className = 'contextmenu';\n\t            container.style.zIndex = 10000;\n\t\n\t            window.addEventListener('keydown', this.onKeyDown, true);\n\t            window.addEventListener('mousedown', this.onMouseDown, true);\n\t            window.addEventListener('touchstart', this.onMouseDown, true);\n\t\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = this.createItems()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var item = _step.value;\n\t\n\t                    container.appendChild(item);\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t\n\t            this.setPosition(x, y);\n\t        }\n\t    }, {\n\t        key: 'hide',\n\t        value: function hide() {\n\t            if (!this._container) {\n\t                return;\n\t            }\n\t            document.body.removeChild(this._container);\n\t            this._container = null;\n\t\n\t            window.removeEventListener('keydown', this.onKeyDown, true);\n\t            window.removeEventListener('mousedown', this.onMouseDown, true);\n\t            window.removeEventListener('touchstart', this.onMouseDown, true);\n\t        }\n\t    }, {\n\t        key: 'setPosition',\n\t        value: function setPosition(x, y) {\n\t            var window_width = window.innerWidth,\n\t                window_height = window.innerHeight,\n\t                menu_width = this._container.offsetWidth,\n\t                menu_height = this._container.offsetHeight;\n\t            if (x + menu_width >= window_width) {\n\t                x -= menu_width;\n\t            }\n\t            if (y + menu_height >= window_height) {\n\t                y -= menu_height;\n\t            }\n\t            this._container.style.left = x + 'px';\n\t            this._container.style.top = y + 'px';\n\t        }\n\t    }, {\n\t        key: 'createItems',\n\t        value: /*#__PURE__*/regeneratorRuntime.mark(function createItems() {\n\t            var items, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, itemOptions;\n\t\n\t            return regeneratorRuntime.wrap(function createItems$(_context) {\n\t                while (1) {\n\t                    switch (_context.prev = _context.next) {\n\t                        case 0:\n\t                            items = this.items;\n\t\n\t                            if (typeof items === 'function') {\n\t                                items = items();\n\t                            }\n\t                            _iteratorNormalCompletion2 = true;\n\t                            _didIteratorError2 = false;\n\t                            _iteratorError2 = undefined;\n\t                            _context.prev = 5;\n\t                            _iterator2 = items[Symbol.iterator]();\n\t\n\t                        case 7:\n\t                            if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n\t                                _context.next = 20;\n\t                                break;\n\t                            }\n\t\n\t                            itemOptions = _step2.value;\n\t\n\t                            if (typeof itemOptions === 'function') {\n\t                                itemOptions = itemOptions();\n\t                            }\n\t\n\t                            if (!(itemOptions === '-' || itemOptions.separator)) {\n\t                                _context.next = 15;\n\t                                break;\n\t                            }\n\t\n\t                            _context.next = 13;\n\t                            return this.createSeparator(itemOptions);\n\t\n\t                        case 13:\n\t                            _context.next = 17;\n\t                            break;\n\t\n\t                        case 15:\n\t                            _context.next = 17;\n\t                            return this.createItem(itemOptions);\n\t\n\t                        case 17:\n\t                            _iteratorNormalCompletion2 = true;\n\t                            _context.next = 7;\n\t                            break;\n\t\n\t                        case 20:\n\t                            _context.next = 26;\n\t                            break;\n\t\n\t                        case 22:\n\t                            _context.prev = 22;\n\t                            _context.t0 = _context['catch'](5);\n\t                            _didIteratorError2 = true;\n\t                            _iteratorError2 = _context.t0;\n\t\n\t                        case 26:\n\t                            _context.prev = 26;\n\t                            _context.prev = 27;\n\t\n\t                            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                                _iterator2.return();\n\t                            }\n\t\n\t                        case 29:\n\t                            _context.prev = 29;\n\t\n\t                            if (!_didIteratorError2) {\n\t                                _context.next = 32;\n\t                                break;\n\t                            }\n\t\n\t                            throw _iteratorError2;\n\t\n\t                        case 32:\n\t                            return _context.finish(29);\n\t\n\t                        case 33:\n\t                            return _context.finish(26);\n\t\n\t                        case 34:\n\t                        case 'end':\n\t                            return _context.stop();\n\t                    }\n\t                }\n\t            }, createItems, this, [[5, 22, 26, 34], [27,, 29, 33]]);\n\t        })\n\t    }, {\n\t        key: 'createItem',\n\t        value: function createItem(itemOptions) {\n\t            var el = document.createElement('a');\n\t            var className = 'item';\n\t            if (itemOptions.disabled) {\n\t                className += ' disabled';\n\t            }\n\t            if (itemOptions.header) {\n\t                className += ' header';\n\t            }\n\t            el.className = className;\n\t            el.innerHTML = itemOptions.text;\n\t\n\t            var callback = itemOptions.callback;\n\t            if (callback && !itemOptions.disabled) {\n\t                el.addEventListener('click', this.onItemClick.bind(this, callback));\n\t            }\n\t            return el;\n\t        }\n\t    }, {\n\t        key: 'onItemClick',\n\t        value: function onItemClick(callback, e) {\n\t            e.stopPropagation();\n\t            e.preventDefault();\n\t            this.hide();\n\t            callback(e);\n\t        }\n\t    }, {\n\t        key: 'createSeparator',\n\t        value: function createSeparator(itemOptions) {\n\t            var el = document.createElement('div');\n\t            el.className = 'separator';\n\t            if (itemOptions.text) {\n\t                el.innerHTML = '<span>' + itemOptions.text + '</span>';\n\t            }\n\t            return el;\n\t        }\n\t    }]);\n\t\n\t    return Contextmenu;\n\t}();\n\t\n\texports.default = Contextmenu;\n\n/***/ },\n/* 57 */,\n/* 58 */,\n/* 59 */,\n/* 60 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = urlViaCorsProxy;\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction urlViaCorsProxy(url) {\n\t    return _config2.default.CORSProxyUrl + url.replace(/^(https?):\\/\\//, '$1/');\n\t};\n\n/***/ },\n/* 61 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _hashState = __webpack_require__(117);\n\t\n\tvar _hashState2 = _interopRequireDefault(_hashState);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Mixin.HashState = {\n\t    enableHashState: function enableHashState(key) {\n\t        var _this = this;\n\t\n\t        var defaultInitialState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\n\t        this._hashStateKey = key;\n\t        var eventSource = this.stateChangeEventsSource ? this[this.stateChangeEventsSource] : this;\n\t\n\t        // setup event listeners\n\t        if (this.stateChangeEvents) {\n\t            this.stateChangeEvents.forEach(function (event) {\n\t                eventSource.on(event, _this._onControlStateChanged, _this);\n\t            });\n\t        }\n\t\n\t        _hashState2.default.addEventListener(key, function (state) {\n\t            return _this._onExternalStateChanged(state);\n\t        });\n\t\n\t        // initialize control state from hash\n\t\n\t        var state = _hashState2.default.getState(key) || defaultInitialState;\n\t        this._ignoreStateChange = true;\n\t        if (!this.unserializeState(state) && !this.unserializeState(defaultInitialState)) {\n\t            // state from hash is invalid, update hash from default state\n\t            _hashState2.default.updateState(key, this.serializeState());\n\t        }\n\t        _hashState2.default.updateState(this._hashStateKey, this.serializeState());\n\t        this._ignoreStateChange = false;\n\t\n\t        return this;\n\t    },\n\t\n\t    _onControlStateChanged: function _onControlStateChanged() {\n\t        if (this._ignoreStateChange) {\n\t            return;\n\t        }\n\t        var state = this.serializeState();\n\t        _hashState2.default.updateState(this._hashStateKey, state);\n\t    },\n\t\n\t    _onExternalStateChanged: function _onExternalStateChanged(state) {\n\t        this._ignoreStateChange = true;\n\t        if (!this.unserializeState(state)) {\n\t            // state from hash is invalid, update hash from component state\n\t            _logging2.default.captureMessageWithUrl('Invalid state in hash string (key \"' + this._hashStateKey + '\")');\n\t            _hashState2.default.updateState(this._hashStateKey, this.serializeState());\n\t        }\n\t        this._ignoreStateChange = false;\n\t    }\n\t\n\t    // TODO: disableHashState\n\t};\n\n/***/ },\n/* 62 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(464);\n\t\n\tvar _rbush = __webpack_require__(488);\n\t\n\tvar _rbush2 = _interopRequireDefault(_rbush);\n\t\n\tvar _imagePromise = __webpack_require__(471);\n\t\n\tvar _imagePromise2 = _interopRequireDefault(_imagePromise);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\t/*\n\t Marker definition:\n\t {\n\t latlng: L.Latlng,\n\t icon: {url: string, center: [x, y]} or function(marker) returning icon,\n\t label: string or function,\n\t tooltip: string or function,\n\t any other fields\n\t }\n\t */\n\t\n\tfunction calcIntersectionSum(rect, rects) {\n\t    var sum = 0,\n\t        left = void 0,\n\t        right = void 0,\n\t        top = void 0,\n\t        bottom = void 0,\n\t        rect2 = void 0;\n\t\n\t    var _iteratorNormalCompletion = true;\n\t    var _didIteratorError = false;\n\t    var _iteratorError = undefined;\n\t\n\t    try {\n\t        for (var _iterator = rects[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t            rect2 = _step.value;\n\t\n\t            left = Math.max(rect.minX, rect2.minX);\n\t            right = Math.min(rect.maxX, rect2.maxX);\n\t            top = Math.max(rect.minY, rect2.minY);\n\t            bottom = Math.min(rect.maxY, rect2.maxY);\n\t            if (top < bottom && left < right) {\n\t                sum += (right - left) * (bottom - top);\n\t            }\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion && _iterator.return) {\n\t                _iterator.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError) {\n\t                throw _iteratorError;\n\t            }\n\t        }\n\t    }\n\t\n\t    return sum;\n\t}\n\t\n\t_leaflet2.default.Layer.CanvasMarkers = _leaflet2.default.GridLayer.extend({\n\t    options: {\n\t        async: true,\n\t        labelFontName: 'Verdana, Arial, sans-serif',\n\t        labelFontSize: 10,\n\t        iconScale: 1,\n\t        pane: 'rasterMarker',\n\t        updateWhenZooming: !_leaflet2.default.Browser.mobile,\n\t        iconsOpacity: 1\n\t    },\n\t\n\t    initialize: function initialize(markers, options) {\n\t        _leaflet2.default.GridLayer.prototype.initialize.call(this, options);\n\t        this.rtree = (0, _rbush2.default)(9, ['.latlng.lng', '.latlng.lat', '.latlng.lng', '.latlng.lat']);\n\t        this._regions = (0, _rbush2.default)();\n\t        this._iconPositions = {};\n\t        this._labelPositions = {};\n\t        this._labelPositionsZoom = null;\n\t        this.addMarkers(markers);\n\t        this._images = {};\n\t        this._tileQueue = [];\n\t        this._hoverMarker = null;\n\t        this.on('markerenter', this.onMarkerEnter, this);\n\t        this.on('markerleave', this.onMarkerLeave, this);\n\t    },\n\t\n\t    addMarkers: function addMarkers(markers) {\n\t        var _this = this;\n\t\n\t        if (markers) {\n\t            this.rtree.load(markers);\n\t            this.resetLabels();\n\t            setTimeout(function () {\n\t                return _this.redraw();\n\t            }, 0);\n\t        }\n\t    },\n\t\n\t    addMarker: function addMarker(marker) {\n\t        var _this2 = this;\n\t\n\t        // FIXME: adding existing marker must be be noop\n\t        this.rtree.insert(marker);\n\t        this.resetLabels();\n\t        setTimeout(function () {\n\t            return _this2.redraw();\n\t        }, 0);\n\t    },\n\t\n\t    removeMarker: function removeMarker(marker) {\n\t        this.removeMarkers([marker]);\n\t    },\n\t\n\t    removeMarkers: function removeMarkers(markers) {\n\t        var _this3 = this;\n\t\n\t        markers.forEach(function (marker) {\n\t            return _this3.rtree.remove(marker);\n\t        });\n\t        this.resetLabels();\n\t        setTimeout(function () {\n\t            return _this3.redraw();\n\t        }, 0);\n\t    },\n\t\n\t    updateMarkers: function updateMarkers(markers) {\n\t        this.removeMarkers(markers);\n\t        this.addMarkers(markers);\n\t    },\n\t\n\t    updateMarker: function updateMarker(marker) {\n\t        this.updateMarkers([marker]);\n\t    },\n\t\n\t    setMarkerPosition: function setMarkerPosition(marker, latlng) {\n\t        this.removeMarker(marker);\n\t        marker.latlng = latlng;\n\t        this.addMarker(marker);\n\t    },\n\t\n\t    getMarkers: function getMarkers() {\n\t        return this.rtree.all();\n\t    },\n\t\n\t    findLabelPosition: function findLabelPosition(iconCenter, iconSize, textWidth, textHeight, pixelExtents) {\n\t        var verticalPadding = 0,\n\t            xPositions = [iconCenter[0] + iconSize[0] / 2 + 2, iconCenter[0] - iconSize[0] / 2 - textWidth - 2],\n\t            yPositions = [iconCenter[1] - textHeight / 2 + verticalPadding, iconCenter[1] - textHeight * .75 - iconSize[1] / 4 + verticalPadding, iconCenter[1] - textHeight / 4 + iconSize[1] / 4 + verticalPadding, iconCenter[1] - textHeight - iconSize[1] / 2 + verticalPadding, iconCenter[1] + iconSize[1] / 2 + verticalPadding];\n\t\n\t        var minIntersectionSum = +Infinity;\n\t        var bestX = xPositions[0],\n\t            bestY = yPositions[0];\n\t        var _iteratorNormalCompletion2 = true;\n\t        var _didIteratorError2 = false;\n\t        var _iteratorError2 = undefined;\n\t\n\t        try {\n\t            for (var _iterator2 = xPositions[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                var x = _step2.value;\n\t                var _iteratorNormalCompletion3 = true;\n\t                var _didIteratorError3 = false;\n\t                var _iteratorError3 = undefined;\n\t\n\t                try {\n\t                    for (var _iterator3 = yPositions[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                        var y = _step3.value;\n\t\n\t                        var rect = { minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight };\n\t                        if (pixelExtents && (rect.minX < pixelExtents.tileW || rect.maxX > pixelExtents.tileE || rect.minY < pixelExtents.tileN || rect.maxY > pixelExtents.tileS)) {\n\t                            continue;\n\t                        }\n\t                        var intersectionSum = calcIntersectionSum(rect, this._regions.search(rect));\n\t                        if (intersectionSum < minIntersectionSum) {\n\t                            minIntersectionSum = intersectionSum;\n\t                            bestX = x;\n\t                            bestY = y;\n\t                            if (minIntersectionSum === 0) {\n\t                                break;\n\t                            }\n\t                        }\n\t                    }\n\t                } catch (err) {\n\t                    _didIteratorError3 = true;\n\t                    _iteratorError3 = err;\n\t                } finally {\n\t                    try {\n\t                        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                            _iterator3.return();\n\t                        }\n\t                    } finally {\n\t                        if (_didIteratorError3) {\n\t                            throw _iteratorError3;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                if (minIntersectionSum === 0) {\n\t                    break;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError2 = true;\n\t            _iteratorError2 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                    _iterator2.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError2) {\n\t                    throw _iteratorError2;\n\t                }\n\t            }\n\t        }\n\t\n\t        return [bestX, bestY];\n\t    },\n\t\n\t    preloadIcons: function preloadIcons(urls) {\n\t        var _this4 = this;\n\t\n\t        var newUrls = urls.filter(function (url) {\n\t            return !(url in _this4._images);\n\t        });\n\t        if (newUrls.length) {\n\t            return (0, _imagePromise2.default)(newUrls).then(function (images) {\n\t                var _iteratorNormalCompletion4 = true;\n\t                var _didIteratorError4 = false;\n\t                var _iteratorError4 = undefined;\n\t\n\t                try {\n\t                    for (var _iterator4 = images[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t                        var image = _step4.value;\n\t\n\t                        _this4._images[image.src] = image;\n\t                    }\n\t                } catch (err) {\n\t                    _didIteratorError4 = true;\n\t                    _iteratorError4 = err;\n\t                } finally {\n\t                    try {\n\t                        if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                            _iterator4.return();\n\t                        }\n\t                    } finally {\n\t                        if (_didIteratorError4) {\n\t                            throw _iteratorError4;\n\t                        }\n\t                    }\n\t                }\n\t            });\n\t        } else {\n\t            return Promise.resolve();\n\t        }\n\t    },\n\t\n\t    createTile: function createTile(coords, done) {\n\t        var _this5 = this;\n\t\n\t        var canvas = _leaflet2.default.DomUtil.create('canvas', 'leaflet-tile');\n\t        canvas.width = this.options.tileSize;\n\t        canvas.height = this.options.tileSize;\n\t        _leaflet2.default.Util.requestAnimFrame(function () {\n\t            _this5.drawTile(canvas, coords).then(function () {\n\t                return done(null, canvas);\n\t            });\n\t        });\n\t        return canvas;\n\t    },\n\t\n\t    selectMarkersForDraw: function selectMarkersForDraw(_ref, zoom, withoutPadding) {\n\t        var tileN = _ref.tileN,\n\t            tileS = _ref.tileS,\n\t            tileE = _ref.tileE,\n\t            tileW = _ref.tileW;\n\t\n\t        // FIXME: padding should depend on options.iconScale and fontSize\n\t        if (!this._map) {\n\t            return {};\n\t        }\n\t        var iconsHorPad = withoutPadding ? 0 : 520,\n\t            iconsVertPad = withoutPadding ? 0 : 50,\n\t            labelsHorPad = withoutPadding ? 0 : 256,\n\t            labelsVertPad = withoutPadding ? 0 : 20;\n\t        var iconsBounds = _leaflet2.default.latLngBounds(this._map.unproject(_leaflet2.default.point(tileW - iconsHorPad, tileS + iconsHorPad), zoom), this._map.unproject(_leaflet2.default.point(tileE + iconsHorPad, tileN - iconsVertPad), zoom)),\n\t            labelsBounds = _leaflet2.default.latLngBounds(this._map.unproject(_leaflet2.default.point(tileW - labelsHorPad, tileS + labelsHorPad), zoom), this._map.unproject(_leaflet2.default.point(tileE + labelsHorPad, tileN - labelsVertPad), zoom));\n\t        var iconUrls = [],\n\t            markerJobs = {};\n\t\n\t        // used only to preload icons\n\t        var pointsForMarkers = this.rtree.search({\n\t            minX: iconsBounds.getWest(),\n\t            minY: iconsBounds.getSouth(),\n\t            maxX: iconsBounds.getEast(),\n\t            maxY: iconsBounds.getNorth()\n\t        });\n\t\n\t        // used to place labels\n\t        var pointsForLabels = this.rtree.search({\n\t            minX: labelsBounds.getWest(), minY: labelsBounds.getSouth(),\n\t            maxX: labelsBounds.getEast(), maxY: labelsBounds.getNorth()\n\t        });\n\t\n\t        var _iteratorNormalCompletion5 = true;\n\t        var _didIteratorError5 = false;\n\t        var _iteratorError5 = undefined;\n\t\n\t        try {\n\t            for (var _iterator5 = pointsForMarkers[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n\t                var marker = _step5.value;\n\t\n\t                var p = this._map.project(marker.latlng, zoom);\n\t                var icon = marker.icon;\n\t                if (typeof icon === 'function') {\n\t                    icon = icon(marker);\n\t                }\n\t                iconUrls.push(icon.url);\n\t                var markerId = _leaflet2.default.stamp(marker);\n\t                markerJobs[markerId] = { marker: marker, icon: icon, projectedXY: p };\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError5 = true;\n\t            _iteratorError5 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion5 && _iterator5.return) {\n\t                    _iterator5.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError5) {\n\t                    throw _iteratorError5;\n\t                }\n\t            }\n\t        }\n\t\n\t        return { iconUrls: iconUrls, markerJobs: markerJobs, pointsForLabels: pointsForLabels };\n\t    },\n\t\n\t    drawSelectedMarkers: function drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom, limitLabelsToImage) {\n\t        var tileN = pixelExtents.tileN,\n\t            tileW = pixelExtents.tileW,\n\t            tileS = pixelExtents.tileS,\n\t            tileE = pixelExtents.tileE;\n\t\n\t        var textHeight = this.options.labelFontSize * this.options.iconScale;\n\t        if (this._labelPositionsZoom !== zoom) {\n\t            this._labelPositionsZoom = zoom;\n\t            this.resetLabels();\n\t        }\n\t        var ctx = canvas.getContext('2d');\n\t        ctx.font = _leaflet2.default.Util.template('bold {size}px {name}', { 'name': this.options.labelFontName, 'size': this.options.labelFontSize * this.options.iconScale });\n\t        var _iteratorNormalCompletion6 = true;\n\t        var _didIteratorError6 = false;\n\t        var _iteratorError6 = undefined;\n\t\n\t        try {\n\t            for (var _iterator6 = Object.entries(markerJobs)[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n\t                var _step6$value = _slicedToArray(_step6.value, 2),\n\t                    markerId = _step6$value[0],\n\t                    job = _step6$value[1];\n\t\n\t                var img = this._images[job.icon.url];\n\t                job.img = img;\n\t                var imgW = Math.round(img.width * this.options.iconScale);\n\t                var imgH = Math.round(img.height * this.options.iconScale);\n\t                if (!(markerId in this._iconPositions)) {\n\t                    var _x = job.projectedXY.x - job.icon.center[0] * this.options.iconScale;\n\t                    var _y = job.projectedXY.y - job.icon.center[1] * this.options.iconScale;\n\t                    _x = Math.round(_x);\n\t                    _y = Math.round(_y);\n\t                    this._iconPositions[markerId] = [_x, _y];\n\t                    this._regions.insert({\n\t                        minX: _x, minY: _y, maxX: _x + imgW, maxY: _y + imgH,\n\t                        marker: job.marker, isLabel: false\n\t                    });\n\t                }\n\t\n\t                var _iconPositions$marker = _slicedToArray(this._iconPositions[markerId], 2),\n\t                    x = _iconPositions$marker[0],\n\t                    y = _iconPositions$marker[1];\n\t\n\t                job.iconCenter = [x + imgW / 2, y + imgH / 2];\n\t                job.iconSize = [imgW, imgH];\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError6 = true;\n\t            _iteratorError6 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion6 && _iterator6.return) {\n\t                    _iterator6.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError6) {\n\t                    throw _iteratorError6;\n\t                }\n\t            }\n\t        }\n\t\n\t        var _iteratorNormalCompletion7 = true;\n\t        var _didIteratorError7 = false;\n\t        var _iteratorError7 = undefined;\n\t\n\t        try {\n\t            for (var _iterator7 = pointsForLabels[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n\t                var marker = _step7.value;\n\t\n\t                var markerId = _leaflet2.default.stamp(marker);\n\t                var job = markerJobs[markerId];\n\t                var label = job.marker.label;\n\t                if (label) {\n\t                    if (typeof label === 'function') {\n\t                        label = label(job.marker);\n\t                    }\n\t                    job.label = label;\n\t                    if (!(markerId in this._labelPositions)) {\n\t                        var textWidth = ctx.measureText(label).width;\n\t                        var p = this.findLabelPosition(job.iconCenter, job.iconSize, textWidth, textHeight, limitLabelsToImage ? pixelExtents : null);\n\t                        this._labelPositions[markerId] = p;\n\t\n\t                        var _p = _slicedToArray(p, 2),\n\t                            x = _p[0],\n\t                            y = _p[1];\n\t\n\t                        this._regions.insert({\n\t                            minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight,\n\t                            marker: job.marker, isLabel: true\n\t                        });\n\t                    }\n\t                } else {\n\t                    this._labelPositions[markerId] = null;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError7 = true;\n\t            _iteratorError7 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion7 && _iterator7.return) {\n\t                    _iterator7.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError7) {\n\t                    throw _iteratorError7;\n\t                }\n\t            }\n\t        }\n\t\n\t        var regionsInTile = this._regions.search({ minX: tileW, minY: tileN, maxX: tileE, maxY: tileS });\n\t        // draw labels\n\t        var _iteratorNormalCompletion8 = true;\n\t        var _didIteratorError8 = false;\n\t        var _iteratorError8 = undefined;\n\t\n\t        try {\n\t            for (var _iterator8 = regionsInTile[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {\n\t                var region = _step8.value;\n\t\n\t                if (region.isLabel) {\n\t                    //TODO: set font name ant size in options\n\t                    var _markerId = _leaflet2.default.stamp(region.marker);\n\t                    var _job = markerJobs[_markerId];\n\t                    var _p2 = this._labelPositions[_markerId];\n\t                    var _x2 = _p2[0] - tileW;\n\t                    var _y2 = _p2[1] - tileN;\n\t                    ctx.textBaseline = 'bottom';\n\t                    ctx.shadowColor = '#fff';\n\t                    ctx.strokeStyle = '#fff';\n\t                    ctx.fillStyle = '#000';\n\t                    ctx.lineWidth = 1.2 * this.options.iconScale;\n\t                    ctx.shadowBlur = 1 * this.options.iconScale;\n\t                    ctx.strokeText(_job.label, _x2, _y2 + textHeight);\n\t                    ctx.shadowBlur = 0;\n\t                    ctx.fillText(_job.label, _x2, _y2 + textHeight);\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError8 = true;\n\t            _iteratorError8 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion8 && _iterator8.return) {\n\t                    _iterator8.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError8) {\n\t                    throw _iteratorError8;\n\t                }\n\t            }\n\t        }\n\t\n\t        ctx.globalAlpha = this.options.iconsOpacity;\n\t        // draw icons\n\t        var _iteratorNormalCompletion9 = true;\n\t        var _didIteratorError9 = false;\n\t        var _iteratorError9 = undefined;\n\t\n\t        try {\n\t            for (var _iterator9 = regionsInTile[Symbol.iterator](), _step9; !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {\n\t                var _region = _step9.value;\n\t\n\t                if (!_region.isLabel) {\n\t                    var _markerId2 = _leaflet2.default.stamp(_region.marker);\n\t                    var _job2 = markerJobs[_markerId2];\n\t                    var _p3 = this._iconPositions[_markerId2];\n\t                    var _x3 = _p3[0] - tileW;\n\t                    var _y3 = _p3[1] - tileN;\n\t                    ctx.drawImage(_job2.img, _x3, _y3, _job2.iconSize[0], _job2.iconSize[1]);\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError9 = true;\n\t            _iteratorError9 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion9 && _iterator9.return) {\n\t                    _iterator9.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError9) {\n\t                    throw _iteratorError9;\n\t                }\n\t            }\n\t        }\n\t\n\t        ctx.globalAlpha = 1;\n\t    },\n\t\n\t    drawTile: function () {\n\t        var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(canvas, coords) {\n\t            var zoom, tileSize, tileN, tileW, tileS, tileE, pixelExtents, _selectMarkersForDraw, iconUrls, markerJobs, pointsForLabels;\n\t\n\t            return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                while (1) {\n\t                    switch (_context.prev = _context.next) {\n\t                        case 0:\n\t                            zoom = coords.z, tileSize = this.options.tileSize, tileN = coords.y * tileSize, tileW = coords.x * tileSize, tileS = tileN + tileSize, tileE = tileW + tileSize;\n\t                            pixelExtents = { tileN: tileN, tileS: tileS, tileE: tileE, tileW: tileW };\n\t                            _selectMarkersForDraw = this.selectMarkersForDraw(pixelExtents, zoom), iconUrls = _selectMarkersForDraw.iconUrls, markerJobs = _selectMarkersForDraw.markerJobs, pointsForLabels = _selectMarkersForDraw.pointsForLabels;\n\t\n\t                            if (markerJobs) {\n\t                                _context.next = 5;\n\t                                break;\n\t                            }\n\t\n\t                            return _context.abrupt('return');\n\t\n\t                        case 5:\n\t                            _context.next = 7;\n\t                            return this.preloadIcons(iconUrls);\n\t\n\t                        case 7:\n\t                            this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom);\n\t\n\t                        case 8:\n\t                        case 'end':\n\t                            return _context.stop();\n\t                    }\n\t                }\n\t            }, _callee, this);\n\t        }));\n\t\n\t        function drawTile(_x4, _x5) {\n\t            return _ref2.apply(this, arguments);\n\t        }\n\t\n\t        return drawTile;\n\t    }(),\n\t\n\t    resetLabels: function resetLabels() {\n\t        this._iconPositions = {};\n\t        this._labelPositions = {};\n\t        this._regions.clear();\n\t    },\n\t\n\t    findMarkerFromMouseEvent: function findMarkerFromMouseEvent(e) {\n\t        var p = this._map.project(e.latlng),\n\t            region = this._regions.search({ minX: p.x, minY: p.y, maxX: p.x, maxY: p.y })[0];\n\t        var marker = void 0;\n\t        if (region) {\n\t            marker = region.marker;\n\t        } else {\n\t            marker = null;\n\t        }\n\t        return marker;\n\t    },\n\t\n\t    onMouseMove: function onMouseMove(e) {\n\t        var marker = this.findMarkerFromMouseEvent(e);\n\t        if (this._hoverMarker !== marker) {\n\t            if (this._hoverMarker) {\n\t                this.fire('markerleave', { marker: this._hoverMarker });\n\t            }\n\t            if (marker) {\n\t                this.fire('markerenter', { marker: marker });\n\t            }\n\t            this._hoverMarker = marker;\n\t        }\n\t    },\n\t\n\t    showTooltip: function showTooltip(e) {\n\t        if (!e.marker.tooltip) {\n\t            return;\n\t        }\n\t        var text = e.marker.tooltip;\n\t        if (typeof text === 'function') {\n\t            text = text(e.marker);\n\t            if (!e.marker.tooltip) {\n\t                return;\n\t            }\n\t        }\n\t        this.toolTip.innerHTML = text;\n\t        var p = this._map.latLngToLayerPoint(e.marker.latlng);\n\t        _leaflet2.default.DomUtil.setPosition(this.toolTip, p);\n\t        _leaflet2.default.DomUtil.addClass(this.toolTip, 'canvas-marker-tooltip-on');\n\t    },\n\t\n\t    onMarkerEnter: function onMarkerEnter(e) {\n\t        this._map._container.style.cursor = 'pointer';\n\t        this.showTooltip(e);\n\t    },\n\t\n\t    onMarkerLeave: function onMarkerLeave() {\n\t        this._map._container.style.cursor = '';\n\t        _leaflet2.default.DomUtil.removeClass(this.toolTip, 'canvas-marker-tooltip-on');\n\t    },\n\t\n\t    onMouseOut: function onMouseOut() {\n\t        if (this._hoverMarker) {\n\t            this._hoverMarker = null;\n\t            this.fire('markerleave', { marker: this._hoverMarker });\n\t        }\n\t    },\n\t\n\t    onClick: function onClick(e) {\n\t        if (this._map.clickLocked) {\n\t            return;\n\t        }\n\t        var marker = this.findMarkerFromMouseEvent(e);\n\t        if (marker) {\n\t            _leaflet2.default.extend(e, { marker: marker });\n\t            this.fire('markerclick', e);\n\t        }\n\t    },\n\t\n\t    onRightClick: function onRightClick(e) {\n\t        var marker = this.findMarkerFromMouseEvent(e);\n\t        if (marker) {\n\t            _leaflet2.default.extend(e, { marker: marker });\n\t            this.fire('markercontextmenu', e);\n\t        }\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        if (this.options.pane === 'rasterMarker' && !map.getPane('rasterMarker')) {\n\t            map.createPane('rasterMarker').style.zIndex = 550;\n\t        }\n\t        _leaflet2.default.GridLayer.prototype.onAdd.call(this, map);\n\t        map.on('mousemove', this.onMouseMove, this);\n\t        map.on('mouseout', this.onMouseOut, this);\n\t        map.on('click', this.onClick, this);\n\t        map.on('contextmenu', this.onRightClick, this);\n\t        this.toolTip = _leaflet2.default.DomUtil.create('div', 'canvas-marker-tooltip', this._map.getPanes().markerPane);\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        this._map.off('mousemove', this.onMouseMove, this);\n\t        this._map.off('mouseout', this.onMouseOut, this);\n\t        this._map.off('click', this.onClick, this);\n\t        this._map.off('contextmenu', this.onRightClick, this);\n\t        if (this._hoverMarker) {\n\t            this._hoverMarker = null;\n\t            this.fire('markerleave', { marker: this._hoverMarker });\n\t        }\n\t        this._map.getPanes().markerPane.removeChild(this.toolTip);\n\t        _leaflet2.default.GridLayer.prototype.onRemove.call(this, map);\n\t    }\n\t});\n\n/***/ },\n/* 63 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tfunction localStorageWorks() {\n\t    try {\n\t        window.localStorage.setItem('_testDummy', 'TEST');\n\t        return window.localStorage.getItem('_testDummy') === 'TEST';\n\t    } catch (e) {\n\t        return false;\n\t    }\n\t}\n\t\n\tvar storage = void 0;\n\t\n\tif (localStorageWorks()) {\n\t    storage = window.localStorage;\n\t} else {\n\t    var _storage = {};\n\t    storage = {\n\t        length: 0,\n\t\n\t        key: function key(n) {\n\t            return Object.keys(_storage)[n];\n\t        },\n\t\n\t        removeItem: function removeItem(key) {\n\t            delete _storage[key];\n\t        },\n\t\n\t        getItem: function getItem(key) {\n\t            return storage[key];\n\t        },\n\t\n\t        setItem: function setItem(key, value) {\n\t            storage[key] = value;\n\t        },\n\t\n\t        clear: function clear() {\n\t            _storage = {};\n\t        }\n\t    };\n\t}\n\t\n\texports.default = storage;\n\n/***/ },\n/* 64 */,\n/* 65 */,\n/* 66 */,\n/* 67 */,\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */,\n/* 72 */,\n/* 73 */,\n/* 74 */,\n/* 75 */,\n/* 76 */,\n/* 77 */,\n/* 78 */,\n/* 79 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\t__webpack_require__(442);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction showNotification(message, mouseEvent) {\n\t    var el = document.createElement('div');\n\t    el.innerHTML = message;\n\t    el.className = 'copy-clipboard-notification';\n\t    document.body.appendChild(el);\n\t    var w = el.offsetWidth,\n\t        h = el.offsetHeight,\n\t        x = mouseEvent.clientX - w - 8,\n\t        y = mouseEvent.clientY - h / 2;\n\t    if (x < 0) {\n\t        x = 0;\n\t    }\n\t    if (y < 0) {\n\t        y = 0;\n\t    }\n\t    el.style.top = y + 'px';\n\t    el.style.left = x + 'px';\n\t    setTimeout(function () {\n\t        document.body.removeChild(el);\n\t    }, 1000);\n\t}\n\t\n\tfunction copyToClipboard(s, mouseEvent) {\n\t    try {\n\t        var ta = document.createElement('textarea');\n\t        ta.value = s;\n\t        document.body.appendChild(ta);\n\t        ta.select();\n\t        document.execCommand('copy');\n\t        showNotification('Copied', mouseEvent);\n\t    } catch (e) {\n\t        _logging2.default.captureException(e, { extra: { description: 'clipborad to copy failed' } });\n\t        prompt(\"Copy to clipboard: Ctrl+C, Enter\", s);\n\t    } finally {\n\t        document.body.removeChild(ta);\n\t    }\n\t}\n\t\n\texports.default = copyToClipboard;\n\n/***/ },\n/* 80 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar PrintStaticLayer = function () {\n\t    function PrintStaticLayer() {\n\t        _classCallCheck(this, PrintStaticLayer);\n\t\n\t        this._layerDummy = true;\n\t        this._printProgressWeight = 0.01;\n\t    }\n\t\n\t    _createClass(PrintStaticLayer, [{\n\t        key: \"cloneForPrint\",\n\t        value: function cloneForPrint() {\n\t            return this;\n\t        }\n\t    }, {\n\t        key: \"getTilesInfo\",\n\t\n\t\n\t        // printOptions = {\n\t        //     xhrOptions,\n\t        //     pixelBounds,\n\t        //     latLngBounds,\n\t        //     destPixelSize,\n\t        //     resolution,\n\t        //     scale,\n\t        //     zoom\n\t        // }\n\t        value: function () {\n\t            var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(printOptions) {\n\t                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                    while (1) {\n\t                        switch (_context2.prev = _context2.next) {\n\t                            case 0:\n\t                                return _context2.abrupt(\"return\", {\n\t                                    iterateTilePromises: /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t                                        var _this = this;\n\t\n\t                                        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                                            while (1) {\n\t                                                switch (_context.prev = _context.next) {\n\t                                                    case 0:\n\t                                                        _context.next = 2;\n\t                                                        return {\n\t                                                            tilePromise: Promise.resolve({\n\t                                                                draw: function draw(canvas) {\n\t                                                                    return _this._drawRaster(canvas, printOptions);\n\t                                                                },\n\t                                                                isOverlay: true,\n\t                                                                overlaySolid: this.overlaySolid\n\t                                                            }),\n\t                                                            abortLoading: function abortLoading() {}\n\t                                                        };\n\t\n\t                                                    case 2:\n\t                                                    case \"end\":\n\t                                                        return _context.stop();\n\t                                                }\n\t                                            }\n\t                                        }, _callee, this);\n\t                                    }).bind(this),\n\t                                    count: 1\n\t                                });\n\t\n\t                            case 1:\n\t                            case \"end\":\n\t                                return _context2.stop();\n\t                        }\n\t                    }\n\t                }, _callee2, this);\n\t            }));\n\t\n\t            function getTilesInfo(_x) {\n\t                return _ref.apply(this, arguments);\n\t            }\n\t\n\t            return getTilesInfo;\n\t        }()\n\t    }, {\n\t        key: \"_drawRaster\",\n\t        value: function _drawRaster(canvas, printOptions) {\n\t            return;\n\t        }\n\t    }]);\n\t\n\t    return PrintStaticLayer;\n\t}();\n\t\n\texports.PrintStaticLayer = PrintStaticLayer;\n\n/***/ },\n/* 81 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.parseGeoFile = undefined;\n\t\n\tvar _jsUnzip = __webpack_require__(476);\n\t\n\tvar _jsUnzip2 = _interopRequireDefault(_jsUnzip);\n\t\n\tvar _rawinflate = __webpack_require__(477);\n\t\n\tvar _rawinflate2 = _interopRequireDefault(_rawinflate);\n\t\n\tvar _stripBom = __webpack_require__(230);\n\t\n\tvar _stripBom2 = _interopRequireDefault(_stripBom);\n\t\n\tvar _utf = __webpack_require__(110);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction xmlGetNodeText(node) {\n\t    if (node) {\n\t        return Array.prototype.slice.call(node.childNodes).map(function (node) {\n\t            return node.nodeValue;\n\t        }).join('');\n\t    }\n\t}\n\t\n\tfunction parseGpx(txt, name, preferNameFromFile) {\n\t    var error;\n\t\n\t    function getSegmentPoints(segment_element) {\n\t        var points_elements = segment_element.getElementsByTagName('trkpt');\n\t        var points = [];\n\t        for (var i = 0; i < points_elements.length; i++) {\n\t            var point_element = points_elements[i];\n\t            var lat = parseFloat(point_element.getAttribute('lat'));\n\t            var lng = parseFloat(point_element.getAttribute('lon'));\n\t            if (isNaN(lat) || isNaN(lng)) {\n\t                error = 'CORRUPT';\n\t                break;\n\t            }\n\t            points.push({ lat: lat, lng: lng });\n\t        }\n\t        return points;\n\t    }\n\t\n\t    var getTrackSegments = function getTrackSegments(xml) {\n\t        var segments = [];\n\t        var segments_elements = xml.getElementsByTagName('trkseg');\n\t        for (var i = 0; i < segments_elements.length; i++) {\n\t            var segment_points = getSegmentPoints(segments_elements[i]);\n\t            if (segment_points.length) {\n\t                segments.push(segment_points);\n\t            }\n\t        }\n\t        return segments;\n\t    };\n\t\n\t    var getWaypoints = function getWaypoints(xml) {\n\t        var waypoint_elements = xml.getElementsByTagName('wpt');\n\t        var waypoints = [];\n\t        for (var i = 0; i < waypoint_elements.length; i++) {\n\t            var waypoint_element = waypoint_elements[i];\n\t            var waypoint = {};\n\t            waypoint.lat = parseFloat(waypoint_element.getAttribute('lat'));\n\t            waypoint.lng = parseFloat(waypoint_element.getAttribute('lon'));\n\t            if (isNaN(waypoint.lat) || isNaN(waypoint.lng)) {\n\t                error = 'CORRUPT';\n\t                continue;\n\t            }\n\t            try {\n\t                waypoint.name = (0, _utf.decode)(xmlGetNodeText(waypoint_element.getElementsByTagName('name')[0]));\n\t            } catch (e) {\n\t                error = 'CORRUPT';\n\t                continue;\n\t            }\n\t            waypoint.symbol_name = xmlGetNodeText(waypoint_element.getElementsByTagName('sym')[0]);\n\t            waypoints.push(waypoint);\n\t        }\n\t        return waypoints;\n\t    };\n\t\n\t    txt = (0, _stripBom2.default)(txt);\n\t    // remove namespaces\n\t    txt = txt.replace(/<([^ >]+):([^ >]+)/g, '<$1_$2');\n\t    try {\n\t        var dom = new DOMParser().parseFromString(txt, \"text/xml\");\n\t    } catch (e) {\n\t        return null;\n\t    }\n\t    if (dom.documentElement.nodeName === 'parsererror') {\n\t        return null;\n\t    }\n\t    if (dom.getElementsByTagName('gpx').length === 0) {\n\t        return null;\n\t    }\n\t    if (preferNameFromFile) {\n\t        var _arr = [].concat(_toConsumableArray(dom.getElementsByTagName('trk')));\n\t\n\t        for (var _i = 0; _i < _arr.length; _i++) {\n\t            var trk = _arr[_i];\n\t            var trkName = trk.getElementsByTagName('name')[0];\n\t            if (trkName) {\n\t                trkName = (0, _utf.decode)(xmlGetNodeText(trkName));\n\t                if (trkName.length) {\n\t                    name = trkName;\n\t                    break;\n\t                }\n\t            }\n\t        }\n\t    }\n\t    return [{\n\t        name: name,\n\t        tracks: getTrackSegments(dom),\n\t        points: getWaypoints(dom),\n\t        error: error\n\t    }];\n\t}\n\t\n\tfunction parseOziPlt(txt, name) {\n\t    var error;\n\t    var segments = [];\n\t    var lines = txt.split('\\n');\n\t    if (lines[0].indexOf('OziExplorer Track Point File') !== 0) {\n\t        return null;\n\t    }\n\t    var expected_points_num = parseInt(lines[5], 10);\n\t    var current_segment = [];\n\t    var total_points_num = 0;\n\t    for (var i = 6; i < lines.length; i++) {\n\t        var line = lines[i].trim();\n\t        if (!line) {\n\t            continue;\n\t        }\n\t        var fields = line.split(',');\n\t        var lat = parseFloat(fields[0]);\n\t        var lon = parseFloat(fields[1]);\n\t        var is_start_of_segment = parseInt(fields[2], 10);\n\t        if (isNaN(lat) || isNaN(lon) || isNaN(is_start_of_segment)) {\n\t            error = 'CORRUPT';\n\t            break;\n\t        }\n\t        if (is_start_of_segment) {\n\t            current_segment = [];\n\t        }\n\t        if (!current_segment.length) {\n\t            segments.push(current_segment);\n\t        }\n\t        current_segment.push({ lat: lat, lng: lon });\n\t        total_points_num += 1;\n\t    }\n\t    if (isNaN(expected_points_num) || expected_points_num !== total_points_num) {\n\t        error = 'CORRUPT';\n\t    }\n\t    return [{ name: name, tracks: segments, error: error }];\n\t}\n\t\n\tfunction decodeCP1251(s) {\n\t    var c,\n\t        i,\n\t        s2 = [];\n\t    for (i = 0; i < s.length; i++) {\n\t        c = s.charCodeAt(i);\n\t        if (c >= 192 && c <= 255) {\n\t            c += 0x410 - 192;\n\t        } else if (c === 168) {\n\t            c = 0x0401;\n\t        } else if (c === 184) {\n\t            c = 0x0451;\n\t        }\n\t        s2.push(String.fromCharCode(c));\n\t    }\n\t    return s2.join('');\n\t}\n\t\n\tfunction parseOziWpt(txt, name) {\n\t    var points = [],\n\t        error,\n\t        lines,\n\t        line,\n\t        i,\n\t        lat,\n\t        lng,\n\t        pointName,\n\t        fields;\n\t    lines = txt.split('\\n');\n\t    if (lines[0].indexOf('OziExplorer Waypoint File') !== 0) {\n\t        return null;\n\t    }\n\t    for (i = 4; i < lines.length; i++) {\n\t        line = lines[i].trim();\n\t        if (!line) {\n\t            continue;\n\t        }\n\t        fields = line.split(',');\n\t        lat = parseFloat(fields[2]);\n\t        lng = parseFloat(fields[3]);\n\t        pointName = decodeCP1251(fields[1]).trim();\n\t        if (isNaN(lat) || isNaN(lng)) {\n\t            error = 'CORRUPT';\n\t            break;\n\t        }\n\t        points.push({\n\t            lat: lat,\n\t            lng: lng,\n\t            name: pointName\n\t        });\n\t    }\n\t    return [{ name: name, points: points, error: error }];\n\t}\n\t\n\tfunction parseKml(txt, name) {\n\t    var error;\n\t    var getSegmentPoints = function getSegmentPoints(coordinates_element) {\n\t        // convert multiline text value of tag to single line\n\t        var coordinates_string = xmlGetNodeText(coordinates_element);\n\t        var points_strings = coordinates_string.split(/\\s+/);\n\t        var points = [];\n\t        for (var i = 0; i < points_strings.length; i++) {\n\t            if (points_strings[i].length) {\n\t                var point = points_strings[i].split(',');\n\t                var lat = parseFloat(point[1]);\n\t                var lng = parseFloat(point[0]);\n\t                if (isNaN(lat) || isNaN(lng)) {\n\t                    error = 'CORRUPT';\n\t                    break;\n\t                }\n\t                points.push({ lat: lat, lng: lng });\n\t            }\n\t        }\n\t        return points;\n\t    };\n\t\n\t    var getTrackSegments = function getTrackSegments(xml) {\n\t        var segments_elements = xml.getElementsByTagName('LineString');\n\t        var segments = [];\n\t        for (var i = 0; i < segments_elements.length; i++) {\n\t            var coordinates_element = segments_elements[i].getElementsByTagName('coordinates');\n\t            if (coordinates_element.length) {\n\t                var segment_points = getSegmentPoints(coordinates_element[0]);\n\t                if (segment_points.length) {\n\t                    segments.push(segment_points);\n\t                }\n\t            }\n\t        }\n\t        return segments;\n\t    };\n\t\n\t    function getPoints(dom) {\n\t        var points = [],\n\t            placemarks,\n\t            i,\n\t            coord,\n\t            name,\n\t            lat,\n\t            lng,\n\t            pointObjs;\n\t        placemarks = dom.getElementsByTagName('Placemark');\n\t        for (i = 0; i < placemarks.length; i++) {\n\t            pointObjs = placemarks[i].getElementsByTagName('Point');\n\t            if (pointObjs.length === 0) {\n\t                continue;\n\t            } else if (pointObjs.length > 1) {\n\t                error = 'CORRUPT';\n\t                break;\n\t            }\n\t            coord = pointObjs[0].getElementsByTagName('coordinates');\n\t            if (coord.length !== 1) {\n\t                error = 'CORRUPT';\n\t                break;\n\t            }\n\t            coord = xmlGetNodeText(coord[0]);\n\t            coord = coord.split(',');\n\t            lat = parseFloat(coord[1]);\n\t            lng = parseFloat(coord[0]);\n\t            if (isNaN(lat) || isNaN(lng)) {\n\t                error = 'CORRUPT';\n\t                break;\n\t            }\n\t            name = placemarks[i].getElementsByTagName('name');\n\t            if (name.length !== 1) {\n\t                error = 'CORRUPT';\n\t                break;\n\t            }\n\t            try {\n\t                name = (0, _utf.decode)(xmlGetNodeText(name[0]).trim());\n\t            } catch (e) {\n\t                error = 'CORRUPT';\n\t                break;\n\t            }\n\t            points.push({\n\t                name: name,\n\t                lat: lat,\n\t                lng: lng\n\t            });\n\t        }\n\t        return points;\n\t    }\n\t\n\t    txt = (0, _stripBom2.default)(txt);\n\t    txt = txt.replace(/<([^ >]+):([^ >]+)/g, '<$1_$2');\n\t    try {\n\t        var dom = new DOMParser().parseFromString(txt, \"text/xml\");\n\t    } catch (e) {\n\t        return null;\n\t    }\n\t    if (dom.documentElement.nodeName === 'parsererror') {\n\t        return null;\n\t    }\n\t    if (dom.getElementsByTagName('kml').length === 0) {\n\t        return null;\n\t    }\n\t\n\t    return [{ name: name, tracks: getTrackSegments(dom), points: getPoints(dom), error: error }];\n\t}\n\t\n\tfunction parseKmz(txt, name) {\n\t    var uncompressed;\n\t    try {\n\t        var unzipper = new _jsUnzip2.default(txt);\n\t    } catch (e) {\n\t        return null;\n\t    }\n\t    var tracks = [],\n\t        points = [],\n\t        geodata,\n\t        error;\n\t    var hasDocKml = false;\n\t    if (!unzipper.isZipFile()) {\n\t        return null;\n\t    }\n\t    try {\n\t        unzipper.readEntries();\n\t    } catch (e) {\n\t        return null;\n\t    }\n\t    var i, entry;\n\t    for (i = 0; i < unzipper.entries.length; i++) {\n\t        entry = unzipper.entries[i];\n\t        if (entry.fileName === 'doc.kml') {\n\t            hasDocKml = true;\n\t            break;\n\t        }\n\t    }\n\t    if (!hasDocKml) {\n\t        return null;\n\t    }\n\t\n\t    for (i = 0; i < unzipper.entries.length; i++) {\n\t        entry = unzipper.entries[i];\n\t        if (entry.fileName.match(/\\.kml$/i)) {\n\t            if (entry.compressionMethod === 0) {\n\t                uncompressed = entry.data;\n\t            } else if (entry.compressionMethod === 8) {\n\t                uncompressed = _rawinflate2.default.inflate(entry.data);\n\t            } else {\n\t                return null;\n\t            }\n\t            geodata = parseKml(uncompressed, 'dummmy');\n\t            if (geodata) {\n\t                error = error || geodata.error;\n\t                tracks.push.apply(tracks, geodata[0].tracks);\n\t                points.push.apply(points, geodata[0].points);\n\t            }\n\t        }\n\t    }\n\t\n\t    geodata = [{ name: name, error: error, tracks: tracks, points: points }];\n\t    return geodata;\n\t}\n\t\n\tfunction parseYandexRulerString(s) {\n\t    var last_lat = 0;\n\t    var last_lng = 0;\n\t    var error;\n\t    var points = [];\n\t    s = s.replace(/%2C/ig, ',');\n\t    var points_str = s.split('~');\n\t    for (var i = 0; i < points_str.length; i++) {\n\t        var point = points_str[i].split(',');\n\t        var lng = parseFloat(point[0]);\n\t        var lat = parseFloat(point[1]);\n\t        if (isNaN(lat) || isNaN(lng)) {\n\t            error = 'CORRUPT';\n\t            break;\n\t        }\n\t        last_lng += lng;\n\t        last_lat += lat;\n\t        points.push({ lat: last_lat, lng: last_lng });\n\t    }\n\t    return { error: error, points: points };\n\t}\n\t\n\tfunction parseYandexRulerUrl(s) {\n\t    var re = /yandex\\..+[?&]rl=([^&]+)/;\n\t    var m = re.exec(s);\n\t    if (!m) {\n\t        return null;\n\t    }\n\t    var res = parseYandexRulerString(m[1]);\n\t    return [{ name: 'Yandex ruler', error: res.error, tracks: [res.points] }];\n\t}\n\t\n\tfunction parseZip(txt, name) {\n\t    try {\n\t        var unzipper = new _jsUnzip2.default(txt);\n\t    } catch (e) {\n\t        return null;\n\t    }\n\t    if (!unzipper.isZipFile()) {\n\t        return null;\n\t    }\n\t    try {\n\t        unzipper.readEntries();\n\t    } catch (e) {\n\t        return null;\n\t    }\n\t    var geodata_array = [];\n\t    for (var i = 0; i < unzipper.entries.length; i++) {\n\t        var entry = unzipper.entries[i];\n\t        var uncompressed;\n\t        if (entry.compressionMethod === 0) {\n\t            uncompressed = entry.data;\n\t        } else if (entry.compressionMethod === 8) {\n\t            uncompressed = _rawinflate2.default.inflate(entry.data);\n\t        } else {\n\t            return null;\n\t        }\n\t        var file_name = name + '/' + entry.fileName;\n\t        var geodata = parseGeoFile(file_name, uncompressed);\n\t        geodata_array.push.apply(geodata_array, geodata);\n\t    }\n\t    return geodata_array;\n\t}\n\t\n\t// function parseYandexMap(txt) {\n\t//     var start_tag = '<script id=\"vpage\" type=\"application/json\">';\n\t//     var json_start = txt.indexOf(start_tag);\n\t//     if (json_start === -1) {\n\t//         return null;\n\t//     }\n\t//     json_start += start_tag.length;\n\t//     var json_end = txt.indexOf('</script>', json_start);\n\t//     if (json_end === -1) {\n\t//         return null;\n\t//     }\n\t//     var map_data = txt.substring(json_start, json_end);\n\t//     map_data = JSON.parse(map_data);\n\t//     console.log(map_data);\n\t//     if (!('request' in map_data)) {\n\t//         return null;\n\t//     }\n\t//     var name = 'YandexMap';\n\t//     var segments = [];\n\t//     var error;\n\t//     if (map_data.vpage && map_data.vpage.data && map_data.vpage.data.objects && map_data.vpage.data.objects.length) {\n\t//         var mapName = ('' + (map_data.vpage.data.name || '')).trim();\n\t//         if (mapName.length > 3) {\n\t//             name = '';\n\t//         } else if (mapName.length) {\n\t//             name += ': ';\n\t//         }\n\t//         name += fileutils.decodeUTF8(mapName);\n\t//         map_data.vpage.data.objects.forEach(function(obj){\n\t//             if (obj.pts && obj.pts.length) {\n\t//                 var segment = [];\n\t//                 for (var i=0; i< obj.pts.length; i++) {\n\t//                     var pt = obj.pts[i];\n\t//                     var lng = parseFloat(pt[0]);\n\t//                     var lat = parseFloat(pt[1]);\n\t//                     if (isNaN(lat) || isNaN(lng)) {\n\t//                         error = 'CORRUPT';\n\t//                         break;\n\t//                     }\n\t//                     segment.push({lat: lat, lng:lng});\n\t//                 }\n\t//                 if (segment.length) {\n\t//                     segments.push(segment);\n\t//                 }\n\t//             }\n\t//         });\n\t//     }\n\t//     if (map_data.request.args && map_data.request.args.rl) {\n\t//         var res = parseYandexRulerString(map_data.request.args.rl);\n\t//         error = error || res.error;\n\t//         if (res.points && res.points.length) {\n\t//             segments.push(res.points);\n\t//         }\n\t//     }\n\t//     return [{name: name, error: error, tracks: segments}];\n\t// }\n\t\n\tfunction decodeUrlSafeBase64(s) {\n\t    var decoded;\n\t    s = s.replace(/[\\n\\r \\t]/g, '').replace(/-/g, '+').replace(/_/g, '/');\n\t    try {\n\t        decoded = atob(s);\n\t    } catch (e) {}\n\t    if (decoded && decoded.length) {\n\t        return decoded;\n\t    }\n\t    return null;\n\t}\n\t\n\tfunction unpackNumber(s, position) {\n\t    var x,\n\t        n = 0;\n\t    x = s.charCodeAt(position);\n\t    if (isNaN(x)) {\n\t        throw new Error('Unexpected end of line while unpacking number');\n\t    }\n\t    if (x < 128) {\n\t        n = x - 64;\n\t        return [n, 1];\n\t    }\n\t    n = x & 0x7f;\n\t    x = s.charCodeAt(position + 1);\n\t    if (isNaN(x)) {\n\t        throw new Error('Unexpected end of line while unpacking number');\n\t    }\n\t    if (x < 128) {\n\t        n |= x << 7;\n\t        n -= 8192;\n\t        return [n, 2];\n\t    }\n\t    n |= (x & 0x7f) << 7;\n\t    x = s.charCodeAt(position + 2);\n\t    if (isNaN(x)) {\n\t        throw new Error('Unexpected end of line while unpacking number');\n\t    }\n\t    if (x < 128) {\n\t        n |= x << 14;\n\t        n -= 1048576;\n\t        return [n, 3];\n\t    }\n\t    n |= (x & 0x7f) << 14;\n\t    x = s.charCodeAt(position + 3);\n\t    if (isNaN(x)) {\n\t        throw new Error('Unexpected end of line while unpacking number');\n\t    }\n\t    n |= x << 21;\n\t    n -= 268435456;\n\t    return [n, 4];\n\t}\n\t\n\tfunction PackedStreamReader(s) {\n\t    this._string = s;\n\t    this.position = 0;\n\t}\n\t\n\tPackedStreamReader.prototype.readNumber = function () {\n\t    var n = unpackNumber(this._string, this.position);\n\t    this.position += n[1];\n\t    return n[0];\n\t};\n\t\n\tPackedStreamReader.prototype.readString = function (size) {\n\t    var s = this._string.slice(this.position, this.position + size);\n\t    this.position += size;\n\t    return s;\n\t};\n\t\n\tfunction parseStringified(s, oldVersion) {\n\t    var name,\n\t        n,\n\t        segments = [],\n\t        segment,\n\t        segmentsCount,\n\t        pointsCount,\n\t        arcUnit = ((1 << 24) - 1) / 360,\n\t        x,\n\t        y,\n\t        error,\n\t        version,\n\t        midX,\n\t        midY,\n\t        /*symbol,*/waypointName,\n\t        wayPoints = [],\n\t        color,\n\t        measureTicksShown,\n\t        trackHidden = false;\n\t    s = decodeUrlSafeBase64(s);\n\t    if (!s) {\n\t        return [{ name: 'Text encoded track', error: ['CORRUPT'] }];\n\t    }\n\t    s = new PackedStreamReader(s);\n\t    try {\n\t        if (oldVersion) {\n\t            version = 0;\n\t        } else {\n\t            version = s.readNumber();\n\t        }\n\t        if (version !== 0 && version !== 1 && version !== 2 && version !== 3) {\n\t            return [{ name: 'Text encoded track', error: ['CORRUPT'] }];\n\t        }\n\t        n = s.readNumber();\n\t        name = s.readString(n);\n\t        name = (0, _utf.decode)(name);\n\t        segmentsCount = s.readNumber();\n\t        for (; segmentsCount--;) {\n\t            segment = [];\n\t            pointsCount = s.readNumber();\n\t            x = 0;\n\t            y = 0;\n\t            for (; pointsCount--;) {\n\t                x += s.readNumber();\n\t                y += s.readNumber();\n\t                segment.push({ lng: x / arcUnit, lat: y / arcUnit });\n\t            }\n\t            segments.push(segment);\n\t            segment = null;\n\t        }\n\t    } catch (e) {\n\t        if (e.message.match('Unexpected end of line while unpacking number')) {\n\t            error = ['CORRUPT'];\n\t            if (segment) {\n\t                segments.push(segment);\n\t            }\n\t        } else {\n\t            throw e;\n\t        }\n\t    }\n\t    try {\n\t        color = s.readNumber();\n\t        measureTicksShown = s.readNumber();\n\t    } catch (e) {\n\t        if (e.message.match('Unexpected end of line while unpacking number')) {\n\t            color = 0;\n\t            measureTicksShown = 0;\n\t            if (version > 0) {\n\t                error = ['CORRUPT'];\n\t            }\n\t        } else {\n\t            throw e;\n\t        }\n\t    }\n\t    if (version >= 3) {\n\t        try {\n\t            trackHidden = !!s.readNumber();\n\t        } catch (e) {\n\t            if (e.message.match('Unexpected end of line while unpacking number')) {\n\t                error = ['CORRUPT'];\n\t            } else {\n\t                throw e;\n\t            }\n\t        }\n\t    }\n\t    if (version >= 2) {\n\t        try {\n\t            pointsCount = s.readNumber();\n\t            if (pointsCount) {\n\t                midX = s.readNumber();\n\t                midY = s.readNumber();\n\t            }\n\t            for (; pointsCount--;) {\n\t                n = s.readNumber();\n\t                waypointName = s.readString(n);\n\t                waypointName = (0, _utf.decode)(waypointName);\n\t\n\t                // let symbol = s.readNumber();\n\t                s.readNumber();\n\t\n\t                x = s.readNumber() + midX;\n\t                y = s.readNumber() + midY;\n\t                wayPoints.push({\n\t                    name: waypointName,\n\t                    lat: y / arcUnit,\n\t                    lng: x / arcUnit\n\t\n\t                });\n\t            }\n\t        } catch (e) {\n\t            if (e.message.match('Unexpected end of line while unpacking number')) {\n\t                error = ['CORRUPT'];\n\t            } else {\n\t                throw e;\n\t            }\n\t        }\n\t    }\n\t    var geoData = {\n\t        name: name || \"Text encoded track\",\n\t        tracks: segments,\n\t        error: error,\n\t        points: wayPoints,\n\t        color: color,\n\t        measureTicksShown: measureTicksShown,\n\t        trackHidden: trackHidden\n\t    };\n\t    return [geoData];\n\t}\n\t\n\tfunction parseTrackUrl(s) {\n\t    var i = s.indexOf('track://');\n\t    if (i === -1) {\n\t        return null;\n\t    }\n\t    return parseStringified(s.substring(i + 8), true);\n\t}\n\t\n\tfunction parseNakarteUrl(s) {\n\t    var i = s.indexOf('#');\n\t    if (i === -1) {\n\t        return null;\n\t    }\n\t    i = s.indexOf('nktk=', i + 1);\n\t    if (i === -1) {\n\t        return null;\n\t    }\n\t    s = s.substring(i + 5).split('/');\n\t    var geodataArray = [];\n\t    for (i = 0; i < s.length; i++) {\n\t        if (s[i]) {\n\t            geodataArray.push.apply(geodataArray, parseStringified(s[i]));\n\t        }\n\t    }\n\t    return geodataArray;\n\t}\n\t\n\tfunction parseGeoFile(name, data, preferNameFromFile) {\n\t    var parsers = [parseTrackUrl, parseNakarteUrl, parseKmz, parseZip, parseGpx, parseOziPlt, parseOziWpt, parseKml, parseYandexRulerUrl];\n\t    for (var i = 0; i < parsers.length; i++) {\n\t        var parsed = parsers[i](data, name, preferNameFromFile);\n\t        if (parsed !== null) {\n\t            return parsed;\n\t        }\n\t    }\n\t    return [{ name: name, error: 'UNSUPPORTED' }];\n\t}\n\t\n\texports.parseGeoFile = parseGeoFile;\n\n/***/ },\n/* 82 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _knockout = __webpack_require__(51);\n\t\n\tvar _knockout2 = _interopRequireDefault(_knockout);\n\t\n\tvar _contextmenu = __webpack_require__(56);\n\t\n\tvar _contextmenu2 = _interopRequireDefault(_contextmenu);\n\t\n\t__webpack_require__(113);\n\t\n\t__webpack_require__(461);\n\t\n\tvar _fileRead = __webpack_require__(177);\n\t\n\tvar _geo_file_formats = __webpack_require__(81);\n\t\n\tvar _CORSProxy = __webpack_require__(60);\n\t\n\tvar _CORSProxy2 = _interopRequireDefault(_CORSProxy);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tvar _geo_file_exporters = __webpack_require__(208);\n\t\n\tvar _geo_file_exporters2 = _interopRequireDefault(_geo_file_exporters);\n\t\n\tvar _clipboardCopy = __webpack_require__(79);\n\t\n\tvar _clipboardCopy2 = _interopRequireDefault(_clipboardCopy);\n\t\n\tvar _browserFilesaver = __webpack_require__(64);\n\t\n\t__webpack_require__(62);\n\t\n\t__webpack_require__(228);\n\t\n\tvar _iconFromBackgroundImage = __webpack_require__(112);\n\t\n\tvar _iconFromBackgroundImage2 = _interopRequireDefault(_iconFromBackgroundImage);\n\t\n\t__webpack_require__(38);\n\t\n\tvar _leafletControl = __webpack_require__(114);\n\t\n\t__webpack_require__(31);\n\t\n\tvar _binaryStrings = __webpack_require__(50);\n\t\n\t__webpack_require__(229);\n\t\n\t__webpack_require__(126);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _gpsies = __webpack_require__(209);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar TrackSegment = _leaflet2.default.MeasuredLine.extend({\n\t    includes: _leaflet2.default.Polyline.EditMixin,\n\t\n\t    options: {\n\t        weight: 6,\n\t        lineCap: 'butt',\n\t        opacity: 0.5\n\t\n\t    }\n\t});\n\tTrackSegment.mergeOptions(_leaflet2.default.Polyline.EditMixinOptions);\n\t\n\t_leaflet2.default.Control.TrackList = _leaflet2.default.Control.extend({\n\t    options: { position: 'bottomright' },\n\t    includes: _leaflet2.default.Mixin.Events,\n\t\n\t    colors: ['#77f', '#f95', '#0ff', '#f77', '#f7f', '#ee5'],\n\t\n\t    initialize: function initialize() {\n\t        _leaflet2.default.Control.prototype.initialize.call(this);\n\t        this.tracks = _knockout2.default.observableArray();\n\t        this.url = _knockout2.default.observable('');\n\t        this.readingFiles = _knockout2.default.observable(false);\n\t        this.readProgressRange = _knockout2.default.observable();\n\t        this.readProgressDone = _knockout2.default.observable();\n\t        this._lastTrackColor = 0;\n\t        this.trackListHeight = _knockout2.default.observable(0);\n\t        this.isPlacingPoint = false;\n\t        this.trackAddingPoint = _knockout2.default.observable(null);\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        var _this = this;\n\t\n\t        this.map = map;\n\t        this.tracks.removeAll();\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'leaflet-control leaflet-control-tracklist');\n\t        this._stopContainerEvents();\n\t\n\t        container.innerHTML = '\\n                <div class=\"leaflet-control-button-toggle\" data-bind=\"click: setExpanded\"\\n                 title=\"Load, edit and save tracks\"></div>\\n                <div class=\"leaflet-control-content\">\\n                <div class=\"header\">\\n                    <div class=\"hint\">\\n                        GPX Ozi GoogleEarth ZIP YandexMaps GPSies\\n                    </div>\\n                    <div class=\"button-minimize\" data-bind=\"click: setMinimized\"></div>\\n                </div>\\n                <div class=\"inputs-row\" data-bind=\"visible: !readingFiles()\">\\n                    <a class=\"button add-track\" title=\"New track\" data-bind=\"click: function(){this.addNewTrack()}\"></a\\n                    ><a class=\"button open-file\" title=\"Open file\" data-bind=\"click: loadFilesFromDisk\"></a\\n                    ><input type=\"text\" class=\"input-url\" placeholder=\"Track URL\"\\n                        data-bind=\"textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: onFileInputRightClick}\"\\n                    ><a class=\"button download-url\" title=\"Download URL\" data-bind=\"click: loadFilesFromUrl\"></a\\n                    ><a class=\"button menu-icon\" data-bind=\"click: function(_,e){this.showMenu(e)}\" title=\"Menu\"></a>\\n                </div>\\n                <div style=\"text-align: center\">\\n                    <div data-bind=\"\\n                        component: {\\n                        name: \\'progress-indicator\\',\\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\\n                        },\\n                        visible: readingFiles\"></div>\\n                </div>\\n                <div class=\"tracks-rows-wrapper\" data-bind=\"style: {maxHeight: trackListHeight}\">\\n                <table class=\"tracks-rows\"><tbody data-bind=\"foreach: {data: tracks, as: \\'track\\'}\">\\n                    <tr data-bind=\"event: {contextmenu: $parent.showTrackMenu.bind($parent)}\">\\n                        <td><input type=\"checkbox\" class=\"visibility-switch\" data-bind=\"checked: track.visible\"></td>\\n                        <td><div class=\"color-sample\" data-bind=\"style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)\"></div></td>\\n                        <td><div class=\"track-name-wrapper\"><div class=\"track-name\" data-bind=\"text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)\"></div></div></td>\\n                        <td><div class=\"button-length\" data-bind=\"text: $parent.formatLength(track.length()), css: {\\'ticks-enabled\\': track.measureTicksShown}, click: $parent.switchMeasureTicksVisibility.bind($parent)\"></div></td>\\n                        <td><div class=\"button-add-track\" title=\"Add track segment\" data-bind=\"click: $parent.addSegmentAndEdit.bind($parent, track)\"></div></td>\\n                        <td><div class=\"button-add-point\" title=\"Add point\" data-bind=\"click: $parent.onAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}\"></div></td>\\n                        <td><a class=\"track-text-button\" title=\"Actions\" data-bind=\"click: $parent.showTrackMenu.bind($parent)\">&hellip;</a></td>\\n                    </tr>\\n                </tbody></table>\\n                </div>\\n                </div>\\n            ';\n\t\n\t        _knockout2.default.applyBindings(this, container);\n\t        // FIXME: add onRemove method and unsubscribe\n\t        _leaflet2.default.DomEvent.addListener(map.getContainer(), 'drop', this.onFileDragDrop, this);\n\t        _leaflet2.default.DomEvent.addListener(map.getContainer(), 'dragover', this.onFileDraging, this);\n\t        this.menu = new _contextmenu2.default([{ text: 'Copy all tracks to clipboard', callback: this.copyAllTracks.bind(this) }, { text: 'Copy visible tracks to clipboard', callback: this.copyVisibleTracks.bind(this) }, '-', { text: 'Delete all tracks', callback: this.deleteAllTracks.bind(this) }, { text: 'Delete hidden tracks', callback: this.deleteHiddenTracks.bind(this) }]);\n\t        this._markerLayer = new _leaflet2.default.Layer.CanvasMarkers(null, {\n\t            print: true,\n\t            scaleDependent: true,\n\t            zIndex: 1000,\n\t            printTransparent: true\n\t        }).addTo(map);\n\t        this._markerLayer.on('markerclick markercontextmenu', this.onMarkerClick, this);\n\t        map.on('resize', this._setAdaptiveHeight, this);\n\t        setTimeout(function () {\n\t            return _this._setAdaptiveHeight();\n\t        }, 0);\n\t        return container;\n\t    },\n\t\n\t    onFileInputRightClick: function onFileInputRightClick(_, e) {\n\t        _leaflet2.default.DomEvent.stopPropagation(e);\n\t        return true;\n\t    },\n\t\n\t    _setAdaptiveHeight: function _setAdaptiveHeight() {\n\t        var mapHeight = this._map.getSize().y;\n\t        var maxHeight = void 0;\n\t        maxHeight = mapHeight - this._container.offsetTop // controls above\n\t        - (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) //controls below\n\t        - 105; // margin\n\t        this.trackListHeight(maxHeight + 'px');\n\t    },\n\t\n\t    setExpanded: function setExpanded() {\n\t        _leaflet2.default.DomUtil.removeClass(this._container, 'minimized');\n\t    },\n\t\n\t    setMinimized: function setMinimized() {\n\t        _leaflet2.default.DomUtil.addClass(this._container, 'minimized');\n\t    },\n\t\n\t    onFileDraging: function onFileDraging(e) {\n\t        _leaflet2.default.DomEvent.stopPropagation(e);\n\t        _leaflet2.default.DomEvent.preventDefault(e);\n\t        e.dataTransfer.dropEffect = 'copy';\n\t    },\n\t\n\t    onFileDragDrop: function onFileDragDrop(e) {\n\t        _leaflet2.default.DomEvent.stopPropagation(e);\n\t        _leaflet2.default.DomEvent.preventDefault(e);\n\t        var files = e.dataTransfer.files;\n\t        if (files && files.length) {\n\t            this.loadFilesFromFilesObject(files);\n\t        }\n\t    },\n\t\n\t    onEnterPressedInInput: function onEnterPressedInInput(this_, e) {\n\t        if (e.keyCode === 13) {\n\t            this_.loadFilesFromUrl();\n\t            _leaflet2.default.DomEvent.stop(e);\n\t        } else {\n\t            return true;\n\t        }\n\t    },\n\t\n\t    getTrackPolylines: function getTrackPolylines(track) {\n\t        return track.feature.getLayers().filter(function (layer) {\n\t            return layer instanceof _leaflet2.default.Polyline;\n\t        });\n\t    },\n\t\n\t    getTrackPoints: function getTrackPoints(track) {\n\t        return track.markers;\n\t    },\n\t\n\t    addNewTrack: function addNewTrack(name) {\n\t        if (!name) {\n\t            name = this.url().slice(0, 50);\n\t            if (!name.length) {\n\t                name = 'New track';\n\t            } else {\n\t                this.url('');\n\t            }\n\t        }\n\t        var track = this.addTrack({ name: name }),\n\t            line = this.addTrackSegment(track);\n\t        this.startEditTrackSegement(track, line);\n\t        line.startDrawingLine();\n\t        return track;\n\t    },\n\t\n\t    loadFilesFromFilesObject: function loadFilesFromFilesObject(files) {\n\t        this.readProgressDone(undefined);\n\t        this.readProgressRange(1);\n\t        this.readingFiles(true);\n\t\n\t        (0, _fileRead.readFiles)(files).then(function (fileDataArray) {\n\t            var geodataArray = fileDataArray.map(function (fileData) {\n\t                return (0, _geo_file_formats.parseGeoFile)(fileData.filename, fileData.data);\n\t            }).reduce(function (prev, next) {\n\t                Array.prototype.push.apply(prev, next);\n\t                return prev;\n\t            }, []);\n\t            this.addTracksFromGeodataArray(geodataArray);\n\t        }.bind(this));\n\t    },\n\t\n\t    loadFilesFromDisk: function loadFilesFromDisk() {\n\t        _logging2.default.captureBreadcrumb({ message: 'load track from disk' });\n\t        (0, _fileRead.selectFiles)(true).then(this.loadFilesFromFilesObject.bind(this));\n\t    },\n\t\n\t    loadFilesFromUrl: function loadFilesFromUrl() {\n\t        var url = this.url().trim();\n\t        _logging2.default.captureBreadcrumb({ message: 'load track from url', data: { url: url } });\n\t        try {\n\t            url = decodeURIComponent(url);\n\t        } catch (e) {}\n\t        var geodata;\n\t        if (url.length > 0) {\n\t            this.readingFiles(true);\n\t            this.readProgressDone(undefined);\n\t            this.readProgressRange(1);\n\t            geodata = (0, _geo_file_formats.parseGeoFile)('', url);\n\t            if (geodata.length === 0 || geodata.length > 1 || geodata[0].error !== 'UNSUPPORTED') {\n\t                this.addTracksFromGeodataArray(geodata);\n\t            } else {\n\t                var name = url.split('#')[0].split('?')[0].replace(/\\/*$/, '').split('/').pop();\n\t                var url_for_request = void 0,\n\t                    xhrOptions = void 0,\n\t                    preferNameFromFile = void 0;\n\t                if ((0, _gpsies.isGpsiesUrl)(url)) {\n\t                    var _gpsiesXhrOptions = (0, _gpsies.gpsiesXhrOptions)(url);\n\t\n\t                    var _gpsiesXhrOptions2 = _slicedToArray(_gpsiesXhrOptions, 2);\n\t\n\t                    url_for_request = _gpsiesXhrOptions2[0];\n\t                    xhrOptions = _gpsiesXhrOptions2[1];\n\t\n\t                    preferNameFromFile = true;\n\t                } else {\n\t                    url_for_request = (0, _CORSProxy2.default)(url);\n\t                    xhrOptions = { responseType: 'binarystring' };\n\t                    preferNameFromFile = false;\n\t                }\n\t                (0, _xhrPromise.fetch)(url_for_request, xhrOptions).then(function (xhr) {\n\t                    var geodata = (0, _geo_file_formats.parseGeoFile)(name, xhr.responseBinaryText, preferNameFromFile);\n\t                    this.addTracksFromGeodataArray(geodata);\n\t                }.bind(this), function () {\n\t                    var geodata = [{ name: url, error: 'NETWORK' }];\n\t                    this.addTracksFromGeodataArray(geodata);\n\t                }.bind(this));\n\t            }\n\t        }\n\t        this.url('');\n\t    },\n\t\n\t    addTracksFromGeodataArray: function addTracksFromGeodataArray(geodata_array) {\n\t        var hasData = false;\n\t        var messages = [];\n\t        if (geodata_array.length === 0) {\n\t            messages.push('No tracks loaded');\n\t        }\n\t        geodata_array.forEach(function (geodata) {\n\t            var data_empty = !(geodata.tracks && geodata.tracks.length || geodata.points && geodata.points.length);\n\t\n\t            if (!data_empty) {\n\t                if (geodata.tracks) {\n\t                    geodata.tracks = geodata.tracks.map(function (line) {\n\t                        return _leaflet2.default.LineUtil.simplifyLatlngs(line, 360 / (1 << 24));\n\t                    });\n\t                }\n\t                hasData = true;\n\t                this.addTrack(geodata);\n\t            }\n\t            var error_messages = {\n\t                'CORRUPT': 'File \"{name}\" is corrupt',\n\t                'UNSUPPORTED': 'File \"{name}\" has unsupported format or is badly corrupt',\n\t                'NETWORK': 'Could not download file from url \"{name}\"'\n\t            };\n\t            var message;\n\t            if (geodata.error) {\n\t                message = error_messages[geodata.error] || geodata.error;\n\t                if (data_empty) {\n\t                    message += ', no data could be loaded';\n\t                } else {\n\t                    message += ', loaded data can be invalid or incomplete';\n\t                }\n\t            }\n\t            if (message) {\n\t                message = _leaflet2.default.Util.template(message, { name: geodata.name });\n\t                messages.push(message);\n\t            }\n\t        }.bind(this));\n\t        this.readingFiles(false);\n\t        if (messages.length) {\n\t            _logging2.default.captureMessage('errors in loaded tracks', { extra: { message: messages.join('\\n') } });\n\t            (0, _notifications.notify)(messages.join('\\n'));\n\t        }\n\t        return hasData;\n\t    },\n\t\n\t    onTrackColorChanged: function onTrackColorChanged(track) {\n\t        var color = this.colors[track.color()];\n\t        this.getTrackPolylines(track).forEach(function (polyline) {\n\t            polyline.setStyle({ color: color });\n\t        });\n\t        var markers = this.getTrackPoints(track);\n\t        markers.forEach(this.setMarkerIcon.bind(this));\n\t        this._markerLayer.updateMarkers(markers);\n\t    },\n\t\n\t    onTrackVisibilityChanged: function onTrackVisibilityChanged(track) {\n\t        if (track.visible()) {\n\t            this.map.addLayer(track.feature);\n\t            this._markerLayer.addMarkers(track.markers);\n\t        } else {\n\t            this.map.removeLayer(track.feature);\n\t            this.stopPlacingPoint();\n\t            this._markerLayer.removeMarkers(track.markers);\n\t        }\n\t    },\n\t\n\t    onTrackLengthChanged: function onTrackLengthChanged(track) {\n\t        var lines = this.getTrackPolylines(track);\n\t        var length = 0;\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = lines[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var line = _step.value;\n\t\n\t                length += line.getLength();\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        track.length(length);\n\t    },\n\t\n\t    formatLength: function formatLength(x) {\n\t        var digits = 0;\n\t        if (x < 10000) {\n\t            digits = 2;\n\t        } else if (x < 100000) {\n\t            digits = 1;\n\t        }\n\t        return (x / 1000).toFixed(digits) + ' km';\n\t    },\n\t\n\t    setTrackMeasureTicksVisibility: function setTrackMeasureTicksVisibility(track) {\n\t        var visible = track.measureTicksShown(),\n\t            lines = this.getTrackPolylines(track);\n\t        lines.forEach(function (line) {\n\t            return line.setMeasureTicksVisible(visible);\n\t        });\n\t    },\n\t\n\t    switchMeasureTicksVisibility: function switchMeasureTicksVisibility(track) {\n\t        track.measureTicksShown(!track.measureTicksShown());\n\t    },\n\t\n\t    onColorSelectorClicked: function onColorSelectorClicked(track, e) {\n\t        track._contextmenu.show(e);\n\t    },\n\t\n\t    setViewToTrack: function setViewToTrack(track) {\n\t        var lines = this.getTrackPolylines(track);\n\t        var points = this.getTrackPoints(track);\n\t        if (lines.length || points.length) {\n\t            var bounds = _leaflet2.default.latLngBounds([]);\n\t            lines.forEach(function (l) {\n\t                if (l.getLatLngs().length > 1) {\n\t                    bounds.extend(l.getBounds());\n\t                }\n\t            });\n\t            points.forEach(function (p) {\n\t                bounds.extend([p.latlng.lat, p.latlng.lng]);\n\t            });\n\t            if (bounds.isValid()) {\n\t                if (_leaflet2.default.Browser.mobile) {\n\t                    this.map.fitBounds(bounds);\n\t                } else {\n\t                    this.map.flyToBounds(bounds);\n\t                }\n\t            }\n\t        }\n\t    },\n\t\n\t    attachColorSelector: function attachColorSelector(track) {\n\t        var items = this.colors.map(function (color, index) {\n\t            return {\n\t                text: '<div style=\"display: inline-block; vertical-align: middle; width: 50px; height: 0; border-top: 4px solid ' + color + '\"></div>',\n\t                callback: track.color.bind(null, index)\n\t            };\n\t        });\n\t        track._contextmenu = new _contextmenu2.default(items);\n\t    },\n\t\n\t    attachActionsMenu: function attachActionsMenu(track) {\n\t        var items = [function () {\n\t            return { text: '' + track.name(), header: true };\n\t        }, '-', { text: 'Rename', callback: this.renameTrack.bind(this, track) }, { text: 'Duplicate', callback: this.duplicateTrack.bind(this, track) }, { text: 'Reverse', callback: this.reverseTrack.bind(this, track) }, { text: 'Show elevation profile', callback: this.showElevationProfileForTrack.bind(this, track) }, '-', { text: 'Delete', callback: this.removeTrack.bind(this, track) }, '-', { text: 'Save as GPX', callback: this.saveTrackAsFile.bind(this, track, _geo_file_exporters2.default.saveGpx, '.gpx') }, { text: 'Save as KML', callback: this.saveTrackAsFile.bind(this, track, _geo_file_exporters2.default.saveKml, '.kml') }, { text: 'Copy link to clipboard', callback: this.copyLinkToClipboard.bind(this, track) }];\n\t        track._actionsMenu = new _contextmenu2.default(items);\n\t    },\n\t\n\t    addSegmentAndEdit: function addSegmentAndEdit(track) {\n\t        if (!track.visible()) {\n\t            return;\n\t        }\n\t        this.stopPlacingPoint();\n\t        var polyline = this.addTrackSegment(track, []);\n\t        this.startEditTrackSegement(track, polyline);\n\t        polyline.startDrawingLine(1);\n\t    },\n\t\n\t    duplicateTrack: function duplicateTrack(track) {\n\t        var segments = [],\n\t            segment,\n\t            line,\n\t            lines = this.getTrackPolylines(track);\n\t        for (var i = 0; i < lines.length; i++) {\n\t            segment = [];\n\t            line = lines[i].getLatLngs();\n\t            for (var j = 0; j < line.length; j++) {\n\t                segment.push([line[j].lat, line[j].lng]);\n\t            }\n\t            segments.push(segment);\n\t        }\n\t        this.addTrack({ name: track.name(), tracks: segments });\n\t    },\n\t\n\t    reverseTrackSegment: function reverseTrackSegment(trackSegment) {\n\t        trackSegment.stopDrawingLine();\n\t        var latlngs = trackSegment.getLatLngs();\n\t        latlngs = latlngs.map(function (ll) {\n\t            return [ll.lat, ll.lng];\n\t        });\n\t        latlngs.reverse();\n\t        var isEdited = this._editedLine === trackSegment;\n\t        this.deleteTrackSegment(trackSegment);\n\t        var newTrackSegment = this.addTrackSegment(trackSegment._parentTrack, latlngs);\n\t        if (isEdited) {\n\t            this.startEditTrackSegement(trackSegment._parentTrack, newTrackSegment);\n\t        }\n\t    },\n\t\n\t    reverseTrack: function reverseTrack(track) {\n\t        var self = this;\n\t        this.getTrackPolylines(track).forEach(function (trackSegment) {\n\t            self.reverseTrackSegment(trackSegment);\n\t        });\n\t    },\n\t\n\t    copyLinkToClipboard: function copyLinkToClipboard(track, mouseEvent) {\n\t        this.stopActiveDraw();\n\t        var s = this.trackToString(track, true);\n\t        var url = window.location + '&nktk=' + s;\n\t        (0, _clipboardCopy2.default)(url, mouseEvent);\n\t    },\n\t\n\t    saveTrackAsFile: function saveTrackAsFile(track, exporter, extension) {\n\t        this.stopActiveDraw();\n\t        var lines = this.getTrackPolylines(track).map(function (line) {\n\t            return line.getLatLngs();\n\t        });\n\t        var points = this.getTrackPoints(track);\n\t        var name = track.name(),\n\t            i = name.lastIndexOf('.');\n\t        if (i > -1 && i >= name.length - 5) {\n\t            name = name.slice(0, i);\n\t        }\n\t\n\t        if (lines.length === 0 && points.length === 0) {\n\t            (0, _notifications.notify)('Track is empty, nothing to save');\n\t            return;\n\t        }\n\t\n\t        var fileText = exporter(lines, name, points);\n\t        var filename = name + extension;\n\t        (0, _browserFilesaver.saveAs)((0, _binaryStrings.blobFromString)(fileText), filename, true);\n\t    },\n\t\n\t    renameTrack: function renameTrack(track) {\n\t        var newName = prompt('Enter new name', track.name());\n\t        if (newName && newName.length) {\n\t            track.name(newName);\n\t        }\n\t    },\n\t\n\t    showTrackMenu: function showTrackMenu(track, e) {\n\t        track._actionsMenu.show(e);\n\t    },\n\t\n\t    showMenu: function showMenu(e) {\n\t        this.menu.show(e);\n\t    },\n\t\n\t    stopActiveDraw: function stopActiveDraw() {\n\t        if (this._editedLine) {\n\t            this._editedLine.stopDrawingLine();\n\t        }\n\t    },\n\t\n\t    stopEditLine: function stopEditLine() {\n\t        if (this._editedLine) {\n\t            this.stopLineJoinSelection();\n\t            this._editedLine.stopEdit();\n\t            this._editedLine = null;\n\t        }\n\t    },\n\t\n\t    onTrackSegmentClick: function onTrackSegmentClick(track, trackSegment, e) {\n\t        if (this.isPlacingPoint) {\n\t            return;\n\t        }\n\t        if (this._lineJoinCursor) {\n\t            _leaflet2.default.DomEvent.stopPropagation(e);\n\t            this.joinTrackSegments(trackSegment);\n\t        } else {\n\t            this.startEditTrackSegement(track, trackSegment);\n\t            _leaflet2.default.DomEvent.stopPropagation(e);\n\t        }\n\t    },\n\t\n\t    startEditTrackSegement: function startEditTrackSegement(track, polyline) {\n\t        if (this._editedLine && this._editedLine !== polyline) {\n\t            this.stopEditLine();\n\t        }\n\t        polyline.startEdit();\n\t        this._editedLine = polyline;\n\t        polyline.once('editend', function (e) {\n\t            setTimeout(this.onLineEditEnd.bind(this, e, track, polyline), 0);\n\t        }.bind(this));\n\t        this.fire('startedit');\n\t    },\n\t\n\t    onAddPointClicked: function onAddPointClicked(track) {\n\t        if (this.trackAddingPoint() === track) {\n\t            this.stopPlacingPoint();\n\t        } else {\n\t            this.beginPointCreate(track);\n\t        }\n\t    },\n\t\n\t    _beginPointEdit: function _beginPointEdit() {\n\t        this.stopPlacingPoint();\n\t        this.stopEditLine();\n\t        _leaflet2.default.DomUtil.addClass(this._map._container, 'leaflet-point-placing');\n\t        this.isPlacingPoint = true;\n\t        _leaflet2.default.DomEvent.on(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n\t        this.fire('startedit');\n\t    },\n\t\n\t    beginPointMove: function beginPointMove(marker) {\n\t        this._beginPointEdit();\n\t        this._movingMarker = marker;\n\t        this.map.on('click', this.movePoint, this);\n\t    },\n\t\n\t    beginPointCreate: function beginPointCreate(track) {\n\t        this._beginPointEdit();\n\t        this.map.on('click', this.createNewPoint, this);\n\t        this.trackAddingPoint(track);\n\t    },\n\t\n\t    movePoint: function movePoint(e) {\n\t        var marker = this._movingMarker;\n\t        this._markerLayer.setMarkerPosition(marker, e.latlng);\n\t        this.stopPlacingPoint();\n\t    },\n\t\n\t    createNewPoint: function createNewPoint(e) {\n\t        var _this2 = this;\n\t\n\t        if (!this.isPlacingPoint) {\n\t            return;\n\t        }\n\t        var parentTrack = this.trackAddingPoint();\n\t        parentTrack._pointAutoInc += 1;\n\t        var name = parentTrack._pointAutoInc.toString();\n\t        while (name.length < 3) {\n\t            name = '0' + name;\n\t        }\n\t        var marker = this.addPoint(parentTrack, { name: name, lat: e.latlng.lat, lng: e.latlng.lng });\n\t        this._markerLayer.addMarker(marker);\n\t        // we need to show prompt after marker is dispalyed;\n\t        // grid layer is updated in setTimout(..., 0)after adding marker\n\t        // it is better to do it on 'load' event but when it is fired marker is not yet displayed\n\t        setTimeout(function () {\n\t            _this2.renamePoint(marker);\n\t            _this2.beginPointCreate(parentTrack);\n\t        }, 10);\n\t    },\n\t\n\t    stopPlacingPointOnEscPressed: function stopPlacingPointOnEscPressed(e) {\n\t        if (e.keyCode === 27) {\n\t            this.stopPlacingPoint();\n\t        }\n\t    },\n\t\n\t    stopPlacingPoint: function stopPlacingPoint() {\n\t        this.isPlacingPoint = false;\n\t        this.trackAddingPoint(null);\n\t        _leaflet2.default.DomUtil.removeClass(this._map._container, 'leaflet-point-placing');\n\t        _leaflet2.default.DomEvent.off(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n\t        this.map.off('click', this.createNewPoint, this);\n\t        this.map.off('click', this.movePoint, this);\n\t    },\n\t\n\t    joinTrackSegments: function joinTrackSegments(newSegment) {\n\t        this.stopLineJoinSelection();\n\t        var originalSegment = this._editedLine;\n\t        var latlngs = originalSegment.getLatLngs(),\n\t            latngs2 = newSegment.getLatLngs();\n\t        if (this._lineJoinToStart === this._lineJoinFromStart) {\n\t            latngs2.reverse();\n\t        }\n\t        if (this._lineJoinFromStart) {\n\t            latlngs.unshift.apply(latlngs, latngs2);\n\t        } else {\n\t            latlngs.push.apply(latlngs, latngs2);\n\t        }\n\t        latlngs = latlngs.map(function (ll) {\n\t            return [ll.lat, ll.lng];\n\t        });\n\t        this.deleteTrackSegment(originalSegment);\n\t        if (originalSegment._parentTrack === newSegment._parentTrack) {\n\t            this.deleteTrackSegment(newSegment);\n\t        }\n\t        this.addTrackSegment(originalSegment._parentTrack, latlngs);\n\t    },\n\t\n\t    onLineEditEnd: function onLineEditEnd(e, track, polyline) {\n\t        if (polyline.getLatLngs().length < 2) {\n\t            track.feature.removeLayer(polyline);\n\t        }\n\t        this.onTrackLengthChanged(track);\n\t        if (this._editedLine === polyline) {\n\t            this._editedLine = null;\n\t        }\n\t        if (!this.getTrackPolylines(track).length && !this.getTrackPoints(track).length && e.userCancelled) {\n\t            this.removeTrack(track);\n\t        }\n\t    },\n\t\n\t    addTrackSegment: function addTrackSegment(track, sourcePoints) {\n\t        var polyline = new TrackSegment(sourcePoints || [], {\n\t            color: this.colors[track.color()],\n\t            print: true\n\t        });\n\t        polyline._parentTrack = track;\n\t        polyline.setMeasureTicksVisible(track.measureTicksShown());\n\t        polyline.on('click', this.onTrackSegmentClick.bind(this, track, polyline));\n\t        polyline.on('nodeschanged', this.onTrackLengthChanged.bind(this, track));\n\t        polyline.on('noderightclick', this.onNodeRightClickShowMenu, this);\n\t        polyline.on('segmentrightclick', this.onSegmentRightClickShowMenu, this);\n\t        polyline.on('mousemove', this.onMouseMoveOnSegmentUpdateLineJoinCursor, this);\n\t\n\t        //polyline.on('editingstart', polyline.setMeasureTicksVisible.bind(polyline, false));\n\t        //polyline.on('editingend', this.setTrackMeasureTicksVisibility.bind(this, track));\n\t        track.feature.addLayer(polyline);\n\t        return polyline;\n\t    },\n\t\n\t    onNodeRightClickShowMenu: function onNodeRightClickShowMenu(e) {\n\t        var items = [];\n\t        if (e.nodeIndex > 0 && e.nodeIndex < e.line.getLatLngs().length - 1) {\n\t            items.push({\n\t                text: 'Cut',\n\t                callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, null)\n\t            });\n\t        }\n\t        if (e.nodeIndex === 0 || e.nodeIndex === e.line.getLatLngs().length - 1) {\n\t            items.push({ text: 'Join', callback: this.startLineJoinSelection.bind(this, e) });\n\t        }\n\t        items.push({ text: 'Reverse', callback: this.reverseTrackSegment.bind(this, e.line) });\n\t        items.push({ text: 'Delete segment', callback: this.deleteTrackSegment.bind(this, e.line) });\n\t        items.push({ text: 'New track from segment', callback: this.newTrackFromSegment.bind(this, e.line) });\n\t        items.push({\n\t            text: 'Show elevation profile for segment',\n\t            callback: this.showElevationProfileForSegment.bind(this, e.line)\n\t        });\n\t\n\t        var menu = new _contextmenu2.default(items);\n\t        menu.show(e.mouseEvent);\n\t    },\n\t\n\t    onSegmentRightClickShowMenu: function onSegmentRightClickShowMenu(e) {\n\t        var menu = new _contextmenu2.default([{\n\t            text: 'Cut',\n\t            callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, e.mouseEvent.latlng)\n\t        }, { text: 'Reverse', callback: this.reverseTrackSegment.bind(this, e.line) }, { text: 'Delete segment', callback: this.deleteTrackSegment.bind(this, e.line) }, { text: 'New track from segment', callback: this.newTrackFromSegment.bind(this, e.line) }, {\n\t            text: 'Show elevation profile for segment',\n\t            callback: this.showElevationProfileForSegment.bind(this, e.line)\n\t        }]);\n\t        menu.show(e.mouseEvent);\n\t    },\n\t\n\t    startLineJoinSelection: function startLineJoinSelection(e) {\n\t        this.stopLineJoinSelection();\n\t        this._editedLine.stopDrawingLine();\n\t        this._lineJoinFromStart = e.nodeIndex === 0;\n\t        var p = this._editedLine.getLatLngs()[e.nodeIndex];\n\t        p = [p.lat, p.lng];\n\t        this._lineJoinCursor = _leaflet2.default.polyline([p, e.mouseEvent.latlng], {\n\t            interactive: false,\n\t            color: 'red',\n\t            weight: 1.5,\n\t            opacity: 1,\n\t            dashArray: '7,7'\n\t        }).addTo(this.map);\n\t        this.map.on('mousemove', this.onMouseMoveUpdateLineJoinCursor, this);\n\t        this.map.on('click', this.stopLineJoinSelection, this);\n\t        _leaflet2.default.DomUtil.addClass(this.map.getContainer(), 'join-line-selecting');\n\t        _leaflet2.default.DomEvent.on(document, 'keyup', this.onEscPressedStopLineJoinSelection, this);\n\t        var self = this;\n\t        setTimeout(function () {\n\t            self._editedLine.preventStopEdit = true;\n\t        }, 0);\n\t    },\n\t\n\t    onMouseMoveUpdateLineJoinCursor: function onMouseMoveUpdateLineJoinCursor(e) {\n\t        if (this._lineJoinCursor) {\n\t            this._lineJoinCursor.getLatLngs().splice(1, 1, e.latlng);\n\t            this._lineJoinCursor.redraw();\n\t            this._lineJoinCursor.setStyle({ color: 'red' });\n\t        }\n\t    },\n\t\n\t    onMouseMoveOnSegmentUpdateLineJoinCursor: function onMouseMoveOnSegmentUpdateLineJoinCursor(e) {\n\t        if (!this._lineJoinCursor) {\n\t            return;\n\t        }\n\t        var trackSegment = e.target,\n\t            latlngs = trackSegment.getLatLngs(),\n\t            distToStart = e.latlng.distanceTo(latlngs[0]),\n\t            distToEnd = e.latlng.distanceTo(latlngs[latlngs.length - 1]);\n\t        this._lineJoinToStart = distToStart < distToEnd;\n\t        var cursorEnd = this._lineJoinToStart ? latlngs[0] : latlngs[latlngs.length - 1];\n\t        this._lineJoinCursor.setStyle({ color: 'green' });\n\t        this._lineJoinCursor.getLatLngs().splice(1, 1, cursorEnd);\n\t        this._lineJoinCursor.redraw();\n\t        _leaflet2.default.DomEvent.stopPropagation(e);\n\t    },\n\t\n\t    onEscPressedStopLineJoinSelection: function onEscPressedStopLineJoinSelection(e) {\n\t        if ('input' === e.target.tagName.toLowerCase()) {\n\t            return;\n\t        }\n\t        switch (e.keyCode) {\n\t            case 27:\n\t            case 13:\n\t                this.stopLineJoinSelection();\n\t                _leaflet2.default.DomEvent.stop(e);\n\t                break;\n\t            default:\n\t        }\n\t    },\n\t\n\t    stopLineJoinSelection: function stopLineJoinSelection() {\n\t        if (this._lineJoinCursor) {\n\t            this.map.off('mousemove', this.onMouseMoveUpdateLineJoinCursor, this);\n\t            this.map.off('click', this.stopLineJoinSelection, this);\n\t            _leaflet2.default.DomUtil.removeClass(this.map.getContainer(), 'join-line-selecting');\n\t            _leaflet2.default.DomEvent.off(document, 'keyup', this.onEscPressedStopLineJoinSelection, this);\n\t            this.map.removeLayer(this._lineJoinCursor);\n\t            this._lineJoinCursor = null;\n\t            var self = this;\n\t            setTimeout(function () {\n\t                self._editedLine.preventStopEdit = false;\n\t            }, 0);\n\t        }\n\t    },\n\t\n\t    splitTrackSegment: function splitTrackSegment(trackSegment, nodeIndex, latlng) {\n\t        var latlngs = trackSegment.getLatLngs();\n\t        latlngs = latlngs.map(function (ll) {\n\t            return [ll.lat, ll.lng];\n\t        });\n\t        var latlngs1 = latlngs.slice(0, nodeIndex + 1),\n\t            latlngs2 = latlngs.slice(nodeIndex + 1);\n\t        if (latlng) {\n\t            var p = this.map.project(latlng),\n\t                p1 = this.map.project(latlngs[nodeIndex]),\n\t                p2 = this.map.project(latlngs[nodeIndex + 1]),\n\t                pnew = _leaflet2.default.LineUtil.closestPointOnSegment(p, p1, p2);\n\t            latlng = this.map.unproject(pnew);\n\t            latlngs1.push(latlng);\n\t            latlng = [latlng.lat, latlng.lng];\n\t        } else {\n\t            latlng = latlngs[nodeIndex];\n\t        }\n\t        latlngs2.unshift(latlng);\n\t        this.deleteTrackSegment(trackSegment);\n\t        var segment1 = this.addTrackSegment(trackSegment._parentTrack, latlngs1);\n\t        this.addTrackSegment(trackSegment._parentTrack, latlngs2);\n\t        this.startEditTrackSegement(trackSegment._parentTrack, segment1);\n\t    },\n\t\n\t    deleteTrackSegment: function deleteTrackSegment(trackSegment) {\n\t        trackSegment._parentTrack.feature.removeLayer(trackSegment);\n\t    },\n\t\n\t    newTrackFromSegment: function newTrackFromSegment(trackSegment) {\n\t        var srcNodes = trackSegment.getLatLngs(),\n\t            newNodes = [],\n\t            i;\n\t        for (i = 0; i < srcNodes.length; i++) {\n\t            newNodes.push([srcNodes[i].lat, srcNodes[i].lng]);\n\t        }\n\t        this.addTrack({ name: \"New track\", tracks: [newNodes] });\n\t    },\n\t\n\t    addTrack: function addTrack(geodata) {\n\t        var color;\n\t        color = geodata.color;\n\t        if (!(color >= 0 && color < this.colors.length)) {\n\t            color = this._lastTrackColor;\n\t            this._lastTrackColor = (this._lastTrackColor + 1) % this.colors.length;\n\t        }\n\t        var track = {\n\t            name: _knockout2.default.observable(geodata.name),\n\t            color: _knockout2.default.observable(color),\n\t            visible: _knockout2.default.observable(!geodata.trackHidden),\n\t            length: _knockout2.default.observable('empty'),\n\t            measureTicksShown: _knockout2.default.observable(geodata.measureTicksShown || false),\n\t            feature: _leaflet2.default.featureGroup([]),\n\t            _pointAutoInc: 0,\n\t            markers: []\n\t        };\n\t        (geodata.tracks || []).forEach(this.addTrackSegment.bind(this, track));\n\t        (geodata.points || []).forEach(this.addPoint.bind(this, track));\n\t\n\t        this.tracks.push(track);\n\t\n\t        track.visible.subscribe(this.onTrackVisibilityChanged.bind(this, track));\n\t        track.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this, track));\n\t        track.color.subscribe(this.onTrackColorChanged.bind(this, track));\n\t\n\t        //this.onTrackColorChanged(track);\n\t        this.onTrackVisibilityChanged(track);\n\t        this.attachColorSelector(track);\n\t        this.attachActionsMenu(track);\n\t        this.onTrackLengthChanged(track);\n\t        return track;\n\t    },\n\t\n\t    setMarkerIcon: function setMarkerIcon(marker) {\n\t        var symbol = 'marker',\n\t            colorInd = marker._parentTrack.color() + 1,\n\t            className = 'symbol-' + symbol + '-' + colorInd;\n\t        marker.icon = (0, _iconFromBackgroundImage2.default)('track-waypoint ' + className);\n\t    },\n\t\n\t    setMarkerLabel: function setMarkerLabel(marker, label) {\n\t        if (label.match(/\\d{3,}/)) {\n\t            var n = parseInt(label, 10);\n\t            marker._parentTrack._pointAutoInc = Math.max(n, marker._parentTrack._pointAutoInc | 0);\n\t        }\n\t        marker.label = label;\n\t    },\n\t\n\t    addPoint: function addPoint(track, srcPoint) {\n\t        var marker = {\n\t            latlng: _leaflet2.default.latLng([srcPoint.lat, srcPoint.lng]),\n\t            _parentTrack: track\n\t        };\n\t        this.setMarkerIcon(marker);\n\t        this.setMarkerLabel(marker, srcPoint.name);\n\t        track.markers.push(marker);\n\t        marker._parentTrack = track;\n\t        return marker;\n\t    },\n\t\n\t    onMarkerClick: function onMarkerClick(e) {\n\t        new _contextmenu2.default([{ text: 'Rename', callback: this.renamePoint.bind(this, e.marker) }, { text: 'Move', callback: this.beginPointMove.bind(this, e.marker) }, { text: 'Delete', callback: this.removePoint.bind(this, e.marker) }]).show(e);\n\t    },\n\t\n\t    removePoint: function removePoint(marker) {\n\t        this.stopPlacingPoint();\n\t        this._markerLayer.removeMarker(marker);\n\t        var markers = marker._parentTrack.markers;\n\t        var i = markers.indexOf(marker);\n\t        markers.splice(i, 1);\n\t    },\n\t\n\t    renamePoint: function renamePoint(marker) {\n\t        this.stopPlacingPoint();\n\t        var newLabel = prompt('New point name', marker.label);\n\t        if (newLabel !== null) {\n\t            this.setMarkerLabel(marker, newLabel);\n\t            this._markerLayer.updateMarker(marker);\n\t        }\n\t    },\n\t\n\t    removeTrack: function removeTrack(track) {\n\t        track.visible(false);\n\t        this.tracks.remove(track);\n\t        this.stopPlacingPoint();\n\t    },\n\t\n\t    deleteAllTracks: function deleteAllTracks() {\n\t        var tracks = this.tracks().slice(0),\n\t            i;\n\t        for (i = 0; i < tracks.length; i++) {\n\t            this.removeTrack(tracks[i]);\n\t        }\n\t    },\n\t\n\t    deleteHiddenTracks: function deleteHiddenTracks() {\n\t        var tracks = this.tracks().slice(0),\n\t            i,\n\t            track;\n\t        for (i = 0; i < tracks.length; i++) {\n\t            track = tracks[i];\n\t            if (!track.visible()) {\n\t                this.removeTrack(tracks[i]);\n\t            }\n\t        }\n\t    },\n\t\n\t    trackToString: function trackToString(track, forceVisible) {\n\t        var lines = this.getTrackPolylines(track).map(function (line) {\n\t            var points = line.getLatLngs();\n\t            points = _leaflet2.default.LineUtil.simplifyLatlngs(points, 360 / (1 << 24));\n\t            return points;\n\t        });\n\t        return _geo_file_exporters2.default.saveToString(lines, track.name(), track.color(), track.measureTicksShown(), this.getTrackPoints(track), forceVisible ? false : !track.visible());\n\t    },\n\t\n\t    copyAllTracks: function copyAllTracks(mouseEvent) {\n\t        this.stopActiveDraw();\n\t        var tracks = this.tracks(),\n\t            serialized = [],\n\t            i,\n\t            track,\n\t            s;\n\t        for (i = 0; i < tracks.length; i++) {\n\t            track = tracks[i];\n\t            s = this.trackToString(track);\n\t            serialized.push(s);\n\t        }\n\t        var url = window.location + '&nktk=' + serialized.join('/');\n\t        (0, _clipboardCopy2.default)(url, mouseEvent);\n\t    },\n\t\n\t    copyVisibleTracks: function copyVisibleTracks(mouseEvent) {\n\t        this.stopActiveDraw();\n\t        var tracks = this.tracks(),\n\t            serialized = [],\n\t            i,\n\t            track,\n\t            s;\n\t        for (i = 0; i < tracks.length; i++) {\n\t            track = tracks[i];\n\t            if (track.visible()) {\n\t                s = this.trackToString(track);\n\t                serialized.push(s);\n\t            }\n\t        }\n\t        var url = window.location + '&nktk=' + serialized.join('/');\n\t        (0, _clipboardCopy2.default)(url, mouseEvent);\n\t    },\n\t\n\t    exportTracks: function exportTracks(minTicksIntervalMeters) {\n\t        var self = this;\n\t        return this.tracks().filter(function (track) {\n\t            return self.getTrackPolylines(track).length;\n\t        }).map(function (track) {\n\t            var capturedTrack = track.feature.getLayers().map(function (pl) {\n\t                return pl.getLatLngs().map(function (ll) {\n\t                    return [ll.lat, ll.lng];\n\t                });\n\t            });\n\t            var bounds = track.feature.getBounds();\n\t            var capturedBounds = [[bounds.getSouth(), bounds.getWest()], [bounds.getNorth(), bounds.getEast()]];\n\t            return {\n\t                color: track.color(),\n\t                visible: track.visible(),\n\t                segments: capturedTrack,\n\t                bounds: capturedBounds,\n\t                measureTicksShown: track.measureTicksShown(),\n\t                measureTicks: [].concat.apply([], track.feature.getLayers().map(function (pl) {\n\t                    return pl.getTicksPositions(minTicksIntervalMeters);\n\t                }))\n\t            };\n\t        });\n\t    },\n\t\n\t    showElevationProfileForSegment: function showElevationProfileForSegment(line) {\n\t        this.hideElevationProfile();\n\t        this.stopEditLine();\n\t        this._elevationControl = new _leafletControl.ElevationProfile(this._map, line.getLatLngs(), {\n\t            samplingInterval: (0, _leafletControl.calcSamplingInterval)(line.getLength())\n\t        });\n\t        this.fire('elevation-shown');\n\t    },\n\t\n\t    showElevationProfileForTrack: function showElevationProfileForTrack(track) {\n\t        var lines = this.getTrackPolylines(track),\n\t            path = [],\n\t            i;\n\t        for (i = 0; i < lines.length; i++) {\n\t            if (lines[i] === this._editedLine) {\n\t                this.stopEditLine();\n\t            }\n\t            path = path.concat(lines[i].getLatLngs());\n\t        }\n\t        this.hideElevationProfile();\n\t        this._elevationControl = new _leafletControl.ElevationProfile(this._map, path, {\n\t            samplingInterval: (0, _leafletControl.calcSamplingInterval)(new _leaflet2.default.MeasuredLine(path).getLength())\n\t        });\n\t        this.fire('elevation-shown');\n\t    },\n\t\n\t    hideElevationProfile: function hideElevationProfile() {\n\t        if (this._elevationControl) {\n\t            this._elevationControl.removeFrom(this._map);\n\t        }\n\t        this._elevationControl = null;\n\t    },\n\t\n\t    hasTracks: function hasTracks() {\n\t        return !!this.tracks().length;\n\t    }\n\t});\n\n/***/ },\n/* 83 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.TiledDataLoader = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _cache = __webpack_require__(176);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar TiledDataLoader = function () {\n\t    function TiledDataLoader() {\n\t        var cacheSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 50;\n\t\n\t        _classCallCheck(this, TiledDataLoader);\n\t\n\t        this._cache = new _cache.Cache(cacheSize);\n\t        this._pendingRequests = {};\n\t        this._xhrQueue = new _xhrPromise.XHRQueue();\n\t    }\n\t\n\t    _createClass(TiledDataLoader, [{\n\t        key: 'makeTileKey',\n\t        value: function makeTileKey(coords) {\n\t            return coords.x + ':' + coords.y + ':' + coords.z;\n\t        }\n\t    }, {\n\t        key: 'getFromCache',\n\t        value: function getFromCache(dataTileCoords) {\n\t            var key = this.makeTileKey(dataTileCoords);\n\t            var res = this._cache.get(key);\n\t            res['coords'] = dataTileCoords;\n\t            return res;\n\t        }\n\t    }, {\n\t        key: 'layerTileToDataTileCoords',\n\t        value: function layerTileToDataTileCoords(layerTileCoords) {\n\t            return Object.assign({}, layerTileCoords);\n\t        }\n\t    }, {\n\t        key: 'makeRequestData',\n\t        value: function makeRequestData(dataTileCoords) {\n\t            throw new Error('Not implemented');\n\t            // return {\n\t            //     url,\n\t            //     options\n\t            // }\n\t        }\n\t    }, {\n\t        key: 'processResponse',\n\t        value: function processResponse(xhr, originalDataTileCoords) {\n\t            throw new Error('Not implemented');\n\t            // return {\n\t            //     tileData,\n\t            //     coords\n\t            // }\n\t        }\n\t    }, {\n\t        key: 'calcAdjustment',\n\t        value: function calcAdjustment(layerTileCoords, dataTileCoords) {\n\t            if (layerTileCoords.x === dataTileCoords.x && layerTileCoords.y === dataTileCoords.y && layerTileCoords.z === dataTileCoords.z) {\n\t                return null;\n\t            }\n\t            if (dataTileCoords.z > layerTileCoords.z) {\n\t                var multiplier = 1 << dataTileCoords.z - layerTileCoords.z;\n\t                return { multiplier: 1 / multiplier, offsetX: 0, offsetY: 0 };\n\t            } else {\n\t                var _multiplier = 1 << layerTileCoords.z - dataTileCoords.z;\n\t                return {\n\t                    multiplier: _multiplier,\n\t                    offsetX: layerTileCoords.x - dataTileCoords.x * _multiplier,\n\t                    offsetY: layerTileCoords.y - dataTileCoords.y * _multiplier\n\t                };\n\t            }\n\t        }\n\t    }, {\n\t        key: 'requestTileData',\n\t        value: function requestTileData(layerTileCoords) {\n\t            var _this = this;\n\t\n\t            var dataTileCoords = this.layerTileToDataTileCoords(layerTileCoords);\n\t            var res = this.getFromCache(dataTileCoords);\n\t            if (res.found) {\n\t                return {\n\t                    dataPromise: Promise.resolve({\n\t                        coords: res.coords,\n\t                        tileData: res.value,\n\t                        adjustment: this.calcAdjustment(layerTileCoords, res.coords)\n\t                    }),\n\t                    abortLoading: function abortLoading() {}\n\t                };\n\t            }\n\t\n\t            var dataTileKey = this.makeTileKey(dataTileCoords);\n\t            if (!(dataTileKey in this._pendingRequests)) {\n\t                var _makeRequestData = this.makeRequestData(dataTileCoords),\n\t                    url = _makeRequestData.url,\n\t                    options = _makeRequestData.options;\n\t\n\t                var fetchPromise = this._xhrQueue.put(url, options);\n\t                // TODO: handle errors\n\t                var dataPromise = fetchPromise.then(function (xhr) {\n\t                    return _this.processResponse(xhr, dataTileCoords);\n\t                }).then(function (_ref) {\n\t                    var tileData = _ref.tileData,\n\t                        coords = _ref.coords;\n\t\n\t                    _this._cache.put(_this.makeTileKey(coords), tileData);\n\t                    delete _this._pendingRequests[dataTileKey];\n\t                    return {\n\t                        tileData: tileData,\n\t                        coords: coords\n\t                    };\n\t                });\n\t                var _pendingRequest = this._pendingRequests[dataTileKey] = {\n\t                    dataPromise: dataPromise,\n\t                    refCount: 0\n\t                };\n\t                _pendingRequest.abortLoading = function () {\n\t                    _pendingRequest.refCount -= 1;\n\t                    if (_pendingRequest.refCount < 1) {\n\t                        fetchPromise.abort();\n\t                        delete _this._pendingRequests[dataTileKey];\n\t                    }\n\t                };\n\t            }\n\t\n\t            var pendingRequest = this._pendingRequests[dataTileKey];\n\t            pendingRequest.refCount += 1;\n\t\n\t            return {\n\t                dataPromise: pendingRequest.dataPromise.then(function (data) {\n\t                    return {\n\t                        coords: data.coords,\n\t                        tileData: data.tileData,\n\t                        adjustment: _this.calcAdjustment(layerTileCoords, data.coords)\n\t                    };\n\t                }),\n\t                abortLoading: function abortLoading() {\n\t                    return pendingRequest.abortLoading();\n\t                }\n\t            };\n\t        }\n\t    }]);\n\t\n\t    return TiledDataLoader;\n\t}();\n\t\n\texports.TiledDataLoader = TiledDataLoader;\n\n/***/ },\n/* 84 */,\n/* 85 */,\n/* 86 */,\n/* 87 */,\n/* 88 */,\n/* 89 */,\n/* 90 */,\n/* 91 */,\n/* 92 */,\n/* 93 */,\n/* 94 */,\n/* 95 */,\n/* 96 */,\n/* 97 */,\n/* 98 */,\n/* 99 */,\n/* 100 */,\n/* 101 */,\n/* 102 */,\n/* 103 */,\n/* 104 */,\n/* 105 */,\n/* 106 */,\n/* 107 */,\n/* 108 */,\n/* 109 */,\n/* 110 */,\n/* 111 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _loadScript = __webpack_require__(478);\n\t\n\tvar _loadScript2 = _interopRequireDefault(_loadScript);\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _google = null;\n\tvar _pending = null;\n\t\n\tfunction getGoogle() {\n\t    if (_google) {\n\t        return Promise.resolve(_google);\n\t    }\n\t    if (!_pending) {\n\t        _pending = new Promise(function (resolve, reject) {\n\t            (0, _loadScript2.default)(_config2.default.googleApiUrl, function (error) {\n\t                if (error) {\n\t                    reject(error);\n\t                }\n\t                _google = window.google;\n\t                resolve(_google);\n\t            });\n\t        });\n\t    }\n\t    return _pending;\n\t}\n\t\n\texports.default = getGoogle;\n\n/***/ },\n/* 112 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tfunction cached(f) {\n\t    var cache = {};\n\t    return function (arg) {\n\t        if (!(arg in cache)) {\n\t            cache[arg] = f(arg);\n\t        }\n\t        return cache[arg];\n\t    };\n\t}\n\t\n\tfunction iconFromBackgroundImage(className) {\n\t    var container = document.createElement('div');\n\t    container.style.position = 'absolute';\n\t    document.body.appendChild(container);\n\t    var el = document.createElement('div');\n\t    el.className = className;\n\t    container.appendChild(el);\n\t    var st = window.getComputedStyle(el),\n\t        url = st.backgroundImage.replace(/^url\\(\"?/, '').replace(/\"?\\)$/, '');\n\t    var icon = { 'url': url, 'center': [-el.offsetLeft, -el.offsetTop] };\n\t    document.body.removeChild(container);\n\t    container.removeChild(el);\n\t    return icon;\n\t}\n\t\n\texports.default = cached(iconFromBackgroundImage);\n\n/***/ },\n/* 113 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _knockout = __webpack_require__(51);\n\t\n\tvar _knockout2 = _interopRequireDefault(_knockout);\n\t\n\t__webpack_require__(444);\n\t\n\t__webpack_require__(38);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_knockout2.default.components.register('progress-indicator', {\n\t    template: '\\n        <div class=\"ko-progress-unknown icon-spinner-nuclear\" data-bind=\"visible: progress() === undefined\"></div>\\n        <div class=\"ko-progress\" data-bind=\"visible: progress() !== undefined\">\\n            <div class=\"ko-progress-bkg\">\\n                <div class=\"ko-progress-bar\"  data-bind=\"style: {width: progress() + \\'%\\'}\"></div>\\n            </div>\\n        </div>',\n\t    viewModel: function viewModel(params) {\n\t        this.progress = _knockout2.default.pureComputed(function () {\n\t            var range = params.progressRange(),\n\t                done = params.progressDone();\n\t            return done === undefined ? undefined : done * 100 / range;\n\t        });\n\t    }\n\t});\n\n/***/ },\n/* 114 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.calcSamplingInterval = exports.ElevationProfile = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(448);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\t__webpack_require__(31);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction calcSamplingInterval(length) {\n\t    var targetPointsN = 2000;\n\t    var maxPointsN = 9999;\n\t    var samplingIntgerval = length / targetPointsN;\n\t    if (samplingIntgerval < 10) {\n\t        samplingIntgerval = 10;\n\t    }\n\t    if (samplingIntgerval > 50) {\n\t        samplingIntgerval = 50;\n\t    }\n\t    if (length / samplingIntgerval > maxPointsN) {\n\t        samplingIntgerval = length / maxPointsN;\n\t    }\n\t    return samplingIntgerval;\n\t}\n\t\n\tfunction createSvg(tagName, attributes, parent) {\n\t    var element = document.createElementNS('http://www.w3.org/2000/svg', tagName);\n\t    if (attributes) {\n\t        var keys = Object.keys(attributes),\n\t            key,\n\t            value;\n\t        for (var i = 0; i < keys.length; i++) {\n\t            key = keys[i];\n\t            value = attributes[key];\n\t            element.setAttribute(key, value);\n\t        }\n\t    }\n\t    if (parent) {\n\t        parent.appendChild(element);\n\t    }\n\t    return element;\n\t}\n\t\n\tfunction pointOnSegmentAtDistance(p1, p2, dist) {\n\t    //FIXME: we should place markers along projected line to avoid transformation distortions\n\t    var q = dist / p1.distanceTo(p2),\n\t        x = p1.lng + (p2.lng - p1.lng) * q,\n\t        y = p1.lat + (p2.lat - p1.lat) * q;\n\t    return _leaflet2.default.latLng(y, x);\n\t}\n\t\n\tfunction gradientToAngle(g) {\n\t    return Math.round(Math.atan(g) * 180 / Math.PI);\n\t}\n\t\n\tfunction pathRegularSamples(latlngs, step) {\n\t    if (!latlngs.length) {\n\t        return [];\n\t    }\n\t    var samples = [],\n\t        lastSampleDist = 0,\n\t        lastPointDistance = 0,\n\t        nextPointDistance = 0,\n\t        segmentLength,\n\t        i;\n\t\n\t    samples.push(latlngs[0]);\n\t    for (i = 1; i < latlngs.length; i++) {\n\t        segmentLength = latlngs[i].distanceTo(latlngs[i - 1]);\n\t        nextPointDistance = lastPointDistance + segmentLength;\n\t        if (nextPointDistance >= lastSampleDist + step) {\n\t            while (lastSampleDist + step <= nextPointDistance) {\n\t                lastSampleDist += step;\n\t                samples.push(pointOnSegmentAtDistance(latlngs[i - 1], latlngs[i], lastSampleDist - lastPointDistance));\n\t            }\n\t        }\n\t        lastPointDistance = nextPointDistance;\n\t    }\n\t    if (samples.length < 2) {\n\t        samples.push(latlngs[latlngs.length - 1]);\n\t    }\n\t    return samples;\n\t}\n\t\n\tfunction offestFromEvent(e) {\n\t    if (e.offsetX === undefined) {\n\t        var rect = e.target.getBoundingClientRect();\n\t        return {\n\t            offsetX: e.clientX - rect.left,\n\t            offestY: e.clientY - rect.top\n\t        };\n\t    } else {\n\t        return {\n\t            offsetX: e.offsetX,\n\t            offestY: e.offsetY\n\t        };\n\t    }\n\t}\n\t\n\tfunction movementFromEvents(e1, e2) {\n\t    return {\n\t        movementX: e2.clientX - e1.clientX,\n\t        movementY: e2.clientY - e1.clientY\n\t    };\n\t}\n\t\n\tvar DragEvents = _leaflet2.default.Class.extend({\n\t    options: {\n\t        dragTolerance: 2,\n\t        dragButtons: [0]\n\t    },\n\t\n\t    includes: _leaflet2.default.Mixin.Events,\n\t\n\t    initialize: function initialize(eventsSource, eventsTarget, options) {\n\t        options = _leaflet2.default.setOptions(this, options);\n\t        if (eventsTarget) {\n\t            this.eventsTarget = eventsTarget;\n\t        } else {\n\t            this.eventsTarget = this;\n\t        }\n\t        this.dragStartPos = [];\n\t        this.prevEvent = [];\n\t        this.isDragging = [];\n\t\n\t        _leaflet2.default.DomEvent.on(eventsSource, 'mousemove', this.onMouseMove, this);\n\t        _leaflet2.default.DomEvent.on(eventsSource, 'mouseup', this.onMouseUp, this);\n\t        _leaflet2.default.DomEvent.on(eventsSource, 'mousedown', this.onMouseDown, this);\n\t        _leaflet2.default.DomEvent.on(eventsSource, 'mouseleave', this.onMouseLeave, this);\n\t    },\n\t\n\t    onMouseDown: function onMouseDown(e) {\n\t        if (this.options.dragButtons.includes(e.button)) {\n\t            e._offset = offestFromEvent(e);\n\t            this.dragStartPos[e.button] = e;\n\t            this.prevEvent[e.button] = e;\n\t            _leaflet2.default.DomUtil.disableImageDrag();\n\t            _leaflet2.default.DomUtil.disableTextSelection();\n\t        }\n\t    },\n\t\n\t    onMouseUp: function onMouseUp(e) {\n\t        _leaflet2.default.DomUtil.enableImageDrag();\n\t        _leaflet2.default.DomUtil.enableTextSelection();\n\t\n\t        if (this.options.dragButtons.includes(e.button)) {\n\t            this.dragStartPos[e.button] = null;\n\t            if (this.isDragging[e.button]) {\n\t                this.isDragging[e.button] = false;\n\t                this.fire('dragend', _leaflet2.default.extend({ dragButton: e.button, origEvent: e }, offestFromEvent(e), movementFromEvents(this.prevEvent[e.button], e)));\n\t            } else {\n\t                this.fire('click', _leaflet2.default.extend({ dragButton: e.button, origEvent: e }, offestFromEvent(e)));\n\t            }\n\t        }\n\t    },\n\t\n\t    onMouseMove: function onMouseMove(e) {\n\t        var i,\n\t            button,\n\t            self = this;\n\t\n\t        function exceedsTolerance(button) {\n\t            var tolerance = self.options.dragTolerance;\n\t            return Math.abs(e.clientX - self.dragStartPos[button].clientX) > tolerance || Math.abs(e.clientY - self.dragStartPos[button].clientY) > tolerance;\n\t        }\n\t\n\t        var dragButtons = this.options.dragButtons;\n\t        for (i = 0; i < dragButtons.length; i++) {\n\t            button = dragButtons[i];\n\t            if (this.isDragging[button]) {\n\t                this.eventsTarget.fire('drag', _leaflet2.default.extend({ dragButton: button, origEvent: e }, offestFromEvent(e), movementFromEvents(this.prevEvent[button], e)));\n\t            } else if (this.dragStartPos[button] && exceedsTolerance(button)) {\n\t                this.isDragging[button] = true;\n\t                this.eventsTarget.fire('dragstart', _leaflet2.default.extend({ dragButton: button, origEvent: this.dragStartPos[button] }, this.dragStartPos[button]._offset));\n\t                this.eventsTarget.fire('drag', _leaflet2.default.extend({\n\t                    dragButton: button,\n\t                    origEvent: e,\n\t                    startEvent: self.dragStartPos[button]\n\t                }, offestFromEvent(e), movementFromEvents(this.prevEvent[button], e)));\n\t            }\n\t            this.prevEvent[button] = e;\n\t        }\n\t    },\n\t\n\t    onMouseLeave: function onMouseLeave(e) {\n\t        var i, button;\n\t        var dragButtons = this.options.dragButtons;\n\t        for (i = 0; i < dragButtons.length; i++) {\n\t            button = dragButtons[i];\n\t            if (this.isDragging[button]) {\n\t                this.isDragging[button] = false;\n\t                this.fire('dragend', _leaflet2.default.extend({ dragButton: button, origEvent: e }, offestFromEvent(e), movementFromEvents(this.prevEvent[button], e)));\n\t            }\n\t        }\n\t        this.dragStartPos = {};\n\t    }\n\t});\n\t\n\tvar ElevationProfile = _leaflet2.default.Class.extend({\n\t    options: {\n\t        elevationsServer: _config2.default.elevationsServer,\n\t        samplingInterval: 50,\n\t        sightLine: false\n\t    },\n\t\n\t    includes: _leaflet2.default.Mixin.Events,\n\t\n\t    initialize: function initialize(map, latlngs, options) {\n\t        _leaflet2.default.setOptions(this, options);\n\t        this.path = latlngs;\n\t        var samples = this.samples = pathRegularSamples(this.path, this.options.samplingInterval);\n\t        if (!samples.length) {\n\t            (0, _notifications.notify)('Track is empty');\n\t            return;\n\t        }\n\t        var self = this;\n\t        this.horizZoom = 1;\n\t        this.dragStart = null;\n\t        this._getElevation(samples).then(function (values) {\n\t            self.values = values;\n\t            self._addTo(map);\n\t        }).catch(function (e) {\n\t            _logging2.default.captureException(e, { extra: { description: 'while getting elevation' } });\n\t            (0, _notifications.notify)('Failed to get elevation data: ' + e.message);\n\t            self._addTo(map);\n\t        });\n\t        this.values = null;\n\t    },\n\t\n\t    _addTo: function _addTo(map) {\n\t        this._map = map;\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'elevation-profile-container');\n\t        _leaflet2.default.Control.prototype._stopContainerEvents.call(this);\n\t        this._map._controlContainer.appendChild(container);\n\t        this.setupContainerLayout();\n\t        this.updateGraph();\n\t        this.trackMarker = _leaflet2.default.marker([1000, 0], { clickable: false, icon: _leaflet2.default.divIcon() });\n\t        this.polyline = _leaflet2.default.polyline(this.path, { weight: 30, opacity: 0 }).addTo(map);\n\t        this.polyline.on('mousemove', this.onLineMouseMove, this);\n\t        this.polyline.on('mouseover', this.onLineMouseEnter, this);\n\t        this.polyline.on('mouseout', this.onLineMouseLeave, this);\n\t        this.polyLineSelection = _leaflet2.default.polyline([], { weight: 20, opacity: .5, color: 'yellow', lineCap: 'butt' });\n\t        return this;\n\t    },\n\t\n\t    setupContainerLayout: function setupContainerLayout() {\n\t        var horizZoom = this.horizZoom = 1;\n\t        var container = this._container;\n\t        this.propsContainer = _leaflet2.default.DomUtil.create('div', 'elevation-profile-properties', container);\n\t        this.leftAxisLables = _leaflet2.default.DomUtil.create('div', 'elevation-profile-left-axis', container);\n\t        this.closeButton = _leaflet2.default.DomUtil.create('div', 'elevation-profile-close', container);\n\t        _leaflet2.default.DomEvent.on(this.closeButton, 'click', this.onCloseButtonClick, this);\n\t        this.drawingContainer = _leaflet2.default.DomUtil.create('div', 'elevation-profile-drawingContainer', container);\n\t        this.graphCursor = _leaflet2.default.DomUtil.create('div', 'elevation-profile-cursor elevation-profile-cursor-hidden', this.drawingContainer);\n\t        this.graphCursorLabel = _leaflet2.default.DomUtil.create('div', 'elevation-profile-cursor-label elevation-profile-cursor-hidden', this.drawingContainer);\n\t        this.graphSelection = _leaflet2.default.DomUtil.create('div', 'elevation-profile-selection elevation-profile-cursor-hidden', this.drawingContainer);\n\t        var svgWidth = this.svgWidth = this.drawingContainer.clientWidth * horizZoom,\n\t            svgHeight = this.svgHeight = this.drawingContainer.clientHeight;\n\t        var svg = this.svg = createSvg('svg', { width: svgWidth, height: svgHeight }, this.drawingContainer);\n\t        _leaflet2.default.DomEvent.on(svg, 'mousemove', this.onSvgMouseMove, this);\n\t        _leaflet2.default.DomEvent.on(svg, 'mouseenter', this.onSvgEnter, this);\n\t        _leaflet2.default.DomEvent.on(svg, 'mouseleave', this.onSvgLeave, this);\n\t        _leaflet2.default.DomEvent.on(svg, 'mousewheel', this.onSvgMouseWheel, this);\n\t        this.svgDragEvents = new DragEvents(this.drawingContainer, null, { dragButtons: [0, 2] });\n\t        this.svgDragEvents.on('dragstart', this.onSvgDragStart, this);\n\t        this.svgDragEvents.on('dragend', this.onSvgDragEnd, this);\n\t        this.svgDragEvents.on('drag', this.onSvgDrag, this);\n\t        this.svgDragEvents.on('click', this.onSvgClick, this);\n\t        _leaflet2.default.DomEvent.on(svg, 'dblclick', this.onSvgDblClick, this);\n\t    },\n\t\n\t    removeFrom: function removeFrom(map) {\n\t        if (this.abortLoading) {\n\t            this.abortLoading();\n\t        }\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        this._map._controlContainer.removeChild(this._container);\n\t        map.removeLayer(this.polyline);\n\t        map.removeLayer(this.trackMarker);\n\t        map.removeLayer(this.polyLineSelection);\n\t        this._map = null;\n\t        this.fire('remove');\n\t        return this;\n\t    },\n\t\n\t    onSvgDragStart: function onSvgDragStart(e) {\n\t        if (e.dragButton === 0) {\n\t            // FIXME: restore hiding when we make display of selection on map\n\t            // this.cursorHide();\n\t            this.polyLineSelection.addTo(this._map).bringToBack();\n\t            this.dragStart = e.offsetX;\n\t        }\n\t    },\n\t\n\t    xToIndex: function xToIndex(x) {\n\t        return x / (this.svgWidth - 1) * (this.values.length - 1);\n\t    },\n\t\n\t    updateGraphSelection: function updateGraphSelection(e) {\n\t        if (this.dragStart === null) {\n\t            return;\n\t        }\n\t        var selStart, selEnd;\n\t        if (e) {\n\t            var x = e.offsetX;\n\t            selStart = Math.min(x, this.dragStart);\n\t            selEnd = Math.max(x, this.dragStart);\n\t            this.selStartInd = Math.round(this.xToIndex(selStart));\n\t            this.selEndInd = Math.round(this.xToIndex(selEnd));\n\t\n\t            if (this.selStartInd < 0) {\n\t                this.selStartInd = 0;\n\t            }\n\t            if (this.selEndInd > this.values.length - 1) {\n\t                this.selEndInd = this.values.length - 1;\n\t            }\n\t        } else {\n\t            selStart = this.selStartInd * (this.svgWidth - 1) / (this.values.length - 1);\n\t            selEnd = this.selEndInd * (this.svgWidth - 1) / (this.values.length - 1);\n\t        }\n\t        this.graphSelection.style.left = selStart + 'px';\n\t        this.graphSelection.style.width = selEnd - selStart + 'px';\n\t        _leaflet2.default.DomUtil.removeClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n\t    },\n\t\n\t    onSvgDragEnd: function onSvgDragEnd(e) {\n\t        if (e.dragButton === 0) {\n\t            this.cursorShow();\n\t            this.updateGraphSelection(e);\n\t            var stats = this.calcProfileStats(this.values.slice(this.selStartInd, this.selEndInd + 1), true);\n\t            this.updatePropsDisplay(stats);\n\t            _leaflet2.default.DomUtil.addClass(this.propsContainer, 'elevation-profile-properties-selected');\n\t        }\n\t        if (e.dragButton === 2) {\n\t            this.drawingContainer.scrollLeft -= e.movementX;\n\t        }\n\t    },\n\t\n\t    onSvgDrag: function onSvgDrag(e) {\n\t        if (e.dragButton === 0) {\n\t            this.updateGraphSelection(e);\n\t            this.polyLineSelection.setLatLngs(this.samples.slice(this.selStartInd, this.selEndInd + 1));\n\t        }\n\t        if (e.dragButton === 2) {\n\t            this.drawingContainer.scrollLeft -= e.movementX;\n\t        }\n\t    },\n\t\n\t    onSvgClick: function onSvgClick(e) {\n\t        if (e.dragButton === 0) {\n\t            this.dragStart = null;\n\t            _leaflet2.default.DomUtil.addClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n\t            _leaflet2.default.DomUtil.removeClass(this.propsContainer, 'elevation-profile-properties-selected');\n\t            this._map.removeLayer(this.polyLineSelection);\n\t            if (this.stats) {\n\t                this.updatePropsDisplay(this.stats);\n\t            }\n\t        }\n\t        if (e.dragButton === 2) {\n\t            this.setMapPositionAtIndex(Math.round(this.xToIndex(e.offsetX)));\n\t        }\n\t    },\n\t\n\t    onSvgDblClick: function onSvgDblClick(e) {\n\t        this.setMapPositionAtIndex(Math.round(this.xToIndex(e.offsetX)));\n\t    },\n\t\n\t    setMapPositionAtIndex: function setMapPositionAtIndex(ind) {\n\t        var latlng = this.samples[ind];\n\t        if (latlng) {\n\t            this._map.panTo(latlng);\n\t        }\n\t    },\n\t\n\t    onSvgMouseWheel: function onSvgMouseWheel(e) {\n\t        var oldHorizZoom = this.horizZoom;\n\t        this.horizZoom += _leaflet2.default.DomEvent.getWheelDelta(e) > 0 ? 1 : -1;\n\t        if (this.horizZoom < 1) {\n\t            this.horizZoom = 1;\n\t        }\n\t        if (this.horizZoom > 10) {\n\t            this.horizZoom = 10;\n\t        }\n\t\n\t        var x = offestFromEvent(e).offsetX;\n\t        var ind = this.xToIndex(x);\n\t\n\t        var newScrollLeft = this.drawingContainer.scrollLeft + offestFromEvent(e).offsetX * (this.horizZoom / oldHorizZoom - 1);\n\t        if (newScrollLeft < 0) {\n\t            newScrollLeft = 0;\n\t        }\n\t\n\t        this.svgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n\t        this.svg.setAttribute('width', this.svgWidth + 'px');\n\t        this.setupGraph();\n\t        if (newScrollLeft > this.svgWidth - this.drawingContainer.clientWidth) {\n\t            newScrollLeft = this.svgWidth - this.drawingContainer.clientWidth;\n\t        }\n\t        this.drawingContainer.scrollLeft = newScrollLeft;\n\t\n\t        this.cursorHide();\n\t        this.setCursorPosition(ind);\n\t        this.cursorShow();\n\t        this.updateGraphSelection();\n\t    },\n\t\n\t    updateGraph: function updateGraph() {\n\t        if (!this._map || !this.values) {\n\t            return;\n\t        }\n\t\n\t        this.stats = this.calcProfileStats(this.values);\n\t        this.updatePropsDisplay(this.stats);\n\t        this.setupGraph();\n\t    },\n\t\n\t    updatePropsDisplay: function updatePropsDisplay(stats) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        this.propsContainer.innerHTML = '';\n\t        var ascentAngleStr = isNaN(stats.angleAvgAscent) ? '-' : _leaflet2.default.Util.template('{avg} / {max}&deg;', { avg: stats.angleAvgAscent, max: stats.angleMaxAscent });\n\t        var descentAngleStr = isNaN(stats.angleAvgDescent) ? '-' : _leaflet2.default.Util.template('{avg} / {max}&deg;', { avg: stats.angleAvgDescent, max: stats.angleMaxDescent });\n\t\n\t        this.propsContainer.innerHTML = '<table>' + '<tr><td>Max elevation:</td><td>' + Math.round(stats.max) + '</td></tr>' + '<tr><td>Min elevation:</td><td>' + Math.round(stats.min) + '</td></tr>' + '<tr class=\"start-group\"><td>Start elevation:</td><td>' + Math.round(stats.start) + '</td></tr>' + '<tr><td>Finish elevation:</td><td>' + Math.round(stats.end) + '</td></tr>' + '<tr><td>Start to finish elevation change:</td><td>' + Math.round(stats.finalAscent) + '</td></tr>' + '<tr class=\"start-group\"><td>Avg / Max ascent inclination:</td><td>' + ascentAngleStr + '</td></tr>' + '<tr><td>Avg / Max descent inclination:</td><td>' + descentAngleStr + '</td></tr>' + '<tr class=\"start-group\"><td>Total ascent:</td><td>' + Math.round(stats.ascent) + '</td></tr>' + '<tr><td>Total descent:</td><td>' + Math.round(stats.descent) + '</td></tr>' + '<tr class=\"start-group\"><td>Distance:</td><td>' + (stats.distance / 1000).toFixed(1) + ' km</td></tr>' + '</table>';\n\t    },\n\t\n\t    calcGridValues: function calcGridValues(minValue, maxValue) {\n\t        var ticksNs = [3, 4, 5],\n\t            tickSteps = [1, 2, 5, 10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000],\n\t            ticks = [],\n\t            i,\n\t            j,\n\t            k,\n\t            ticksN,\n\t            tickStep,\n\t            tick1,\n\t            tick2,\n\t            matchFound = false;\n\t\n\t        for (i = 0; i < tickSteps.length; i++) {\n\t            tickStep = tickSteps[i];\n\t            for (j = 0; j < ticksNs.length; j++) {\n\t                ticksN = ticksNs[j];\n\t                tick1 = Math.floor(minValue / tickStep);\n\t                tick2 = Math.ceil(maxValue / tickStep);\n\t                if (tick2 - tick1 < ticksN) {\n\t                    matchFound = true;\n\t                    break;\n\t                }\n\t            }\n\t            if (matchFound) {\n\t                break;\n\t            }\n\t        }\n\t        for (k = tick1; k < tick1 + ticksN; k++) {\n\t            ticks.push(k * tickStep);\n\t        }\n\t        return ticks;\n\t    },\n\t\n\t    filterElevations: function filterElevations(values, tolerance) {\n\t        var filtered = values.slice(0);\n\t        if (filtered.length < 3) {\n\t            return filtered;\n\t        }\n\t        var scanStart, scanEnd, job, linearValue, linearDelta, maxError, maxErrorInd, i, error;\n\t        var queue = [[0, filtered.length - 1]];\n\t        while (queue.length) {\n\t            job = queue.pop();\n\t            scanStart = job[0];\n\t            scanEnd = job[1];\n\t            linearValue = filtered[scanStart];\n\t            linearDelta = (filtered[scanEnd] - filtered[scanStart]) / (scanEnd - scanStart);\n\t            maxError = null;\n\t            maxErrorInd = null;\n\t            for (i = scanStart + 1; i < scanEnd; i++) {\n\t                linearValue += linearDelta;\n\t                error = Math.abs(filtered[i] - linearValue);\n\t                if (error === null || error > maxError) {\n\t                    maxError = error;\n\t                    maxErrorInd = i;\n\t                }\n\t            }\n\t            if (maxError > tolerance) {\n\t                if (scanEnd > scanStart + 2) {\n\t                    queue.push([scanStart, maxErrorInd]);\n\t                    queue.push([maxErrorInd, scanEnd]);\n\t                }\n\t            } else {\n\t                filtered.splice(scanStart + 1, scanEnd - scanStart - 1);\n\t            }\n\t        }\n\t        return filtered;\n\t    },\n\t\n\t    calcProfileStats: function calcProfileStats(values, partial) {\n\t        var stats = {},\n\t            gradient,\n\t            i;\n\t        stats.min = Math.min.apply(null, values);\n\t        stats.max = Math.max.apply(null, values);\n\t        stats.finalAscent = values[values.length - 1] - values[0];\n\t        var ascents = [],\n\t            descents = [];\n\t        for (i = 1; i < values.length; i++) {\n\t            gradient = values[i] - values[i - 1];\n\t            if (gradient > 0) {\n\t                ascents.push(gradient);\n\t            } else if (gradient < 0) {\n\t                descents.push(-gradient);\n\t            }\n\t        }\n\t        function sum(a, b) {\n\t            return a + b;\n\t        }\n\t\n\t        stats.gradientAvgAscent = ascents.reduce(sum, 0) / ascents.length / this.options.samplingInterval;\n\t        stats.gradientMinAscent = Math.min.apply(null, ascents) / this.options.samplingInterval;\n\t        stats.gradientMaxAscent = Math.max.apply(null, ascents) / this.options.samplingInterval;\n\t        stats.gradientAvgDescent = descents.reduce(sum, 0) / descents.length / this.options.samplingInterval;\n\t        stats.gradientMinDescent = Math.min.apply(null, descents) / this.options.samplingInterval;\n\t        stats.gradientMaxDescent = Math.max.apply(null, descents) / this.options.samplingInterval;\n\t\n\t        stats.angleAvgAscent = gradientToAngle(stats.gradientAvgAscent);\n\t        stats.angleMinAscent = gradientToAngle(stats.gradientMinAscent);\n\t        stats.angleMaxAscent = gradientToAngle(stats.gradientMaxAscent);\n\t        stats.angleAvgDescent = gradientToAngle(stats.gradientAvgDescent);\n\t        stats.angleMinDescent = gradientToAngle(stats.gradientMinDescent);\n\t        stats.angleMaxDescent = gradientToAngle(stats.gradientMaxDescent);\n\t\n\t        stats.start = values[0];\n\t        stats.end = values[values.length - 1];\n\t        stats.distance = (values.length - 1) * this.options.samplingInterval;\n\t\n\t        var filterTolerance = 5;\n\t        var filtered = this.filterElevations(values, filterTolerance);\n\t        var ascent = 0,\n\t            descent = 0,\n\t            delta;\n\t        for (i = 1; i < filtered.length; i++) {\n\t            delta = filtered[i] - filtered[i - 1];\n\t            if (delta < 0) {\n\t                descent += -delta;\n\t            } else {\n\t                ascent += delta;\n\t            }\n\t        }\n\t        stats.ascent = ascent;\n\t        stats.descent = descent;\n\t\n\t        return stats;\n\t    },\n\t\n\t    setCursorPosition: function setCursorPosition(ind) {\n\t        if (!this._map || !this.values) {\n\t            return;\n\t        }\n\t        var distance = this.options.samplingInterval * ind;\n\t        distance = (distance / 1000).toFixed(2);\n\t        var gradient = (this.values[Math.ceil(ind)] - this.values[Math.floor(ind)]) / this.options.samplingInterval;\n\t        var angle = Math.round(Math.atan(gradient) * 180 / Math.PI);\n\t        gradient = Math.round(gradient * 100);\n\t\n\t        var x = Math.round(ind / (this.values.length - 1) * (this.svgWidth - 1));\n\t        var indInt = Math.round(ind);\n\t        var elevation = this.values[indInt];\n\t        this.graphCursorLabel.innerHTML = _leaflet2.default.Util.template('{ele} m<br>{dist} km<br>{angle}&deg;', { ele: Math.round(elevation), dist: distance, grad: gradient, angle: angle });\n\t\n\t        this.graphCursor.style.left = x + 'px';\n\t        this.graphCursorLabel.style.left = x + 'px';\n\t        if (this.drawingContainer.getBoundingClientRect().left - this.drawingContainer.scrollLeft + x + this.graphCursorLabel.offsetWidth >= this._container.getBoundingClientRect().right) {\n\t            _leaflet2.default.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n\t        } else {\n\t            _leaflet2.default.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n\t        }\n\t\n\t        var markerPos;\n\t        if (ind <= 0) {\n\t            markerPos = this.samples[0];\n\t        } else if (ind >= this.samples.length - 1) {\n\t            markerPos = this.samples[this.samples.length - 1];\n\t        } else {\n\t            var p1 = this.samples[Math.floor(ind)],\n\t                p2 = this.samples[Math.ceil(ind)],\n\t                indFrac = ind - Math.floor(ind);\n\t            markerPos = [p1.lat + (p2.lat - p1.lat) * indFrac, p1.lng + (p2.lng - p1.lng) * indFrac];\n\t        }\n\t        this.trackMarker.setLatLng(markerPos);\n\t        var label = _leaflet2.default.Util.template('{ele} m<br>{dist} km<br>{angle}&deg;', { ele: Math.round(elevation), dist: distance, grad: gradient, angle: angle });\n\t        var icon = _leaflet2.default.divIcon({\n\t            className: 'elevation-profile-marker',\n\t            html: '<div class=\"elevation-profile-marker-icon\"></div><div class=\"elevation-profile-marker-label\">' + label + '</div>'\n\t        });\n\t        this.trackMarker.setIcon(icon);\n\t    },\n\t\n\t    onSvgMouseMove: function onSvgMouseMove(e) {\n\t        if (!this.values) {\n\t            return;\n\t        }\n\t        var x = offestFromEvent(e).offsetX;\n\t        var ind = x / (this.svgWidth - 1) * (this.values.length - 1);\n\t        this.setCursorPosition(ind);\n\t    },\n\t\n\t    cursorShow: function cursorShow() {\n\t        _leaflet2.default.DomUtil.removeClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n\t        _leaflet2.default.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n\t        this._map.addLayer(this.trackMarker);\n\t    },\n\t\n\t    cursorHide: function cursorHide() {\n\t        _leaflet2.default.DomUtil.addClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n\t        _leaflet2.default.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n\t        this._map.removeLayer(this.trackMarker);\n\t    },\n\t\n\t    onSvgEnter: function onSvgEnter() {\n\t        this.cursorShow();\n\t    },\n\t\n\t    onSvgLeave: function onSvgLeave() {\n\t        this.cursorHide();\n\t    },\n\t\n\t    onLineMouseEnter: function onLineMouseEnter() {\n\t        this.cursorShow();\n\t    },\n\t\n\t    onLineMouseLeave: function onLineMouseLeave() {\n\t        this.cursorHide();\n\t    },\n\t\n\t    onLineMouseMove: function onLineMouseMove(e) {\n\t        function sqrDist(latlng1, latlng2) {\n\t            var dx = latlng1.lng - latlng2.lng;\n\t            var dy = latlng1.lat - latlng2.lat;\n\t            return dx * dx + dy * dy;\n\t        }\n\t\n\t        var nearestInd = null,\n\t            ind,\n\t            minDist = null,\n\t            mouseLatlng = e.latlng,\n\t            i,\n\t            sampleLatlng,\n\t            dist,\n\t            di;\n\t        for (i = 0; i < this.samples.length; i++) {\n\t            sampleLatlng = this.samples[i];\n\t            dist = sqrDist(sampleLatlng, mouseLatlng);\n\t            if (nearestInd === null || dist < minDist) {\n\t                nearestInd = i;\n\t                minDist = dist;\n\t            }\n\t        }\n\t\n\t        if (nearestInd !== null) {\n\t            ind = nearestInd;\n\t            if (nearestInd > 0) {\n\t                var prevDist = sqrDist(mouseLatlng, this.samples[nearestInd - 1]),\n\t                    prevSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd - 1]);\n\t            }\n\t            if (nearestInd < this.samples.length - 1) {\n\t                var nextDist = sqrDist(mouseLatlng, this.samples[nearestInd + 1]),\n\t                    nextSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd + 1]);\n\t            }\n\t\n\t            if (nearestInd === 0) {\n\t                if (nextDist < minDist + nextSampleDist) {\n\t                    di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n\t                } else {\n\t                    di = .001;\n\t                }\n\t            } else if (nearestInd === this.samples.length - 1) {\n\t                if (prevDist < minDist + prevSampleDist) {\n\t                    di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n\t                } else {\n\t                    di = -0.001;\n\t                }\n\t            } else {\n\t                if (prevDist < nextDist) {\n\t                    di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n\t                } else {\n\t                    di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n\t                }\n\t            }\n\t            if (di < -1) {\n\t                di = -1;\n\t            }\n\t            if (di > 1) {\n\t                di = 1;\n\t            }\n\t            this.setCursorPosition(ind + di);\n\t        }\n\t    },\n\t\n\t    setupGraph: function setupGraph() {\n\t        var _this = this;\n\t\n\t        if (!this._map || !this.values) {\n\t            return;\n\t        }\n\t\n\t        while (this.svg.hasChildNodes()) {\n\t            this.svg.removeChild(this.svg.lastChild);\n\t        }\n\t        while (this.leftAxisLables.hasChildNodes()) {\n\t            this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);\n\t        }\n\t\n\t        var maxValue = Math.max.apply(null, this.values),\n\t            minValue = Math.min.apply(null, this.values),\n\t            svg = this.svg,\n\t            path,\n\t            i,\n\t            horizStep,\n\t            verticalMultiplier,\n\t            x,\n\t            y,\n\t            gridValues,\n\t            label;\n\t\n\t        var paddingBottom = 8 + 16,\n\t            paddingTop = 8;\n\t\n\t        gridValues = this.calcGridValues(minValue, maxValue);\n\t        var gridStep = (this.svgHeight - paddingBottom - paddingTop) / (gridValues.length - 1);\n\t        for (i = 0; i < gridValues.length; i++) {\n\t            y = Math.round(i * gridStep - 0.5) + 0.5 + paddingTop;\n\t            path = _leaflet2.default.Util.template('M{x1} {y} L{x2} {y}', { x1: 0, x2: this.svgWidth * this.horizZoom, y: y });\n\t            createSvg('path', { d: path, 'stroke-width': '1px', stroke: 'green', fill: 'none', 'stroke-opacity': '0.5' }, svg);\n\t\n\t            label = _leaflet2.default.DomUtil.create('div', 'elevation-profile-grid-label', this.leftAxisLables);\n\t            label.innerHTML = gridValues[gridValues.length - i - 1];\n\t            label.style.top = gridStep * i + paddingTop + 'px';\n\t        }\n\t\n\t        horizStep = this.svgWidth / (this.values.length - 1);\n\t        verticalMultiplier = (this.svgHeight - paddingTop - paddingBottom) / (gridValues[gridValues.length - 1] - gridValues[0]);\n\t\n\t        path = [];\n\t        var valueToSvgCoord = function valueToSvgCoord(el) {\n\t            var y = (el - gridValues[0]) * verticalMultiplier;\n\t            return _this.svgHeight - y - paddingBottom;\n\t        };\n\t\n\t        var startNewSegment = true;\n\t        for (i = 0; i < this.values.length; i++) {\n\t            var value = this.values[i];\n\t            if (value === null) {\n\t                startNewSegment = true;\n\t                continue;\n\t            }\n\t            path.push(startNewSegment ? 'M' : 'L');\n\t            x = i * horizStep;\n\t            y = valueToSvgCoord(value);\n\t            path.push(x + ' ' + y + ' ');\n\t            startNewSegment = false;\n\t        }\n\t        path = path.join('');\n\t        createSvg('path', { d: path, 'stroke-width': '1px', stroke: 'brown', fill: 'none' }, svg);\n\t        // sightline\n\t        if (this.options.sightLine) {\n\t            path = _leaflet2.default.Util.template('M{x1} {y1} L{x2} {y2}', {\n\t                x1: 0, x2: this.svgWidth * this.horizZoom,\n\t                y1: valueToSvgCoord(this.values[0]),\n\t                y2: valueToSvgCoord(this.values[this.values.length - 1])\n\t            });\n\t            createSvg('path', { d: path, 'stroke-width': '3px', stroke: '#94b1ff', fill: 'none', 'stroke-opacity': '0.5' }, svg);\n\t        }\n\t    },\n\t\n\t    _getElevation: function _getElevation(latlngs) {\n\t        function parseResponse(s) {\n\t            var values = [],\n\t                v;\n\t            s = s.split('\\n');\n\t            for (var i = 0; i < s.length; i++) {\n\t                if (s[i]) {\n\t                    if (s[i] === 'NULL') {\n\t                        v = null;\n\t                    } else {\n\t                        v = parseFloat(s[i]);\n\t                    }\n\t                    values.push(v);\n\t                }\n\t            }\n\t            return values;\n\t        }\n\t\n\t        var req = [];\n\t        for (var i = 0; i < latlngs.length; i++) {\n\t            req.push(latlngs[i].lat.toFixed(6) + ' ' + latlngs[i].lng.toFixed(5));\n\t        }\n\t        req = req.join('\\n');\n\t        var xhrPromise = (0, _xhrPromise.fetch)(this.options.elevationsServer, { method: 'POST', data: req });\n\t        this.abortLoading = xhrPromise.abort.bind(xhrPromise);\n\t        return xhrPromise.then(function (xhr) {\n\t            return parseResponse(xhr.responseText);\n\t        });\n\t    },\n\t    onCloseButtonClick: function onCloseButtonClick() {\n\t        this.removeFrom(this._map);\n\t    }\n\t});\n\t\n\texports.ElevationProfile = ElevationProfile;\n\texports.calcSamplingInterval = calcSamplingInterval;\n\n/***/ },\n/* 115 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(452);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction extendLayerName(name, layer) {\n\t    if (layer.options) {\n\t        var code = layer.options.code;\n\t        if (code && code.length === 1) {\n\t            name += '<span class=\"layers-control-hotkey\">' + code + '</span>';\n\t        }\n\t    }\n\t    return name;\n\t}\n\t\n\tfunction enableHotKeys(control) {\n\t    var originalOnAdd = control.onAdd;\n\t    var originalOnRemove = control.onRemove;\n\t    var originalAddItem = control._addItem;\n\t\n\t    if (control._hotKeysEnabled) {\n\t        return control;\n\t    }\n\t\n\t    _leaflet2.default.Util.extend(control, {\n\t        _hotKeysEnabled: true,\n\t\n\t        _addItem: function _addItem(obj) {\n\t            obj = _leaflet2.default.Util.extend({}, obj);\n\t            obj.name = extendLayerName(obj.name, obj.layer);\n\t            return originalAddItem.call(this, obj);\n\t        },\n\t\n\t        onAdd: function onAdd(map) {\n\t            var result = originalOnAdd.call(this, map);\n\t            this._addHotketEvents();\n\t            return result;\n\t        },\n\t\n\t        onRemove: function onRemove(map) {\n\t            _leaflet2.default.DomEvent.off(document, 'keyup', this._onHotkeyUp, this);\n\t            _leaflet2.default.DomEvent.off(document, 'keydown', this.onKeyDown, this);\n\t            originalOnRemove.call(this, map);\n\t        },\n\t\n\t        _addHotKetEvents: function _addHotKetEvents() {\n\t            _leaflet2.default.DomEvent.on(document, 'keyup', this._onHotkeyUp, this);\n\t            _leaflet2.default.DomEvent.on(document, 'keydown', this.onKeyDown, this);\n\t        },\n\t\n\t        onKeyDown: function onKeyDown(e) {\n\t            if (e.altKey || e.ctrlKey || e.shiftKey) {\n\t                return;\n\t            }\n\t            this._keyDown = e.keyCode;\n\t        },\n\t\n\t        _onHotkeyUp: function _onHotkeyUp(e) {\n\t            var pressedKey = this._keyDown;\n\t            this._keyDown = null;\n\t            var targetTag = e.target.tagName.toLowerCase();\n\t            if ('input' === targetTag && e.target.type === 'text' || 'textarea' === targetTag || pressedKey !== e.keyCode) {\n\t                return;\n\t            }\n\t            var key = String.fromCharCode(e.keyCode);\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = this._layers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var layer = _step.value;\n\t\n\t                    var layerId = _leaflet2.default.stamp(layer.layer);\n\t                    if (layer.layer.options && layer.layer.options.code && layer.layer.options.code.toUpperCase() === key) {\n\t                        var inputs = this._form.getElementsByTagName('input');\n\t\n\t                        var _arr = [].concat(_toConsumableArray(inputs));\n\t\n\t                        for (var _i = 0; _i < _arr.length; _i++) {\n\t                            var input = _arr[_i];\n\t                            if (input.layerId === layerId) {\n\t                                input.click();\n\t                                break;\n\t                            }\n\t                        }\n\t                        break;\n\t                    }\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    });\n\t    var _iteratorNormalCompletion2 = true;\n\t    var _didIteratorError2 = false;\n\t    var _iteratorError2 = undefined;\n\t\n\t    try {\n\t        for (var _iterator2 = control._layers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t            var layer = _step2.value;\n\t\n\t            layer.name = extendLayerName(layer.name, layer.layer);\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError2 = true;\n\t        _iteratorError2 = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                _iterator2.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError2) {\n\t                throw _iteratorError2;\n\t            }\n\t        }\n\t    }\n\t\n\t    control._addHotKetEvents();\n\t    control._update();\n\t    return control;\n\t}\n\t\n\texports.default = enableHotKeys;\n\n/***/ },\n/* 116 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(454);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction enableTopRow(control) {\n\t    var originalOnAdd = control.onAdd;\n\t    if (control._topRowEnabled) {\n\t        return;\n\t    }\n\t\n\t    _leaflet2.default.Util.extend(control, {\n\t        _topRowEnabled: true,\n\t\n\t        onAdd: function onAdd(map) {\n\t            var _this = this;\n\t\n\t            var container = originalOnAdd.call(this, map);\n\t            setTimeout(function () {\n\t                return _this.__injectTopRow();\n\t            }, 0);\n\t            return container;\n\t        },\n\t\n\t        __injectTopRow: function __injectTopRow() {\n\t            this._topRow = _leaflet2.default.DomUtil.create('div', 'leaflet-control-layers-top-row');\n\t            this._form.parentNode.insertBefore(this._topRow, this._form);\n\t        }\n\t\n\t    });\n\t    if (control._map) {\n\t        control.__injectTopRow();\n\t    }\n\t}\n\t\n\texports.default = enableTopRow;\n\n/***/ },\n/* 117 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tfunction arrayItemsEqual(l1, l2) {\n\t    if (l1.length !== l2.length) return false;\n\t    for (var i = 0; i < l1.length; i++) {\n\t        if (l1[i] !== l2[i]) {\n\t            return false;\n\t        }\n\t    }\n\t    return true;\n\t}\n\t\n\tvar hashState = {\n\t    _listeners: [],\n\t    _state: {},\n\t\n\t    addEventListener: function addEventListener(key, callback) {\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = this._listeners[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var _step$value = _slicedToArray(_step.value, 2),\n\t                    k = _step$value[0],\n\t                    c = _step$value[1];\n\t\n\t                if (k === key && c === callback) {\n\t                    return;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        this._listeners.push([key, callback]);\n\t    },\n\t\n\t    removeEventListener: function removeEventListener(key, callback) {\n\t        var _this = this;\n\t\n\t        this._listeners.forEach(function (_ref, i) {\n\t            var _ref2 = _slicedToArray(_ref, 2),\n\t                k = _ref2[0],\n\t                c = _ref2[1];\n\t\n\t            if (k === key && c === callback) {\n\t                _this._listeners.splice(i, 1);\n\t                return;\n\t            }\n\t        });\n\t    },\n\t\n\t    updateState: function updateState(key, values) {\n\t        if (values) {\n\t            this._state[key] = values;\n\t        } else {\n\t            delete this._state[key];\n\t        }\n\t        this._saveStateToHash();\n\t    },\n\t\n\t    getState: function getState(key) {\n\t        return this._state[key];\n\t    },\n\t\n\t    _parseHash: function _parseHash() {\n\t        var hash = location.hash;\n\t        var args = {},\n\t            i = hash.indexOf('#');\n\t        if (i >= 0) {\n\t            hash = hash.substr(i + 1).trim();\n\t            var m = void 0,\n\t                key = void 0,\n\t                value = void 0;\n\t            var _iteratorNormalCompletion2 = true;\n\t            var _didIteratorError2 = false;\n\t            var _iteratorError2 = undefined;\n\t\n\t            try {\n\t                for (var _iterator2 = hash.split('&')[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                    var pair = _step2.value;\n\t\n\t                    m = /^([^=]+?)(?:=(.*))?$/.exec(pair);\n\t                    if (m) {\n\t                        var _m = m;\n\t\n\t                        var _m2 = _slicedToArray(_m, 3);\n\t\n\t                        key = _m2[1];\n\t                        value = _m2[2];\n\t\n\t                        if (value) {\n\t                            value = value.split('/');\n\t                            value = value.map(decodeURIComponent);\n\t                        } else {\n\t                            value = [];\n\t                        }\n\t                        args[key] = value;\n\t                    }\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError2 = true;\n\t                _iteratorError2 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                        _iterator2.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError2) {\n\t                        throw _iteratorError2;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t        return args;\n\t    },\n\t\n\t    _saveStateToHash: function _saveStateToHash() {\n\t        var stateItems = [];\n\t        var _iteratorNormalCompletion3 = true;\n\t        var _didIteratorError3 = false;\n\t        var _iteratorError3 = undefined;\n\t\n\t        try {\n\t            for (var _iterator3 = Object.keys(this._state)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                var key = _step3.value;\n\t\n\t                if (this._state[key]) {\n\t                    if (this._state[key].length) {\n\t                        var values = this._state[key].join('/');\n\t                        stateItems.push(key + '=' + values);\n\t                    } else {\n\t                        stateItems.push(key);\n\t                    }\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError3 = true;\n\t            _iteratorError3 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                    _iterator3.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError3) {\n\t                    throw _iteratorError3;\n\t                }\n\t            }\n\t        }\n\t\n\t        location.hash = stateItems.join('&');\n\t    },\n\t\n\t    onHashChanged: function onHashChanged() {\n\t        var newState = this._parseHash();\n\t        var changedKeys = {};\n\t        var _iteratorNormalCompletion4 = true;\n\t        var _didIteratorError4 = false;\n\t        var _iteratorError4 = undefined;\n\t\n\t        try {\n\t            for (var _iterator4 = Object.keys(newState)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t                var key = _step4.value;\n\t\n\t                if (!(key in this._state) || !arrayItemsEqual(newState[key], this._state[key])) {\n\t                    changedKeys[key] = 1;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError4 = true;\n\t            _iteratorError4 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                    _iterator4.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError4) {\n\t                    throw _iteratorError4;\n\t                }\n\t            }\n\t        }\n\t\n\t        var _iteratorNormalCompletion5 = true;\n\t        var _didIteratorError5 = false;\n\t        var _iteratorError5 = undefined;\n\t\n\t        try {\n\t            for (var _iterator5 = Object.keys(this._state)[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n\t                var _key = _step5.value;\n\t\n\t                if (!(_key in newState)) {\n\t                    changedKeys[_key] = 1;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError5 = true;\n\t            _iteratorError5 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion5 && _iterator5.return) {\n\t                    _iterator5.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError5) {\n\t                    throw _iteratorError5;\n\t                }\n\t            }\n\t        }\n\t\n\t        var _iteratorNormalCompletion6 = true;\n\t        var _didIteratorError6 = false;\n\t        var _iteratorError6 = undefined;\n\t\n\t        try {\n\t            for (var _iterator6 = this._listeners[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n\t                var _step6$value = _slicedToArray(_step6.value, 2),\n\t                    _key2 = _step6$value[0],\n\t                    callback = _step6$value[1];\n\t\n\t                if (_key2 in changedKeys) {\n\t                    callback(newState[_key2]);\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError6 = true;\n\t            _iteratorError6 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion6 && _iterator6.return) {\n\t                    _iterator6.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError6) {\n\t                    throw _iteratorError6;\n\t                }\n\t            }\n\t        }\n\t\n\t        this._state = newState;\n\t    }\n\t};\n\t\n\twindow.addEventListener('hashchange', hashState.onHashChanged.bind(hashState));\n\thashState.onHashChanged();\n\t\n\texports.default = hashState;\n\n/***/ },\n/* 118 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.BingLayer = _leaflet2.default.TileLayer.extend({\n\t    options: {\n\t        subdomains: [0, 1, 2, 3],\n\t        type: 'Aerial',\n\t        attribution: 'Bing',\n\t        culture: ''\n\t    },\n\t\n\t    initialize: function initialize(key, options) {\n\t        _leaflet2.default.Util.setOptions(this, options);\n\t\n\t        this._key = key;\n\t        this._url = null;\n\t        this._providers = [];\n\t        this.metaRequested = false;\n\t    },\n\t\n\t    tile2quad: function tile2quad(x, y, z) {\n\t        var quad = '';\n\t        for (var i = z; i > 0; i--) {\n\t            var digit = 0;\n\t            var mask = 1 << i - 1;\n\t            if ((x & mask) !== 0) digit += 1;\n\t            if ((y & mask) !== 0) digit += 2;\n\t            quad += digit;\n\t        }\n\t        return quad;\n\t    },\n\t\n\t    getTileUrl: function getTileUrl(tilePoint) {\n\t        var zoom = this._getZoomForUrl();\n\t        var subdomains = this.options.subdomains,\n\t            s = this.options.subdomains[Math.abs((tilePoint.x + tilePoint.y) % subdomains.length)];\n\t        return this._url.replace('{subdomain}', s).replace('{quadkey}', this.tile2quad(tilePoint.x, tilePoint.y, zoom)).replace('{culture}', this.options.culture);\n\t    },\n\t\n\t    loadMetadata: function loadMetadata() {\n\t        if (this.metaRequested) return;\n\t        this.metaRequested = true;\n\t        var _this = this;\n\t        var cbid = '_bing_metadata_' + _leaflet2.default.Util.stamp(this);\n\t        window[cbid] = function (meta) {\n\t            window[cbid] = undefined;\n\t            var e = document.getElementById(cbid);\n\t            e.parentNode.removeChild(e);\n\t            if (meta.errorDetails) {\n\t                throw new Error(meta.errorDetails);\n\t            }\n\t            _this.initMetadata(meta);\n\t        };\n\t        var urlScheme = document.location.protocol === 'file:' ? 'http' : document.location.protocol.slice(0, -1);\n\t        var url = urlScheme + '://dev.virtualearth.net/REST/v1/Imagery/Metadata/' + this.options.type + '?include=ImageryProviders&jsonp=' + cbid + '&key=' + this._key + '&UriScheme=' + urlScheme;\n\t        var script = document.createElement('script');\n\t        script.type = 'text/javascript';\n\t        script.src = url;\n\t        script.id = cbid;\n\t        document.getElementsByTagName('head')[0].appendChild(script);\n\t    },\n\t\n\t    initMetadata: function initMetadata(meta) {\n\t        var r = meta.resourceSets[0].resources[0];\n\t        this.options.subdomains = r.imageUrlSubdomains;\n\t        this._url = r.imageUrl;\n\t        if (r.imageryProviders) {\n\t            for (var i = 0; i < r.imageryProviders.length; i++) {\n\t                var p = r.imageryProviders[i];\n\t                for (var j = 0; j < p.coverageAreas.length; j++) {\n\t                    var c = p.coverageAreas[j];\n\t                    var coverage = { zoomMin: c.zoomMin, zoomMax: c.zoomMax, active: false };\n\t                    var bounds = new _leaflet2.default.LatLngBounds(new _leaflet2.default.LatLng(c.bbox[0] + 0.01, c.bbox[1] + 0.01), new _leaflet2.default.LatLng(c.bbox[2] - 0.01, c.bbox[3] - 0.01));\n\t                    coverage.bounds = bounds;\n\t                    coverage.attrib = p.attribution;\n\t                    this._providers.push(coverage);\n\t                }\n\t            }\n\t        }\n\t        this._update();\n\t    },\n\t\n\t    _update: function _update() {\n\t        if (this._url === null || !this._map) return;\n\t        this._update_attribution();\n\t        _leaflet2.default.TileLayer.prototype._update.apply(this, []);\n\t    },\n\t\n\t    _update_attribution: function _update_attribution() {\n\t        var bounds = _leaflet2.default.latLngBounds(this._map.getBounds().getSouthWest().wrap(), this._map.getBounds().getNorthEast().wrap());\n\t        var zoom = this._map.getZoom();\n\t        for (var i = 0; i < this._providers.length; i++) {\n\t            var p = this._providers[i];\n\t            if (zoom <= p.zoomMax && zoom >= p.zoomMin && bounds.intersects(p.bounds)) {\n\t                if (!p.active && this._map.attributionControl) this._map.attributionControl.addAttribution(p.attrib);\n\t                p.active = true;\n\t            } else {\n\t                if (p.active && this._map.attributionControl) this._map.attributionControl.removeAttribution(p.attrib);\n\t                p.active = false;\n\t            }\n\t        }\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this.loadMetadata();\n\t        _leaflet2.default.TileLayer.prototype.onAdd.apply(this, [map]);\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        for (var i = 0; i < this._providers.length; i++) {\n\t            var p = this._providers[i];\n\t            if (p.active && this._map.attributionControl) {\n\t                this._map.attributionControl.removeAttribution(p.attrib);\n\t                p.active = false;\n\t            }\n\t        }\n\t        _leaflet2.default.TileLayer.prototype.onRemove.apply(this, [map]);\n\t    }\n\t});\n\t\n\t_leaflet2.default.bingLayer = function (key, options) {\n\t    return new _leaflet2.default.BingLayer(key, options);\n\t};\n\n/***/ },\n/* 119 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _googleMapsApi = __webpack_require__(111);\n\t\n\tvar _googleMapsApi2 = _interopRequireDefault(_googleMapsApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\t_leaflet2.default.Layer.Google = _leaflet2.default.GridLayer.extend({\n\t    options: {},\n\t\n\t    // Possible types: SATELLITE, ROADMAP, HYBRID, TERRAIN\n\t    initialize: function initialize(mapType, options) {\n\t        _leaflet2.default.GridLayer.prototype.initialize.call(this, options);\n\t        this.mapType = mapType;\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        var _this = this;\n\t\n\t        this._clearTiles();\n\t        _leaflet2.default.GridLayer.prototype.onAdd.call(this, map);\n\t        this._googleMapContainer = _leaflet2.default.DomUtil.create('div', '', map.getContainer());\n\t        this._googleMapContainer.style.width = '100%';\n\t        this._googleMapContainer.style.height = '100%';\n\t        // this._googleMapContainer.style.opacity = 0;\n\t        this._googleMapContainer.style.visibility = 'hidden';\n\t        this._googleMapContainer.style.pointerEvents = 'none';\n\t        (0, _googleMapsApi2.default)().then(function (google) {\n\t            var zoom = void 0,\n\t                center = void 0;\n\t            if (map) {\n\t                zoom = map.getZoom();\n\t                center = map.getCenter;\n\t                center = new google.maps.LatLng(center.lat, center.lng);\n\t            } else {\n\t                zoom = 0;\n\t                center = new google.maps.LatLng(0, 0);\n\t            }\n\t            _this.google = google;\n\t            _this._googleMap = new google.maps.Map(_this._googleMapContainer, {\n\t                center: center,\n\t                zoom: zoom,\n\t                tilt: 0,\n\t                mapTypeId: google.maps.MapTypeId[_this.mapType],\n\t                disableDefaultUI: true,\n\t                keyboardShortcuts: false,\n\t                draggable: false,\n\t                disableDoubleClickZoom: true,\n\t                scrollwheel: false,\n\t                streetViewControl: false,\n\t                clickableIcons: false\n\t            });\n\t            google.maps.event.addListener(_this._googleMap, 'tilesloaded', _this._onTilesLoaded.bind(_this));\n\t            setTimeout(_this._syncPosition.bind(_this), 0);\n\t        });\n\t        map.on({\n\t            viewreset: this._syncPosition,\n\t            resize: this._onResize,\n\t            move: this._syncPosition,\n\t            zoomanim: this._onZoom\n\t        }, this);\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        if (this.google) {\n\t            this.google.maps.event.clearInstanceListeners(this._googleMap);\n\t        }\n\t        this._googleMap = null;\n\t        this._clearTiles();\n\t        _leaflet2.default.DomUtil.remove(this._googleMapContainer);\n\t        map.off({\n\t            viewreset: this._clearTiles,\n\t            resize: this._onResize,\n\t            move: this._syncPosition,\n\t            zoomanim: this._onZoom\n\t        }, this);\n\t        _leaflet2.default.GridLayer.prototype.onRemove.call(this, map);\n\t    },\n\t\n\t    _clearTiles: function _clearTiles() {\n\t        this._pendingTiles = {};\n\t        this._readyTiles = {};\n\t    },\n\t\n\t    _onResize: function _onResize() {\n\t        if (!this.google) {\n\t            return;\n\t        }\n\t        this.google.maps.event.trigger(this._googleMap, 'resize');\n\t    },\n\t\n\t    _syncPosition: function _syncPosition() {\n\t        var _this2 = this;\n\t\n\t        if (!this.google || !this._map) {\n\t            return;\n\t        }\n\t        var center = this._map.getCenter();\n\t        var googleCenter = new this.google.maps.LatLng(center.lat, center.lng);\n\t        setTimeout(function () {\n\t            if (!_this2._googleMap) {\n\t                return;\n\t            }\n\t            _this2._googleMap.setCenter(googleCenter);\n\t            _this2._googleMap.setZoom(_this2._map.getZoom());\n\t        }, 0);\n\t    },\n\t\n\t    _onZoom: function _onZoom(e) {\n\t        var _this3 = this;\n\t\n\t        if (!this.google) {\n\t            return;\n\t        }\n\t        var center = e.center;\n\t        var googleCenter = new this.google.maps.LatLng(center.lat, center.lng);\n\t        setTimeout(function () {\n\t            if (!_this3._googleMap) {\n\t                return;\n\t            }\n\t            _this3._googleMap.setCenter(googleCenter);\n\t            _this3._googleMap.setZoom(Math.round(e.zoom));\n\t        }, 0);\n\t    },\n\t\n\t    _roadRegexp: /!1i(\\d+)!2i(\\d+)!3i(\\d+)!/,\n\t    _satRegexp: /x=(\\d+)&y=(\\d+)&z=(\\d+)/,\n\t\n\t    _onTilesLoaded: function _onTilesLoaded() {\n\t        this._readyTiles = this._collectMapImageElements();\n\t        this._fullfillPendingTiles();\n\t    },\n\t\n\t    _collectMapImageElements: function _collectMapImageElements() {\n\t        var images = this._googleMapContainer.getElementsByTagName('img');\n\t        var tiles = {};\n\t\n\t        var _arr = [].concat(_toConsumableArray(images));\n\t\n\t        for (var _i = 0; _i < _arr.length; _i++) {\n\t            var image = _arr[_i];\n\t            var url = image.src;\n\t            var match = void 0,\n\t                coords = void 0;\n\t            match = url.match(this._roadRegexp);\n\t\n\t            if (match) {\n\t                coords = { z: match[1], x: match[2], y: match[3] };\n\t            } else {\n\t                match = url.match(this._satRegexp);\n\t                if (match) {\n\t                    coords = { x: match[1], y: match[2], z: match[3] };\n\t                }\n\t            }\n\t            if (coords) {\n\t                tiles[this._tileCoordsToKey(coords)] = url;\n\t            }\n\t        }\n\t        return tiles;\n\t    },\n\t\n\t    _fullfillPendingTiles: function _fullfillPendingTiles() {\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = Object.keys(this._readyTiles)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var key = _step.value;\n\t\n\t                if (key in this._pendingTiles) {\n\t                    var _iteratorNormalCompletion2 = true;\n\t                    var _didIteratorError2 = false;\n\t                    var _iteratorError2 = undefined;\n\t\n\t                    try {\n\t                        for (var _iterator2 = this._pendingTiles[key][Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                            var _step2$value = _slicedToArray(_step2.value, 2),\n\t                                img = _step2$value[0],\n\t                                cb = _step2$value[1];\n\t\n\t                            _leaflet2.default.DomEvent.on(img, 'load', _leaflet2.default.bind(this._tileOnLoad, this, cb, img));\n\t                            _leaflet2.default.DomEvent.on(img, 'error', _leaflet2.default.bind(this._tileOnError, this, cb, img));\n\t                            img.alt = '';\n\t                            img.src = this._readyTiles[key];\n\t                        }\n\t                    } catch (err) {\n\t                        _didIteratorError2 = true;\n\t                        _iteratorError2 = err;\n\t                    } finally {\n\t                        try {\n\t                            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                                _iterator2.return();\n\t                            }\n\t                        } finally {\n\t                            if (_didIteratorError2) {\n\t                                throw _iteratorError2;\n\t                            }\n\t                        }\n\t                    }\n\t\n\t                    delete this._pendingTiles[key];\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t    },\n\t\n\t    _tileOnLoad: function _tileOnLoad(done, tile) {\n\t        // For https://github.com/Leaflet/Leaflet/issues/3332\n\t        if (_leaflet2.default.Browser.ielt9) {\n\t            setTimeout(_leaflet2.default.bind(done, this, null, tile), 0);\n\t        } else {\n\t            done(null, tile);\n\t        }\n\t    },\n\t\n\t    _tileOnError: function _tileOnError(done, tile, e) {\n\t        done(e, tile);\n\t    },\n\t\n\t    createTile: function createTile(coords, done) {\n\t        var tile = _leaflet2.default.DomUtil.create('img');\n\t        var key = this._tileCoordsToKey(coords);\n\t        if (!(key in this._pendingTiles)) {\n\t            this._pendingTiles[key] = [];\n\t        }\n\t        this._pendingTiles[key].push([tile, done]);\n\t        setTimeout(this._fullfillPendingTiles.bind(this), 0);\n\t        return tile;\n\t    }\n\t});\n\n/***/ },\n/* 120 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(62);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\t_leaflet2.default.Layer.CanvasMarkers.include({\n\t    _printProgressWeight: 0.1,\n\t\n\t    cloneMarkers: function cloneMarkers() {\n\t        var markers = this.rtree.all();\n\t\n\t        function cloneMarker(marker) {\n\t            return {\n\t                latlng: { lat: marker.latlng.lat, lng: marker.latlng.lng },\n\t                label: marker.label,\n\t                icon: marker.icon\n\t            };\n\t        }\n\t\n\t        var markersCopy = markers.map(cloneMarker);\n\t        return markersCopy;\n\t    },\n\t\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        options = _leaflet2.default.Util.extend({}, this.options);\n\t        if (options.printIconsOpacity !== undefined) {\n\t            options.iconsOpacity = options.printIconsOpacity;\n\t        }\n\t        return new _leaflet2.default.Layer.CanvasMarkers(this.cloneMarkers(), options);\n\t    },\n\t\n\t    getTilesInfo: function () {\n\t        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(printOptions) {\n\t            var scale, pixelExtents, crs, dummyMap, zoom, _selectMarkersForDraw, iconUrls, markerJobs, pointsForLabels;\n\t\n\t            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                while (1) {\n\t                    switch (_context2.prev = _context2.next) {\n\t                        case 0:\n\t                            this.options.iconScale = printOptions.resolution / 90 * 0.75;\n\t                            scale = printOptions.pixelBounds.getSize().x / printOptions.destPixelSize.x;\n\t                            pixelExtents = {\n\t                                tileN: printOptions.pixelBounds.getTopRight().y / scale,\n\t                                tileS: printOptions.pixelBounds.getBottomLeft().y / scale,\n\t                                tileE: printOptions.pixelBounds.getTopRight().x / scale,\n\t                                tileW: printOptions.pixelBounds.getBottomLeft().x / scale\n\t                            };\n\t                            crs = _leaflet2.default.CRS.EPSG3857;\n\t\n\t                            if (!this._map) {\n\t                                dummyMap = {\n\t                                    project: crs.latLngToPoint.bind(crs),\n\t                                    unproject: crs.pointToLatLng.bind(crs)\n\t                                };\n\t\n\t                                this._map = dummyMap;\n\t                            }\n\t                            zoom = crs.zoom(1 / scale * crs.scale(printOptions.zoom));\n\t                            _selectMarkersForDraw = this.selectMarkersForDraw(pixelExtents, zoom, true), iconUrls = _selectMarkersForDraw.iconUrls, markerJobs = _selectMarkersForDraw.markerJobs, pointsForLabels = _selectMarkersForDraw.pointsForLabels;\n\t                            _context2.next = 9;\n\t                            return this.preloadIcons(iconUrls);\n\t\n\t                        case 9:\n\t                            return _context2.abrupt(\"return\", {\n\t                                iterateTilePromises: /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t                                    var _this = this;\n\t\n\t                                    return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                                        while (1) {\n\t                                            switch (_context.prev = _context.next) {\n\t                                                case 0:\n\t                                                    _context.next = 2;\n\t                                                    return {\n\t                                                        tilePromise: Promise.resolve({\n\t                                                            draw: function draw(canvas) {\n\t                                                                _this.resetLabels();\n\t                                                                _this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom, true);\n\t                                                            },\n\t                                                            isOverlay: true,\n\t                                                            overlaySolid: !this.options.printTransparent\n\t                                                        }),\n\t                                                        abortLoading: function abortLoading() {}\n\t                                                    };\n\t\n\t                                                case 2:\n\t                                                case \"end\":\n\t                                                    return _context.stop();\n\t                                            }\n\t                                        }\n\t                                    }, _callee, this);\n\t                                }).bind(this),\n\t                                count: 1\n\t                            });\n\t\n\t                        case 10:\n\t                        case \"end\":\n\t                            return _context2.stop();\n\t                    }\n\t                }\n\t            }, _callee2, this);\n\t        }));\n\t\n\t        function getTilesInfo(_x) {\n\t            return _ref.apply(this, arguments);\n\t        }\n\t\n\t        return getTilesInfo;\n\t    }()\n\t});\n\n/***/ },\n/* 121 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.CanvasLayerGrabMixin = exports.GridLayerGrabMixin = exports.TileLayerGrabMixin = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _CORSProxy = __webpack_require__(60);\n\t\n\tvar _CORSProxy2 = _interopRequireDefault(_CORSProxy);\n\t\n\tvar _imgFromDataString = __webpack_require__(223);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar GridLayerGrabMixin = {\n\t    tileImagePromiseFromCoords: function tileImagePromiseFromCoords(coords) {\n\t        throw new Error('Method not implemented');\n\t    },\n\t\n\t    waitTilesReadyToGrab: function waitTilesReadyToGrab() {\n\t        return Promise.resolve(null);\n\t    },\n\t\n\t    getTilesInfo: function () {\n\t        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(printOptions) {\n\t            var pixelBounds, tileRange, topLeft, tilePromiseIterator;\n\t            return regeneratorRuntime.wrap(function _callee2$(_context3) {\n\t                while (1) {\n\t                    switch (_context3.prev = _context3.next) {\n\t                        case 0:\n\t                            _context3.next = 2;\n\t                            return this.waitTilesReadyToGrab();\n\t\n\t                        case 2:\n\t                            pixelBounds = printOptions.pixelBounds;\n\t                            tileRange = this._pxBoundsToTileRange(pixelBounds);\n\t                            topLeft = pixelBounds.min;\n\t                            tilePromiseIterator = /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t                                var _this = this;\n\t\n\t                                var j, _loop, i, _ret;\n\t\n\t                                return regeneratorRuntime.wrap(function _callee$(_context2) {\n\t                                    while (1) {\n\t                                        switch (_context2.prev = _context2.next) {\n\t                                            case 0:\n\t                                                j = tileRange.min.y;\n\t\n\t                                            case 1:\n\t                                                if (!(j <= tileRange.max.y)) {\n\t                                                    _context2.next = 15;\n\t                                                    break;\n\t                                                }\n\t\n\t                                                _loop = /*#__PURE__*/regeneratorRuntime.mark(function _loop(i) {\n\t                                                    var coords, tilePos, coordsPlusOne, tilePlusOne, tileSize, latLngBounds, _tileImagePromiseFrom, tilePromise, abortLoading;\n\t\n\t                                                    return regeneratorRuntime.wrap(function _loop$(_context) {\n\t                                                        while (1) {\n\t                                                            switch (_context.prev = _context.next) {\n\t                                                                case 0:\n\t                                                                    coords = new _leaflet2.default.Point(i, j);\n\t\n\t                                                                    coords.z = _this._tileZoom;\n\t\n\t                                                                    if (_this._isValidTile(coords)) {\n\t                                                                        _context.next = 4;\n\t                                                                        break;\n\t                                                                    }\n\t\n\t                                                                    return _context.abrupt('return', 'continue');\n\t\n\t                                                                case 4:\n\t                                                                    tilePos = _this._getTilePos(coords);\n\t                                                                    coordsPlusOne = coords.add(_leaflet2.default.point(1, 1));\n\t\n\t                                                                    coordsPlusOne.z = coords.z;\n\t                                                                    tilePlusOne = _this._getTilePos(coordsPlusOne);\n\t                                                                    tileSize = tilePlusOne.subtract(tilePos);\n\t                                                                    latLngBounds = _leaflet2.default.latLngBounds(_this._map.unproject(tilePos.add(_this._level.origin)), _this._map.unproject(tilePlusOne.add(_this._level.origin)));\n\t\n\t                                                                    tilePos = tilePos.add(_this._level.origin).subtract(topLeft);\n\t                                                                    _tileImagePromiseFrom = _this.tileImagePromiseFromCoords(_this._wrapCoords(coords), printOptions), tilePromise = _tileImagePromiseFrom.tilePromise, abortLoading = _tileImagePromiseFrom.abortLoading;\n\t                                                                    _context.next = 14;\n\t                                                                    return {\n\t                                                                        tilePromise: tilePromise.then(function (image) {\n\t                                                                            return { image: image, tilePos: tilePos, tileSize: tileSize, latLngBounds: latLngBounds };\n\t                                                                        }),\n\t                                                                        abortLoading: abortLoading\n\t                                                                    };\n\t\n\t                                                                case 14:\n\t                                                                case 'end':\n\t                                                                    return _context.stop();\n\t                                                            }\n\t                                                        }\n\t                                                    }, _loop, _this);\n\t                                                });\n\t                                                i = tileRange.min.x;\n\t\n\t                                            case 4:\n\t                                                if (!(i <= tileRange.max.x)) {\n\t                                                    _context2.next = 12;\n\t                                                    break;\n\t                                                }\n\t\n\t                                                return _context2.delegateYield(_loop(i), 't0', 6);\n\t\n\t                                            case 6:\n\t                                                _ret = _context2.t0;\n\t\n\t                                                if (!(_ret === 'continue')) {\n\t                                                    _context2.next = 9;\n\t                                                    break;\n\t                                                }\n\t\n\t                                                return _context2.abrupt('continue', 9);\n\t\n\t                                            case 9:\n\t                                                i++;\n\t                                                _context2.next = 4;\n\t                                                break;\n\t\n\t                                            case 12:\n\t                                                j++;\n\t                                                _context2.next = 1;\n\t                                                break;\n\t\n\t                                            case 15:\n\t                                            case 'end':\n\t                                                return _context2.stop();\n\t                                        }\n\t                                    }\n\t                                }, _callee, this);\n\t                            }).bind(this);\n\t                            return _context3.abrupt('return', {\n\t                                iterateTilePromises: tilePromiseIterator,\n\t                                count: (tileRange.max.x - tileRange.min.x + 1) * (tileRange.max.y - tileRange.min.y + 1)\n\t                            });\n\t\n\t                        case 7:\n\t                        case 'end':\n\t                            return _context3.stop();\n\t                    }\n\t                }\n\t            }, _callee2, this);\n\t        }));\n\t\n\t        function getTilesInfo(_x) {\n\t            return _ref.apply(this, arguments);\n\t        }\n\t\n\t        return getTilesInfo;\n\t    }()\n\t};\n\t\n\tvar TileLayerGrabMixin = _leaflet2.default.Util.extend({}, GridLayerGrabMixin, {\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        return _leaflet2.default.tileLayer(this._url, _leaflet2.default.Util.extend({}, this.options, options));\n\t    },\n\t\n\t    tileImagePromiseFromCoords: function tileImagePromiseFromCoords(coords, printOptions) {\n\t        var xhrOptions = printOptions.xhrOptions;\n\t\n\t        var url = this.getTileUrl(coords);\n\t        if (!url) {\n\t            return { tilePromise: Promise.resolve(null), abortLoading: noop };\n\t        }\n\t        if (this.options.noCors) {\n\t            url = (0, _CORSProxy2.default)(url);\n\t        }\n\t        var promise = this.options.xhrQueue.put(url, xhrOptions);\n\t\n\t        return {\n\t            tilePromise: printOptions.rawData ? promise : promise.then(_imgFromDataString.imgFromDataString),\n\t            abortLoading: function abortLoading() {\n\t                return promise.abort();\n\t            }\n\t        };\n\t    }\n\t});\n\t\n\tfunction noop() {}\n\t\n\tvar CanvasLayerGrabMixin = _leaflet2.default.Util.extend({}, GridLayerGrabMixin, {\n\t    getCanvasFromTile: function getCanvasFromTile(tile) {\n\t        return tile;\n\t    },\n\t\n\t    tileImagePromiseFromCoords: function tileImagePromiseFromCoords(coords) {\n\t        var _this2 = this;\n\t\n\t        var tilePromise = void 0;\n\t        if (this.createTile.length < 2) {\n\t            var tile = this.createTile(coords);\n\t            tilePromise = Promise.resolve(tile);\n\t        } else {\n\t            tilePromise = new Promise(function (resolve) {\n\t                _this2.createTile(coords, function (_, canvas) {\n\t                    return resolve(canvas);\n\t                });\n\t            });\n\t        }\n\t\n\t        return {\n\t            tilePromise: tilePromise.then(this.getCanvasFromTile),\n\t            abortLoading: noop\n\t        };\n\t    }\n\t});\n\t\n\t_leaflet2.default.TileLayer.include(TileLayerGrabMixin);\n\t\n\texports.TileLayerGrabMixin = TileLayerGrabMixin;\n\texports.GridLayerGrabMixin = GridLayerGrabMixin;\n\texports.CanvasLayerGrabMixin = CanvasLayerGrabMixin;\n\n/***/ },\n/* 122 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.disposeMap = exports.getTempMap = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(121);\n\t\n\t__webpack_require__(218);\n\t\n\t__webpack_require__(222);\n\t\n\t__webpack_require__(219);\n\t\n\t__webpack_require__(221);\n\t\n\t__webpack_require__(120);\n\t\n\t__webpack_require__(220);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction getTempMap(zoom, fullSize, pixelBounds) {\n\t    var container = _leaflet2.default.DomUtil.create('div', '', document.body);\n\t    var width = void 0,\n\t        height = void 0,\n\t        center = void 0;\n\t    if (fullSize) {\n\t        var size = pixelBounds.getSize();\n\t        width = size.x;\n\t        height = size.y;\n\t        center = pixelBounds.min.add(size.divideBy(2));\n\t        center = _leaflet2.default.CRS.EPSG3857.pointToLatLng(center, zoom);\n\t    } else {\n\t        width = 100;\n\t        height = 100;\n\t        center = _leaflet2.default.latLng(0, 0);\n\t    }\n\t\n\t    Object.assign(container.style, {\n\t        width: width + 'px',\n\t        height: height + 'px',\n\t        position: 'absolute',\n\t        left: '0',\n\t        top: '0',\n\t        visibility: 'hidden'\n\t    });\n\t\n\t    var map = _leaflet2.default.map(container, { fadeAnimation: false, zoomAnimation: false, inertia: false, maxZoom: 18 });\n\t    map.setView(center, zoom);\n\t    return map;\n\t}\n\t\n\tfunction disposeMap(map) {\n\t    var container = map._container;\n\t    map.remove();\n\t    _leaflet2.default.DomUtil.remove(container);\n\t}\n\t\n\texports.getTempMap = getTempMap;\n\texports.disposeMap = disposeMap;\n\n/***/ },\n/* 123 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(466);\n\t\n\t__webpack_require__(216);\n\t\n\tvar _westraPassesMarkers = __webpack_require__(124);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Layer.WestraPasses = _leaflet2.default.Layer.extend({\n\t    options: {\n\t        fileRegions1: 'westra_regions_geo1.json',\n\t        fileRegions2: 'westra_regions_geo2.json',\n\t        scaleDependent: true\n\t    },\n\t\n\t    initialize: function initialize(baseUrl, options) {\n\t        _leaflet2.default.setOptions(this, options);\n\t        this.markers = new _westraPassesMarkers.WestraPassesMarkers(baseUrl);\n\t        this.regions1 = new _leaflet2.default.Layer.GeoJSONAjax(baseUrl + this.options.fileRegions1, {\n\t            className: 'westra-region-polygon',\n\t            onEachFeature: this._setRegionLabel.bind(this, 'regions1')\n\t        });\n\t        this.regions2 = new _leaflet2.default.Layer.GeoJSONAjax(baseUrl + this.options.fileRegions2, {\n\t            className: 'westra-region-polygon',\n\t            onEachFeature: this._setRegionLabel.bind(this, 'regions2')\n\t        });\n\t    },\n\t\n\t    _setRegionLabel: function _setRegionLabel(layerName, feature, layer) {\n\t        var latlon = layer.getBounds().getCenter();\n\t        var icon = _leaflet2.default.divIcon({\n\t            className: 'westra-region-label',\n\t            html: '<span>' + feature.properties.name + '</span>'\n\t        });\n\t        var labelMarker = _leaflet2.default.marker(latlon, { icon: icon });\n\t        this[layerName].addLayer(labelMarker);\n\t        function zoomToRegion() {\n\t            this._map.fitBounds(layer.getBounds());\n\t        }\n\t\n\t        layer.on('click', zoomToRegion, this);\n\t        labelMarker.on('click', zoomToRegion, this);\n\t    },\n\t\n\t    setLayersVisibility: function setLayersVisibility(e) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        var newZoom;\n\t        var zoomFinished = e ? e.type !== 'zoomanim' : true;\n\t        if (e && e.zoom !== undefined) {\n\t            newZoom = e.zoom;\n\t        } else {\n\t            newZoom = this._map.getZoom();\n\t        }\n\t        if (newZoom < 2) {\n\t            this._map.removeLayer(this.markers);\n\t            this._map.removeLayer(this.regions1);\n\t            this._map.removeLayer(this.regions2);\n\t        } else if (newZoom < 7) {\n\t            this._map.removeLayer(this.markers);\n\t            this._map.addLayer(this.regions1);\n\t            this._map.removeLayer(this.regions2);\n\t        } else if (newZoom < 10) {\n\t            this._map.removeLayer(this.regions1);\n\t            this._map.addLayer(this.regions2);\n\t            this._map.removeLayer(this.markers);\n\t        } else {\n\t            if (zoomFinished) {\n\t                this._map.addLayer(this.markers);\n\t            }\n\t            this._map.removeLayer(this.regions1);\n\t            this._map.removeLayer(this.regions2);\n\t        }\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        this.markers.loadData();\n\t        this.regions1.loadData();\n\t        this.regions2.loadData();\n\t        this.setLayersVisibility();\n\t        map.on('zoomend', this.setLayersVisibility, this);\n\t        map.on('zoomanim', this.setLayersVisibility, this);\n\t    },\n\t\n\t    onRemove: function onRemove() {\n\t        this._map.removeLayer(this.markers);\n\t        this._map.removeLayer(this.regions1);\n\t        this._map.removeLayer(this.regions2);\n\t        this._map.off('zoomend', this.setLayersVisibility, this);\n\t        this._map.off('zoomanim', this.setLayersVisibility, this);\n\t        this._map = null;\n\t    }\n\t});\n\n/***/ },\n/* 124 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.WestraPassesMarkers = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(62);\n\t\n\tvar _popupWindow = __webpack_require__(128);\n\t\n\tvar _escapeHtml = __webpack_require__(164);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tvar _browserFilesaver = __webpack_require__(64);\n\t\n\tvar _iconFromBackgroundImage = __webpack_require__(112);\n\t\n\tvar _iconFromBackgroundImage2 = _interopRequireDefault(_iconFromBackgroundImage);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar WestraPassesMarkers = _leaflet2.default.Layer.CanvasMarkers.extend({\n\t    options: {\n\t        filePasses: 'westra_passes.json',\n\t        scaleDependent: true\n\t    },\n\t\n\t    initialize: function initialize(baseUrl, options) {\n\t        _leaflet2.default.Layer.CanvasMarkers.prototype.initialize.call(this, null, options);\n\t        this.on('markerclick', this.showPassDescription, this);\n\t        this._baseUrl = baseUrl;\n\t        this.url = baseUrl + this.options.filePasses;\n\t    },\n\t\n\t    loadData: function loadData() {\n\t        var _this = this;\n\t\n\t        if (this._downloadStarted) {\n\t            return;\n\t        }\n\t        this._downloadStarted = true;\n\t        (0, _xhrPromise.fetch)(this.url).then(function (xhr) {\n\t            return _this._loadMarkers(xhr);\n\t        }, function (e) {\n\t            _this._downloadStarted = false;\n\t            _logging2.default.captureException(e, {\n\t                extra: {\n\t                    description: 'failed to get westra passes',\n\t                    url: _this.url,\n\t                    status: e.xhr.status\n\t                }\n\t            });\n\t            (0, _notifications.notify)('Failed to get Westra passes data');\n\t        });\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        _leaflet2.default.Layer.CanvasMarkers.prototype.onAdd.call(this, map);\n\t        this.loadData();\n\t    },\n\t\n\t    _makeTooltip: function _makeTooltip(marker) {\n\t        var properties = marker.properties,\n\t            toolTip = properties.grade || '';\n\t        if (toolTip && properties.elevation) {\n\t            toolTip += ', ';\n\t        }\n\t        toolTip += properties.elevation || '';\n\t        if (toolTip) {\n\t            toolTip = ' (' + toolTip + ')';\n\t        }\n\t        toolTip = (properties.name || 'без названия') + toolTip;\n\t        toolTip = (properties.is_summit ? 'Вершина ' : 'Перевал ') + toolTip;\n\t        return toolTip;\n\t    },\n\t\n\t    _passToGpx: function _passToGpx(marker) {\n\t        var label = marker.tooltip;\n\t        if (typeof label === 'function') {\n\t            label = label(marker);\n\t        }\n\t        label = (0, _escapeHtml2.default)(label);\n\t        var gpx = '\\n                <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\\n                <gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.tk\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\">\\n                    <wpt lat=\"' + marker.latlng.lat.toFixed(6) + '\" lon=\"' + marker.latlng.lng.toFixed(6) + '\">\\n                        <name>' + label + '</name>\\n                    </wpt>\\n                </gpx>\\n            ';\n\t        var filename = marker.properties.name || 'Без названия';\n\t        (0, _browserFilesaver.saveAs)(new Blob([gpx], { type: 'application/gpx+xml' }), filename + '.gpx', true);\n\t    },\n\t\n\t    _passToKml: function _passToKml(marker) {\n\t        var label = marker.tooltip;\n\t        if (typeof label === 'function') {\n\t            label = label(marker);\n\t        }\n\t        label = (0, _escapeHtml2.default)(label);\n\t        var kml = '\\n                <?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n                <kml xmlns=\"http://www.opengis.net/kml/2.2\">\\n                    <Placemark>\\n                        <name>' + label + '</name>\\n                        <Point>\\n                            <coordinates>\\n                                ' + marker.latlng.lng.toFixed(6) + ',' + marker.latlng.lat.toFixed(6) + ',0\\n                            </coordinates>\\n                        </Point>\\n                    </Placemark>\\n                </kml>\\n            ';\n\t        var filename = marker.properties.name || 'Без названия';\n\t        (0, _browserFilesaver.saveAs)(new Blob([kml], { type: 'application/vnd.google-earth.kml+xml' }), filename + '.kml', true);\n\t    },\n\t\n\t    _makeIcon: function _makeIcon(marker) {\n\t        var className;\n\t        className = 'westra-pass-marker ';\n\t        if (marker.properties.is_summit) {\n\t            className += 'westra-pass-marker-summit';\n\t        } else {\n\t            className += 'westra-pass-marker-' + marker.properties.grade_eng;\n\t        }\n\t        return (0, _iconFromBackgroundImage2.default)(className);\n\t    },\n\t\n\t    _loadMarkers: function _loadMarkers(xhr) {\n\t        var markers = [],\n\t            features = JSON.parse(xhr.response),\n\t            feature,\n\t            i,\n\t            marker;\n\t        for (i = 0; i < features.length; i++) {\n\t            feature = features[i];\n\t            marker = {\n\t                latlng: {\n\t                    lat: feature.latlon[0],\n\t                    lng: feature.latlon[1]\n\t                },\n\t                label: feature.name || \"\",\n\t                icon: this._makeIcon,\n\t                tooltip: this._makeTooltip.bind(this),\n\t                properties: feature\n\t            };\n\t            markers.push(marker);\n\t        }\n\t        this.addMarkers(markers);\n\t        this._dataLoaded = true;\n\t        this.fire('data-loaded');\n\t    },\n\t\n\t    showPassDescription: function showPassDescription(e) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        var properties = e.marker.properties,\n\t            latLng = e.marker.latlng,\n\t            url = 'http://westra.ru/passes/Passes/' + properties.id;\n\t        var altnames = '',\n\t            connects = '',\n\t            comments = '';\n\t        if (properties.altnames) {\n\t            altnames = '\\n                    <tr>\\n                        <td>\\u0414\\u0440\\u0443\\u0433\\u0438\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u044F</td>\\n                        <td>' + properties.altnames + '</td>\\n                    </tr>';\n\t        }\n\t\n\t        if (!properties.is_summit) {\n\t            connects = '\\n                    <tr>\\n                        <td>\\u0421\\u043E\\u0435\\u0434\\u0438\\u043D\\u044F\\u0435\\u0442</td>\\n                        <td>' + (properties.connects || \"неизвестнo\") + '</td>\\n                    </tr>';\n\t        }\n\t\n\t        if (properties.comments) {\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t\n\t                for (var _iterator = properties.comments[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    var comment = _step.value;\n\t\n\t                    var user = '';\n\t                    if (comment.user) {\n\t                        user = '<span class=\"westra-passes-description-comment-author\">' + comment.user + ':</span>';\n\t                    }\n\t                    comments += '<p class=\"westra-passes-description-comment\">' + user + comment.content + '</p>';\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t\n\t            comments = '\\n                    <tr>\\n                        <td>\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0438</td>\\n                        <td>' + comments + '</td>\\n                    </tr>';\n\t        }\n\t\n\t        var description = '\\n                <table class=\"pass-details\">\\n                    <tr>\\n                        <td>' + (properties.is_summit ? 'Вершина ' : 'Перевал ') + '</td>\\n                        <td>' + (properties.name || 'название неизвестно') + '</td>\\n                    </tr>\\n                    ' + altnames + '\\n                    <tr>\\n                        <td>\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F</td>\\n                        <td>' + (properties.grade || \"неизвестная\") + '</td>\\n                    </tr>\\n                    <tr>\\n                        <td>\\u0412\\u044B\\u0441\\u043E\\u0442\\u0430</td>\\n                        <td>' + (properties.elevation ? properties.elevation + ' м' : 'неизвестная') + '</td>\\n                    </tr>\\n                    ' + connects + '\\n                    <tr>\\n                        <td>\\u0425\\u0430\\u0440\\u0430\\u043A\\u0442\\u0435\\u0440\\u0438\\u0441\\u0442\\u0438\\u043A\\u0430 \\u0441\\u043A\\u043B\\u043E\\u043D\\u043E\\u0432</td>\\n                        <td>' + (properties.slopes || \"неизвестная\") + '</td>\\n                    </tr>\\n                    <tr>\\n                        <td>\\u041A\\u043E\\u043E\\u0440\\u0434\\u0438\\u043D\\u0430\\u0442\\u044B</td>\\n                        <td>\\n                            <table class=\"westra-passes-description-coords\">\\n                                <tr>\\n                                    <td>\\u0428\\u0438\\u0440\\u043E\\u0442\\u0430</td>\\n                                    <td>\\u0414\\u043E\\u043B\\u0433\\u043E\\u0442\\u0430</td>\\n                                </tr>\\n                                <tr>\\n                                    <td>' + latLng.lat.toFixed(5) + '</td>\\n                                    <td>' + latLng.lng.toFixed(5) + '</td>\\n                                    <td><a id=\"westra-pass-gpx\" title=\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\">gpx</a></td>\\n                                    <td><a id=\"westra-pass-kml\" title=\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\">kml</a></td>\\n                                </tr>\\n                            </table>\\n                        </td>\\n                    </tr>\\n                    <tr>\\n                        <td>\\u041D\\u0430 \\u0441\\u0430\\u0439\\u0442\\u0435 \\u0412\\u0435\\u0441\\u0442\\u0440\\u044B</td>\\n                        <td><a id=\"westra-pass-link\" href=\"' + url + '\">' + url + '</a></td></tr>\\n                    <tr>\\n                        <td>\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u043B</td>\\n                        <td>' + (properties.author || \"неизвестно\") + '</td>\\n                    </tr>\\n                    ' + comments + '\\n                </table>';\n\t        this._map.openPopup(description, latLng, { maxWidth: 500 });\n\t        document.getElementById('westra-pass-link').onclick = function () {\n\t            (0, _popupWindow.openPopupWindow)(url, 780, 'westra-details');\n\t            return false;\n\t        };\n\t        document.getElementById('westra-pass-gpx').onclick = function () {\n\t            this._passToGpx(e.marker);\n\t            return false;\n\t        }.bind(this);\n\t        document.getElementById('westra-pass-kml').onclick = function () {\n\t            this._passToKml(e.marker);\n\t            return false;\n\t        }.bind(this);\n\t    }\n\t});\n\t\n\texports.WestraPassesMarkers = WestraPassesMarkers;\n\n/***/ },\n/* 125 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(468);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar yandexCrs = _leaflet2.default.CRS.EPSG3395;\n\t\n\t_leaflet2.default.Layer.Yandex = _leaflet2.default.TileLayer.extend({\n\t    options: {\n\t        subdomains: '1234',\n\t        className: _leaflet2.default.Browser.retina ? '' : 'yandex-tile-layer',\n\t        yandexScale: _leaflet2.default.Browser.retina ? 2 : 1\n\t    },\n\t\n\t    initialize: function initialize(mapType, options) {\n\t        var url = void 0;\n\t        this._mapType = mapType;\n\t        if (mapType === 'sat') {\n\t            url = 'https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}';\n\t        } else {\n\t            url = 'https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}';\n\t        }\n\t\n\t        _leaflet2.default.TileLayer.prototype.initialize.call(this, url, options);\n\t    },\n\t\n\t    _getTilePos: function _getTilePos(coords) {\n\t        var tilePosLatLng = yandexCrs.pointToLatLng(coords.scaleBy(this.getTileSize()), coords.z);\n\t        return this._map.project(tilePosLatLng, coords.z).subtract(this._level.origin).round();\n\t    },\n\t\n\t    _pxBoundsToTileRange: function _pxBoundsToTileRange(bounds) {\n\t        var zoom = this._tileZoom;\n\t        var bounds2 = new _leaflet2.default.Bounds(yandexCrs.latLngToPoint(this._map.unproject(bounds.min, zoom), zoom), yandexCrs.latLngToPoint(this._map.unproject(bounds.max, zoom), zoom));\n\t        return _leaflet2.default.TileLayer.prototype._pxBoundsToTileRange.call(this, bounds2);\n\t    },\n\t\n\t    createTile: function createTile(coords, done) {\n\t        var tile = _leaflet2.default.TileLayer.prototype.createTile.call(this, coords, done);\n\t        var coordsBelow = _leaflet2.default.point(coords).add([0, 1]);\n\t        coordsBelow.z = coords.z;\n\t        tile._adjustHeight = this._getTilePos(coordsBelow).y - this._getTilePos(coords).y;\n\t        return tile;\n\t    },\n\t\n\t    _initTile: function _initTile(tile) {\n\t        _leaflet2.default.TileLayer.prototype._initTile.call(this, tile);\n\t        tile.style.height = tile._adjustHeight + 'px';\n\t    }\n\t});\n\n/***/ },\n/* 126 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(470);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction pointOnSegmentAtDistance(p1, p2, dist) {\n\t    //FIXME: we should place markers along projected line to avoid transformation distortions\n\t    var q = dist / p1.distanceTo(p2),\n\t        x = p1.lng + (p2.lng - p1.lng) * q,\n\t        y = p1.lat + (p2.lat - p1.lat) * q;\n\t    return _leaflet2.default.latLng(y, x);\n\t}\n\t\n\tfunction sinCosFromLatLonSegment(segment) {\n\t    var p1 = _leaflet2.default.CRS.EPSG3857.project(segment[0]),\n\t        p2 = _leaflet2.default.CRS.EPSG3857.project(segment[1]),\n\t        dx = p2.x - p1.x,\n\t        dy = p1.y - p2.y,\n\t        len = Math.sqrt(dx * dx + dy * dy),\n\t        sin = dy / len,\n\t        cos = dx / len;\n\t    return [sin, cos];\n\t}\n\t\n\t_leaflet2.default.MeasuredLine = _leaflet2.default.Polyline.extend({\n\t    options: {\n\t        minTicksIntervalMm: 15\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        _leaflet2.default.Polyline.prototype.onAdd.call(this, map);\n\t        this._ticks = {};\n\t        this.updateTicks();\n\t        this._map.on('zoomend', this.updateTicks, this);\n\t        this._map.on('dragend', this.updateTicks, this);\n\t        this.on('nodeschanged', this.updateTicksLater, this);\n\t    },\n\t\n\t    updateTicksLater: function updateTicksLater() {\n\t        setTimeout(this.updateTicks.bind(this), 0);\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        this._map.off('zoomend', this.updateTicks, this);\n\t        this._map.off('dragend', this.updateTicks, this);\n\t        this.off('nodeschanged', this.updateTicks, this);\n\t        this._clearTicks();\n\t        _leaflet2.default.Polyline.prototype.onRemove.call(this, map);\n\t    },\n\t\n\t    _clearTicks: function _clearTicks() {\n\t        var _this = this;\n\t\n\t        if (this._map) {\n\t            Object.values(this._ticks).forEach(function (tick) {\n\t                return _this._map.removeLayer(tick);\n\t            });\n\t            this._ticks = {};\n\t        }\n\t    },\n\t\n\t    _addTick: function _addTick(tick, marker) {\n\t        var transformMatrixString = 'matrix(' + tick.transformMatrix.join(',') + ')';\n\t        if (marker) {\n\t            marker._icon.childNodes[0].style.transform = transformMatrixString;\n\t            marker.setLatLng(tick.position);\n\t        } else {\n\t            var labelText = Math.round(tick.distanceValue / 10) / 100 + ' km',\n\t                icon = _leaflet2.default.divIcon({\n\t                html: '<div class=\"measure-tick-icon-text\" style=\"transform:' + transformMatrixString + '\">' + labelText + '</div>',\n\t                className: 'measure-tick-icon'\n\t            });\n\t            marker = _leaflet2.default.marker(tick.position, { icon: icon, interactive: false, keyboard: false });\n\t            marker.addTo(this._map);\n\t        }\n\t        this._ticks[tick.distanceValue.toString()] = marker;\n\t    },\n\t\n\t    setMeasureTicksVisible: function setMeasureTicksVisible(visible) {\n\t        this.options.measureTicksShown = visible;\n\t        this.updateTicks();\n\t    },\n\t\n\t    getTicksPositions: function getTicksPositions(minTicksIntervalMeters, bounds) {\n\t        var steps = [500, 1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000];\n\t        var ticks = [];\n\t\n\t        function addTick(position, segment, distanceValue) {\n\t            if (bounds && !bounds.contains(position)) {\n\t                return;\n\t            }\n\t            var sinCos = sinCosFromLatLonSegment(segment),\n\t                sin = sinCos[0],\n\t                cos = sinCos[1],\n\t                transformMatrix;\n\t\n\t            if (sin > 0) {\n\t                transformMatrix = [sin, -cos, cos, sin, 0, 0];\n\t            } else {\n\t                transformMatrix = [-sin, cos, -cos, -sin, 0, 0];\n\t            }\n\t            ticks.push({ position: position, distanceValue: distanceValue, transformMatrix: transformMatrix });\n\t        }\n\t\n\t        var step = void 0;\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = steps[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                step = _step.value;\n\t\n\t                if (step >= minTicksIntervalMeters) {\n\t                    break;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        var lastTickMeasure = 0,\n\t            lastPointMeasure = 0,\n\t            points = this._latlngs,\n\t            points_n = points.length,\n\t            nextPointMeasure,\n\t            segmentLength;\n\t        if (points_n < 2) {\n\t            return ticks;\n\t        }\n\t\n\t        for (var i = 1; i < points_n; i++) {\n\t            segmentLength = points[i].distanceTo(points[i - 1]);\n\t            nextPointMeasure = lastPointMeasure + segmentLength;\n\t            if (nextPointMeasure >= lastTickMeasure + step) {\n\t                while (lastTickMeasure + step <= nextPointMeasure) {\n\t                    lastTickMeasure += step;\n\t                    addTick(pointOnSegmentAtDistance(points[i - 1], points[i], lastTickMeasure - lastPointMeasure), [points[i - 1], points[i]], lastTickMeasure);\n\t                }\n\t            }\n\t            lastPointMeasure = nextPointMeasure;\n\t        }\n\t        if (lastPointMeasure > minTicksIntervalMeters / 2) {\n\t            addTick(points[0], [points[0], points[1]], 0);\n\t            addTick(points[points_n - 1], [points[points_n - 2], points[points_n - 1]], lastPointMeasure);\n\t        }\n\t        return ticks;\n\t    },\n\t\n\t    updateTicks: function updateTicks() {\n\t        var _this2 = this;\n\t\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        if (!this.options.measureTicksShown) {\n\t            this._clearTicks();\n\t            return;\n\t        }\n\t        var bounds = this._map.getBounds().pad(1),\n\t            rad = Math.PI / 180,\n\t            dpi = 96,\n\t            mercatorMetersPerPixel = 20003931 / this._map.project([180, 0]).x,\n\t            referencePoint = this.getLatLngs().length ? this.getBounds().getCenter() : this._map.getCenter(),\n\t            realMetersPerPixel = mercatorMetersPerPixel * Math.cos(referencePoint.lat * rad),\n\t            mapScale = 1 / dpi * 2.54 / 100 / realMetersPerPixel,\n\t            minTicksIntervalMeters = this.options.minTicksIntervalMm / mapScale / 1000,\n\t            ticks = this.getTicksPositions(minTicksIntervalMeters, bounds),\n\t            oldTicks = this._ticks;\n\t        this._ticks = {};\n\t        ticks.forEach(function (tick) {\n\t            var oldMarker = oldTicks[tick.distanceValue.toString()];\n\t            this._addTick(tick, oldMarker);\n\t            if (oldMarker) {\n\t                delete oldTicks[tick.distanceValue.toString()];\n\t            }\n\t        }.bind(this));\n\t        Object.values(oldTicks).forEach(function (tick) {\n\t            return _this2._map.removeLayer(tick);\n\t        });\n\t    },\n\t\n\t    getLength: function getLength() {\n\t        var points = this._latlngs,\n\t            points_n = points.length,\n\t            length = 0;\n\t\n\t        for (var i = 1; i < points_n; i++) {\n\t            length += points[i].distanceTo(points[i - 1]);\n\t        }\n\t        return length;\n\t    }\n\t});\n\t\n\t_leaflet2.default.measuredLine = function (latlngs, options) {\n\t    return new _leaflet2.default.MeasuredLine(latlngs, options);\n\t};\n\n/***/ },\n/* 127 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.getDeclination = undefined;\n\t\n\tvar _declination = __webpack_require__(473);\n\t\n\tvar _declination2 = _interopRequireDefault(_declination);\n\t\n\tvar _binaryStrings = __webpack_require__(50);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar data = void 0;\n\t\n\tfunction mod(x, n) {\n\t    return (x % n + n) % n;\n\t}\n\t\n\tfunction loadData() {\n\t    var ar1 = new Uint8Array((0, _binaryStrings.stringToArrayBuffer)(atob(_declination2.default.array)));\n\t    var ar2 = new Float32Array(ar1.length);\n\t    var scale = _declination2.default.valueScale;\n\t    var offset = _declination2.default.valueOffset;\n\t    for (var i = 0; i < ar1.length; i++) {\n\t        ar2[i] = ar1[i] / scale - offset;\n\t    }\n\t    return ar2;\n\t}\n\t\n\tfunction getArrayValue(row, col) {\n\t    if (row < 0 || col < 0 || col >= _declination2.default.colsCount || row >= _declination2.default.rowsCount) {\n\t        throw new Error('Invalid col/row value col=' + col + ' row=' + row);\n\t    }\n\t    var ind = row * _declination2.default.colsCount + col;\n\t    if (ind >= data.length) {\n\t        throw new Error('Index value out of range');\n\t    }\n\t    return data[ind];\n\t}\n\t\n\tfunction getDeclination(lat, lon) {\n\t    if (lat < _declination2.default.minLat || lat > _declination2.default.maxLat) {\n\t        return null;\n\t    }\n\t    lon = mod(lon + 180, 360) - 180;\n\t    var row1 = Math.floor((lat - _declination2.default.minLat) / _declination2.default.step);\n\t    var row2 = row1 + 1;\n\t    var dlat = (lat - (row1 * _declination2.default.step + _declination2.default.minLat)) / _declination2.default.step;\n\t    var col1 = Math.floor((lon + 180) / _declination2.default.step);\n\t    var col2 = col1 + 1;\n\t    var dlon = (lon - (col1 * _declination2.default.step - 180)) / _declination2.default.step;\n\t    col1 %= _declination2.default.colsCount;\n\t    col2 %= _declination2.default.colsCount;\n\t    var a1 = getArrayValue(row1, col1);\n\t    var a2 = getArrayValue(row1, col2);\n\t    var v1 = a1 * (1 - dlon) + a2 * dlon;\n\t    if (row2 >= _declination2.default.rowsCount) {\n\t        return v1;\n\t    }\n\t    a1 = getArrayValue(row2, col1);\n\t    a2 = getArrayValue(row2, col2);\n\t    var v2 = a1 * (1 - dlon) + a2 * dlon;\n\t    var v = v1 * (1 - dlat) + v2 * dlat;\n\t    return v;\n\t}\n\t\n\tdata = loadData();\n\t\n\texports.getDeclination = getDeclination;\n\n/***/ },\n/* 128 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tfunction openPopupWindow(url, width) {\n\t    var uniqName = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\n\t    var left,\n\t        top,\n\t        height,\n\t        screenLeft = screen.availLeft || 0,\n\t        bordersWidth = 8;\n\t    // if browser window is in the right half of screen, place new window on left half\n\t    if (window.screenX - screenLeft - bordersWidth * 1.5 > width) {\n\t        left = window.screenX - width - bordersWidth * 1.5;\n\t        // if browser window is in the left half of screen, place new window on right half\n\t    } else if (window.screenX + window.outerWidth + width + bordersWidth * 1.5 < screenLeft + screen.availWidth) {\n\t        left = window.screenX + window.outerWidth + bordersWidth;\n\t        // if screen is small or browser window occupies whole screen, place new window on top of current window\n\t    } else {\n\t        left = window.screenX + window.outerWidth / 2 - width / 2;\n\t        if (left < 0) {\n\t            left = 0;\n\t        }\n\t    }\n\t    top = window.screenY;\n\t    height = window.innerHeight;\n\t    var features = 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top;\n\t    features += ',resizable,scrollbars';\n\t    window.open(url, uniqName, features).focus();\n\t}\n\t\n\texports.openPopupWindow = openPopupWindow;\n\n/***/ },\n/* 129 */,\n/* 130 */,\n/* 131 */,\n/* 132 */,\n/* 133 */,\n/* 134 */,\n/* 135 */,\n/* 136 */,\n/* 137 */,\n/* 138 */,\n/* 139 */,\n/* 140 */,\n/* 141 */,\n/* 142 */,\n/* 143 */,\n/* 144 */,\n/* 145 */,\n/* 146 */,\n/* 147 */,\n/* 148 */,\n/* 149 */,\n/* 150 */,\n/* 151 */,\n/* 152 */,\n/* 153 */,\n/* 154 */,\n/* 155 */,\n/* 156 */,\n/* 157 */,\n/* 158 */,\n/* 159 */,\n/* 160 */,\n/* 161 */,\n/* 162 */,\n/* 163 */,\n/* 164 */,\n/* 165 */,\n/* 166 */\n437,\n/* 167 */,\n/* 168 */,\n/* 169 */,\n/* 170 */,\n/* 171 */,\n/* 172 */,\n/* 173 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\t__webpack_require__(438);\n\t\n\t__webpack_require__(441);\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(437);\n\t\n\t__webpack_require__(200);\n\t\n\t__webpack_require__(179);\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\t__webpack_require__(180);\n\t\n\tvar _leafletControlLayers = __webpack_require__(115);\n\t\n\tvar _leafletControlLayers2 = _interopRequireDefault(_leafletControlLayers);\n\t\n\t__webpack_require__(215);\n\t\n\t__webpack_require__(214);\n\t\n\tvar _leaflet3 = __webpack_require__(213);\n\t\n\t__webpack_require__(439);\n\t\n\t__webpack_require__(191);\n\t\n\t__webpack_require__(82);\n\t\n\t__webpack_require__(207);\n\t\n\t__webpack_require__(210);\n\t\n\t__webpack_require__(211);\n\t\n\tvar _leafletControlLayers3 = __webpack_require__(187);\n\t\n\tvar _leafletControlLayers4 = _interopRequireDefault(_leafletControlLayers3);\n\t\n\tvar _leafletControlLayers5 = __webpack_require__(190);\n\t\n\tvar _leafletControlLayers6 = _interopRequireDefault(_leafletControlLayers5);\n\t\n\tvar _leafletControlLayers7 = __webpack_require__(188);\n\t\n\tvar _leafletControlLayers8 = _interopRequireDefault(_leafletControlLayers7);\n\t\n\tvar _hashState = __webpack_require__(117);\n\t\n\tvar _hashState2 = _interopRequireDefault(_hashState);\n\t\n\tvar _leafletControls = __webpack_require__(212);\n\t\n\tvar _leafletControls2 = _interopRequireDefault(_leafletControls);\n\t\n\tvar _layers = __webpack_require__(175);\n\t\n\tvar _layers2 = _interopRequireDefault(_layers);\n\t\n\t__webpack_require__(189);\n\t\n\t__webpack_require__(183);\n\t\n\t__webpack_require__(182);\n\t\n\t__webpack_require__(178);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction setUp() {\n\t    (0, _leaflet3.fixAll)();\n\t\n\t    var map = _leaflet2.default.map('map', {\n\t        zoomControl: false,\n\t        fadeAnimation: false,\n\t        attributionControl: false,\n\t        inertiaMaxSpeed: 1500,\n\t        worldCopyJump: true,\n\t        maxZoom: 18\n\t    });\n\t    map.enableHashState('m', [10, 55.75185, 37.61856]);\n\t\n\t    var tracklist = new _leaflet2.default.Control.TrackList();\n\t\n\t    /////////// controls top-left corner\n\t\n\t    new _leaflet2.default.Control.Caption('<a href=\"' + _config2.default.newsUrl + '\">News</a> | <a href=\"mailto:' + _config2.default.email + '\">nakarte@nakarte.tk</a>', {\n\t        position: 'topleft'\n\t    }).addTo(map);\n\t\n\t    new _leaflet2.default.Control.Scale({ imperial: false, position: 'topleft' }).addTo(map);\n\t\n\t    _leaflet2.default.control.zoom().addTo(map);\n\t\n\t    new _leaflet2.default.Control.TrackList.Ruler(tracklist).addTo(map);\n\t\n\t    var panoramas = new _leaflet2.default.Control.Panoramas(document.getElementById('street-view')).addTo(map).enableHashState('n2');\n\t    _leaflet2.default.Control.Panoramas.hashStateUpgrader(panoramas).enableHashState('n');\n\t\n\t    new _leaflet2.default.Control.Coordinates({ position: 'topleft' }).addTo(map);\n\t\n\t    var azimuthControl = new _leaflet2.default.Control.Azimuth({ position: 'topleft' }).addTo(map);\n\t\n\t    /////////// controls top-right corner\n\t\n\t    var layersControl = _leaflet2.default.control.layers(null, null, { collapsed: false }).addTo(map);\n\t    (0, _leafletControlLayers2.default)(layersControl);\n\t    (0, _leafletControlLayers4.default)(layersControl);\n\t    (0, _leafletControlLayers6.default)(layersControl);\n\t    (0, _leafletControlLayers8.default)(layersControl, (0, _layers2.default)());\n\t    layersControl.enableHashState('l');\n\t\n\t    /////////// controls bottom-left corner\n\t\n\t    var printControl = new _leaflet2.default.Control.PrintPages({ position: 'bottomleft' }).addTo(map).enableHashState('p');\n\t    if (!printControl.hasPages()) {\n\t        printControl.setMinimized();\n\t    }\n\t\n\t    new _leaflet2.default.Control.JNX(layersControl, { position: 'bottomleft' }).addTo(map).enableHashState('j');\n\t\n\t    /////////// controls bottom-right corner\n\t\n\t    tracklist.addTo(map);\n\t    if (!_hashState2.default.getState('nktk')) {\n\t        tracklist.loadTracksFromStorage();\n\t    }\n\t    tracklist.enableHashState('nktk');\n\t\n\t    ////////// adaptive layout\n\t\n\t    if (_leaflet2.default.Browser.mobile) {\n\t        layersControl.setMinimized();\n\t        if (!tracklist.hasTracks()) {\n\t            tracklist.setMinimized();\n\t        }\n\t    }\n\t\n\t    if (_leaflet2.default.Browser.mobile) {\n\t        map.on('mousedown dragstart', function () {\n\t            return layersControl.setMinimized();\n\t        });\n\t    }\n\t\n\t    (0, _leafletControls2.default)(map);\n\t\n\t    //////////// save state at unload\n\t\n\t    _leaflet2.default.DomEvent.on(window, 'beforeunload', function () {\n\t        return tracklist.saveTracksToStorage();\n\t    });\n\t\n\t    ////////// track list and azimuth measure interaction\n\t\n\t    tracklist.on('startedit', function () {\n\t        return azimuthControl.setEnabled(false);\n\t    });\n\t    tracklist.on('elevation-shown', function () {\n\t        return azimuthControl.hideProfile();\n\t    });\n\t    azimuthControl.on('enabled', function () {\n\t        tracklist.stopEditLine();\n\t    });\n\t    azimuthControl.on('elevation-shown', function () {\n\t        return tracklist.hideElevationProfile();\n\t    });\n\t}\n\t\n\texports.default = { setUp: setUp };\n\n/***/ },\n/* 174 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _ravenJs = __webpack_require__(169);\n\t\n\tvar _ravenJs2 = _interopRequireDefault(_ravenJs);\n\t\n\t__webpack_require__(440);\n\t\n\tvar _App = __webpack_require__(173);\n\t\n\tvar _App2 = _interopRequireDefault(_App);\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/* eslint-disable no-undef */\n\tif ((\"production\") === 'production' && _config2.default.sentryDSN.length > 0) {\n\t    _ravenJs2.default.config(_config2.default.sentryDSN, { release: (\"2017-10-11_17:37:31-master-a0e3125-dirty\\n\") }).install();\n\t    /* eslint-enable no-undef */\n\t}\n\t\n\tvar oldOnunhandledrejection = window.onunhandledrejection;\n\t\n\t// Not using addEventListener due to https://github.com/zloirock/core-js/issues/205\n\twindow.onunhandledrejection = function (e) {\n\t    var result = true;\n\t    if (oldOnunhandledrejection) {\n\t        result = oldOnunhandledrejection(e);\n\t    }\n\t    console.error('Uncaught in promise:', e.reason);\n\t    var err = e.reason;\n\t    if (err && err.name) {\n\t        err.name = 'Uncaught in promise: ' + err.name;\n\t    }\n\t    _ravenJs2.default.captureException(err);\n\t    return result;\n\t};\n\t\n\t/* eslint-disable no-undef */\n\tconsole.log('Version:', (\"2017-10-11_17:37:31-master-a0e3125-dirty\\n\"));\n\t/* eslint-enable no-undef */\n\t\n\t_App2.default.setUp();\n\n/***/ },\n/* 175 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = getLayers;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(125);\n\t\n\t__webpack_require__(119);\n\t\n\t__webpack_require__(118);\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\t__webpack_require__(224);\n\t\n\t__webpack_require__(123);\n\t\n\t__webpack_require__(217);\n\t\n\t__webpack_require__(225);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction getLayers() {\n\t    var layers = [{\n\t        group: 'Default layers',\n\t        layers: [{\n\t            title: 'OpenStreetMap',\n\t            description: 'OSM default style',\n\t            order: 10,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { code: 'O', scaleDependent: true, print: true, jnx: true })\n\t        }, {\n\t            title: 'ESRI Sat',\n\t            order: 20,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { code: 'E', scaleDependent: false, maxNativeZoom: 17, print: true, jnx: true })\n\t        }, {\n\t            title: 'Yandex map',\n\t            order: 30,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Layer.Yandex('map', { scaleDependent: true, code: 'Y', print: true, jnx: true })\n\t        }, {\n\t            title: 'Yandex Satellite',\n\t            order: 40,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Layer.Yandex('sat', { scaleDependent: false, code: 'S', print: true, jnx: true })\n\t        }, {\n\t            title: 'Google',\n\t            order: 50,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Layer.Google('ROADMAP', { code: 'G', scaleDependent: true, print: true, jnx: true })\n\t        }, {\n\t            title: 'Google Satellite',\n\t            order: 60,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Layer.Google('SATELLITE', { code: 'L', scaleDependent: false, print: true, jnx: true })\n\t        }, {\n\t            title: 'Google Terrain',\n\t            order: 65,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Layer.Google('TERRAIN', { code: 'P', scaleDependent: false, print: true, jnx: true })\n\t        }, {\n\t            title: 'Bing Sat',\n\t            order: 70,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.bingLayer(_config2.default.bingKey, { code: 'I', scaleDependent: false, print: true, jnx: true })\n\t        }, {\n\t            title: 'marshruty.ru',\n\t            order: 80,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer('http://maps.marshruty.ru/ml.ashx?x={x}&y={y}&z={z}&i=1&al=1', { code: 'M', maxNativeZoom: 18, noCors: true, scaleDependent: true, print: true, jnx: true })\n\t        }, {\n\t            title: 'Topomapper 1km',\n\t            order: 90,\n\t            isOverlay: false,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer('http://144.76.234.108/cgi-bin/tapp/tilecache.py/1.0.0/topomapper_v2/{z}/{x}/{y}.jpg', { code: 'T', scaleDependent: false, maxNativeZoom: 13, noCors: true, print: true, jnx: true })\n\t        }, {\n\t            title: 'Topo 10km',\n\t            order: 1010,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/topo001m/{z}/{x}/{y}\", { code: 'D', tms: true, scaleDependent: false, maxNativeZoom: 9, print: true, jnx: true })\n\t        }, {\n\t            title: 'GGC 2 km',\n\t            order: 1020,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc2000/{z}/{x}/{y}\", { code: 'N', tms: true, scaleDependent: false, maxNativeZoom: 12, print: true, jnx: true })\n\t        }, {\n\t            title: 'ArbaletMO',\n\t            order: 1030,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/ArbaletMO/{z}/{x}/{y}\", { code: 'A', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true })\n\t        }, {\n\t            title: 'Slazav mountains',\n\t            order: 1040,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/map_hr/{z}/{x}/{y}\", { code: 'Q', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true })\n\t        }, {\n\t            title: 'GGC 1km',\n\t            order: 1050,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc1000/{z}/{x}/{y}\", { code: 'J', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true })\n\t        }, {\n\t            title: 'Topo 1km',\n\t            order: 1060,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/topo1000/{z}/{x}/{y}\", { code: 'C', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true })\n\t        }, {\n\t            title: 'GGC 500m',\n\t            order: 1070,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc500/{z}/{x}/{y}\", { code: 'F', tms: true, scaleDependent: false, maxNativeZoom: 14, print: true, jnx: true })\n\t        }, {\n\t            title: 'Topo 500m',\n\t            order: 1080,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/topo500/{z}/{x}/{y}\", { code: 'B', tms: true, scaleDependent: false, maxNativeZoom: 14, print: true, jnx: true })\n\t        }, {\n\t            title: 'GGC 250m',\n\t            order: 1090,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc250/{z}/{x}/{y}\", { code: 'K', tms: true, scaleDependent: false, maxNativeZoom: 15, print: true, jnx: true })\n\t        }, {\n\t            title: 'Slazav map',\n\t            order: 1100,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/map_podm/{z}/{x}/{y}\", { code: 'Z', tms: true, scaleDependent: false, maxNativeZoom: 14, print: true, jnx: true })\n\t        }, {\n\t            title: 'O-sport',\n\t            order: 1110,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/osport/{z}/{x}/{y}\", { code: 'R', tms: true, scaleDependent: false, maxNativeZoom: 17, print: true, jnx: true })\n\t        }, {\n\t            title: 'Soviet topo maps grid',\n\t            order: 1120,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Layer.SovietTopoGrid({ code: 'Ng' })\n\t        }, {\n\t            title: 'Wikimapia',\n\t            order: 1130,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Wikimapia({ code: 'W' })\n\t        }, {\n\t            title: 'Mountain passes (Westra)',\n\t            order: 1140,\n\t            isOverlay: true,\n\t            isDefault: true,\n\t            layer: new _leaflet2.default.Layer.WestraPasses(_config2.default.westraDataBaseUrl, {\n\t                code: 'Wp',\n\t                print: true,\n\t                scaleDependent: true\n\t            })\n\t        }]\n\t    }, {\n\t        group: 'OpenStreetMap alternatives',\n\t        layers: [{\n\t            title: 'OpenTopoMap',\n\t            order: 11,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', { code: 'Otm', maxNativeZoom: 17, scaleDependent: true, print: true, jnx: true, noCors: true })\n\t        }, {\n\t            title: 'OpenCycleMap',\n\t            description: '<a href=\"https://www.opencyclemap.org/docs/\">(Info and key)</a>',\n\t            order: 12,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer('http://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=' + _config2.default.thunderforestKey, { code: 'Ocm', scaleDependent: true, print: true, jnx: true })\n\t        }, {\n\t            title: 'OSM Outdoors',\n\t            order: 13,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer('http://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey=' + _config2.default.thunderforestKey, { code: 'Oso', scaleDependent: true, print: true, jnx: true })\n\t        }]\n\t    }, {\n\t        group: 'Topo maps',\n\t        layers: [{\n\t            title: 'Eurasia 25km',\n\t            description: '1975-80',\n\t            order: 1009,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/eurasia25km/{z}/{x}/{y}\", { code: 'E25m', tms: true, maxNativeZoom: 9, print: true, jnx: true, scaleDependent: false })\n\t        }, {\n\t            title: 'Caucasus 1km',\n\t            order: 1061,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/new_gsh_100k/{z}/{x}/{y}\", { code: 'NT1', tms: true, maxNativeZoom: 14, print: true, jnx: true, scaleDependent: false })\n\t        }, {\n\t            title: 'Caucasus 500m',\n\t            order: 1081,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/new_gsh_050k/{z}/{x}/{y}\", { code: 'NT5', tms: true, maxNativeZoom: 15, print: true, jnx: true, scaleDependent: false })\n\t        }, {\n\t            title: 'Topo 250m',\n\t            order: 1095,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/topo250/{z}/{x}/{y}\", { code: 'T25', tms: true, maxNativeZoom: 15, print: true, jnx: true, scaleDependent: false })\n\t        }, {\n\t            title: 'Montenegro topo 250m',\n\t            description: '1970-72',\n\t            order: 1096,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"http://{s}.tiles.nakarte.tk/montenegro250m/{z}/{x}/{y}\", { code: 'MN25', tms: true, maxNativeZoom: 15, print: true, jnx: true, scaleDependent: false })\n\t        }]\n\t    }, {\n\t        group: 'Mountains maps',\n\t        layers: [{\n\t            title: 'Mountains by Aleksey Tsvetkov',\n\t            description: 'Tian Shan, Dzungaria, <a href=\"http://pereval.g-utka.ru/\">http://pereval.g-utka.ru/</a>',\n\t            order: 1039,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"http://map.g-utka.ru/{z}/{x}/{y}.png\",\n\t            // FIXME: сделать minZoom=5, когда перейдём на версию leaflet с поддержкой minNativeZoom\n\t            {\n\t                code: 'Mt',\n\t                tms: false,\n\t                minZoom: 7,\n\t                minNativeZoom: 7,\n\t                maxNativeZoom: 15,\n\t                print: true,\n\t                jnx: true,\n\t                scaleDependent: false,\n\t                noCors: true\n\t            })\n\t        }]\n\t    }, {\n\t        group: 'Norway <a href=\"https://www.ut.no/kart/\">https://www.ut.no/kart/</a>',\n\t        layers: [{\n\t            // Вместо 404 отдают 500 для отсутствующих тайлов\n\t            title: 'Norway UT map',\n\t            order: 500,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://tilesprod.ut.no/tilestache/ut_topo_light/{z}/{x}/{y}.jpg\", { code: 'Nu', tms: false, maxNativeZoom: 16, print: true, jnx: true, scaleDependent: true, noCors: true })\n\t        }, {\n\t            title: 'Norway paper map',\n\t            order: 1031,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: new _leaflet2.default.TileLayer.Nordeskart('http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=toporaster3&zoom={z}&x={x}&y={y}&gkt={baatToken}', { code: 'Np', maxNativeZoom: 16, tms: false, print: true, jnx: true, scaleDependent: true })\n\t        }, {\n\t            title: 'Norway map',\n\t            order: 1032,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: new _leaflet2.default.TileLayer.Nordeskart('http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=topo2&zoom={z}&x={x}&y={y}&gkt={baatToken}', { code: 'Nm', tms: false, print: true, jnx: true, scaleDependent: true })\n\t        }, {\n\t            title: 'Norway summer trails',\n\t            order: 2000,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://tilesprod.ut.no/tilestache/dnt_sommer/{z}/{x}/{y}.png\", { code: 'Ns', tms: false, print: true, jnx: true, scaleDependent: true, noCors: true })\n\t        }, {\n\t            title: 'Norway winter trails',\n\t            order: 2001,\n\t            isOverlay: true,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://tilesprod.ut.no/tilestache/dnt_vinter/{z}/{x}/{y}.png\", { code: 'Nw', tms: false, print: true, jnx: true, scaleDependent: true, noCors: true })\n\t        }, {\n\t            // Вместо 404 отдают 500 для отсутствующих тайлов\n\t            title: 'Norway roads',\n\t            description: '<a href=\"http://kart.finn.no/\">http://kart.finn.no/</a>',\n\t            order: 503,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"http://maptiles1.finncdn.no/tileService/1.0.3/normap/{z}/{x}/{y}.png\", { code: 'Nr', tms: false, print: true, jnx: true, scaleDependent: true, noCors: true })\n\t        }]\n\t    }, {\n\t        group: 'Czech <a href=\"http://mapy.cz\">http://mapy.cz</a>',\n\t        layers: [{\n\t            title: 'Czech basic',\n\t            order: 504,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://m{s}.mapserver.mapy.cz/base-m/{z}-{x}-{y}\", { code: 'Czb', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true })\n\t        }, {\n\t            title: 'Czhch tourist',\n\t            order: 505,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://m{s}.mapserver.mapy.cz/wturist-m/{z}-{x}-{y}\", { code: 'Czt', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true })\n\t        }, {\n\t            title: 'Czech summer',\n\t            order: 506,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://m{s}.mapserver.mapy.cz/turist_aquatic-m/{z}-{x}-{y}\", { code: 'Czs', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true })\n\t        }, {\n\t            title: 'Czech winter',\n\t            order: 507,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://m{s}.mapserver.mapy.cz/wturist_winter-m/{z}-{x}-{y}\", { code: 'Czw', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true })\n\t        }, {\n\t            title: 'Czech geographical',\n\t            order: 508,\n\t            isOverlay: false,\n\t            isDefault: false,\n\t            layer: _leaflet2.default.tileLayer(\"https://m{s}.mapserver.mapy.cz/zemepis-m/{z}-{x}-{y}\", { code: 'Czg', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true })\n\t        }]\n\t    }];\n\t    // TODO: move it to tests\n\t    var codes = {};\n\t    var orders = {};\n\t    var _iteratorNormalCompletion = true;\n\t    var _didIteratorError = false;\n\t    var _iteratorError = undefined;\n\t\n\t    try {\n\t        for (var _iterator = layers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t            var group = _step.value;\n\t            var _iteratorNormalCompletion2 = true;\n\t            var _didIteratorError2 = false;\n\t            var _iteratorError2 = undefined;\n\t\n\t            try {\n\t                for (var _iterator2 = group.layers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                    var layer = _step2.value;\n\t\n\t                    if (!layer.layer.options) {\n\t                        throw new Error('Layer without options: ' + layer.title);\n\t                    }\n\t                    var code = layer.layer.options.code;\n\t                    if (!code) {\n\t                        throw new Error('Layer without code: ' + layer.title);\n\t                    }\n\t                    if (code in codes) {\n\t                        throw new Error('Duplicate layer code \"' + code + '\"');\n\t                    }\n\t                    codes[code] = 1;\n\t                    var order = layer.order;\n\t                    if (!order) {\n\t                        throw new Error('Layer without order: ' + layer.title);\n\t                    }\n\t                    if (order in orders) {\n\t                        throw new Error('Duplicate layer order \"' + order + '\"');\n\t                    }\n\t                    orders[order] = 1;\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError2 = true;\n\t                _iteratorError2 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                        _iterator2.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError2) {\n\t                        throw _iteratorError2;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion && _iterator.return) {\n\t                _iterator.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError) {\n\t                throw _iteratorError;\n\t            }\n\t        }\n\t    }\n\t\n\t    return layers;\n\t}\n\t// import 'lib/leaflet.layer.tracks-collection';\n\n/***/ },\n/* 176 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Cache = function () {\n\t    function Cache(maxSize) {\n\t        _classCallCheck(this, Cache);\n\t\n\t        this._maxSize = maxSize;\n\t        this._store = {};\n\t        this._size = 0;\n\t    }\n\t\n\t    _createClass(Cache, [{\n\t        key: \"get\",\n\t        value: function get(key) {\n\t            if (key in this._store) {\n\t                var value = this._store[key];\n\t                delete this._store[key];\n\t                this._store[key] = value;\n\t                return { value: value, found: true };\n\t            }\n\t            return { found: false };\n\t        }\n\t    }, {\n\t        key: \"put\",\n\t        value: function put(key, value) {\n\t            if (key in this._store) {\n\t                delete this._store[key];\n\t            } else {\n\t                this._size += 1;\n\t            }\n\t            this._store[key] = value;\n\t            if (this._size > this._maxSize) {\n\t                delete this._store[Object.keys(this._store)[0]];\n\t                this._size -= 1;\n\t            }\n\t        }\n\t    }]);\n\t\n\t    return Cache;\n\t}();\n\t\n\texports.Cache = Cache;\n\n/***/ },\n/* 177 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.readFiles = exports.readFile = exports.selectFiles = undefined;\n\t\n\tvar _binaryStrings = __webpack_require__(50);\n\t\n\tvar selectFiles = function () {\n\t    var fileInput = void 0;\n\t    return function selectFiles() {\n\t        var multiple = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\t\n\t        if (fileInput) {\n\t            document.body.removeChild(fileInput);\n\t        }\n\t        fileInput = document.createElement('input');\n\t        document.body.appendChild(fileInput);\n\t        fileInput.type = 'file';\n\t        fileInput.multiple = !!multiple;\n\t        fileInput.style.display = 'none';\n\t\n\t        var result = new Promise(function (resolve) {\n\t            fileInput.addEventListener('change', function () {\n\t                resolve(fileInput.files);\n\t            });\n\t        });\n\t        fileInput.click();\n\t        return result;\n\t    };\n\t}();\n\t\n\tfunction readFile(file) {\n\t    return new Promise(function (resolve) {\n\t        var reader = new FileReader();\n\t        reader.onload = function (e) {\n\t            resolve({\n\t                data: (0, _binaryStrings.arrayBufferToString)(e.target.result),\n\t                filename: file.name\n\t            });\n\t        };\n\t        reader.readAsArrayBuffer(file);\n\t    });\n\t}\n\t\n\tfunction readFiles(files) {\n\t    files = Array.prototype.slice.apply(files);\n\t    return Promise.all(files.map(readFile));\n\t}\n\t\n\texports.selectFiles = selectFiles;\n\texports.readFile = readFile;\n\texports.readFiles = readFiles;\n\n/***/ },\n/* 178 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _knockout = __webpack_require__(474);\n\t\n\tvar _knockout2 = _interopRequireDefault(_knockout);\n\t\n\t__webpack_require__(31);\n\t\n\tvar _control = __webpack_require__(486);\n\t\n\tvar _control2 = _interopRequireDefault(_control);\n\t\n\t__webpack_require__(38);\n\t\n\t__webpack_require__(445);\n\t\n\tvar _magneticDeclination = __webpack_require__(127);\n\t\n\t__webpack_require__(232);\n\t\n\tvar _pointer = __webpack_require__(505);\n\t\n\tvar _pointer2 = _interopRequireDefault(_pointer);\n\t\n\tvar _pointerStart = __webpack_require__(504);\n\t\n\tvar _pointerStart2 = _interopRequireDefault(_pointerStart);\n\t\n\tvar _pointerEnd = __webpack_require__(503);\n\t\n\tvar _pointerEnd2 = _interopRequireDefault(_pointerEnd);\n\t\n\tvar _leafletControl = __webpack_require__(114);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction radians(x) {\n\t    return x / 180 * Math.PI;\n\t}\n\t\n\tfunction degrees(x) {\n\t    return x / Math.PI * 180;\n\t}\n\t\n\tfunction calcAzimuth(latlng1, latlng2) {\n\t    var lat1 = radians(latlng1.lat);\n\t    var lat2 = radians(latlng2.lat);\n\t    var lng1 = radians(latlng1.lng);\n\t    var lng2 = radians(latlng2.lng);\n\t\n\t    var y = Math.sin(lng2 - lng1) * Math.cos(lat2);\n\t    var x = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1);\n\t    var brng = Math.atan2(y, x);\n\t    brng = degrees(brng);\n\t    return brng;\n\t}\n\t\n\tfunction calcAngle(latlng1, latlng2) {\n\t    var p1 = _leaflet2.default.Projection.SphericalMercator.project(latlng1);\n\t    var p2 = _leaflet2.default.Projection.SphericalMercator.project(latlng2);\n\t    var delta = p2.subtract(p1);\n\t    var angle = Math.atan2(delta.x, delta.y);\n\t    return degrees(angle);\n\t}\n\t\n\tfunction roundAzimuth(a) {\n\t    return (Math.round(a) + 360) % 360;\n\t}\n\t\n\t_leaflet2.default.Control.Azimuth = _leaflet2.default.Control.extend({\n\t    options: {\n\t        position: 'bottomleft'\n\t    },\n\t\n\t    includes: _leaflet2.default.Mixin.Events,\n\t\n\t    initialize: function initialize(options) {\n\t        _leaflet2.default.Control.prototype.initialize.call(this, options);\n\t        this._enabled = _knockout2.default.observable(false);\n\t        this.trueAzimuth = _knockout2.default.observable(null);\n\t        this.magneticAzimuth = _knockout2.default.observable(null);\n\t        this.distance = _knockout2.default.observable(null);\n\t        this.points = {\n\t            start: null,\n\t            end: null\n\t        };\n\t        var iconSingle = _leaflet2.default.icon({ iconUrl: _pointer2.default, iconSize: [30, 30] });\n\t        var iconStart = _leaflet2.default.icon({ iconUrl: _pointerStart2.default, iconSize: [40, 40] });\n\t        var iconEnd = _leaflet2.default.icon({ iconUrl: _pointerEnd2.default, iconSize: [40, 40] });\n\t        this.markers = {\n\t            single: _leaflet2.default.marker([0, 0], { icon: iconSingle, draggable: true, which: 'start' }).on('drag', this.onMarkerDrag, this).on('click', _leaflet2.default.DomEvent.stopPropagation),\n\t            start: _leaflet2.default.marker([0, 0], { icon: iconStart, draggable: true, which: 'start', rotationOrigin: 'center center' }).on('drag', this.onMarkerDrag, this).on('click', _leaflet2.default.DomEvent.stopPropagation).on('dragend', this.onMarkerDragEnd, this),\n\t            end: _leaflet2.default.marker([0, 0], { icon: iconEnd, draggable: true, which: 'end', rotationOrigin: 'center center' }).on('drag', this.onMarkerDrag, this).on('click', _leaflet2.default.DomEvent.stopPropagation).on('dragend', this.onMarkerDragEnd, this)\n\t        };\n\t        this.azimuthLine = _leaflet2.default.polyline([], { interactive: false, weight: 1.5 });\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'leaflet-control leaflet-control-button leaflet-control-azimuth');\n\t        this._stopContainerEvents();\n\t        container.innerHTML = _control2.default;\n\t        container.title = \"Measure bearing, display line of sight\";\n\t        _knockout2.default.applyBindings(this, container);\n\t        _leaflet2.default.DomEvent.on(container, 'click', this.onClick, this);\n\t        return container;\n\t    },\n\t\n\t    onClick: function onClick() {\n\t        this.setExpanded(true);\n\t    },\n\t\n\t    onMinimizeButtonClick: function onMinimizeButtonClick(e) {\n\t        var _this = this;\n\t\n\t        setTimeout(function () {\n\t            return _this.setExpanded(false);\n\t        }, 0);\n\t    },\n\t\n\t    onMarkerDrag: function onMarkerDrag(e) {\n\t        var marker = e.target;\n\t        this.setPoints(_defineProperty({}, marker.options.which, marker.getLatLng()));\n\t    },\n\t\n\t    onMarkerDragEnd: function onMarkerDragEnd() {\n\t        if (this.elevationControl) {\n\t            this.showProfile();\n\t        }\n\t    },\n\t\n\t    setExpanded: function setExpanded(expanded) {\n\t        if (!!expanded === this.isExpanded()) {\n\t            return;\n\t        }\n\t        if (expanded) {\n\t            _leaflet2.default.DomUtil.addClass(this._container, 'expanded');\n\t        } else {\n\t            _leaflet2.default.DomUtil.removeClass(this._container, 'expanded');\n\t            this.hideProfile();\n\t            this.setPoints({ start: null, end: null });\n\t        }\n\t        this.setEnabled(expanded);\n\t    },\n\t\n\t    setEnabled: function setEnabled(enabled) {\n\t        if (!!enabled === this.isEnabled()) {\n\t            return;\n\t        }\n\t        if (enabled) {\n\t            _leaflet2.default.DomUtil.addClass(this._map._container, 'azimuth-control-active');\n\t            this._map.on('click', this.onMapClick, this);\n\t            this.fire('enabled');\n\t        } else {\n\t            _leaflet2.default.DomUtil.removeClass(this._map._container, 'azimuth-control-active');\n\t            this._map.off('click', this.onMapClick, this);\n\t        }\n\t        this._map.clickLocked = enabled;\n\t        this._enabled(!!enabled);\n\t    },\n\t\n\t    isEnabled: function isEnabled() {\n\t        return !!this._enabled();\n\t    },\n\t\n\t    onEnableButtonClick: function onEnableButtonClick() {\n\t        this.setEnabled(!this.isEnabled());\n\t    },\n\t\n\t    isExpanded: function isExpanded() {\n\t        return _leaflet2.default.DomUtil.hasClass(this._container, 'expanded');\n\t    },\n\t\n\t    setPoints: function setPoints(points) {\n\t        Object.assign(this.points, points);\n\t        points = this.points;\n\t        if (points.start && !points.end) {\n\t            this.markers.single.setLatLng(points.start).addTo(this._map);\n\t        } else {\n\t            this.markers.single.removeFrom(this._map);\n\t        }\n\t        if (points.start && points.end) {\n\t            var angle = calcAngle(points.start, points.end);\n\t            this.markers.start.setLatLng(points.start).addTo(this._map).setRotationAngle(angle);\n\t            this.markers.end.setLatLng(points.end).addTo(this._map).setRotationAngle(angle);\n\t            this.azimuthLine.setLatLngs([[points.start, points.end]]).addTo(this._map);\n\t        } else {\n\t            this.markers.start.removeFrom(this._map);\n\t            this.markers.end.removeFrom(this._map);\n\t            this.azimuthLine.removeFrom(this._map);\n\t        }\n\t        this.updateValuesDisplay();\n\t    },\n\t\n\t    updateValuesDisplay: function updateValuesDisplay() {\n\t        if (this.points.start && this.points.end) {\n\t            var points = this.points;\n\t            var azimuth = calcAzimuth(points.start, points.end);\n\t            this.trueAzimuth(roundAzimuth(azimuth));\n\t            var declination = (0, _magneticDeclination.getDeclination)(points.start.lat, points.start.lng);\n\t            if (declination !== null) {\n\t                this.magneticAzimuth(roundAzimuth(azimuth - declination));\n\t            } else {\n\t                this.magneticAzimuth(null);\n\t            }\n\t            this.distance(points.start.distanceTo(points.end));\n\t        } else {\n\t            this.distance(null);\n\t            this.trueAzimuth(null);\n\t            this.magneticAzimuth(null);\n\t        }\n\t    },\n\t\n\t    onMapClick: function onMapClick(e) {\n\t        if (!this.points.start && !this.points.end) {\n\t            this.setPoints({ start: e.latlng });\n\t        } else if (this.points.start && !this.points.end) {\n\t            this.setPoints({ end: e.latlng });\n\t        } else if (this.points.start && this.points.end) {\n\t            this.hideProfile();\n\t            this.setPoints({ start: e.latlng, end: null });\n\t        }\n\t    },\n\t\n\t    showProfile: function showProfile() {\n\t        var _this2 = this;\n\t\n\t        if (!this.points.end) {\n\t            return;\n\t        }\n\t        if (this.elevationControl) {\n\t            this.elevationControl.removeFrom(this._map);\n\t        }\n\t\n\t        var dist = this.points.start.distanceTo(this.points.end);\n\t        this.elevationControl = new _leafletControl.ElevationProfile(this._map, [this.points.start, this.points.end], {\n\t            samplingInterval: (0, _leafletControl.calcSamplingInterval)(dist),\n\t            sightLine: true\n\t        });\n\t        this.elevationControl.on('remove', function () {\n\t            return _this2.elevationControl = null;\n\t        });\n\t        this.fire('elevation-shown');\n\t    },\n\t\n\t    hideProfile: function hideProfile() {\n\t        if (this.elevationControl) {\n\t            this.elevationControl.removeFrom(this._map);\n\t        }\n\t        this.elevationControl = null;\n\t    },\n\t\n\t    onProfileButtonClick: function onProfileButtonClick() {\n\t        this.showProfile();\n\t    },\n\t\n\t    onReverseButtonClick: function onReverseButtonClick() {\n\t        if (this.points.end && this.points.start) {\n\t            this.setPoints({ start: this.points.end, end: this.points.start });\n\t            if (this.elevationControl) {\n\t                this.showProfile();\n\t            }\n\t        }\n\t    }\n\t\n\t});\n\n/***/ },\n/* 179 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(446);\n\t\n\t__webpack_require__(31);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.Caption = _leaflet2.default.Control.extend({\n\t    options: {\n\t        position: 'bottomright',\n\t        className: 'leaflet-control-caption'\n\t    },\n\t\n\t    initialize: function initialize(contents, options) {\n\t        _leaflet2.default.setOptions(this, options);\n\t        this._contents = contents;\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        this._container = _leaflet2.default.DomUtil.create('div', this.options.className);\n\t        this._stopContainerEvents();\n\t        this._container.innerHTML = this._contents;\n\t        _leaflet2.default.DomEvent.on(this._container, 'contextmenu', function (e) {\n\t            _leaflet2.default.DomEvent.stopPropagation(e);\n\t            e.returnValue = true;\n\t            return true;\n\t        });\n\t        return this._container;\n\t    },\n\t\n\t    setContents: function setContents(contents) {\n\t        this._contents = contents;\n\t        if (this._map) {\n\t            this._container.innerHTML = this._contents;\n\t        }\n\t    }\n\t\n\t});\n\n/***/ },\n/* 180 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(447);\n\t\n\tvar _clipboardCopy = __webpack_require__(79);\n\t\n\tvar _clipboardCopy2 = _interopRequireDefault(_clipboardCopy);\n\t\n\tvar _contextmenu = __webpack_require__(56);\n\t\n\tvar _contextmenu2 = _interopRequireDefault(_contextmenu);\n\t\n\t__webpack_require__(31);\n\t\n\tvar _safeLocalstorage = __webpack_require__(63);\n\t\n\tvar _safeLocalstorage2 = _interopRequireDefault(_safeLocalstorage);\n\t\n\t__webpack_require__(38);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction pad(s, n) {\n\t    var j = s.indexOf('.');\n\t    if (j === -1) {\n\t        j = s.length;\n\t    }\n\t    var zeroes = n - j;\n\t    if (zeroes > 0) {\n\t        s = Array(zeroes + 1).join('0') + s;\n\t    }\n\t    return s;\n\t}\n\t\n\tfunction mod(n, m) {\n\t    return (n % m + m) % m;\n\t}\n\t\n\tfunction normalizeLongitude(lng) {\n\t    return mod(lng + 180, 360) - 180;\n\t}\n\t\n\t_leaflet2.default.Control.Coordinates = _leaflet2.default.Control.extend({\n\t    options: {\n\t        position: 'bottomleft'\n\t    },\n\t\n\t    formatNames: {\n\t        'd': 'ddd.ddddd',\n\t        'D': 'ddd.ddddd&deg',\n\t        'DM': 'ddd&deg;mm.mmm\\'',\n\t        'DMS': 'ddd&deg;mm\\'ss.s\"'\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'leaflet-control leaflet-control-button leaflet-control-coordinates');\n\t        container.title = \"Show coordinates at cursor\";\n\t        this._stopContainerEvents();\n\t        this._field_lat = _leaflet2.default.DomUtil.create('div', 'leaflet-control-coordinates-text', container);\n\t        this._field_lon = _leaflet2.default.DomUtil.create('div', 'leaflet-control-coordinates-text', container);\n\t        _leaflet2.default.DomEvent.on(container, {\n\t            'click': this.onClick\n\t        }, this);\n\t        this.menu = new _contextmenu2.default([{ text: 'Click map to copy coordinates to clipboard', callback: this.prepareForClickOnMap.bind(this) }, '-', { text: '&plusmn;ddd.ddddd', callback: this.onMenuSelect.bind(this, 'd') }, { text: 'ddd.ddddd&deg;', callback: this.onMenuSelect.bind(this, 'D') }, { text: 'ddd&deg;mm.mmm\\'', callback: this.onMenuSelect.bind(this, 'DM') }, { text: 'ddd&deg;mm\\'ss.s\"', callback: this.onMenuSelect.bind(this, 'DMS') }]);\n\t        this.loadStateFromStorage();\n\t        this.onMouseMove();\n\t        _leaflet2.default.DomEvent.on(container, 'contextmenu', this.onRightClick, this);\n\t        return container;\n\t    },\n\t\n\t    loadStateFromStorage: function loadStateFromStorage() {\n\t        var active = false,\n\t            fmt = 'D';\n\t        active = _safeLocalstorage2.default.leafletCoordinatesActive === '1';\n\t        fmt = _safeLocalstorage2.default.leafletCoordinatesFmt || fmt;\n\t        this.setEnabled(active);\n\t        this.setFormat(fmt);\n\t    },\n\t\n\t    saveStateToStorage: function saveStateToStorage() {\n\t        _safeLocalstorage2.default.leafletCoordinatesActive = this.isEnabled() ? '1' : '0';\n\t        _safeLocalstorage2.default.leafletCoordinatesFmt = this.fmt;\n\t    },\n\t\n\t    formatCoodinate: function formatCoodinate(value, isLat, fmt) {\n\t        if (value === undefined || isNaN(value)) {\n\t            return '-------';\n\t        }\n\t        fmt = fmt || this.fmt;\n\t        var h, d, m, s;\n\t        if (isLat) {\n\t            h = value < 0 ? 'S' : 'N';\n\t        } else {\n\t            h = value < 0 ? 'W' : 'E';\n\t        }\n\t        if (fmt === 'd') {\n\t            d = value.toFixed(5);\n\t            d = pad(d, isLat ? 2 : 3);\n\t            return d;\n\t        }\n\t\n\t        value = Math.abs(value);\n\t        if (fmt === 'D') {\n\t            d = value.toFixed(5);\n\t            d = pad(d, isLat ? 2 : 3);\n\t            return h + ' ' + d + '&deg;';\n\t        }\n\t        if (fmt === 'DM') {\n\t            d = Math.floor(value).toString();\n\t            d = pad(d, isLat ? 2 : 3);\n\t            m = ((value - d) * 60).toFixed(3);\n\t            m = pad(m, 2);\n\t            return h + ' ' + d + '&deg;' + m + '\\'';\n\t        }\n\t        if (fmt === 'DMS') {\n\t            d = Math.floor(value).toString();\n\t            d = pad(d, isLat ? 2 : 3);\n\t            m = Math.floor((value - d) * 60).toString();\n\t            m = pad(m, 2);\n\t            s = ((value - d - m / 60) * 3600).toFixed(2);\n\t            s = pad(s, 2);\n\t            return h + ' ' + d + '&deg;' + m + '\\'' + s + '\"';\n\t        }\n\t    },\n\t\n\t    onMenuSelect: function onMenuSelect(fmt) {\n\t        this.setFormat(fmt);\n\t        this.saveStateToStorage();\n\t    },\n\t\n\t    setFormat: function setFormat(fmt) {\n\t        this.fmt = fmt;\n\t        this.onMouseMove();\n\t    },\n\t\n\t    onMouseMove: function onMouseMove(e) {\n\t        var lat, lng;\n\t        if (e) {\n\t            var _e$latlng = e.latlng;\n\t            lat = _e$latlng.lat;\n\t            lng = _e$latlng.lng;\n\t        }\n\t        lng = normalizeLongitude(lng);\n\t        this._field_lat.innerHTML = this.formatCoodinate(lat, true);\n\t        this._field_lon.innerHTML = this.formatCoodinate(lng, false);\n\t    },\n\t\n\t    setEnabled: function setEnabled(enabled) {\n\t        if (!!enabled === this.isEnabled()) {\n\t            return;\n\t        }\n\t        if (enabled) {\n\t            _leaflet2.default.DomUtil.addClass(this._container, 'expanded');\n\t            _leaflet2.default.DomUtil.addClass(this._map._container, 'coordinates-control-active');\n\t            this._map.on('mousemove', this.onMouseMove, this);\n\t            this._map.on('contextmenu', this.onMapRightClick, this);\n\t        } else {\n\t            _leaflet2.default.DomUtil.removeClass(this._container, 'expanded');\n\t            _leaflet2.default.DomUtil.removeClass(this._map._container, 'coordinates-control-active');\n\t            this._map.off('contextmenu', this.onMapRightClick, this);\n\t            this._map.off('mousemove', this.onMouseMove, this);\n\t        }\n\t    },\n\t\n\t    onMapRightClick: function onMapRightClick(e) {\n\t        var _this = this;\n\t\n\t        var items = [{ text: '<b>Copy coordinates to clipboard</b>', header: true }, '-'];\n\t\n\t        var lat = e.latlng.lat,\n\t            lng = normalizeLongitude(e.latlng.lng);\n\t\n\t        var _arr = ['d', 'D', 'DM', 'DMS'];\n\t\n\t        var _loop = function _loop() {\n\t            var fmt = _arr[_i];\n\t            var strLat = _this.formatCoodinate(lat, true, fmt);\n\t            var strLng = _this.formatCoodinate(lng, false, fmt);\n\t            var s = strLat + ' ' + strLng;\n\t            items.push({\n\t                text: s + ' <span class=\"leaflet-coordinates-menu-fmt\">' + _this.formatNames[fmt] + '</span>',\n\t                callback: function callback() {\n\t                    (0, _clipboardCopy2.default)(s.replace(/&deg;/g, '°'), e.originalEvent);\n\t                }\n\t            });\n\t        };\n\t\n\t        for (var _i = 0; _i < _arr.length; _i++) {\n\t            _loop();\n\t        }\n\t        var menu = new _contextmenu2.default(items);\n\t        menu.show(e);\n\t    },\n\t\n\t    isEnabled: function isEnabled() {\n\t        return _leaflet2.default.DomUtil.hasClass(this._container, 'expanded');\n\t    },\n\t\n\t    onClick: function onClick(e) {\n\t        this.setEnabled(!this.isEnabled());\n\t        this.saveStateToStorage();\n\t        this.onMouseMove();\n\t    },\n\t\n\t    onRightClick: function onRightClick(e) {\n\t        this.menu.show(e);\n\t    },\n\t\n\t    onMapClick: function onMapClick(e) {\n\t        var s = this.formatCoodinate(e.latlng.lat, true) + ' ' + this.formatCoodinate(e.latlng.lng, false);\n\t        s = s.replace(/&deg;/g, '°');\n\t        (0, _clipboardCopy2.default)(s, e.originalEvent);\n\t    },\n\t\n\t    prepareForClickOnMap: function prepareForClickOnMap() {\n\t        this._map.once('click', this.onMapClick, this);\n\t    }\n\t\n\t    // TODO: onRemove\n\t\n\t});\n\n/***/ },\n/* 181 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.BinStream = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utf = __webpack_require__(110);\n\t\n\tvar _utf2 = _interopRequireDefault(_utf);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar BinStream = function () {\n\t    function BinStream(size, littlEndian) {\n\t        _classCallCheck(this, BinStream);\n\t\n\t        this.maxSize = 1024;\n\t        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n\t        this._pos = 0;\n\t        this.size = 0;\n\t        this.littlEndian = littlEndian;\n\t    }\n\t\n\t    _createClass(BinStream, [{\n\t        key: 'grow',\n\t        value: function grow() {\n\t            this.maxSize *= 2;\n\t            var old_buffer = this.dv.buffer;\n\t            this.dv = new DataView(new ArrayBuffer(this.maxSize));\n\t            var newAr = new Uint8Array(this.dv.buffer);\n\t            var oldAr = new Uint8Array(old_buffer);\n\t            for (var i = 0; i < oldAr.length; i++) {\n\t                newAr[i] = oldAr[i];\n\t            }\n\t        }\n\t    }, {\n\t        key: 'checkSize',\n\t        value: function checkSize(size) {\n\t            if (this._pos + size >= this.maxSize) {\n\t                this.grow();\n\t            }\n\t            var newPos = this._pos + size;\n\t            this.size = newPos > this.size ? newPos : this.size;\n\t        }\n\t    }, {\n\t        key: 'writeUint8',\n\t        value: function writeUint8(value) {\n\t            this.checkSize(1);\n\t            this.dv.setUint8(this._pos, value);\n\t            this._pos += 1;\n\t        }\n\t    }, {\n\t        key: 'writeInt8',\n\t        value: function writeInt8(value) {\n\t            this.checkSize(1);\n\t            this.dv.setInt8(this._pos, value);\n\t            this._pos += 1;\n\t        }\n\t    }, {\n\t        key: 'writeInt16',\n\t        value: function writeInt16(value) {\n\t            this.checkSize(2);\n\t            this.dv.setInt16(this._pos, value, this.littlEndian);\n\t            this._pos += 2;\n\t        }\n\t    }, {\n\t        key: 'writeUint16',\n\t        value: function writeUint16(value) {\n\t            this.checkSize(2);\n\t            this.dv.setUint16(this._pos, value, this.littlEndian);\n\t            this._pos += 2;\n\t        }\n\t    }, {\n\t        key: 'writeInt32',\n\t        value: function writeInt32(value) {\n\t            this.checkSize(4);\n\t            this.dv.setInt32(this._pos, value, this.littlEndian);\n\t            this._pos += 4;\n\t        }\n\t    }, {\n\t        key: 'writeUint32',\n\t        value: function writeUint32(value) {\n\t            this.checkSize(4);\n\t            this.dv.setUint32(this._pos, value, this.littlEndian);\n\t            this._pos += 4;\n\t        }\n\t    }, {\n\t        key: 'writeString',\n\t        value: function writeString(s, zeroTerminated) {\n\t            s = _utf2.default.encode(s);\n\t            for (var i = 0; i < s.length; i++) {\n\t                this.writeUint8(s.charCodeAt(i));\n\t            }\n\t            if (zeroTerminated) {\n\t                this.writeUint8(0);\n\t            }\n\t        }\n\t    }, {\n\t        key: 'tell',\n\t        value: function tell() {\n\t            return this._pos;\n\t        }\n\t    }, {\n\t        key: 'seek',\n\t        value: function seek(pos) {\n\t            this._pos = pos;\n\t        }\n\t    }, {\n\t        key: 'getBuffer',\n\t        value: function getBuffer() {\n\t            return this.dv.buffer.slice(0, this.size);\n\t        }\n\t    }]);\n\t\n\t    return BinStream;\n\t}();\n\t\n\texports.BinStream = BinStream;\n\n/***/ },\n/* 182 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(115);\n\t\n\t__webpack_require__(61);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.JNX.include(_leaflet2.default.Mixin.HashState);\n\t_leaflet2.default.Control.JNX.include({\n\t    stateChangeEvents: ['selectionchange'],\n\t\n\t    serializeState: function serializeState() {\n\t        var state = void 0;\n\t        if (this._selector) {\n\t            var bounds = this._selector.getBounds();\n\t            state = [bounds.getSouth().toFixed(5), bounds.getWest().toFixed(5), bounds.getNorth().toFixed(5), bounds.getEast().toFixed(5)];\n\t        }\n\t        return state;\n\t    },\n\t\n\t    unserializeState: function unserializeState(values) {\n\t        function validateFloat(value, min, max) {\n\t            value = parseFloat(value);\n\t            if (isNaN(value) || value < min || value > max) {\n\t                throw new Error('INVALID VALUE');\n\t            }\n\t            return value;\n\t        }\n\t\n\t        if (values && values.length === 4) {\n\t            try {\n\t                var south = validateFloat(values[0], -86, 86),\n\t                    west = validateFloat(values[1], -180, 180),\n\t                    north = validateFloat(values[2], -86, 86),\n\t                    east = validateFloat(values[3], -180, 180);\n\t            } catch (e) {\n\t                if (e.message === 'INVALID VALUE') {\n\t                    return false;\n\t                }\n\t                throw e;\n\t            }\n\t            this.removeSelector();\n\t            this.addSelector([[south, west], [north, east]]);\n\t            return true;\n\t        } else {\n\t            return false;\n\t        }\n\t    }\n\t});\n\n/***/ },\n/* 183 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _knockout = __webpack_require__(51);\n\t\n\tvar _knockout2 = _interopRequireDefault(_knockout);\n\t\n\t__webpack_require__(449);\n\t\n\t__webpack_require__(31);\n\t\n\tvar _selector = __webpack_require__(186);\n\t\n\tvar _contextmenu = __webpack_require__(56);\n\t\n\tvar _contextmenu2 = _interopRequireDefault(_contextmenu);\n\t\n\tvar _jnxMaker = __webpack_require__(185);\n\t\n\tvar _browserFilesaver = __webpack_require__(64);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.JNX = _leaflet2.default.Control.extend({\n\t    includes: _leaflet2.default.Mixin.Events,\n\t\n\t    initialize: function initialize(layersControl, options) {\n\t        var _this = this;\n\t\n\t        _leaflet2.default.Control.prototype.initialize.call(this, options);\n\t        this._layersControl = layersControl;\n\t        this.makingJnx = _knockout2.default.observable(false);\n\t        this.downloadProgressRange = _knockout2.default.observable(1);\n\t        this.downloadProgressDone = _knockout2.default.observable(0);\n\t        this.contextMenu = new _contextmenu2.default(function () {\n\t            return _this.makeMenuItems();\n\t        });\n\t    },\n\t\n\t    getLayerForJnx: function getLayerForJnx() {\n\t        var selectedLayer = {};\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = this._layersControl._layers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var layerRec = _step.value;\n\t\n\t                var layer = layerRec.layer;\n\t                if (this._map.hasLayer(layer) && layer.options && layer.options.jnx) {\n\t                    selectedLayer = {\n\t                        layer: layer,\n\t                        layerName: layerRec.name\n\t                    };\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        return selectedLayer;\n\t    },\n\t\n\t    estimateTilesCount: function estimateTilesCount(maxZoom) {\n\t        var tilesCount = 0;\n\t        var bounds = this._selector.getBounds();\n\t        for (var zoom = (0, _jnxMaker.minZoom)(maxZoom); zoom <= maxZoom; zoom++) {\n\t            var topLeftTile = this._map.project(bounds.getNorthWest(), zoom).divideBy(256).floor();\n\t            var bottomRightTile = this._map.project(bounds.getSouthEast(), zoom).divideBy(256).ceil();\n\t            tilesCount += Math.ceil((bottomRightTile.x - topLeftTile.x) * (bottomRightTile.y - topLeftTile.y));\n\t        }\n\t        return tilesCount;\n\t    },\n\t\n\t    makeMenuItems: function makeMenuItems() {\n\t        var _this2 = this;\n\t\n\t        var _getLayerForJnx = this.getLayerForJnx(),\n\t            layer = _getLayerForJnx.layer,\n\t            layerName = _getLayerForJnx.layerName;\n\t\n\t        if (!layer) {\n\t            return [{ text: 'No supported layer' }];\n\t        }\n\t        var maxLevel = layer.options.maxNativeZoom || layer.options.maxZoom || 18;\n\t        var minLevel = Math.max(0, maxLevel - 6);\n\t\n\t        var equatorLength = 40075016;\n\t        var lat = this._selector.getBounds().getCenter().lat;\n\t        var metersPerPixel = equatorLength / Math.pow(2, maxLevel) / 256 * Math.cos(lat / 180 * Math.PI);\n\t\n\t        var items = [{ text: layerName, header: true }];\n\t\n\t        var _loop = function _loop(zoom) {\n\t            var tilesCount = _this2.estimateTilesCount(zoom);\n\t            var fileSizeMb = tilesCount * 0.02;\n\t            var itemClass = tilesCount > 50000 ? 'jnx-menu-warning' : '';\n\t            var resolutionString = metersPerPixel.toFixed(2);\n\t            var sizeString = fileSizeMb.toFixed(fileSizeMb > 1 ? 0 : 1);\n\t            var item = {\n\t                text: '<span class=\"' + itemClass + '\">Zoom ' + zoom + ' (' + resolutionString + ' m/pixel) &mdash; ' + tilesCount + ' tiles (~' + sizeString + ' Mb)</span>',\n\t                callback: function callback() {\n\t                    return _this2.makeJnx(layer, layerName, zoom);\n\t                },\n\t                disabled: _this2.makingJnx()\n\t            };\n\t            items.push(item);\n\t            metersPerPixel *= 2;\n\t        };\n\t\n\t        for (var zoom = maxLevel; zoom >= minLevel; zoom -= 1) {\n\t            _loop(zoom);\n\t        }\n\t        return items;\n\t    },\n\t\n\t    notifyProgress: function notifyProgress(value, maxValue) {\n\t        this.downloadProgressDone(this.downloadProgressDone() + value);\n\t        this.downloadProgressRange(maxValue);\n\t    },\n\t\n\t    makeJnx: function makeJnx(layer, layerName, zoom) {\n\t        var _this3 = this;\n\t\n\t        _logging2.default.captureBreadcrumbWithUrl({ message: 'start making jnx' });\n\t        this.makingJnx(true);\n\t        this.downloadProgressDone(0);\n\t\n\t        var bounds = this._selector.getBounds();\n\t        var sanitizedLayerName = layerName.toLowerCase().replace(/[ ()]+/, '_');\n\t        var fileName = 'nakarte.tk_' + sanitizedLayerName + '_z' + zoom + '.jnx';\n\t        (0, _jnxMaker.makeJnxFromLayer)(layer, layerName, zoom, bounds, this.notifyProgress.bind(this)).then(function (fileData) {\n\t            return (0, _browserFilesaver.saveAs)(fileData, fileName, true);\n\t        }).catch(function (e) {\n\t            _logging2.default.captureException(e);\n\t            (0, _notifications.notify)('Failed to create JNX: ' + e.message);\n\t        }).then(function () {\n\t            return _this3.makingJnx(false);\n\t        });\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'leaflet-control leaflet-control-jnx');\n\t        container.innerHTML = '\\n                <a class=\"button\" data-bind=\"visible: !makingJnx(), click: onButtonClicked\"\\n                 title=\"Make JNX for Garmin receivers\">JNX</a>\\n                <div data-bind=\"\\n                    component:{\\n                        name: \\'progress-indicator\\',\\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\\n                    },\\n                    visible: makingJnx()\"></div>';\n\t        _knockout2.default.applyBindings(this, container);\n\t        this._stopContainerEvents();\n\t        return container;\n\t    },\n\t\n\t    removeSelector: function removeSelector() {\n\t        if (this._selector) {\n\t            this._map.removeLayer(this._selector);\n\t            this._selector = null;\n\t            this.fire('selectionchange');\n\t        }\n\t    },\n\t\n\t    addSelector: function addSelector(bounds) {\n\t        var _this4 = this;\n\t\n\t        if (!bounds) {\n\t            bounds = this._map.getBounds().pad(-0.25);\n\t        }\n\t        this._selector = new _selector.RectangleSelect(bounds).addTo(this._map).on('change', function () {\n\t            return _this4.fire('selectionchange');\n\t        }).on('click contextmenu', function (e) {\n\t            return _this4.contextMenu.show(e);\n\t        });\n\t        this.fire('selectionchange');\n\t    },\n\t\n\t    onButtonClicked: function onButtonClicked() {\n\t        if (this._selector) {\n\t            if (this._selector.getBounds().intersects(this._map.getBounds().pad(-0.05))) {\n\t                this.removeSelector();\n\t            } else {\n\t                this.removeSelector();\n\t                this.addSelector();\n\t            }\n\t        } else {\n\t            this.addSelector();\n\t        }\n\t    }\n\t});\n\n/***/ },\n/* 184 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.JnxWriter = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _binaryStream = __webpack_require__(181);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction jnxCoordinates(extents) {\n\t    function toJnx(x) {\n\t        return Math.round(x / 180.0 * 0x7fffffff);\n\t    }\n\t\n\t    return [toJnx(extents.north), toJnx(extents.east), toJnx(extents.south), toJnx(extents.west)];\n\t}\n\t\n\tvar JnxWriter = _leaflet2.default.Class.extend({\n\t    initialize: function initialize(productName, productId, zOrder) {\n\t        this.tiles = {};\n\t        this.productName = productName || 'Raster map';\n\t        this.productId = productId || 0;\n\t        this.zOrder = zOrder;\n\t    },\n\t\n\t    addTile: function addTile(tileData, level, latLngBounds) {\n\t        this.tiles[level] = this.tiles[level] || [];\n\t        tileData = new Blob([tileData]).slice(2);\n\t        var extents = {\n\t            west: latLngBounds.getWest(),\n\t            north: latLngBounds.getNorth(),\n\t            south: latLngBounds.getSouth(),\n\t            east: latLngBounds.getEast()\n\t\n\t        };\n\t        this.tiles[level].push({ data: tileData, extents: extents });\n\t    },\n\t\n\t    getJnx: function getJnx() {\n\t        var HEADER_SIZE = 52,\n\t            LEVEL_INFO_SIZE = 17,\n\t            TILE_INFO_SIZE = 28;\n\t\n\t        var totalTilesCount = 0;\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = Object.values(this.tiles)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var levelTiles = _step.value;\n\t\n\t                totalTilesCount += levelTiles.length;\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        if (totalTilesCount === 0) {\n\t            throw new Error('No tiles collected, JNX is empty');\n\t        }\n\t        if (totalTilesCount > 50000) {\n\t            throw new Error('Too many tiles found (more then 50000)');\n\t        }\n\t\n\t        var west = 1e10,\n\t            east = -1e10,\n\t            north = -1e10,\n\t            south = 1e10,\n\t            levels_n = Object.keys(this.tiles).length,\n\t            level = void 0,\n\t            tiles = void 0,\n\t            extents = void 0,\n\t            i = void 0,\n\t            tile = void 0;\n\t        var _iteratorNormalCompletion2 = true;\n\t        var _didIteratorError2 = false;\n\t        var _iteratorError2 = undefined;\n\t\n\t        try {\n\t            for (var _iterator2 = Object.values(this.tiles)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                var _levelTiles = _step2.value;\n\t                var _iteratorNormalCompletion7 = true;\n\t                var _didIteratorError7 = false;\n\t                var _iteratorError7 = undefined;\n\t\n\t                try {\n\t                    for (var _iterator7 = _levelTiles[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n\t                        var _tile = _step7.value;\n\t\n\t                        west = west < _tile.extents.west ? west : _tile.extents.west;\n\t                        east = east > _tile.extents.east ? east : _tile.extents.east;\n\t                        north = north > _tile.extents.north ? north : _tile.extents.north;\n\t                        south = south < _tile.extents.south ? south : _tile.extents.south;\n\t                    }\n\t                } catch (err) {\n\t                    _didIteratorError7 = true;\n\t                    _iteratorError7 = err;\n\t                } finally {\n\t                    try {\n\t                        if (!_iteratorNormalCompletion7 && _iterator7.return) {\n\t                            _iterator7.return();\n\t                        }\n\t                    } finally {\n\t                        if (_didIteratorError7) {\n\t                            throw _iteratorError7;\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError2 = true;\n\t            _iteratorError2 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                    _iterator2.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError2) {\n\t                    throw _iteratorError2;\n\t                }\n\t            }\n\t        }\n\t\n\t        var stream = new _binaryStream.BinStream(1024, true);\n\t        // header\n\t        stream.writeInt32(4); // version\n\t        stream.writeInt32(0); // device id\n\t        extents = jnxCoordinates({ south: south, north: north, west: west, east: east });\n\t        stream.writeInt32(extents[0]); // north\n\t        stream.writeInt32(extents[1]); // west\n\t        stream.writeInt32(extents[2]); // south\n\t        stream.writeInt32(extents[3]); // east\n\t        stream.writeInt32(levels_n); // number of zoom levels\n\t        stream.writeInt32(0); //expiration date\n\t        stream.writeInt32(this.productId);\n\t        stream.writeInt32(0); // tiles CRC32\n\t        stream.writeInt32(0); // signature version\n\t        stream.writeUint32(0); // signature offset\n\t        stream.writeInt32(this.zOrder);\n\t        stream.seek(HEADER_SIZE + LEVEL_INFO_SIZE * levels_n);\n\t        // map description\n\t        stream.writeInt32(9); // section version\n\t        stream.writeString('12345678-1234-1234-1234-123456789ABC', true); // GUID\n\t        stream.writeString(this.productName, true);\n\t        stream.writeString('', true);\n\t        stream.writeInt16(this.productId);\n\t        stream.writeString(this.productName, true);\n\t        stream.writeInt32(levels_n);\n\t        // levels descriptions\n\t        var _iteratorNormalCompletion3 = true;\n\t        var _didIteratorError3 = false;\n\t        var _iteratorError3 = undefined;\n\t\n\t        try {\n\t            for (var _iterator3 = Object.keys(this.tiles)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                level = _step3.value;\n\t\n\t                stream.writeString('', true);\n\t                stream.writeString('', true);\n\t                stream.writeString('', true);\n\t                stream.writeInt32(level);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError3 = true;\n\t            _iteratorError3 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                    _iterator3.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError3) {\n\t                    throw _iteratorError3;\n\t                }\n\t            }\n\t        }\n\t\n\t        var tileDescriptorOffset = stream.tell();\n\t        // level info\n\t        var jnxScale = void 0;\n\t        stream.seek(HEADER_SIZE);\n\t        var _iteratorNormalCompletion4 = true;\n\t        var _didIteratorError4 = false;\n\t        var _iteratorError4 = undefined;\n\t\n\t        try {\n\t            for (var _iterator4 = Object.keys(this.tiles)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t                level = _step4.value;\n\t\n\t                level = parseInt(level, 10);\n\t                stream.writeInt32(this.tiles[level].length);\n\t                stream.writeUint32(tileDescriptorOffset);\n\t                //jnxScale = JnxScales[level + 3];\n\t                jnxScale = 34115555 / Math.pow(2, level) * Math.cos((north + south) / 2 / 180 * Math.PI) / 1.1;\n\t                stream.writeInt32(jnxScale);\n\t                stream.writeInt32(2);\n\t                stream.writeUint8(0);\n\t                tileDescriptorOffset += TILE_INFO_SIZE * this.tiles[level].length;\n\t            }\n\t            // tiles descriptors\n\t        } catch (err) {\n\t            _didIteratorError4 = true;\n\t            _iteratorError4 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                    _iterator4.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError4) {\n\t                    throw _iteratorError4;\n\t                }\n\t            }\n\t        }\n\t\n\t        stream.seek(stream.size);\n\t        var tileDataOffset = tileDescriptorOffset;\n\t        var _iteratorNormalCompletion5 = true;\n\t        var _didIteratorError5 = false;\n\t        var _iteratorError5 = undefined;\n\t\n\t        try {\n\t            for (var _iterator5 = Object.keys(this.tiles)[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n\t                level = _step5.value;\n\t\n\t                tiles = this.tiles[level];\n\t                for (i = 0; i < tiles.length; i++) {\n\t                    tile = tiles[i];\n\t                    extents = jnxCoordinates(tile.extents);\n\t                    stream.writeInt32(extents[0]); // north\n\t                    stream.writeInt32(extents[1]); // west\n\t                    stream.writeInt32(extents[2]); // south\n\t                    stream.writeInt32(extents[3]); // east\n\t                    stream.writeInt16(256); // width\n\t                    stream.writeInt16(256); // height\n\t                    stream.writeInt32(tile.data.size);\n\t                    stream.writeUint32(tileDataOffset);\n\t                    tileDataOffset += tile.data.size;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError5 = true;\n\t            _iteratorError5 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion5 && _iterator5.return) {\n\t                    _iterator5.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError5) {\n\t                    throw _iteratorError5;\n\t                }\n\t            }\n\t        }\n\t\n\t        var blob = [];\n\t        blob.push(stream.getBuffer());\n\t        var _iteratorNormalCompletion6 = true;\n\t        var _didIteratorError6 = false;\n\t        var _iteratorError6 = undefined;\n\t\n\t        try {\n\t            for (var _iterator6 = Object.keys(this.tiles)[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n\t                level = _step6.value;\n\t\n\t                tiles = this.tiles[level];\n\t                for (i = 0; i < tiles.length; i++) {\n\t                    tile = tiles[i];\n\t                    blob.push(tile.data);\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError6 = true;\n\t            _iteratorError6 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion6 && _iterator6.return) {\n\t                    _iterator6.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError6) {\n\t                    throw _iteratorError6;\n\t                }\n\t            }\n\t        }\n\t\n\t        blob.push('BirdsEye');\n\t        return new Blob(blob);\n\t    }\n\t});\n\t\n\texports.JnxWriter = JnxWriter;\n\n/***/ },\n/* 185 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.minZoom = exports.makeJnxFromLayer = undefined;\n\t\n\tvar convertToJpeg = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(image) {\n\t        var canvas, ctx, dataURL, s;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        _context.prev = 0;\n\t                        _context.next = 3;\n\t                        return imageFromarrayBuffer(image);\n\t\n\t                    case 3:\n\t                        image = _context.sent;\n\t                        _context.next = 9;\n\t                        break;\n\t\n\t                    case 6:\n\t                        _context.prev = 6;\n\t                        _context.t0 = _context['catch'](0);\n\t                        return _context.abrupt('return', null);\n\t\n\t                    case 9:\n\t                        canvas = document.createElement(\"canvas\");\n\t\n\t                        canvas.width = image.width;\n\t                        canvas.height = image.height;\n\t                        ctx = canvas.getContext(\"2d\");\n\t\n\t                        ctx.drawImage(image, 0, 0);\n\t                        dataURL = canvas.toDataURL(\"image/jpeg\");\n\t                        s = atob(dataURL.replace(/^data:image\\/jpeg;base64,/, \"\"));\n\t                        return _context.abrupt('return', (0, _binaryStrings.stringToArrayBuffer)(s));\n\t\n\t                    case 17:\n\t                    case 'end':\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this, [[0, 6]]);\n\t    }));\n\t\n\t    return function convertToJpeg(_x) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar makeJnxFromLayer = function () {\n\t    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(srcLayer, layerName, maxZoomLevel, latLngBounds, progress) {\n\t        var jnxProductId, jnxZOrder, writer, xhrQueue, doStop, error, minZoomLevel, progressWeight, zoom, pixelBounds, promises, layer, tempMap, _ref3, iterateTilePromises, tilesCount, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, tilePromiseRec, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, tilePromise, imageRec, xhr, image;\n\t\n\t        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t            while (1) {\n\t                switch (_context2.prev = _context2.next) {\n\t                    case 0:\n\t                        jnxProductId = _leaflet2.default.stamp(srcLayer);\n\t                        jnxZOrder = Math.min(jnxProductId, 100);\n\t                        writer = new _jnxEncoder.JnxWriter(layerName, jnxProductId, jnxZOrder);\n\t                        xhrQueue = new _xhrPromise.XHRQueue();\n\t                        doStop = false;\n\t                        error = void 0;\n\t                        minZoomLevel = minZoom(maxZoomLevel);\n\t                        progressWeight = 1;\n\t                        zoom = maxZoomLevel;\n\t\n\t                    case 9:\n\t                        if (!(zoom >= minZoomLevel)) {\n\t                            _context2.next = 95;\n\t                            break;\n\t                        }\n\t\n\t                        pixelBounds = _leaflet2.default.bounds(_leaflet2.default.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(), _leaflet2.default.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round());\n\t                        promises = [];\n\t                        layer = srcLayer.cloneForPrint({ xhrQueue: xhrQueue });\n\t                        tempMap = (0, _leafletLayer.getTempMap)(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n\t\n\t                        tempMap.addLayer(layer);\n\t                        _context2.next = 17;\n\t                        return layer.getTilesInfo({\n\t                            xhrOptions: defaultXHROptions,\n\t                            pixelBounds: pixelBounds,\n\t                            rawData: true\n\t                        });\n\t\n\t                    case 17:\n\t                        _ref3 = _context2.sent;\n\t                        iterateTilePromises = _ref3.iterateTilePromises;\n\t                        tilesCount = _ref3.count;\n\t                        _iteratorNormalCompletion = true;\n\t                        _didIteratorError = false;\n\t                        _iteratorError = undefined;\n\t                        _context2.prev = 23;\n\t\n\t                        for (_iterator = iterateTilePromises()[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                            tilePromiseRec = _step.value;\n\t\n\t                            promises.push(tilePromiseRec);\n\t                        }\n\t                        _context2.next = 31;\n\t                        break;\n\t\n\t                    case 27:\n\t                        _context2.prev = 27;\n\t                        _context2.t0 = _context2['catch'](23);\n\t                        _didIteratorError = true;\n\t                        _iteratorError = _context2.t0;\n\t\n\t                    case 31:\n\t                        _context2.prev = 31;\n\t                        _context2.prev = 32;\n\t\n\t                        if (!_iteratorNormalCompletion && _iterator.return) {\n\t                            _iterator.return();\n\t                        }\n\t\n\t                    case 34:\n\t                        _context2.prev = 34;\n\t\n\t                        if (!_didIteratorError) {\n\t                            _context2.next = 37;\n\t                            break;\n\t                        }\n\t\n\t                        throw _iteratorError;\n\t\n\t                    case 37:\n\t                        return _context2.finish(34);\n\t\n\t                    case 38:\n\t                        return _context2.finish(31);\n\t\n\t                    case 39:\n\t                        _iteratorNormalCompletion2 = true;\n\t                        _didIteratorError2 = false;\n\t                        _iteratorError2 = undefined;\n\t                        _context2.prev = 42;\n\t                        _iterator2 = promises[Symbol.iterator]();\n\t\n\t                    case 44:\n\t                        if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n\t                            _context2.next = 73;\n\t                            break;\n\t                        }\n\t\n\t                        tilePromise = _step2.value.tilePromise;\n\t                        imageRec = void 0;\n\t                        _context2.prev = 47;\n\t                        _context2.next = 50;\n\t                        return tilePromise;\n\t\n\t                    case 50:\n\t                        imageRec = _context2.sent;\n\t                        _context2.next = 58;\n\t                        break;\n\t\n\t                    case 53:\n\t                        _context2.prev = 53;\n\t                        _context2.t1 = _context2['catch'](47);\n\t\n\t                        error = _context2.t1;\n\t                        doStop = true;\n\t                        return _context2.abrupt('break', 73);\n\t\n\t                    case 58:\n\t                        xhr = imageRec.image;\n\t\n\t                        if (!(xhr === null || xhr.status !== 200 || !xhr.response || !xhr.response.byteLength)) {\n\t                            _context2.next = 61;\n\t                            break;\n\t                        }\n\t\n\t                        return _context2.abrupt('continue', 70);\n\t\n\t                    case 61:\n\t                        _context2.next = 63;\n\t                        return ensureImageJpg(xhr.response);\n\t\n\t                    case 63:\n\t                        image = _context2.sent;\n\t\n\t                        if (image) {\n\t                            _context2.next = 68;\n\t                            break;\n\t                        }\n\t\n\t                        error = new Error('Tile image invalid');\n\t                        doStop = true;\n\t                        return _context2.abrupt('break', 73);\n\t\n\t                    case 68:\n\t                        writer.addTile(image, zoom, imageRec.latLngBounds);\n\t                        progress(progressWeight / tilesCount, 4 / 3);\n\t\n\t                    case 70:\n\t                        _iteratorNormalCompletion2 = true;\n\t                        _context2.next = 44;\n\t                        break;\n\t\n\t                    case 73:\n\t                        _context2.next = 79;\n\t                        break;\n\t\n\t                    case 75:\n\t                        _context2.prev = 75;\n\t                        _context2.t2 = _context2['catch'](42);\n\t                        _didIteratorError2 = true;\n\t                        _iteratorError2 = _context2.t2;\n\t\n\t                    case 79:\n\t                        _context2.prev = 79;\n\t                        _context2.prev = 80;\n\t\n\t                        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                            _iterator2.return();\n\t                        }\n\t\n\t                    case 82:\n\t                        _context2.prev = 82;\n\t\n\t                        if (!_didIteratorError2) {\n\t                            _context2.next = 85;\n\t                            break;\n\t                        }\n\t\n\t                        throw _iteratorError2;\n\t\n\t                    case 85:\n\t                        return _context2.finish(82);\n\t\n\t                    case 86:\n\t                        return _context2.finish(79);\n\t\n\t                    case 87:\n\t                        (0, _leafletLayer.disposeMap)(tempMap);\n\t\n\t                        if (!doStop) {\n\t                            _context2.next = 91;\n\t                            break;\n\t                        }\n\t\n\t                        promises.forEach(function (promiseRec) {\n\t                            return promiseRec.abortLoading();\n\t                        });\n\t                        throw error;\n\t\n\t                    case 91:\n\t                        progressWeight /= 4;\n\t\n\t                    case 92:\n\t                        zoom--;\n\t                        _context2.next = 9;\n\t                        break;\n\t\n\t                    case 95:\n\t                        return _context2.abrupt('return', writer.getJnx());\n\t\n\t                    case 96:\n\t                    case 'end':\n\t                        return _context2.stop();\n\t                }\n\t            }\n\t        }, _callee2, this, [[23, 27, 31, 39], [32,, 34, 38], [42, 75, 79, 87], [47, 53], [80,, 82, 86]]);\n\t    }));\n\t\n\t    return function makeJnxFromLayer(_x2, _x3, _x4, _x5, _x6) {\n\t        return _ref2.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _jnxEncoder = __webpack_require__(184);\n\t\n\tvar _leafletLayer = __webpack_require__(122);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tvar _binaryStrings = __webpack_require__(50);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar defaultXHROptions = {\n\t    responseType: 'arraybuffer',\n\t    timeout: 20000,\n\t    isResponseSuccess: function isResponseSuccess(xhr) {\n\t        return xhr.status === 200 || xhr.status === 404;\n\t    }\n\t};\n\t\n\tfunction minZoom(maxZoom) {\n\t    return Math.max(maxZoom - 4, 0);\n\t}\n\t\n\tfunction imageFromarrayBuffer(arr) {\n\t    var dataUrl = 'data:image/png;base64,' + btoa((0, _binaryStrings.arrayBufferToString)(arr));\n\t    var image = new Image();\n\t    return new Promise(function (resolve, reject) {\n\t        image.onload = function () {\n\t            return resolve(image);\n\t        };\n\t        image.onerror = function () {\n\t            return reject(new Error('Tile image corrupt'));\n\t        };\n\t        image.src = dataUrl;\n\t    });\n\t}\n\t\n\tfunction ensureImageJpg(image) {\n\t    if (!image) {\n\t        return null;\n\t    }\n\t    if ((0, _binaryStrings.arrayBufferToString)(image.slice(0, 4)) === '\\x89PNG' && (0, _binaryStrings.arrayBufferToString)(image.slice(-8)) === 'IEND\\xae\\x42\\x60\\x82') {\n\t        return convertToJpeg(image);\n\t    } else if ((0, _binaryStrings.arrayBufferToString)(image.slice(0, 2)) === '\\xff\\xd8' && (0, _binaryStrings.arrayBufferToString)(image.slice(-2)) === '\\xff\\xd9') {\n\t        return Promise.resolve(image);\n\t    } else {\n\t        return null;\n\t    }\n\t}\n\t\n\texports.makeJnxFromLayer = makeJnxFromLayer;\n\texports.minZoom = minZoom;\n\n/***/ },\n/* 186 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.RectangleSelect = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar RectangleSelect = _leaflet2.default.Rectangle.extend({\n\t    includes: _leaflet2.default.Mixin.Events,\n\t\n\t    options: {\n\t        opacity: 1,\n\t        weight: 0.5,\n\t        fillOpacity: 0.2,\n\t        color: '#3388ff',\n\t        fillColor: '#3388ff'\n\t\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        _leaflet2.default.Rectangle.prototype.onAdd.call(this, map);\n\t        this.markers = [];\n\t        var _arr = ['top', 'right', 'bottom', 'left'];\n\t        for (var _i = 0; _i < _arr.length; _i++) {\n\t            var position = _arr[_i];\n\t            var marker = _leaflet2.default.marker([0, 0], {\n\t                icon: _leaflet2.default.divIcon({ className: 'leaflet-rectangle-select-edge edge-' + position }),\n\t                draggable: true\n\t            }).addTo(map);\n\t            marker.on({\n\t                'drag': this.onMarkerDrag,\n\t                'dragend': this.onMarkerDragEnd\n\t            }, this);\n\t            this.markers[position] = marker;\n\t        }\n\t        this.placeMarkers();\n\t        map.on('zoomend', this.placeMarkers, this);\n\t    },\n\t\n\t    placeMarkers: function placeMarkers() {\n\t        var bounds = this.getBounds();\n\t        var topLeftPixel = this._map.project(bounds.getNorthWest());\n\t        var bottomRightPixel = this._map.project(bounds.getSouthEast());\n\t        var size = bottomRightPixel.subtract(topLeftPixel);\n\t        var center = topLeftPixel.add(size.divideBy(2));\n\t        center = this._map.unproject(center);\n\t        this.markers['top'].setLatLng([bounds.getNorth(), center.lng]);\n\t        this.markers['top']._icon.style.width = size.x + 'px';\n\t        this.markers['top']._icon.style.marginLeft = '-' + size.x / 2 + 'px';\n\t        this.markers['right'].setLatLng([center.lat, bounds.getEast()]);\n\t        this.markers['right']._icon.style.height = size.y + 'px';\n\t        this.markers['right']._icon.style.marginTop = '-' + size.y / 2 + 'px';\n\t        this.markers['bottom'].setLatLng([bounds.getSouth(), center.lng]);\n\t        this.markers['bottom']._icon.style.width = size.x + 'px';\n\t        this.markers['bottom']._icon.style.marginLeft = '-' + size.x / 2 + 'px';\n\t        this.markers['left'].setLatLng([center.lat, bounds.getWest()]);\n\t        this.markers['left']._icon.style.height = size.y + 'px';\n\t        this.markers['left']._icon.style.marginTop = '-' + size.y / 2 + 'px';\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = Object.values(this.markers)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var marker = _step.value;\n\t\n\t                this._map.removeLayer(marker);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        this.markers = null;\n\t        map.off('zoomend', this.placeMarkers, this);\n\t        _leaflet2.default.Rectangle.prototype.onRemove.call(this, map);\n\t    },\n\t\n\t    setBoundsFromMarkers: function setBoundsFromMarkers() {\n\t        this.setBounds([[this.markers['top'].getLatLng().lat, this.markers['left'].getLatLng().lng], [this.markers['bottom'].getLatLng().lat, this.markers['right'].getLatLng().lng]]);\n\t    },\n\t    onMarkerDrag: function onMarkerDrag() {\n\t        this.setBoundsFromMarkers();\n\t    },\n\t\n\t    onMarkerDragEnd: function onMarkerDragEnd() {\n\t        this.setBoundsFromMarkers();\n\t        this.placeMarkers();\n\t        this.fire('change');\n\t    }\n\t});\n\t\n\texports.RectangleSelect = RectangleSelect;\n\n/***/ },\n/* 187 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(450);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction enableAdaptiveHeight(control) {\n\t    if (control._adaptiveHeightEnabled) {\n\t        return;\n\t    }\n\t    var originalOnAdd = control.onAdd;\n\t\n\t    _leaflet2.default.Util.extend(control, {\n\t        _adaptiveHeightEnabled: true,\n\t\n\t        onAdd: function onAdd(map) {\n\t            var _this = this;\n\t\n\t            var result = originalOnAdd.call(this, map);\n\t            this.__setupResizeEventsHandler();\n\t            setTimeout(function () {\n\t                return _this.__setAdaptiveHeight();\n\t            }, 0);\n\t            return result;\n\t        },\n\t\n\t        __setupResizeEventsHandler: function __setupResizeEventsHandler() {\n\t            this._map.on('resize', this.__setAdaptiveHeight, this);\n\t        },\n\t\n\t        __setAdaptiveHeight: function __setAdaptiveHeight() {\n\t            var mapHeight = this._map.getSize().y;\n\t            var maxHeight = void 0;\n\t            maxHeight = mapHeight - this._container.offsetTop // controls above\n\t            - (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) //controls below\n\t            - 70; // margin\n\t            this._form.style.maxHeight = maxHeight + 'px';\n\t        }\n\t    });\n\t\n\t    if (control._map) {\n\t        control.__setupResizeEventsHandler();\n\t        setTimeout(function () {\n\t            return control.__setAdaptiveHeight();\n\t        }, 0);\n\t    }\n\t\n\t    return control;\n\t}\n\t\n\texports.default = enableAdaptiveHeight;\n\n/***/ },\n/* 188 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(451);\n\t\n\tvar _leafletControlLayers = __webpack_require__(116);\n\t\n\tvar _leafletControlLayers2 = _interopRequireDefault(_leafletControlLayers);\n\t\n\tvar _knockout = __webpack_require__(51);\n\t\n\tvar _knockout2 = _interopRequireDefault(_knockout);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tvar _safeLocalstorage = __webpack_require__(63);\n\t\n\tvar _safeLocalstorage2 = _interopRequireDefault(_safeLocalstorage);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction enableConfig(control, layers) {\n\t    var _ref;\n\t\n\t    var originalOnAdd = control.onAdd;\n\t    var originalUnserializeState = control.unserializeState;\n\t    var originalAddItem = control._addItem;\n\t    if (control._configEnabled) {\n\t        return;\n\t    }\n\t    (0, _leafletControlLayers2.default)(control);\n\t\n\t    _leaflet2.default.Util.extend(control, {\n\t        _configEnabled: true,\n\t        _allLayersGroups: layers,\n\t        _allLayers: (_ref = []).concat.apply(_ref, _toConsumableArray(layers.map(function (group) {\n\t            return group.layers;\n\t        }))),\n\t        _customLayers: _knockout2.default.observableArray(),\n\t\n\t        onAdd: function onAdd(map) {\n\t            var container = originalOnAdd.call(this, map);\n\t            this.__injectConfigButton();\n\t            return container;\n\t        },\n\t\n\t        __injectConfigButton: function __injectConfigButton() {\n\t            var configButton = _leaflet2.default.DomUtil.create('div', 'button icon-settings');\n\t            configButton.title = 'Configure layers';\n\t            this._topRow.appendChild(configButton);\n\t            _leaflet2.default.DomEvent.on(configButton, 'click', this._onConfigButtonClick, this);\n\t\n\t            var newCustomLayerButton = _leaflet2.default.DomUtil.create('div', 'button icon-edit');\n\t            newCustomLayerButton.title = 'Add custom layer';\n\t            this._topRow.appendChild(newCustomLayerButton);\n\t            _leaflet2.default.DomEvent.on(newCustomLayerButton, 'click', this.onCustomLayerCreateClicked, this);\n\t        },\n\t\n\t        _initializeLayersState: function _initializeLayersState() {\n\t            var _this = this;\n\t\n\t            var storedLayersEnabled = {};\n\t            var serialized = _safeLocalstorage2.default.getItem('layersEnabled');\n\t            if (serialized) {\n\t                try {\n\t                    storedLayersEnabled = JSON.parse(serialized);\n\t                } catch (e) {\n\t                    _logging2.default.captureMessage('Failed to load enabled layers from localstorage - invalid json', {\n\t                        extra: { \"localstorage.layersEnabled\": serialized.slice(0, 1000) }\n\t                    });\n\t                }\n\t            }\n\t            // restore custom layers\n\t            Object.keys(storedLayersEnabled).forEach(function (code) {\n\t                return _this.loadCustomLayerFromString(code);\n\t            });\n\t\n\t            var _arr = [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers()));\n\t\n\t            for (var _i = 0; _i < _arr.length; _i++) {\n\t                var layer = _arr[_i];\n\t                var enabled = storedLayersEnabled[layer.layer.options.code];\n\t                // if storage is empty enable only default layers\n\t                // if new default layer appears it will be enabled\n\t                if (typeof enabled === 'undefined') {\n\t                    enabled = layer.isDefault;\n\t                }\n\t                layer.enabled = enabled;\n\t                layer.checked = _knockout2.default.observable(enabled);\n\t                layer.description = layer.description || '';\n\t            }\n\t            this.updateEnabledLayers();\n\t        },\n\t\n\t        _onConfigButtonClick: function _onConfigButtonClick() {\n\t            this.showLayersSelectWindow();\n\t        },\n\t\n\t        _initLayersSelectWindow: function _initLayersSelectWindow() {\n\t            if (this._configWindow) {\n\t                return;\n\t            }\n\t\n\t            var container = this._configWindow = _leaflet2.default.DomUtil.create('div', 'leaflet-layers-dialog-wrapper');\n\t            _leaflet2.default.DomEvent.disableClickPropagation(container).disableScrollPropagation(container);\n\t            container.innerHTML = '\\n<div class=\"leaflet-layers-select-window\">\\n    <form>\\n        <!-- ko foreach: _allLayersGroups -->\\n            <div class=\"section-header\" data-bind=\"html: group\"></div>\\n            <!-- ko foreach: layers -->\\n                <label>\\n                    <input type=\"checkbox\" data-bind=\"checked: checked\"/>\\n                    <span data-bind=\"text: title\">\\n                    </span><!--  ko if: description -->\\n                    <span data-bind=\"html: description || \\'\\'\"></span>\\n                    <!-- /ko -->\\n                </label>\\n            <!-- /ko -->\\n        <!-- /ko -->\\n        <div data-bind=\"if: _customLayers().length\" class=\"section-header\">Custom layers</div>\\n        <!-- ko foreach: _customLayers -->\\n                <label>\\n                    <input type=\"checkbox\" data-bind=\"checked: checked\"/>\\n                    <span data-bind=\"text: title\"></span>\\n                </label>\\n        <!-- /ko -->\\n    </form>\\n    <div class=\"buttons-row\">\\n        <div href=\"#\" class=\"button\" data-bind=\"click: onSelectWindowOkClicked\">Ok</div>\\n        <div href=\"#\" class=\"button\" data-bind=\"click: onSelectWindowCancelClicked\">Cancel</div>\\n        <div href=\"#\" class=\"button\" data-bind=\"click: onSelectWindowResetClicked\">Reset</div>\\n    </div>            \\n</div>\\n                ';\n\t            _knockout2.default.applyBindings(this, container);\n\t        },\n\t\n\t        showLayersSelectWindow: function showLayersSelectWindow() {\n\t            if (this._configWindowVisible) {\n\t                return;\n\t            }\n\t            [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers())).forEach(function (layer) {\n\t                return layer.checked(layer.enabled);\n\t            });\n\t            this._initLayersSelectWindow();\n\t            this._map._controlContainer.appendChild(this._configWindow);\n\t            this._configWindowVisible = true;\n\t        },\n\t\n\t        hideSelectWindow: function hideSelectWindow() {\n\t            if (!this._configWindowVisible) {\n\t                return;\n\t            }\n\t            this._map._controlContainer.removeChild(this._configWindow);\n\t            this._configWindowVisible = false;\n\t        },\n\t\n\t        onSelectWindowCancelClicked: function onSelectWindowCancelClicked() {\n\t            this.hideSelectWindow();\n\t        },\n\t\n\t        onSelectWindowResetClicked: function onSelectWindowResetClicked() {\n\t            if (!this._configWindow) {\n\t                return;\n\t            }\n\t            [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers())).forEach(function (layer) {\n\t                return layer.checked(layer.isDefault);\n\t            });\n\t        },\n\t\n\t        onSelectWindowOkClicked: function onSelectWindowOkClicked() {\n\t            [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers())).forEach(function (layer) {\n\t                return layer.enabled = layer.checked();\n\t            });\n\t            this.updateEnabledLayers();\n\t            this.hideSelectWindow();\n\t        },\n\t\n\t        onCustomLayerCreateClicked: function onCustomLayerCreateClicked() {\n\t            var _this2 = this;\n\t\n\t            this.showCustomLayerForm([{\n\t                caption: 'Add layer',\n\t                callback: function callback(fieldValues) {\n\t                    return _this2.onCustomLayerAddClicked(fieldValues);\n\t                }\n\t            }, {\n\t                caption: 'Cancel',\n\t                callback: function callback() {\n\t                    return _this2.onCustomLayerCancelClicked();\n\t                }\n\t            }], {\n\t                name: 'Custom layer',\n\t                url: '',\n\t                tms: false,\n\t                maxZoom: 18,\n\t                isOverlay: false,\n\t                scaleDependent: false\n\t            });\n\t        },\n\t\n\t        updateEnabledLayers: function updateEnabledLayers() {\n\t            var _this3 = this;\n\t\n\t            var disabledLayers = [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers())).filter(function (l) {\n\t                return !l.enabled;\n\t            });\n\t            disabledLayers.forEach(function (l) {\n\t                return _this3._map.removeLayer(l.layer);\n\t            });\n\t            [].concat(_toConsumableArray(this._layers)).forEach(function (l) {\n\t                return _this3.removeLayer(l.layer);\n\t            });\n\t\n\t            var hasBaselayerOnMap = false;\n\t            var enabledLayers = [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers())).filter(function (l) {\n\t                return l.enabled;\n\t            });\n\t            enabledLayers.sort(function (l1, l2) {\n\t                return l1.order - l2.order;\n\t            });\n\t            enabledLayers.forEach(function (l) {\n\t                l.isOverlay ? _this3.addOverlay(l.layer, l.title) : _this3.addBaseLayer(l.layer, l.title);\n\t                if (!l.isOverlay && _this3._map.hasLayer(l.layer)) {\n\t                    hasBaselayerOnMap = true;\n\t                }\n\t            });\n\t            // если нет активного базового слоя, включить первый, если он есть\n\t            if (!hasBaselayerOnMap) {\n\t                var _iteratorNormalCompletion = true;\n\t                var _didIteratorError = false;\n\t                var _iteratorError = undefined;\n\t\n\t                try {\n\t                    for (var _iterator = enabledLayers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                        var layer = _step.value;\n\t\n\t                        if (!layer.isOverlay) {\n\t                            this._map.addLayer(layer.layer);\n\t                            break;\n\t                        }\n\t                    }\n\t                } catch (err) {\n\t                    _didIteratorError = true;\n\t                    _iteratorError = err;\n\t                } finally {\n\t                    try {\n\t                        if (!_iteratorNormalCompletion && _iterator.return) {\n\t                            _iterator.return();\n\t                        }\n\t                    } finally {\n\t                        if (_didIteratorError) {\n\t                            throw _iteratorError;\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t            this.storeEnabledLayers();\n\t        },\n\t\n\t        storeEnabledLayers: function storeEnabledLayers() {\n\t            var layersState = {};\n\t\n\t            var _arr2 = [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers()));\n\t\n\t            for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n\t                var layer = _arr2[_i2];\n\t                if (layer.isDefault || layer.enabled || layer.isCustom) {\n\t                    layersState[layer.layer.options.code] = layer.enabled;\n\t                }\n\t            }\n\t            var serialized = JSON.stringify(layersState);\n\t            _safeLocalstorage2.default.setItem('layersEnabled', serialized);\n\t        },\n\t\n\t        unserializeState: function unserializeState(values) {\n\t            var _this4 = this;\n\t\n\t            if (values) {\n\t                values = values.map(function (code) {\n\t                    var newCode = _this4.loadCustomLayerFromString(code);\n\t                    return newCode || code;\n\t                });\n\t\n\t                var _arr3 = [].concat(_toConsumableArray(this._allLayers), _toConsumableArray(this._customLayers()));\n\t\n\t                for (var _i3 = 0; _i3 < _arr3.length; _i3++) {\n\t                    var layer = _arr3[_i3];\n\t                    if (layer.layer.options && values.includes(layer.layer.options.code)) {\n\t                        layer.enabled = true;\n\t                    }\n\t                }\n\t                this.updateEnabledLayers();\n\t            }\n\t            this.storeEnabledLayers();\n\t            return originalUnserializeState.call(this, values);\n\t        },\n\t\n\t        showCustomLayerForm: function showCustomLayerForm(buttons, fieldValues) {\n\t            if (this._customLayerWindow) {\n\t                return;\n\t            }\n\t            this._customLayerWindow = _leaflet2.default.DomUtil.create('div', 'leaflet-layers-dialog-wrapper', this._map._controlContainer);\n\t\n\t            _leaflet2.default.DomEvent.disableClickPropagation(this._customLayerWindow).disableScrollPropagation(this._customLayerWindow);\n\t\n\t            var customLayerWindow = _leaflet2.default.DomUtil.create('div', 'custom-layers-window', this._customLayerWindow);\n\t            var form = _leaflet2.default.DomUtil.create('form', '', customLayerWindow);\n\t\n\t            var buttonsHtml = '';\n\t            var _iteratorNormalCompletion2 = true;\n\t            var _didIteratorError2 = false;\n\t            var _iteratorError2 = undefined;\n\t\n\t            try {\n\t                for (var _iterator2 = buttons.entries()[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                    var _step2$value = _slicedToArray(_step2.value, 2),\n\t                        i = _step2$value[0],\n\t                        button = _step2$value[1];\n\t\n\t                    buttonsHtml += '<a class=\"button\" name=\"btn-' + i + '\">' + button.caption + '</a>';\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError2 = true;\n\t                _iteratorError2 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                        _iterator2.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError2) {\n\t                        throw _iteratorError2;\n\t                    }\n\t                }\n\t            }\n\t\n\t            _leaflet2.default.DomEvent.on(form, 'submit', _leaflet2.default.DomEvent.preventDefault);\n\t            form.innerHTML = '\\n<p><a href=\"http://leafletjs.com/reference-1.0.2.html#tilelayer\" target=\"_blank\">See Leaflet TileLayer documentation for url format</a></p>\\n<label>Layer name<br/>\\n<input name=\"name\"/></label><br/>\\n<label>Tile url template<br/>\\n<textarea name=\"url\" style=\"width: 100%\"></textarea></label><br/>\\n<label><input type=\"radio\" name=\"overlay\" value=\"no\">Base layer</label><br/>\\n<label><input type=\"radio\" name=\"overlay\" value=\"yes\">Overlay</label><br/>\\n<label><input type=\"checkbox\" name=\"scaleDependent\"/>Content depends on scale(like OSM or Google maps)</label><br/>\\n<label><input type=\"checkbox\" name=\"tms\" />TMS rows order</label><br />\\n\\n<label>Max zoom<br>\\n<select name=\"maxZoom\">\\n<option value=\"9\">9</option>\\n<option value=\"10\">10</option>\\n<option value=\"11\">11</option>\\n<option value=\"12\">12</option>\\n<option value=\"13\">13</option>\\n<option value=\"14\">14</option>\\n<option value=\"15\">15</option>\\n<option value=\"16\">16</option>\\n<option value=\"17\">17</option>\\n<option value=\"18\" selected>18</option>\\n</select></label>\\n<br />\\n' + buttonsHtml;\n\t\n\t            form.name.value = fieldValues.name;\n\t            form.url.value = fieldValues.url;\n\t            form.tms.checked = fieldValues.tms;\n\t            form.scaleDependent.checked = fieldValues.scaleDependent;\n\t            form.maxZoom.value = fieldValues.maxZoom;\n\t            form.overlay[fieldValues.isOverlay ? 1 : 0].checked = true;\n\t\n\t            function buttonClicked(callback) {\n\t                var fieldValues = {\n\t                    name: form.name.value.trim(),\n\t                    url: form.url.value.trim(),\n\t                    tms: form.tms.checked,\n\t                    scaleDependent: form.scaleDependent.checked,\n\t                    maxZoom: form.maxZoom.value,\n\t                    isOverlay: form.querySelector('input[name=\"overlay\"]:checked').value === 'yes'\n\t                };\n\t                callback(fieldValues);\n\t            }\n\t\n\t            var _iteratorNormalCompletion3 = true;\n\t            var _didIteratorError3 = false;\n\t            var _iteratorError3 = undefined;\n\t\n\t            try {\n\t                for (var _iterator3 = buttons.entries()[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                    var _step3$value = _slicedToArray(_step3.value, 2),\n\t                        i = _step3$value[0],\n\t                        button = _step3$value[1];\n\t\n\t                    var buttonEl = form.querySelector('[name=\"btn-' + i + '\"]');\n\t                    _leaflet2.default.DomEvent.on(buttonEl, 'click', buttonClicked.bind(this, button.callback));\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError3 = true;\n\t                _iteratorError3 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                        _iterator3.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError3) {\n\t                        throw _iteratorError3;\n\t                    }\n\t                }\n\t            }\n\t        },\n\t\n\t        _addItem: function _addItem(obj) {\n\t            var _this5 = this;\n\t\n\t            var label = originalAddItem.call(this, obj);\n\t            if (obj.layer.__customLayer) {\n\t                var editButton = _leaflet2.default.DomUtil.create('div', 'custom-layer-edit-button icon-edit', label.children[0]);\n\t                editButton.title = 'Edit layer';\n\t                _leaflet2.default.DomEvent.on(editButton, 'click', function (e) {\n\t                    return _this5.onCustomLayerEditClicked(obj.layer.__customLayer, e);\n\t                });\n\t            }\n\t            return label;\n\t        },\n\t\n\t        serializeCustomLayer: function serializeCustomLayer(fieldValues) {\n\t            var s = JSON.stringify(fieldValues);\n\t            s = s.replace(/[\\u007f-\\uffff]/g, function (c) {\n\t                return '\\\\u' + ('0000' + c.charCodeAt(0).toString(16)).slice(-4);\n\t            });\n\t\n\t            function encodeUrlSafeBase64(s) {\n\t                return btoa(s).replace(/\\+/g, '-').replace(/\\//g, '_');\n\t            }\n\t\n\t            return '-cs' + encodeUrlSafeBase64(s);\n\t        },\n\t\n\t        customLayerExists: function customLayerExists(fieldValues, ignoreLayer) {\n\t            var serialized = this.serializeCustomLayer(fieldValues);\n\t            var _iteratorNormalCompletion4 = true;\n\t            var _didIteratorError4 = false;\n\t            var _iteratorError4 = undefined;\n\t\n\t            try {\n\t                for (var _iterator4 = this._customLayers()[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t                    var layer = _step4.value;\n\t\n\t                    if (layer !== ignoreLayer && layer.serialized === serialized) {\n\t                        return layer;\n\t                    }\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError4 = true;\n\t                _iteratorError4 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                        _iterator4.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError4) {\n\t                        throw _iteratorError4;\n\t                    }\n\t                }\n\t            }\n\t\n\t            return false;\n\t        },\n\t\n\t        checkCustomLayerValues: function checkCustomLayerValues(fieldValues) {\n\t            if (!fieldValues.url) {\n\t                return { 'error': 'Url is empty' };\n\t            }\n\t            if (!fieldValues.name) {\n\t                return { 'error': 'Name is empty' };\n\t            }\n\t            return {};\n\t        },\n\t\n\t        onCustomLayerAddClicked: function onCustomLayerAddClicked(fieldValues) {\n\t            var error = this.checkCustomLayerValues(fieldValues).error;\n\t            if (error) {\n\t                (0, _notifications.notify)(error);\n\t                return;\n\t            }\n\t\n\t            var duplicateLayer = this.customLayerExists(fieldValues);\n\t            if (duplicateLayer) {\n\t                var msg = 'Same layer already exists';\n\t                if (!duplicateLayer.enabled) {\n\t                    msg += ' but it is hidden. You can enable it in layers setting.';\n\t                }\n\t                (0, _notifications.notify)(msg);\n\t                return;\n\t            }\n\t\n\t            var layer = this.createCustomLayer(fieldValues);\n\t            layer.enabled = true;\n\t            layer.checked = _knockout2.default.observable(true);\n\t            this._customLayers.push(layer);\n\t            this.hideCustomLayerForm();\n\t            this.updateEnabledLayers();\n\t        },\n\t\n\t        createCustomLayer: function createCustomLayer(fieldValues, position, ignoreExists) {\n\t            var serialized = this.serializeCustomLayer(fieldValues);\n\t            var tileLayer = _leaflet2.default.tileLayer(fieldValues.url, {\n\t                tms: fieldValues.tms,\n\t                maxNativeZoom: fieldValues.maxZoom,\n\t                scaleDependent: fieldValues.scaleDependent,\n\t                print: true,\n\t                jnx: true,\n\t                code: serialized,\n\t                noCors: true\n\t            });\n\t\n\t            var customLayer = {\n\t                title: fieldValues.name,\n\t                isOverlay: fieldValues.isOverlay,\n\t                isDefault: false,\n\t                isCustom: true,\n\t                serialized: serialized,\n\t                layer: tileLayer,\n\t                order: 10000,\n\t                fieldValues: fieldValues,\n\t                enabled: true,\n\t                checked: _knockout2.default.observable(true)\n\t            };\n\t            tileLayer.__customLayer = customLayer;\n\t            return customLayer;\n\t        },\n\t\n\t        onCustomLayerCancelClicked: function onCustomLayerCancelClicked() {\n\t            this.hideCustomLayerForm();\n\t        },\n\t\n\t        hideCustomLayerForm: function hideCustomLayerForm() {\n\t            if (!this._customLayerWindow) {\n\t                return;\n\t            }\n\t            this._customLayerWindow.parentNode.removeChild(this._customLayerWindow);\n\t            this._customLayerWindow = null;\n\t        },\n\t\n\t        onCustomLayerEditClicked: function onCustomLayerEditClicked(layer, e) {\n\t            var _this6 = this;\n\t\n\t            _leaflet2.default.DomEvent.stop(e);\n\t            this.showCustomLayerForm([{ caption: 'Save', callback: function callback(fieldValues) {\n\t                    return _this6.onCustomLayerChangeClicked(layer, fieldValues);\n\t                } }, { caption: 'Delete', callback: function callback(fieldValues) {\n\t                    return _this6.onCustomLayerDeletelClicked(layer);\n\t                } }, { caption: 'Cancel', callback: function callback() {\n\t                    return _this6.onCustomLayerCancelClicked();\n\t                } }], layer.fieldValues);\n\t        },\n\t\n\t        onCustomLayerChangeClicked: function onCustomLayerChangeClicked(layer, newFieldValues) {\n\t            var error = this.checkCustomLayerValues(newFieldValues).error;\n\t            if (error) {\n\t                (0, _notifications.notify)(error);\n\t                return;\n\t            }\n\t            var duplicateLayer = this.customLayerExists(newFieldValues, layer);\n\t            if (duplicateLayer) {\n\t                var msg = 'Same layer already exists';\n\t                if (!duplicateLayer.enabled) {\n\t                    msg += ' but it is hidden. You can enable it in layers setting.';\n\t                }\n\t                (0, _notifications.notify)(msg);\n\t                return;\n\t            }\n\t\n\t            var layerPos = this._customLayers.indexOf(layer);\n\t            this._customLayers.remove(layer);\n\t\n\t            var newLayer = this.createCustomLayer(newFieldValues);\n\t            this._customLayers.splice(layerPos, 0, newLayer);\n\t            if (this._map.hasLayer(layer.layer) && (!layer.isOverlay || newLayer.isOverlay)) {\n\t                this._map.addLayer(newLayer.layer);\n\t            }\n\t            this._map.removeLayer(layer.layer);\n\t            this.updateEnabledLayers();\n\t            this.hideCustomLayerForm();\n\t        },\n\t\n\t        onCustomLayerDeletelClicked: function onCustomLayerDeletelClicked(layer) {\n\t            this._map.removeLayer(layer.layer);\n\t            this._customLayers.remove(layer);\n\t            this.updateEnabledLayers();\n\t            this.hideCustomLayerForm();\n\t        },\n\t\n\t        loadCustomLayerFromString: function loadCustomLayerFromString(s) {\n\t            var fieldValues = void 0;\n\t            var m = s.match(/^-cs(.+)$/);\n\t            if (m) {\n\t                s = m[1].replace(/-/g, '+').replace(/_/g, '/');\n\t                try {\n\t                    s = atob(s);\n\t                    fieldValues = JSON.parse(s);\n\t                } catch (e) {}\n\t\n\t                if (fieldValues) {\n\t                    if (!this.customLayerExists(fieldValues)) {\n\t                        this._customLayers.push(this.createCustomLayer(fieldValues));\n\t                    }\n\t                    return this.serializeCustomLayer(fieldValues);\n\t                }\n\t            }\n\t        }\n\t\n\t    });\n\t    if (control._map) {\n\t        control.__injectConfigButton();\n\t    }\n\t    control._initializeLayersState();\n\t}\n\t\n\texports.default = enableConfig;\n\n/***/ },\n/* 189 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(31);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar originalLayerOnAdd = _leaflet2.default.Control.Layers.prototype.onAdd;\n\t\n\t_leaflet2.default.Control.Layers.include({\n\t    onAdd: function onAdd(map) {\n\t        var container = originalLayerOnAdd.call(this, map);\n\t        this._stopContainerEvents();\n\t        return container;\n\t    }\n\t});\n\t\n\tvar originalZoomOnAdd = _leaflet2.default.Control.Zoom.prototype.onAdd;\n\t\n\t_leaflet2.default.Control.Zoom.include({\n\t    onAdd: function onAdd(map) {\n\t        var container = originalZoomOnAdd.call(this, map);\n\t        this._container = container;\n\t        this._stopContainerEvents();\n\t        return container;\n\t    }\n\t});\n\n/***/ },\n/* 190 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(453);\n\t\n\t__webpack_require__(38);\n\t\n\tvar _leafletControlLayers = __webpack_require__(116);\n\t\n\tvar _leafletControlLayers2 = _interopRequireDefault(_leafletControlLayers);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction enableMinimize(control) {\n\t    var originalOnAdd = control.onAdd;\n\t    if (control._minimizeEnabled) {\n\t        return;\n\t    }\n\t    (0, _leafletControlLayers2.default)(control);\n\t\n\t    _leaflet2.default.Util.extend(control, {\n\t        _minimizeEnabled: true,\n\t\n\t        onAdd: function onAdd(map) {\n\t            var _this = this;\n\t\n\t            var container = originalOnAdd.call(this, map);\n\t            setTimeout(function () {\n\t                return _this.__injectMinimizeButtons();\n\t            }, 0);\n\t            return container;\n\t        },\n\t\n\t        __injectMinimizeButtons: function __injectMinimizeButtons() {\n\t            var container = this._container;\n\t            var contentsWrapper = _leaflet2.default.DomUtil.create('div', 'leaflet-control-content');\n\t            while (container.childNodes.length) {\n\t                contentsWrapper.appendChild(container.childNodes[0]);\n\t            }\n\t            container.appendChild(contentsWrapper);\n\t            var minimizeButton = _leaflet2.default.DomUtil.create('div', 'button-minimize');\n\t            this._topRow.appendChild(minimizeButton);\n\t            var expandButton = _leaflet2.default.DomUtil.create('div', 'leaflet-control-button-toggle', container);\n\t            expandButton.title = 'Select layers';\n\t            _leaflet2.default.DomEvent.on(expandButton, 'click', this.setExpanded, this);\n\t            _leaflet2.default.DomEvent.on(minimizeButton, 'click', this.setMinimized, this);\n\t        },\n\t\n\t        setExpanded: function setExpanded() {\n\t            _leaflet2.default.DomUtil.removeClass(this._container, 'minimized');\n\t        },\n\t\n\t        setMinimized: function setMinimized() {\n\t            _leaflet2.default.DomUtil.addClass(this._container, 'minimized');\n\t        }\n\t    });\n\t    if (control._map) {\n\t        control.__injectMinimizeButtons();\n\t    }\n\t}\n\t\n\texports.default = enableMinimize;\n\n/***/ },\n/* 191 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(457);\n\t\n\t__webpack_require__(38);\n\t\n\tvar _knockout = __webpack_require__(51);\n\t\n\tvar _knockout2 = _interopRequireDefault(_knockout);\n\t\n\tvar _google = __webpack_require__(192);\n\t\n\tvar _google2 = _interopRequireDefault(_google);\n\t\n\tvar _mapillary = __webpack_require__(193);\n\t\n\tvar _mapillary2 = _interopRequireDefault(_mapillary);\n\t\n\tvar _wikimedia = __webpack_require__(199);\n\t\n\tvar _wikimedia2 = _interopRequireDefault(_wikimedia);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction fireRefreshEventOnWindow() {\n\t    var evt = document.createEvent(\"HTMLEvents\");\n\t    evt.initEvent('resize', true, false);\n\t    window.dispatchEvent(evt);\n\t}\n\t\n\tvar PanoMarker = _leaflet2.default.Marker.extend({\n\t    options: {\n\t        zIndexOffset: 10000\n\t    },\n\t\n\t    initialize: function initialize() {\n\t        var icon = _leaflet2.default.divIcon({\n\t            className: 'leaflet-panorama-marker-wraper',\n\t            html: '<div class=\"leaflet-panorama-marker\"></div>'\n\t        });\n\t        _leaflet2.default.Marker.prototype.initialize.call(this, [0, 0], { icon: icon, interactive: false });\n\t    },\n\t\n\t    getIcon: function getIcon() {\n\t        var markerIcon = this.getElement();\n\t        markerIcon = markerIcon.children[0];\n\t        return markerIcon;\n\t    },\n\t\n\t    setHeading: function setHeading(angle) {\n\t        var markerIcon = this.getIcon();\n\t        markerIcon.style.transform = 'rotate(' + (angle || 0) + 'deg)';\n\t    },\n\t\n\t    setType: function setType(markerType) {\n\t        var className = {\n\t            'slim': 'leaflet-panorama-marker-circle',\n\t            'normal': 'leaflet-panorama-marker-binocular' }[markerType];\n\t        this.getIcon().className = className;\n\t    }\n\t});\n\t\n\t_leaflet2.default.Control.Panoramas = _leaflet2.default.Control.extend({\n\t    includes: _leaflet2.default.Mixin.Events,\n\t\n\t    options: {\n\t        position: 'topleft'\n\t    },\n\t\n\t    getProviders: function getProviders() {\n\t        return [{ name: 'google', title: 'Google street view', provider: _google2.default, layerOptions: { zIndex: 10 },\n\t            code: 'g',\n\t            selected: _knockout2.default.observable(true),\n\t            mapMarkerType: 'normal' }, { name: 'wikimedia', title: 'Wikimedia commons', provider: _wikimedia2.default,\n\t            layerOptions: { opacity: 0.7, zIndex: 9 },\n\t            code: 'w',\n\t            selected: _knockout2.default.observable(false),\n\t            mapMarkerType: 'slim'\n\t        }, { name: 'mapillary', title: 'Mapillary', provider: _mapillary2.default,\n\t            layerOptions: { opacity: 0.7, zIndex: 8 },\n\t            code: 'm',\n\t            selected: _knockout2.default.observable(false),\n\t            mapMarkerType: 'normal' }];\n\t    },\n\t\n\t    initialize: function initialize(panoramaContainer, options) {\n\t        _leaflet2.default.Control.prototype.initialize.call(this, options);\n\t        this._panoramaContainer = panoramaContainer;\n\t        this.providers = this.getProviders();\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = this.providers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var provider = _step.value;\n\t\n\t                provider.selected.subscribe(this.updateCoverageVisibility, this);\n\t                provider.container = _leaflet2.default.DomUtil.create('div', 'panorama-container', panoramaContainer);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        this.nearbyPoints = [];\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'leaflet-control leaflet-contol-panoramas');\n\t        container.innerHTML = '\\n                <a name=\"button\" class=\"panoramas-button leaflet-control-button icon-panoramas\" title=\"Show panoramas\"\\n                    data-bind=\"click: onButtonClick\"></a>\\n                <div class=\"panoramas-list control-form\" data-bind=\"foreach: providers\">\\n                    <div><label><input type=\"checkbox\" data-bind=\"checked: selected\"><span data-bind=\"text: title\"></span></label></div>\\n                </div>\\n            ';\n\t        this._stopContainerEvents();\n\t        _knockout2.default.applyBindings(this, container);\n\t        map.createPane('rasterOverlay').style.zIndex = 300;\n\t        return container;\n\t    },\n\t\n\t    onButtonClick: function onButtonClick() {\n\t        if (this.controlEnabled) {\n\t            this.disableControl();\n\t        } else {\n\t            this.enableControl();\n\t        }\n\t    },\n\t\n\t    enableControl: function enableControl() {\n\t        if (this.controlEnabled) {\n\t            return;\n\t        }\n\t        this.controlEnabled = true;\n\t        _leaflet2.default.DomUtil.addClass(this._container, 'enabled');\n\t        this.updateCoverageVisibility();\n\t        this._map.on('click', this.onMapClick, this);\n\t        _leaflet2.default.DomUtil.addClass(this._map._container, 'panoramas-control-active');\n\t        this.notifyChanged();\n\t    },\n\t\n\t    disableControl: function disableControl() {\n\t        if (!this.controlEnabled) {\n\t            return;\n\t        }\n\t        this.controlEnabled = false;\n\t        _leaflet2.default.DomUtil.removeClass(this._container, 'enabled');\n\t        this.updateCoverageVisibility();\n\t        this._map.off('click', this.onMapClick, this);\n\t        this.hidePanoViewer();\n\t        _leaflet2.default.DomUtil.removeClass(this._map._container, 'panoramas-control-active');\n\t        this.notifyChanged();\n\t    },\n\t\n\t    updateCoverageVisibility: function updateCoverageVisibility() {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        var _iteratorNormalCompletion2 = true;\n\t        var _didIteratorError2 = false;\n\t        var _iteratorError2 = undefined;\n\t\n\t        try {\n\t            for (var _iterator2 = this.providers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                var provider = _step2.value;\n\t\n\t                if (this.controlEnabled && provider.selected()) {\n\t                    if (!provider.coverageLayer) {\n\t                        var options = _leaflet2.default.extend({ pane: 'rasterOverlay' }, provider.layerOptions);\n\t                        provider.coverageLayer = provider.provider.getCoverageLayer(options);\n\t                    }\n\t                    provider.coverageLayer.addTo(this._map);\n\t                } else {\n\t                    if (provider.coverageLayer) {\n\t                        this._map.removeLayer(provider.coverageLayer);\n\t                    }\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError2 = true;\n\t            _iteratorError2 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                    _iterator2.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError2) {\n\t                    throw _iteratorError2;\n\t                }\n\t            }\n\t        }\n\t\n\t        this.notifyChanged();\n\t    },\n\t\n\t    showPanoramaContainer: function showPanoramaContainer() {\n\t        _leaflet2.default.DomUtil.addClass(this._panoramaContainer, 'enabled');\n\t        fireRefreshEventOnWindow();\n\t    },\n\t\n\t    panoramaVisible: function panoramaVisible() {\n\t        if (_leaflet2.default.DomUtil.hasClass(this._panoramaContainer, 'enabled')) {\n\t            var _iteratorNormalCompletion3 = true;\n\t            var _didIteratorError3 = false;\n\t            var _iteratorError3 = undefined;\n\t\n\t            try {\n\t                for (var _iterator3 = this.providers[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                    var provider = _step3.value;\n\t\n\t                    if (_leaflet2.default.DomUtil.hasClass(provider.container, 'enabled')) {\n\t                        return provider;\n\t                    }\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError3 = true;\n\t                _iteratorError3 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                        _iterator3.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError3) {\n\t                        throw _iteratorError3;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t        return false;\n\t    },\n\t\n\t    setupNearbyPoints: function setupNearbyPoints(points) {\n\t        var _iteratorNormalCompletion4 = true;\n\t        var _didIteratorError4 = false;\n\t        var _iteratorError4 = undefined;\n\t\n\t        try {\n\t            for (var _iterator4 = this.nearbyPoints[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t                var point = _step4.value;\n\t\n\t                this._map.removeLayer(point);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError4 = true;\n\t            _iteratorError4 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                    _iterator4.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError4) {\n\t                    throw _iteratorError4;\n\t                }\n\t            }\n\t        }\n\t\n\t        this.nearbyPoints = [];\n\t        if (points) {\n\t            var icon = _leaflet2.default.divIcon({ className: 'leaflet-panorama-marker-point' });\n\t            var _iteratorNormalCompletion5 = true;\n\t            var _didIteratorError5 = false;\n\t            var _iteratorError5 = undefined;\n\t\n\t            try {\n\t                for (var _iterator5 = points[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n\t                    var latlng = _step5.value;\n\t\n\t                    this.nearbyPoints.push(_leaflet2.default.marker(latlng, { icon: icon }).addTo(this._map));\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError5 = true;\n\t                _iteratorError5 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion5 && _iterator5.return) {\n\t                        _iterator5.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError5) {\n\t                        throw _iteratorError5;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    },\n\t\n\t    hidePano: function hidePano(provider) {\n\t        _leaflet2.default.DomUtil.removeClass(provider.container, 'enabled');\n\t        if (provider.viewer) {\n\t            provider.viewer.deactivate();\n\t        }\n\t        this.setupNearbyPoints();\n\t    },\n\t\n\t    showPano: function () {\n\t        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(provider, data) {\n\t            var _iteratorNormalCompletion6, _didIteratorError6, _iteratorError6, _iterator6, _step6, otherProvider;\n\t\n\t            return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                while (1) {\n\t                    switch (_context.prev = _context.next) {\n\t                        case 0:\n\t                            this.showPanoramaContainer();\n\t                            _iteratorNormalCompletion6 = true;\n\t                            _didIteratorError6 = false;\n\t                            _iteratorError6 = undefined;\n\t                            _context.prev = 4;\n\t                            for (_iterator6 = this.providers[Symbol.iterator](); !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n\t                                otherProvider = _step6.value;\n\t\n\t                                if (otherProvider !== provider) {\n\t                                    this.hidePano(otherProvider);\n\t                                }\n\t                            }\n\t                            _context.next = 12;\n\t                            break;\n\t\n\t                        case 8:\n\t                            _context.prev = 8;\n\t                            _context.t0 = _context['catch'](4);\n\t                            _didIteratorError6 = true;\n\t                            _iteratorError6 = _context.t0;\n\t\n\t                        case 12:\n\t                            _context.prev = 12;\n\t                            _context.prev = 13;\n\t\n\t                            if (!_iteratorNormalCompletion6 && _iterator6.return) {\n\t                                _iterator6.return();\n\t                            }\n\t\n\t                        case 15:\n\t                            _context.prev = 15;\n\t\n\t                            if (!_didIteratorError6) {\n\t                                _context.next = 18;\n\t                                break;\n\t                            }\n\t\n\t                            throw _iteratorError6;\n\t\n\t                        case 18:\n\t                            return _context.finish(15);\n\t\n\t                        case 19:\n\t                            return _context.finish(12);\n\t\n\t                        case 20:\n\t                            _leaflet2.default.DomUtil.addClass(provider.container, 'enabled');\n\t\n\t                            if (provider.viewer) {\n\t                                _context.next = 26;\n\t                                break;\n\t                            }\n\t\n\t                            _context.next = 24;\n\t                            return provider.provider.getViewer(provider.container);\n\t\n\t                        case 24:\n\t                            provider.viewer = _context.sent;\n\t\n\t                            this.setupViewerEvents(provider);\n\t\n\t                        case 26:\n\t                            if (data) {\n\t                                // wait for panorama container become of right size, needed for viewer setup\n\t                                _leaflet2.default.Util.requestAnimFrame(function () {\n\t                                    return provider.viewer.showPano(data);\n\t                                });\n\t                            }\n\t                            provider.viewer.activate();\n\t                            this.notifyChanged();\n\t\n\t                        case 29:\n\t                        case 'end':\n\t                            return _context.stop();\n\t                    }\n\t                }\n\t            }, _callee, this, [[4, 8, 12, 20], [13,, 15, 19]]);\n\t        }));\n\t\n\t        function showPano(_x, _x2) {\n\t            return _ref.apply(this, arguments);\n\t        }\n\t\n\t        return showPano;\n\t    }(),\n\t\n\t    setupViewerEvents: function setupViewerEvents(provider) {\n\t        provider.viewer.on({\n\t            'change': this.onPanoramaChangeView.bind(this, provider),\n\t            'closeclick': this.onPanoramaCloseClick\n\t        }, this);\n\t    },\n\t\n\t    hidePanoViewer: function hidePanoViewer() {\n\t        var _iteratorNormalCompletion7 = true;\n\t        var _didIteratorError7 = false;\n\t        var _iteratorError7 = undefined;\n\t\n\t        try {\n\t            for (var _iterator7 = this.providers[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n\t                var provider = _step7.value;\n\t\n\t                this.hidePano(provider);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError7 = true;\n\t            _iteratorError7 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion7 && _iterator7.return) {\n\t                    _iterator7.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError7) {\n\t                    throw _iteratorError7;\n\t                }\n\t            }\n\t        }\n\t\n\t        _leaflet2.default.DomUtil.removeClass(this._panoramaContainer, 'enabled');\n\t        this.hideMarker();\n\t        fireRefreshEventOnWindow();\n\t        this.notifyChanged();\n\t    },\n\t\n\t    placeMarker: function placeMarker(latlng, heading) {\n\t        if (!this.panoramaVisible()) {\n\t            return;\n\t        }\n\t        if (!this.marker) {\n\t            this.marker = new PanoMarker();\n\t        }\n\t        this._map.addLayer(this.marker);\n\t        this.marker.setLatLng(latlng);\n\t        this.marker.setHeading(heading);\n\t    },\n\t\n\t    hideMarker: function hideMarker() {\n\t        if (this.marker) {\n\t            this._map.removeLayer(this.marker);\n\t        }\n\t    },\n\t    notifyChanged: function notifyChanged() {\n\t        this.fire('panoramachanged');\n\t    },\n\t\n\t    onPanoramaChangeView: function onPanoramaChangeView(provider, e) {\n\t        if (!this._map.getBounds().pad(-0.05).contains(e.latlng)) {\n\t            this._map.panTo(e.latlng);\n\t        }\n\t        this.placeMarker(e.latlng, e.heading);\n\t        this.marker.setType(provider.mapMarkerType);\n\t        this.setupNearbyPoints(e.latlngs);\n\t        this.notifyChanged();\n\t    },\n\t\n\t    onPanoramaCloseClick: function onPanoramaCloseClick(e) {\n\t        this.hidePanoViewer();\n\t    },\n\t\n\t    onMapClick: function () {\n\t        var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(e) {\n\t            var searchRadiusPx, p, searchRadiusMeters, promises, _iteratorNormalCompletion8, _didIteratorError8, _iteratorError8, _iterator8, _step8, provider, _iteratorNormalCompletion9, _didIteratorError9, _iteratorError9, _iterator9, _step9, _step9$value, promise, _provider, searchResult;\n\t\n\t            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                while (1) {\n\t                    switch (_context2.prev = _context2.next) {\n\t                        case 0:\n\t                            searchRadiusPx = 24, p = this._map.project(e.latlng).add([searchRadiusPx, 0]), searchRadiusMeters = e.latlng.distanceTo(this._map.unproject(p)), promises = [];\n\t                            _iteratorNormalCompletion8 = true;\n\t                            _didIteratorError8 = false;\n\t                            _iteratorError8 = undefined;\n\t                            _context2.prev = 4;\n\t\n\t                            for (_iterator8 = this.providers[Symbol.iterator](); !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {\n\t                                provider = _step8.value;\n\t\n\t                                if (provider.selected()) {\n\t                                    promises.push({\n\t                                        promise: provider.provider.getPanoramaAtPos(e.latlng, searchRadiusMeters),\n\t                                        provider: provider\n\t                                    });\n\t                                }\n\t                            }\n\t\n\t                            _context2.next = 12;\n\t                            break;\n\t\n\t                        case 8:\n\t                            _context2.prev = 8;\n\t                            _context2.t0 = _context2['catch'](4);\n\t                            _didIteratorError8 = true;\n\t                            _iteratorError8 = _context2.t0;\n\t\n\t                        case 12:\n\t                            _context2.prev = 12;\n\t                            _context2.prev = 13;\n\t\n\t                            if (!_iteratorNormalCompletion8 && _iterator8.return) {\n\t                                _iterator8.return();\n\t                            }\n\t\n\t                        case 15:\n\t                            _context2.prev = 15;\n\t\n\t                            if (!_didIteratorError8) {\n\t                                _context2.next = 18;\n\t                                break;\n\t                            }\n\t\n\t                            throw _iteratorError8;\n\t\n\t                        case 18:\n\t                            return _context2.finish(15);\n\t\n\t                        case 19:\n\t                            return _context2.finish(12);\n\t\n\t                        case 20:\n\t                            _iteratorNormalCompletion9 = true;\n\t                            _didIteratorError9 = false;\n\t                            _iteratorError9 = undefined;\n\t                            _context2.prev = 23;\n\t                            _iterator9 = promises[Symbol.iterator]();\n\t\n\t                        case 25:\n\t                            if (_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done) {\n\t                                _context2.next = 36;\n\t                                break;\n\t                            }\n\t\n\t                            _step9$value = _step9.value, promise = _step9$value.promise, _provider = _step9$value.provider;\n\t                            _context2.next = 29;\n\t                            return promise;\n\t\n\t                        case 29:\n\t                            searchResult = _context2.sent;\n\t\n\t                            if (!searchResult.found) {\n\t                                _context2.next = 33;\n\t                                break;\n\t                            }\n\t\n\t                            this.showPano(_provider, searchResult.data);\n\t                            return _context2.abrupt('return');\n\t\n\t                        case 33:\n\t                            _iteratorNormalCompletion9 = true;\n\t                            _context2.next = 25;\n\t                            break;\n\t\n\t                        case 36:\n\t                            _context2.next = 42;\n\t                            break;\n\t\n\t                        case 38:\n\t                            _context2.prev = 38;\n\t                            _context2.t1 = _context2['catch'](23);\n\t                            _didIteratorError9 = true;\n\t                            _iteratorError9 = _context2.t1;\n\t\n\t                        case 42:\n\t                            _context2.prev = 42;\n\t                            _context2.prev = 43;\n\t\n\t                            if (!_iteratorNormalCompletion9 && _iterator9.return) {\n\t                                _iterator9.return();\n\t                            }\n\t\n\t                        case 45:\n\t                            _context2.prev = 45;\n\t\n\t                            if (!_didIteratorError9) {\n\t                                _context2.next = 48;\n\t                                break;\n\t                            }\n\t\n\t                            throw _iteratorError9;\n\t\n\t                        case 48:\n\t                            return _context2.finish(45);\n\t\n\t                        case 49:\n\t                            return _context2.finish(42);\n\t\n\t                        case 50:\n\t                        case 'end':\n\t                            return _context2.stop();\n\t                    }\n\t                }\n\t            }, _callee2, this, [[4, 8, 12, 20], [13,, 15, 19], [23, 38, 42, 50], [43,, 45, 49]]);\n\t        }));\n\t\n\t        function onMapClick(_x3) {\n\t            return _ref2.apply(this, arguments);\n\t        }\n\t\n\t        return onMapClick;\n\t    }()\n\t});\n\t\n\t_leaflet2.default.Control.Panoramas.include(_leaflet2.default.Mixin.HashState);\n\t_leaflet2.default.Control.Panoramas.include({\n\t    stateChangeEvents: ['panoramachanged'],\n\t\n\t    serializeState: function serializeState() {\n\t        var state = null;\n\t        if (this.controlEnabled) {\n\t            state = [];\n\t            var coverageCode = '_';\n\t            var _iteratorNormalCompletion10 = true;\n\t            var _didIteratorError10 = false;\n\t            var _iteratorError10 = undefined;\n\t\n\t            try {\n\t                for (var _iterator10 = this.providers[Symbol.iterator](), _step10; !(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done); _iteratorNormalCompletion10 = true) {\n\t                    var _provider2 = _step10.value;\n\t\n\t                    if (_provider2.selected()) {\n\t                        coverageCode += _provider2.code;\n\t                    }\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError10 = true;\n\t                _iteratorError10 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion10 && _iterator10.return) {\n\t                        _iterator10.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError10) {\n\t                        throw _iteratorError10;\n\t                    }\n\t                }\n\t            }\n\t\n\t            state.push(coverageCode);\n\t            var provider = this.panoramaVisible();\n\t            if (provider && provider.viewer) {\n\t                var viewerState = provider.viewer.getState();\n\t                if (viewerState) {\n\t                    var _state;\n\t\n\t                    state.push(provider.code);\n\t                    (_state = state).push.apply(_state, _toConsumableArray(viewerState));\n\t                }\n\t            }\n\t        }\n\t        return state;\n\t    },\n\t\n\t    unserializeState: function unserializeState(state) {\n\t        var _this = this;\n\t\n\t        if (!state) {\n\t            this.disableControl();\n\t            return true;\n\t        }\n\t\n\t        var coverageCode = state[0];\n\t        if (!coverageCode || coverageCode[0] !== '_') {\n\t            return false;\n\t        }\n\t        this.enableControl();\n\t        var _iteratorNormalCompletion11 = true;\n\t        var _didIteratorError11 = false;\n\t        var _iteratorError11 = undefined;\n\t\n\t        try {\n\t            for (var _iterator11 = this.providers[Symbol.iterator](), _step11; !(_iteratorNormalCompletion11 = (_step11 = _iterator11.next()).done); _iteratorNormalCompletion11 = true) {\n\t                var _provider3 = _step11.value;\n\t\n\t                _provider3.selected(coverageCode.includes(_provider3.code));\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError11 = true;\n\t            _iteratorError11 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion11 && _iterator11.return) {\n\t                    _iterator11.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError11) {\n\t                    throw _iteratorError11;\n\t                }\n\t            }\n\t        }\n\t\n\t        if (state.length > 2) {\n\t            var panoramaVisible = state[1];\n\t            var _iteratorNormalCompletion12 = true;\n\t            var _didIteratorError12 = false;\n\t            var _iteratorError12 = undefined;\n\t\n\t            try {\n\t                var _loop = function _loop() {\n\t                    var provider = _step12.value;\n\t\n\t                    if (panoramaVisible === provider.code) {\n\t                        _this.showPano(provider).then(function () {\n\t                            var success = provider.viewer.setState(state.slice(2));\n\t                            if (!success) {\n\t                                _this.hidePanoViewer();\n\t                            }\n\t                        });\n\t                        return 'break';\n\t                    }\n\t                };\n\t\n\t                for (var _iterator12 = this.providers[Symbol.iterator](), _step12; !(_iteratorNormalCompletion12 = (_step12 = _iterator12.next()).done); _iteratorNormalCompletion12 = true) {\n\t                    var _ret = _loop();\n\t\n\t                    if (_ret === 'break') break;\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError12 = true;\n\t                _iteratorError12 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion12 && _iterator12.return) {\n\t                        _iterator12.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError12) {\n\t                        throw _iteratorError12;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t        return true;\n\t    }\n\t});\n\t\n\t_leaflet2.default.Control.Panoramas.hashStateUpgrader = function (panoramasControl) {\n\t    return _leaflet2.default.Util.extend({}, _leaflet2.default.Mixin.HashState, {\n\t        unserializeState: function unserializeState(oldState) {\n\t            if (oldState) {\n\t                console.log('Upgrading');\n\t                var upgradedState = ['_g'];\n\t                if (oldState.length) {\n\t                    upgradedState.push.apply(upgradedState, ['g'].concat(_toConsumableArray(oldState)));\n\t                }\n\t                setTimeout(function () {\n\t                    return panoramasControl.unserializeState(upgradedState);\n\t                }, 0);\n\t            }\n\t            return false;\n\t        },\n\t\n\t        serializeState: function serializeState() {\n\t            return null;\n\t        }\n\t    });\n\t};\n\n/***/ },\n/* 192 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar getStreetViewService = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t        var google;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        _context.next = 2;\n\t                        return (0, _googleMapsApi2.default)();\n\t\n\t                    case 2:\n\t                        google = _context.sent;\n\t                        return _context.abrupt('return', new google.maps.StreetViewService());\n\t\n\t                    case 4:\n\t                    case 'end':\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function getStreetViewService() {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar getPanoramaAtPos = function () {\n\t    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(latlng, searchRadiusMeters) {\n\t        var google, service, _ref3, data, status;\n\t\n\t        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t            while (1) {\n\t                switch (_context2.prev = _context2.next) {\n\t                    case 0:\n\t                        _context2.next = 2;\n\t                        return (0, _googleMapsApi2.default)();\n\t\n\t                    case 2:\n\t                        google = _context2.sent;\n\t                        _context2.next = 5;\n\t                        return getStreetViewService();\n\t\n\t                    case 5:\n\t                        service = _context2.sent;\n\t                        _context2.next = 8;\n\t                        return new Promise(function (resolve) {\n\t                            service.getPanorama({\n\t                                location: latlng,\n\t                                radius: searchRadiusMeters,\n\t                                preference: google.maps.StreetViewPreference.NEAREST\n\t                            }, function (data, status) {\n\t                                return resolve({ data: data, status: status });\n\t                            });\n\t                        });\n\t\n\t                    case 8:\n\t                        _ref3 = _context2.sent;\n\t                        data = _ref3.data;\n\t                        status = _ref3.status;\n\t\n\t                        if (!(status === google.maps.StreetViewStatus.OK)) {\n\t                            _context2.next = 15;\n\t                            break;\n\t                        }\n\t\n\t                        return _context2.abrupt('return', { found: true, data: data });\n\t\n\t                    case 15:\n\t                        return _context2.abrupt('return', { found: false });\n\t\n\t                    case 16:\n\t                    case 'end':\n\t                        return _context2.stop();\n\t                }\n\t            }\n\t        }, _callee2, this);\n\t    }));\n\t\n\t    return function getPanoramaAtPos(_x, _x2) {\n\t        return _ref2.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar getViewer = function () {\n\t    var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(container) {\n\t        var google;\n\t        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n\t            while (1) {\n\t                switch (_context3.prev = _context3.next) {\n\t                    case 0:\n\t                        _context3.next = 2;\n\t                        return (0, _googleMapsApi2.default)();\n\t\n\t                    case 2:\n\t                        google = _context3.sent;\n\t                        return _context3.abrupt('return', new Viewer(google, container));\n\t\n\t                    case 4:\n\t                    case 'end':\n\t                        return _context3.stop();\n\t                }\n\t            }\n\t        }, _callee3, this);\n\t    }));\n\t\n\t    return function getViewer(_x3) {\n\t        return _ref4.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _googleMapsApi = __webpack_require__(111);\n\t\n\tvar _googleMapsApi2 = _interopRequireDefault(_googleMapsApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction getCoverageLayer(options) {\n\t    return _leaflet2.default.tileLayer('https://maps.googleapis.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m8!1e2!2ssvv!4m2!1scb_client!2sapiv3!4m2!1scc!2s*211m3*211e3*212b1*213e2*211m3*211e2*212b1*213e2!3m5!3sUS!12m1!1e40!12m1!1e18!4e0', options);\n\t}\n\t\n\tvar Viewer = _leaflet2.default.Evented.extend({\n\t    initialize: function initialize(google, container) {\n\t        var _this = this;\n\t\n\t        var panorama = this.panorama = new google.maps.StreetViewPanorama(container, {\n\t            enableCloseButton: true,\n\t            imageDateControl: true\n\t        });\n\t        panorama.addListener('position_changed', function () {\n\t            return _this.onPanoramaChangeView();\n\t        });\n\t        panorama.addListener('pov_changed', function () {\n\t            return _this.onPanoramaChangeView();\n\t        });\n\t        panorama.addListener('closeclick', function () {\n\t            return _this.onCloseClick();\n\t        });\n\t    },\n\t\n\t    showPano: function showPano(data) {\n\t        this.panorama.setPosition(data.location.latLng);\n\t        this.panorama.setZoom(1);\n\t    },\n\t\n\t    onPanoramaChangeView: function onPanoramaChangeView() {\n\t        if (!this._active) {\n\t            return;\n\t        }\n\t        var pos = this.panorama.getPosition();\n\t        pos = _leaflet2.default.latLng(pos.lat(), pos.lng());\n\t        var pov = this.panorama.getPov();\n\t        this.fire('change', { latlng: pos, heading: pov.heading, zoom: pov.zoom, pitch: pov.pitch });\n\t    },\n\t\n\t    onCloseClick: function onCloseClick() {\n\t        this.fire('closeclick');\n\t    },\n\t\n\t    activate: function activate() {\n\t        this._active = true;\n\t        this.panorama.setVisible(true);\n\t    },\n\t\n\t    deactivate: function deactivate() {\n\t        this._active = false;\n\t        this.panorama.setVisible(false);\n\t    },\n\t\n\t    getState: function getState() {\n\t        var pos = this.panorama.getPosition();\n\t        var pov = this.panorama.getPov();\n\t        if (pos && pov) {\n\t            return [pos.lat().toFixed(6), pos.lng().toFixed(6), (pov.heading || 0).toFixed(1), (pov.pitch || 0).toFixed(1), (pov.zoom || 1).toFixed(1)];\n\t        } else {\n\t            return null;\n\t        }\n\t    },\n\t\n\t    setState: function setState(state) {\n\t        var lat = parseFloat(state[0]);\n\t        var lng = parseFloat(state[1]);\n\t        var heading = parseFloat(state[2]);\n\t        var pitch = parseFloat(state[3]);\n\t        var zoom = parseFloat(state[4]);\n\t        if (!isNaN(lat) && !isNaN(lng) && !isNaN(heading) && !isNaN(pitch) && !isNaN(zoom)) {\n\t            this.panorama.setPosition({ lat: lat, lng: lng });\n\t            this.panorama.setPov({ heading: heading, pitch: pitch, zoom: zoom });\n\t            return true;\n\t        }\n\t        return false;\n\t    }\n\t});\n\t\n\texports.default = { getCoverageLayer: getCoverageLayer, getPanoramaAtPos: getPanoramaAtPos, getViewer: getViewer };\n\n/***/ },\n/* 193 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar getPanoramaAtPos = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(latlng, searchRadiusMeters) {\n\t        var url, resp;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        url = 'https://a.mapillary.com/v3/images?client_id=' + _config2.default.mapillary + '&closeto=' + latlng.lng + ',' + latlng.lat + '&radius=' + searchRadiusMeters;\n\t                        _context.next = 3;\n\t                        return (0, _xhrPromise.fetch)(url, { responseType: 'json', timeout: 10000 });\n\t\n\t                    case 3:\n\t                        resp = _context.sent;\n\t\n\t                        if (!(resp.status === 200 && resp.responseJSON.features.length)) {\n\t                            _context.next = 6;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt('return', { found: true, data: resp.responseJSON.features[0].properties.key });\n\t\n\t                    case 6:\n\t                        return _context.abrupt('return', { found: false });\n\t\n\t                    case 7:\n\t                    case 'end':\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function getPanoramaAtPos(_x, _x2) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar getViewer = function () {\n\t    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(container) {\n\t        var mapillary;\n\t        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t            while (1) {\n\t                switch (_context2.prev = _context2.next) {\n\t                    case 0:\n\t                        _context2.next = 2;\n\t                        return getMapillary();\n\t\n\t                    case 2:\n\t                        mapillary = _context2.sent;\n\t                        return _context2.abrupt('return', new Viewer(mapillary, container));\n\t\n\t                    case 4:\n\t                    case 'end':\n\t                        return _context2.stop();\n\t                }\n\t            }\n\t        }, _callee2, this);\n\t    }));\n\t\n\t    return function getViewer(_x3) {\n\t        return _ref2.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _mapillaryCoverageLayer = __webpack_require__(194);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\t__webpack_require__(455);\n\t\n\t__webpack_require__(166);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction getCoverageLayer(options) {\n\t    return new _mapillaryCoverageLayer.MapillaryCoverage(options);\n\t}\n\t\n\tfunction getMapillary() {\n\t    return new Promise(function (resolve) {\n\t        __webpack_require__.e/* nsure */(1, function () {\n\t            __webpack_require__(165);\n\t            resolve(__webpack_require__(168));\n\t        });\n\t    });\n\t}\n\t\n\tfunction formatDateTime(ts) {\n\t    var d = new Date(ts);\n\t    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n\t    return d.getDate() + ' ' + months[d.getMonth()] + ' ' + d.getFullYear();\n\t}\n\t\n\tvar Viewer = _leaflet2.default.Evented.extend({\n\t    initialize: function initialize(mapillary, container) {\n\t        var id = 'container-' + _leaflet2.default.stamp(container);\n\t        container.id = id;\n\t        var viewer = this.viewer = new mapillary.Viewer(id, _config2.default.mapillary, null, { component: { cover: false, bearing: false } });\n\t        window.addEventListener('resize', function () {\n\t            viewer.resize();\n\t        });\n\t        viewer.on('nodechanged', this.onNodeChanged.bind(this));\n\t        viewer.on('bearingchanged', this.onBearingChanged.bind(this));\n\t        this.dateLabel = _leaflet2.default.DomUtil.create('div', 'mapillary-viewer-date-overlay', container);\n\t        this.closeButton = _leaflet2.default.DomUtil.create('div', 'photo-viewer-button-close', container);\n\t        _leaflet2.default.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n\t        this._bearing = 0;\n\t        this._zoom = 0;\n\t        this._center = [0, 0];\n\t    },\n\t\n\t    showPano: function showPano(data) {\n\t        var _this = this;\n\t\n\t        this.deactivate();\n\t        this.activate();\n\t        this.viewer.moveToKey(data).then(function () {\n\t            _this.viewer.setZoom(0);\n\t            _this.updateZoomAndCenter();\n\t        });\n\t    },\n\t\n\t    onNodeChanged: function onNodeChanged(node) {\n\t        if (this._node && node.key === this._node.key) {\n\t            return;\n\t        }\n\t        this._node = node;\n\t        this.fireChangeEvenet();\n\t        this.dateLabel.innerHTML = formatDateTime(node.capturedAt);\n\t    },\n\t\n\t    getBearingCorrection: function getBearingCorrection() {\n\t        if (this._node && 'computedCA' in this._node) {\n\t            return this._node.computedCA - this._node.originalCA;\n\t        }\n\t        return 0;\n\t    },\n\t\n\t    onBearingChanged: function onBearingChanged(bearing) {\n\t        bearing -= this.getBearingCorrection();\n\t        if (this._bearing === bearing) {\n\t            return;\n\t        }\n\t        this._bearing = bearing;\n\t        this.fireChangeEvenet();\n\t    },\n\t\n\t    onCloseClick: function onCloseClick() {\n\t        this.fire('closeclick');\n\t    },\n\t\n\t    fireChangeEvenet: function fireChangeEvenet() {\n\t        if (this._node) {\n\t            var latlon = this._node.originalLatLon;\n\t            this.fire('change', {\n\t                latlng: _leaflet2.default.latLng(latlon.lat, latlon.lon),\n\t                heading: this._bearing,\n\t                pitch: this._pitch,\n\t                zoom: this._zoom\n\t            });\n\t        }\n\t    },\n\t\n\t    deactivate: function deactivate() {\n\t        this.viewer.activateCover();\n\t        if (this._updateHandler) {\n\t            clearInterval(this._updateHandler);\n\t            this._updateHandler = null;\n\t        }\n\t    },\n\t\n\t    updateZoomAndCenter: function updateZoomAndCenter() {\n\t        var _this2 = this;\n\t\n\t        this.viewer.getZoom().then(function (zoom) {\n\t            _this2._zoom = zoom;\n\t        });\n\t        this.viewer.getCenter().then(function (center) {\n\t            _this2._center = center;\n\t        });\n\t        this.viewer.getBearing().then(function (bearing) {\n\t            _this2.onBearingChanged(bearing);\n\t        });\n\t    },\n\t\n\t    activate: function activate() {\n\t        var _this3 = this;\n\t\n\t        this.viewer.resize();\n\t        this.viewer.deactivateCover();\n\t        if (!this._updateHandler) {\n\t            this._updateHandler = setInterval(function () {\n\t                return _this3.updateZoomAndCenter();\n\t            }, 200);\n\t        }\n\t    },\n\t\n\t    getState: function getState() {\n\t        if (!this._node) {\n\t            return [];\n\t        }\n\t        var _node$originalLatLon = this._node.originalLatLon,\n\t            lat = _node$originalLatLon.lat,\n\t            lon = _node$originalLatLon.lon;\n\t\n\t        return [lat.toFixed(6), lon.toFixed(6), this._center[0].toFixed(4), this._center[1].toFixed(4), this._zoom.toFixed(2)];\n\t    },\n\t\n\t    setState: function setState(state) {\n\t        var _this4 = this;\n\t\n\t        var lat = parseFloat(state[0]);\n\t        var lng = parseFloat(state[1]);\n\t        var center0 = parseFloat(state[2]);\n\t        var center1 = parseFloat(state[3]);\n\t        var zoom = parseFloat(state[4]);\n\t        if (!isNaN(lat) && !isNaN(lng) && !isNaN(center0) && !isNaN(center1) && !isNaN(zoom)) {\n\t            this.viewer.moveCloseTo(lat, lng).then(function () {\n\t                _this4.viewer.setCenter([center0, center1]);\n\t                _this4.viewer.setZoom(zoom);\n\t            });\n\t            return true;\n\t        }\n\t        return false;\n\t    }\n\t});\n\t\n\texports.default = { getCoverageLayer: getCoverageLayer, getPanoramaAtPos: getPanoramaAtPos, getViewer: getViewer };\n\n/***/ },\n/* 194 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.MapillaryCoverage = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _mapillaryLoader = __webpack_require__(195);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar MapillaryCoverage = _leaflet2.default.GridLayer.extend({\n\t    options: {\n\t        tileSize: 1024,\n\t        updateWhenIdle: true,\n\t        color: '#00cfb1'\n\t    },\n\t\n\t    initialize: function initialize(options) {\n\t        _leaflet2.default.GridLayer.prototype.initialize.call(this, options);\n\t        this.loader = new _mapillaryLoader.MapillaryLoader(this.options.url, 12);\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        _leaflet2.default.GridLayer.prototype.onAdd.call(this, map);\n\t        this.on('tileunload', this.onTileUnload, this);\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        _leaflet2.default.GridLayer.prototype.onRemove.call(this, map);\n\t        this.off('tileunload', this.onTileUnload, this);\n\t    },\n\t\n\t    onTileUnload: function onTileUnload(e) {\n\t        var tile = e.tile;\n\t        tile._abortLoading();\n\t        delete tile._tileData;\n\t        delete tile._adjustment;\n\t    },\n\t\n\t    drawOverview: function drawOverview(canvas) {\n\t        var tileData = canvas._tileData;\n\t        if (!tileData['mapillary-sequence-overview']) {\n\t            return;\n\t        }\n\t        var _canvas$_adjustment = canvas._adjustment,\n\t            multiplier = _canvas$_adjustment.multiplier,\n\t            offsetX = _canvas$_adjustment.offsetX,\n\t            offsetY = _canvas$_adjustment.offsetY;\n\t\n\t        var canvasCtx = canvas.getContext('2d');\n\t        canvasCtx.fillStyle = this.options.color;\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = tileData['mapillary-sequence-overview'][Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var feature = _step.value;\n\t\n\t                if (feature.geometry.type !== 'Point') {\n\t                    throw new Error('Invalid sequence overview geometry type \"' + feature.geometry.type + '\"');\n\t                }\n\t                canvasCtx.beginPath();\n\t                var x = feature.geometry.coordinates[0] * multiplier - offsetX;\n\t                var y = feature.geometry.coordinates[1] * multiplier - offsetY;\n\t                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n\t                canvasCtx.fill();\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t    },\n\t\n\t    drawSequences: function drawSequences(canvas, lineWidth) {\n\t        var tileData = canvas._tileData,\n\t            adjustment = canvas._adjustment;\n\t\n\t        if (!tileData['mapillary-sequences']) {\n\t            return;\n\t        }\n\t        var canvasCtx = canvas.getContext('2d');\n\t        canvasCtx.beginPath();\n\t        canvasCtx.strokeStyle = this.options.color;\n\t        canvasCtx.lineWidth = lineWidth;\n\t        // canvasCtx.lineWidth = thinLines ? 1 : 1;\n\t        canvasCtx.lineCap = \"round\";\n\t        canvasCtx.lineJoin = \"bevel\";\n\t        var _iteratorNormalCompletion2 = true;\n\t        var _didIteratorError2 = false;\n\t        var _iteratorError2 = undefined;\n\t\n\t        try {\n\t            for (var _iterator2 = tileData['mapillary-sequences'][Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                var feature = _step2.value;\n\t\n\t                if (feature.geometry.type !== 'MultiLineString') {\n\t                    throw new Error('Invalid sequence geometry type \"' + feature.geometry.type + '\"');\n\t                }\n\t                var multiplier = adjustment.multiplier,\n\t                    offsetX = adjustment.offsetX,\n\t                    offsetY = adjustment.offsetY;\n\t\n\t\n\t                var lines = feature.geometry.coordinates;\n\t                for (var lineI = 0; lineI < lines.length; lineI++) {\n\t                    var line = lines[lineI];\n\t                    if (!line.length) {\n\t                        continue;\n\t                    }\n\t                    var x = line[0][0] * multiplier - offsetX;\n\t                    var y = line[0][1] * multiplier - offsetY;\n\t                    canvasCtx.moveTo(x, y);\n\t                    if (line.length === 1) {\n\t                        canvasCtx.lineTo(x, y);\n\t                    }\n\t                    for (var pointI = 0; pointI < line.length; pointI++) {\n\t                        var _x = line[pointI][0] * multiplier - offsetX;\n\t                        var _y = line[pointI][1] * multiplier - offsetY;\n\t                        canvasCtx.lineTo(_x, _y);\n\t                    }\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError2 = true;\n\t            _iteratorError2 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                    _iterator2.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError2) {\n\t                    throw _iteratorError2;\n\t                }\n\t            }\n\t        }\n\t\n\t        canvasCtx.stroke();\n\t    },\n\t\n\t    drawImages: function drawImages(canvas) {\n\t        var tileData = canvas._tileData,\n\t            adjustment = canvas._adjustment;\n\t        if (!tileData['mapillary-images']) {\n\t            return;\n\t        }\n\t        var multiplier = adjustment.multiplier,\n\t            offsetX = adjustment.offsetX,\n\t            offsetY = adjustment.offsetY;\n\t\n\t        var canvasCtx = canvas.getContext('2d');\n\t        canvasCtx.beginPath();\n\t        canvasCtx.fillStyle = this.options.color;\n\t        var _iteratorNormalCompletion3 = true;\n\t        var _didIteratorError3 = false;\n\t        var _iteratorError3 = undefined;\n\t\n\t        try {\n\t            for (var _iterator3 = tileData['mapillary-images'][Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                var feature = _step3.value;\n\t\n\t                if (feature.geometry.type !== 'Point') {\n\t                    throw new Error('Invalid image geometry type \"' + feature.geometry.type + '\"');\n\t                }\n\t                canvasCtx.beginPath();\n\t                var x = feature.geometry.coordinates[0] * multiplier - offsetX;\n\t                var y = feature.geometry.coordinates[1] * multiplier - offsetY;\n\t                canvasCtx.arc(x, y, 4, 0, 2 * Math.PI);\n\t                canvasCtx.fill();\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError3 = true;\n\t            _iteratorError3 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                    _iterator3.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError3) {\n\t                    throw _iteratorError3;\n\t                }\n\t            }\n\t        }\n\t    },\n\t\n\t    drawTile: function drawTile(canvas, coords) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        if (!canvas._tileData) {\n\t            return;\n\t        }\n\t        if (coords.z < 6 + 2) {\n\t            this.drawOverview(canvas);\n\t        } else if (coords.z < 14 + 2) {\n\t            var width = coords.z < 14 ? 10 : 5;\n\t            this.drawSequences(canvas, width);\n\t        } else {\n\t            this.drawSequences(canvas, 2);\n\t            this.drawImages(canvas);\n\t        }\n\t    },\n\t\n\t    createTile: function createTile(coords, done) {\n\t        var _this = this;\n\t\n\t        var canvas = _leaflet2.default.DomUtil.create('canvas', 'leaflet-tile');\n\t        canvas.width = this.options.tileSize;\n\t        canvas.height = this.options.tileSize;\n\t\n\t        var _loader$requestTileDa = this.loader.requestTileData(coords),\n\t            dataPromise = _loader$requestTileDa.dataPromise,\n\t            abortLoading = _loader$requestTileDa.abortLoading;\n\t\n\t        dataPromise.then(function (data) {\n\t            canvas._tileData = data.tileData;\n\t            canvas._adjustment = data.adjustment || { multiplier: 1, offsetX: 0, offsetY: 0 };\n\t            setTimeout(function () {\n\t                _this.drawTile(canvas, coords);\n\t                done(null, canvas);\n\t            }, 1);\n\t        });\n\t        canvas._abortLoading = abortLoading;\n\t        return canvas;\n\t    }\n\t\n\t});\n\t\n\texports.MapillaryCoverage = MapillaryCoverage;\n\n/***/ },\n/* 195 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.MapillaryLoader = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _tiledDataLoader = __webpack_require__(83);\n\t\n\tvar _mvt = __webpack_require__(196);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar MapillaryLoader = function (_TiledDataLoader) {\n\t    _inherits(MapillaryLoader, _TiledDataLoader);\n\t\n\t    function MapillaryLoader() {\n\t        var _ref;\n\t\n\t        var _temp, _this, _ret;\n\t\n\t        _classCallCheck(this, MapillaryLoader);\n\t\n\t        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t            args[_key] = arguments[_key];\n\t        }\n\t\n\t        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = MapillaryLoader.__proto__ || Object.getPrototypeOf(MapillaryLoader)).call.apply(_ref, [this].concat(args))), _this), _this.url = 'https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt', _this.maxZoom = 14, _temp), _possibleConstructorReturn(_this, _ret);\n\t    }\n\t\n\t    _createClass(MapillaryLoader, [{\n\t        key: 'getTileUrl',\n\t        value: function getTileUrl(coords) {\n\t            var data = {\n\t                x: coords.x,\n\t                z: coords.z,\n\t                y: coords.y\n\t            };\n\t            return _leaflet2.default.Util.template(this.url, data);\n\t        }\n\t    }, {\n\t        key: 'layerTileToDataTileCoords',\n\t        value: function layerTileToDataTileCoords(layerTileCoords) {\n\t            var z = layerTileCoords.z - 2;\n\t            var z2 = null;\n\t            if (z > 6 && z <= 10) {\n\t                z2 = 6;\n\t            } else if (z >= 11 && z < 14) {\n\t                z2 = z - 4;\n\t            } else if (z < 0) {\n\t                z2 = 0;\n\t            } else if (z > this.maxZoom) {\n\t                z2 = this.maxZoom;\n\t            } else {\n\t                return { z: z, x: layerTileCoords.x, y: layerTileCoords.y };\n\t            }\n\t\n\t            var multiplier = 1 << z - z2;\n\t            return {\n\t                x: Math.floor(layerTileCoords.x / multiplier),\n\t                y: Math.floor(layerTileCoords.y / multiplier),\n\t                z: z2\n\t            };\n\t        }\n\t    }, {\n\t        key: 'makeRequestData',\n\t        value: function makeRequestData(dataTileCoords) {\n\t            return {\n\t                url: this.getTileUrl(dataTileCoords),\n\t                options: {\n\t                    responseType: 'arraybuffer',\n\t                    timeout: 10000,\n\t                    isResponseSuccess: function isResponseSuccess(xhr) {\n\t                        return xhr.status === 200 || xhr.status === 403;\n\t                    }\n\t                }\n\t            };\n\t        }\n\t    }, {\n\t        key: 'calcAdjustment',\n\t        value: function calcAdjustment(layerTileCoords, dataTileCoords) {\n\t            var adjustment = _get(MapillaryLoader.prototype.__proto__ || Object.getPrototypeOf(MapillaryLoader.prototype), 'calcAdjustment', this).call(this, { x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2 }, dataTileCoords);\n\t            if (adjustment) {\n\t                adjustment.offsetX *= 1024;\n\t                adjustment.offsetY *= 1024;\n\t            }\n\t            return adjustment;\n\t        }\n\t    }, {\n\t        key: 'processResponse',\n\t        value: function () {\n\t            var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(xhr, originalDataTileCoords) {\n\t                return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                    while (1) {\n\t                        switch (_context.prev = _context.next) {\n\t                            case 0:\n\t                                return _context.abrupt('return', this._processResponse(xhr, originalDataTileCoords));\n\t\n\t                            case 1:\n\t                            case 'end':\n\t                                return _context.stop();\n\t                        }\n\t                    }\n\t                }, _callee, this);\n\t            }));\n\t\n\t            function processResponse(_x, _x2) {\n\t                return _ref2.apply(this, arguments);\n\t            }\n\t\n\t            return processResponse;\n\t        }()\n\t    }, {\n\t        key: '_processResponse',\n\t        value: function () {\n\t            var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(xhr, originalDataTileCoords) {\n\t                var tileData, layers, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, layer;\n\t\n\t                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                    while (1) {\n\t                        switch (_context2.prev = _context2.next) {\n\t                            case 0:\n\t                                tileData = void 0;\n\t\n\t                                if (!(xhr.status === 200 && xhr.response)) {\n\t                                    _context2.next = 25;\n\t                                    break;\n\t                                }\n\t\n\t                                layers = (0, _mvt.decodeMvt)(xhr.response, 1024);\n\t\n\t                                tileData = {};\n\t                                _iteratorNormalCompletion = true;\n\t                                _didIteratorError = false;\n\t                                _iteratorError = undefined;\n\t                                _context2.prev = 7;\n\t                                for (_iterator = layers[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                                    layer = _step.value;\n\t\n\t                                    tileData[layer.name] = layer.features;\n\t                                }\n\t                                _context2.next = 15;\n\t                                break;\n\t\n\t                            case 11:\n\t                                _context2.prev = 11;\n\t                                _context2.t0 = _context2['catch'](7);\n\t                                _didIteratorError = true;\n\t                                _iteratorError = _context2.t0;\n\t\n\t                            case 15:\n\t                                _context2.prev = 15;\n\t                                _context2.prev = 16;\n\t\n\t                                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                                    _iterator.return();\n\t                                }\n\t\n\t                            case 18:\n\t                                _context2.prev = 18;\n\t\n\t                                if (!_didIteratorError) {\n\t                                    _context2.next = 21;\n\t                                    break;\n\t                                }\n\t\n\t                                throw _iteratorError;\n\t\n\t                            case 21:\n\t                                return _context2.finish(18);\n\t\n\t                            case 22:\n\t                                return _context2.finish(15);\n\t\n\t                            case 23:\n\t                                _context2.next = 26;\n\t                                break;\n\t\n\t                            case 25:\n\t                                tileData = null;\n\t\n\t                            case 26:\n\t                                return _context2.abrupt('return', {\n\t                                    tileData: tileData,\n\t                                    coords: originalDataTileCoords\n\t                                });\n\t\n\t                            case 27:\n\t                            case 'end':\n\t                                return _context2.stop();\n\t                        }\n\t                    }\n\t                }, _callee2, this, [[7, 11, 15, 23], [16,, 18, 22]]);\n\t            }));\n\t\n\t            function _processResponse(_x3, _x4) {\n\t                return _ref3.apply(this, arguments);\n\t            }\n\t\n\t            return _processResponse;\n\t        }()\n\t    }]);\n\t\n\t    return MapillaryLoader;\n\t}(_tiledDataLoader.TiledDataLoader);\n\t\n\texports.MapillaryLoader = MapillaryLoader;\n\n/***/ },\n/* 196 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.decodeMvt = undefined;\n\t\n\tvar _pbf = __webpack_require__(479);\n\t\n\tvar _pbf2 = _interopRequireDefault(_pbf);\n\t\n\tvar _vector_tile_proto = __webpack_require__(197);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction decodeCoordinate(x) {\n\t    return x >> 1 ^ -(x & 1);\n\t}\n\t\n\tfunction parseGeometry(geometryType, ints, coordinatesScale) {\n\t    if (geometryType !== _vector_tile_proto.Tile.GeomType.POINT && geometryType !== _vector_tile_proto.Tile.GeomType.LINESTRING && geometryType !== _vector_tile_proto.Tile.GeomType.POLYGON) {\n\t        throw new Error('Unknown feature geometry type ' + geometryType);\n\t    }\n\t    var len = ints.length;\n\t    var pos = 0;\n\t    var lineStrings = [];\n\t    var line = void 0;\n\t    var x = 0,\n\t        y = 0;\n\t    while (pos < len) {\n\t        var i = ints[pos];\n\t        var cmd = i & 0x7;\n\t        var cmdRepeat = i >> 3;\n\t        switch (cmd) {\n\t            case 1:\n\t                // MoveTo\n\t                if (cmdRepeat !== 1) {\n\t                    throw new Error('repeat=' + cmdRepeat + ' for command MoveTo');\n\t                }\n\t                if (pos + 2 > len) {\n\t                    throw new Error('Not enough elements for MoveTo arguments');\n\t                }\n\t                if (line) {\n\t                    lineStrings.push(line);\n\t                }\n\t                x += decodeCoordinate(ints[pos + 1]);\n\t                y += decodeCoordinate(ints[pos + 2]);\n\t                line = [[x * coordinatesScale, y * coordinatesScale]];\n\t                pos += 3;\n\t                break;\n\t            case 2:\n\t                // LineTo\n\t                if (cmdRepeat < 1) {\n\t                    throw new Error('repeat=' + cmdRepeat + ' for command LineTo');\n\t                }\n\t                if (!line) {\n\t                    throw new Error('LineTo with empty linestring');\n\t                }\n\t                pos += 1;\n\t                for (var cmdN = 0; cmdN < cmdRepeat; cmdN++) {\n\t                    if (pos + 2 > len) {\n\t                        throw new Error('Not enough elements for LineTo arguments');\n\t                    }\n\t                    x += decodeCoordinate(ints[pos]);\n\t                    y += decodeCoordinate(ints[pos + 1]);\n\t                    line.push([x * coordinatesScale, y * coordinatesScale]);\n\t                    pos += 2;\n\t                }\n\t                break;\n\t            case 7:\n\t                // ClosePath\n\t                if (geometryType !== _vector_tile_proto.Tile.GeomType.POLYGON) {\n\t                    throw new Error('ClosePath command for non-polygon type ' + geometryType);\n\t                }\n\t                if (!line) {\n\t                    throw new Error('ClosePath with empty linestring');\n\t                }\n\t                if (cmdRepeat !== 1) {\n\t                    throw new Error('ClosePath repeats ' + cmdRepeat + ' times');\n\t                }\n\t                line.push(line[0]);\n\t                pos += 1;\n\t                break;\n\t            default:\n\t                throw new Error('Unknown command ' + i + ' & 0x7 = ' + cmd);\n\t        }\n\t    }\n\t    if (line) {\n\t        lineStrings.push(line);\n\t    }\n\t    var geometry = {};\n\t    switch (geometryType) {\n\t        case _vector_tile_proto.Tile.GeomType.POINT:\n\t            if (lineStrings.length !== 1 || lineStrings[0].length !== 1) {\n\t                throw new Error('Invalid coordinates number for point');\n\t            }\n\t            geometry.type = 'Point';\n\t            geometry.coordinates = lineStrings[0][0];\n\t            break;\n\t        case _vector_tile_proto.Tile.GeomType.LINESTRING:\n\t            geometry.type = 'MultiLineString';\n\t            geometry.coordinates = lineStrings;\n\t            break;\n\t        case _vector_tile_proto.Tile.GeomType.POLYGON:\n\t            geometry.type = 'Polygon';\n\t            geometry.coordinates = lineStrings;\n\t            break;\n\t        default:\n\t    }\n\t    return geometry;\n\t}\n\t\n\tfunction parseFeatures(layer, coordinatesScale) {\n\t    var features = [];\n\t    var _iteratorNormalCompletion = true;\n\t    var _didIteratorError = false;\n\t    var _iteratorError = undefined;\n\t\n\t    try {\n\t        for (var _iterator = layer.features[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t            var feature = _step.value;\n\t\n\t            var geometry = parseGeometry(feature.type, feature.geometry, coordinatesScale);\n\t            features.push({ geometry: geometry });\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion && _iterator.return) {\n\t                _iterator.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError) {\n\t                throw _iteratorError;\n\t            }\n\t        }\n\t    }\n\t\n\t    return features;\n\t}\n\t\n\tfunction decodeMvt(ar) {\n\t    var tileExtent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 256;\n\t\n\t    var pbf = new _pbf2.default(new Uint8Array(ar)),\n\t        tileData = _vector_tile_proto.Tile.read(pbf);\n\t    var parsedLayers = [];\n\t    var _iteratorNormalCompletion2 = true;\n\t    var _didIteratorError2 = false;\n\t    var _iteratorError2 = undefined;\n\t\n\t    try {\n\t        for (var _iterator2 = tileData.layers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t            var layer = _step2.value;\n\t\n\t            var scale = tileExtent / layer.extent;\n\t            parsedLayers.push({\n\t                name: layer.name,\n\t                features: parseFeatures(layer, scale)\n\t            });\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError2 = true;\n\t        _iteratorError2 = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                _iterator2.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError2) {\n\t                throw _iteratorError2;\n\t            }\n\t        }\n\t    }\n\t\n\t    return parsedLayers;\n\t}\n\t\n\texports.decodeMvt = decodeMvt;\n\n/***/ },\n/* 197 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\t// code generated by pbf v3.0.5\n\t\n\t// Tile ========================================\n\t\n\tvar Tile = exports.Tile = {};\n\t\n\tTile.read = function (pbf, end) {\n\t    return pbf.readFields(Tile._readField, { layers: [] }, end);\n\t};\n\tTile._readField = function (tag, obj, pbf) {\n\t    if (tag === 3) obj.layers.push(Tile.Layer.read(pbf, pbf.readVarint() + pbf.pos));\n\t};\n\t\n\tTile.GeomType = {\n\t    \"UNKNOWN\": 0,\n\t    \"POINT\": 1,\n\t    \"LINESTRING\": 2,\n\t    \"POLYGON\": 3\n\t};\n\t\n\t// Tile.Feature ========================================\n\t\n\tTile.Feature = {};\n\t\n\tTile.Feature.read = function (pbf, end) {\n\t    return pbf.readFields(Tile.Feature._readField, { id: 0, tags: [], type: 0, geometry: [] }, end);\n\t};\n\tTile.Feature._readField = function (tag, obj, pbf) {\n\t    if (tag === 3) obj.type = pbf.readVarint();else if (tag === 4) pbf.readPackedVarint(obj.geometry);\n\t};\n\t\n\t// Tile.Layer ========================================\n\t\n\tTile.Layer = {};\n\t\n\tTile.Layer.read = function (pbf, end) {\n\t    return pbf.readFields(Tile.Layer._readField, { version: 0, name: \"\", features: [], keys: [], values: [], extent: 0 }, end);\n\t};\n\tTile.Layer._readField = function (tag, obj, pbf) {\n\t    if (tag === 15) obj.version = pbf.readVarint();else if (tag === 1) obj.name = pbf.readString();else if (tag === 2) obj.features.push(Tile.Feature.read(pbf, pbf.readVarint() + pbf.pos));else if (tag === 5) obj.extent = pbf.readVarint();\n\t};\n\n/***/ },\n/* 198 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.WikimediaVectorCoverage = exports.MultiLayer = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _tiledDataLoader = __webpack_require__(83);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar MultiLayer = _leaflet2.default.Layer.extend({\n\t    initialize: function initialize(layers) {\n\t        this.layers = layers;\n\t    },\n\t\n\t    setLayersVisibility: function setLayersVisibility(e) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t\n\t        var newZoom = void 0;\n\t        if (e && e.zoom !== undefined) {\n\t            newZoom = e.zoom;\n\t        } else {\n\t            newZoom = this._map.getZoom();\n\t        }\n\t\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = this.layers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var layer = _step.value;\n\t\n\t                if (layer.minZoom <= newZoom && newZoom <= layer.maxZoom) {\n\t                    this._map.addLayer(layer.layer);\n\t                } else {\n\t                    this._map.removeLayer(layer.layer);\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        this.setLayersVisibility();\n\t        map.on('zoomend', this.setLayersVisibility, this);\n\t    },\n\t\n\t    onRemove: function onRemove() {\n\t        var _iteratorNormalCompletion2 = true;\n\t        var _didIteratorError2 = false;\n\t        var _iteratorError2 = undefined;\n\t\n\t        try {\n\t            for (var _iterator2 = this.layers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                var layer = _step2.value;\n\t\n\t                this._map.removeLayer(layer.layer);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError2 = true;\n\t            _iteratorError2 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                    _iterator2.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError2) {\n\t                    throw _iteratorError2;\n\t                }\n\t            }\n\t        }\n\t\n\t        this._map.off('zoomend', this.setLayersVisibility, this);\n\t        this._map.off('zoomanim', this.setLayersVisibility, this);\n\t        this._map = null;\n\t    }\n\t\n\t});\n\t\n\tvar WikimediaLoader = function (_TiledDataLoader) {\n\t    _inherits(WikimediaLoader, _TiledDataLoader);\n\t\n\t    function WikimediaLoader(urlTemplate, zoom) {\n\t        _classCallCheck(this, WikimediaLoader);\n\t\n\t        var _this = _possibleConstructorReturn(this, (WikimediaLoader.__proto__ || Object.getPrototypeOf(WikimediaLoader)).call(this));\n\t\n\t        _this.url = urlTemplate;\n\t        _this.maxZoom = zoom;\n\t        return _this;\n\t    }\n\t\n\t    _createClass(WikimediaLoader, [{\n\t        key: 'getTileUrl',\n\t        value: function getTileUrl(coords) {\n\t            var data = {\n\t                x: coords.x,\n\t                z: coords.z,\n\t                y: Math.pow(2, coords.z) - 1 - coords.y\n\t            };\n\t            return _leaflet2.default.Util.template(this.url, data);\n\t        }\n\t    }, {\n\t        key: 'layerTileToDataTileCoords',\n\t        value: function layerTileToDataTileCoords(layerTileCoords) {\n\t            var z = layerTileCoords.z;\n\t            var z2 = null;\n\t            if (z > this.maxZoom) {\n\t                z2 = this.maxZoom;\n\t            } else {\n\t                return { z: z, x: layerTileCoords.x, y: layerTileCoords.y };\n\t            }\n\t\n\t            var multiplier = 1 << z - z2;\n\t            return {\n\t                x: Math.floor(layerTileCoords.x / multiplier),\n\t                y: Math.floor(layerTileCoords.y / multiplier),\n\t                z: z2\n\t            };\n\t        }\n\t    }, {\n\t        key: 'makeRequestData',\n\t        value: function makeRequestData(dataTileCoords) {\n\t            return {\n\t                url: this.getTileUrl(dataTileCoords),\n\t                options: {\n\t                    responseType: 'arraybuffer',\n\t                    timeout: 5000,\n\t                    isResponseSuccess: function isResponseSuccess(xhr) {\n\t                        return xhr.status === 200 || xhr.status === 404;\n\t                    }\n\t                }\n\t            };\n\t        }\n\t    }, {\n\t        key: 'processResponse',\n\t        value: function () {\n\t            var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(xhr, originalDataTileCoords) {\n\t                var tileData;\n\t                return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                    while (1) {\n\t                        switch (_context.prev = _context.next) {\n\t                            case 0:\n\t                                tileData = void 0;\n\t\n\t                                if (originalDataTileCoords.z >= this.maxZoom && xhr.status === 200 && xhr.response) {\n\t                                    tileData = new Uint16Array(xhr.response);\n\t                                } else {\n\t                                    tileData = null;\n\t                                }\n\t\n\t                                return _context.abrupt('return', {\n\t                                    tileData: tileData,\n\t                                    coords: originalDataTileCoords\n\t                                });\n\t\n\t                            case 3:\n\t                            case 'end':\n\t                                return _context.stop();\n\t                        }\n\t                    }\n\t                }, _callee, this);\n\t            }));\n\t\n\t            function processResponse(_x, _x2) {\n\t                return _ref.apply(this, arguments);\n\t            }\n\t\n\t            return processResponse;\n\t        }()\n\t    }]);\n\t\n\t    return WikimediaLoader;\n\t}(_tiledDataLoader.TiledDataLoader);\n\t\n\tvar WikimediaVectorCoverage = _leaflet2.default.GridLayer.extend({\n\t    options: {\n\t        tileSize: 256,\n\t        // updateWhenIdle: true,\n\t        color: '#ff00ff'\n\t    },\n\t\n\t    initialize: function initialize(url, options) {\n\t        _leaflet2.default.GridLayer.prototype.initialize.call(this, options);\n\t        this.loader = new WikimediaLoader(url, 11);\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        _leaflet2.default.GridLayer.prototype.onAdd.call(this, map);\n\t        this.on('tileunload', this.onTileUnload, this);\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        _leaflet2.default.GridLayer.prototype.onRemove.call(this, map);\n\t        this.off('tileunload', this.onTileUnload, this);\n\t    },\n\t\n\t    onTileUnload: function onTileUnload(e) {\n\t        var tile = e.tile;\n\t        tile._abortLoading();\n\t        delete tile._tileData;\n\t        delete tile._adjustment;\n\t    },\n\t\n\t    drawTile: function drawTile(canvas, coords) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        if (!canvas._tileData) {\n\t            return;\n\t        }\n\t        var dataOffset = 5000;\n\t        var dataExtent = 65535 - 2 * dataOffset;\n\t        var tileData = canvas._tileData;\n\t        var _canvas$_adjustment = canvas._adjustment,\n\t            multiplier = _canvas$_adjustment.multiplier,\n\t            offsetX = _canvas$_adjustment.offsetX,\n\t            offsetY = _canvas$_adjustment.offsetY;\n\t\n\t        var canvasCtx = canvas.getContext('2d');\n\t        var pixelScale = multiplier * 256 / dataExtent;\n\t        canvasCtx.fillStyle = this.options.color;\n\t        for (var i = 0, l = tileData.length; i < l; i += 2) {\n\t            var x = (tileData[i] - dataOffset) * pixelScale - offsetX * 256;\n\t            var y = (tileData[i + 1] - dataOffset) * pixelScale - offsetY * 256;\n\t            canvasCtx.beginPath();\n\t            canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n\t            canvasCtx.fill();\n\t        }\n\t    },\n\t\n\t    createTile: function createTile(coords, done) {\n\t        var _this2 = this;\n\t\n\t        var canvas = _leaflet2.default.DomUtil.create('canvas', 'leaflet-tile');\n\t        canvas.width = this.options.tileSize;\n\t        canvas.height = this.options.tileSize;\n\t\n\t        var _loader$requestTileDa = this.loader.requestTileData(coords),\n\t            dataPromise = _loader$requestTileDa.dataPromise,\n\t            abortLoading = _loader$requestTileDa.abortLoading;\n\t\n\t        dataPromise.then(function (data) {\n\t            canvas._tileData = data.tileData;\n\t            canvas._adjustment = data.adjustment || { multiplier: 1, offsetX: 0, offsetY: 0 };\n\t            setTimeout(function () {\n\t                _this2.drawTile(canvas, coords);\n\t                done(null, canvas);\n\t            }, 1);\n\t        });\n\t\n\t        canvas._abortLoading = abortLoading;\n\t        return canvas;\n\t    }\n\t});\n\t\n\texports.MultiLayer = MultiLayer;\n\texports.WikimediaVectorCoverage = WikimediaVectorCoverage;\n\n/***/ },\n/* 199 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar getPanoramaAtPos = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(latlng, searchRadiusMeters) {\n\t        var clusterSize, urlTemplate, url, resp, photos;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        clusterSize = 10;\n\t                        urlTemplate = 'https://commons.wikimedia.org/w/api.php?' + 'origin=*&format=json&action=query&generator=geosearch&' + 'ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&' + 'ggsradius={radius}&ggscoord={lat}|{lng}&' + 'iiurlwidth=134&' + 'prop=imageinfo|coordinates&' + 'iiprop=url|mime|size|extmetadata|commonmetadata|metadata';\n\t\n\t                        searchRadiusMeters += clusterSize;\n\t                        if (searchRadiusMeters < 10) {\n\t                            searchRadiusMeters = 10;\n\t                        }\n\t                        if (searchRadiusMeters > 10000) {\n\t                            searchRadiusMeters = 10000;\n\t                        }\n\t                        url = _leaflet2.default.Util.template(urlTemplate, { lat: latlng.lat, lng: latlng.lng, radius: searchRadiusMeters });\n\t                        _context.next = 8;\n\t                        return (0, _xhrPromise.fetch)(url, { responseType: 'json', timeout: 10000 });\n\t\n\t                    case 8:\n\t                        resp = _context.sent;\n\t\n\t                        if (!(resp.status === 200)) {\n\t                            _context.next = 20;\n\t                            break;\n\t                        }\n\t\n\t                        photos = parseSearchResponse(resp.responseJSON);\n\t\n\t                        if (!photos) {\n\t                            _context.next = 19;\n\t                            break;\n\t                        }\n\t\n\t                        latlng = _leaflet2.default.latLng(latlng.lat, latlng.lng);\n\t                        photos.sort(isCloser.bind(null, latlng));\n\t                        latlng = _leaflet2.default.latLng(photos[0].lat, photos[0].lng);\n\t                        photos = photos.filter(function (photo) {\n\t                            return latlng.distanceTo(_leaflet2.default.latLng(photo.lat, photo.lng)) <= clusterSize;\n\t                        }, latlng);\n\t                        return _context.abrupt('return', {\n\t                            found: true,\n\t                            data: photos\n\t                        });\n\t\n\t                    case 19:\n\t                        return _context.abrupt('return', { found: false });\n\t\n\t                    case 20:\n\t                        return _context.abrupt('return', { found: false });\n\t\n\t                    case 21:\n\t                    case 'end':\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function getPanoramaAtPos(_x, _x2) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _coverageLayer = __webpack_require__(198);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\t__webpack_require__(456);\n\t\n\t__webpack_require__(166);\n\t\n\tvar _config = __webpack_require__(34);\n\t\n\tvar _config2 = _interopRequireDefault(_config);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction getCoverageLayer(options) {\n\t    var url = _config2.default.wikimediaCommonsCoverageUrl;\n\t    return new _coverageLayer.MultiLayer([{ layer: _leaflet2.default.tileLayer(url, _leaflet2.default.extend({}, options, { tms: true })),\n\t        minZoom: 0, maxZoom: 10 }, { layer: new _coverageLayer.WikimediaVectorCoverage(url, options),\n\t        minZoom: 11, maxZoom: 18 }]);\n\t}\n\t\n\tfunction parseSearchResponse(resp) {\n\t    var images = [];\n\t    if (resp && resp.query && resp.query.pages && resp.query.pages) {\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = Object.values(resp.query.pages)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var page = _step.value;\n\t\n\t                var iinfo = page.imageinfo[0];\n\t                var imageDescription = iinfo.extmetadata.ImageDescription ? iinfo.extmetadata.ImageDescription.value : null;\n\t                var objectDescription = iinfo.extmetadata.ObjectName ? iinfo.extmetadata.ObjectName.value : null;\n\t                if (imageDescription && /^<table (.|\\n)+<\\/table>$/.test(imageDescription)) {\n\t                    imageDescription = null;\n\t                }\n\t                if (imageDescription) {\n\t                    imageDescription = imageDescription.replace(/<[^>]+>/g, '');\n\t                    imageDescription = imageDescription.replace(/[\\n\\r]/g, '');\n\t                }\n\t                if (imageDescription && objectDescription && objectDescription.toLowerCase().includes(imageDescription.toLowerCase())) {\n\t                    imageDescription = null;\n\t                }\n\t                if (objectDescription && imageDescription && imageDescription.toLowerCase().includes(objectDescription.toLowerCase())) {\n\t                    objectDescription = null;\n\t                }\n\t                var description = 'Wikimedia commons';\n\t                if (objectDescription || imageDescription) {\n\t                    description = '';\n\t                    if (objectDescription) {\n\t                        description = objectDescription;\n\t                    }\n\t                    if (imageDescription) {\n\t                        if (objectDescription) {\n\t                            description += '</br>';\n\t                        }\n\t                        description += imageDescription;\n\t                    }\n\t                }\n\t\n\t                var author = iinfo.extmetadata.Artist ? iinfo.extmetadata.Artist.value : null;\n\t                if (author && /^<table (.|\\n)+<\\/table>$/.test(author)) {\n\t                    author = 'See author info at <a href=\"' + iinfo.descriptionurl + '\">Wikimedia commons</a>';\n\t                }\n\t\n\t                // original images can be rotated, 90 degrees\n\t                // thumbnails are always oriented right\n\t                // so we request thumbnail of original image size\n\t                var url = iinfo.thumburl.replace('134px', iinfo.width + 'px');\n\t                images.push({\n\t                    url: url,\n\t                    width: iinfo.width,\n\t                    height: iinfo.height,\n\t                    lat: page.coordinates[0].lat,\n\t                    lng: page.coordinates[0].lon,\n\t                    author: author,\n\t                    timeOriginal: iinfo.extmetadata.DateTimeOriginal ? iinfo.extmetadata.DateTimeOriginal.value : null,\n\t                    time: iinfo.extmetadata.DateTime ? iinfo.extmetadata.DateTime.value : null,\n\t                    description: description,\n\t                    pageUrl: iinfo.descriptionurl,\n\t                    pageId: page.pageid.toString()\n\t                });\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        if (images.length) {\n\t            return images;\n\t        }\n\t    }\n\t    return null;\n\t}\n\t\n\tfunction isCloser(target, a, b) {\n\t    var d1 = target.distanceTo(a);\n\t    var d2 = target.distanceTo(b);\n\t    if (d1 < d2) {\n\t        return -1;\n\t    } else if (d1 === d2) {\n\t        return 0;\n\t    } else {\n\t        return 1;\n\t    }\n\t}\n\t\n\tfunction formatDateTime(dateStr) {\n\t    var m = /^(\\d+)-(\\d+)-(\\d+)/.exec(dateStr);\n\t    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n\t    if (m) {\n\t        var _m$slice = m.slice(1),\n\t            _m$slice2 = _slicedToArray(_m$slice, 3),\n\t            year = _m$slice2[0],\n\t            month = _m$slice2[1],\n\t            day = _m$slice2[2];\n\t\n\t        return day + ' ' + months[month - 1] + ' ' + year;\n\t    } else {\n\t        return dateStr;\n\t    }\n\t}\n\t\n\tvar Viewer = _leaflet2.default.Evented.extend({\n\t    initialize: function initialize(container) {\n\t        var _this = this;\n\t\n\t        container = _leaflet2.default.DomUtil.create('div', 'wikimedia-viewer-container', container);\n\t        var mapContainer = this.mapContainer = _leaflet2.default.DomUtil.create('div', 'wikimedia-viewer-map-container', container);\n\t        this.pageButtonContainer = _leaflet2.default.DomUtil.create('div', 'wikimedia-viewer-page-buttons-container', container);\n\t\n\t        this.map = _leaflet2.default.map(mapContainer, {\n\t            maxBoundsViscosity: 1,\n\t            crs: _leaflet2.default.CRS.Simple,\n\t            zoomControl: false,\n\t            attributionControl: false,\n\t            zoomSnap: 0\n\t        });\n\t\n\t        this.map.on('zoomend', this.notifyChange, this);\n\t        this.map.on('moveend', this.notifyChange, this);\n\t\n\t        this.infoLabel = _leaflet2.default.DomUtil.create('div', 'wikimedia-viewer-info-overlay', mapContainer);\n\t        this.closeButton = _leaflet2.default.DomUtil.create('div', 'photo-viewer-button-close', container);\n\t        this.prevPhotoButton = _leaflet2.default.DomUtil.create('div', 'wikimedia-viewer-button-prev', mapContainer);\n\t        this.nextPhotoButton = _leaflet2.default.DomUtil.create('div', 'wikimedia-viewer-button-next', mapContainer);\n\t        _leaflet2.default.DomEvent.on(this.prevPhotoButton, 'click', function () {\n\t            _this.switchPhoto(_this._imageIdx - 1);\n\t        });\n\t        _leaflet2.default.DomEvent.on(this.nextPhotoButton, 'click', function () {\n\t            _this.switchPhoto(_this._imageIdx + 1);\n\t        });\n\t        _leaflet2.default.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n\t    },\n\t\n\t    setupPageButtons: function setupPageButtons(count) {\n\t        var _this2 = this;\n\t\n\t        if (this._buttons) {\n\t            var _iteratorNormalCompletion2 = true;\n\t            var _didIteratorError2 = false;\n\t            var _iteratorError2 = undefined;\n\t\n\t            try {\n\t                for (var _iterator2 = this._buttons[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                    var button = _step2.value;\n\t\n\t                    this.pageButtonContainer.removeChild(button);\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError2 = true;\n\t                _iteratorError2 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                        _iterator2.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError2) {\n\t                        throw _iteratorError2;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t        this._buttons = [];\n\t        if (count > 1) {\n\t            _leaflet2.default.DomUtil.addClass(this.pageButtonContainer, 'enabled');\n\t\n\t            var _loop = function _loop(i) {\n\t                var button = _leaflet2.default.DomUtil.create('div', 'wikimedia-viewer-page-button', _this2.pageButtonContainer);\n\t                button.innerHTML = '' + (i + 1);\n\t                _this2._buttons.push(button);\n\t                _leaflet2.default.DomEvent.on(button, 'click', function () {\n\t                    return _this2.switchPhoto(i);\n\t                });\n\t            };\n\t\n\t            for (var i = 0; i < count; i++) {\n\t                _loop(i);\n\t            }\n\t        } else {\n\t            _leaflet2.default.DomUtil.removeClass(this.pageButtonContainer, 'enabled');\n\t        }\n\t    },\n\t\n\t    switchPhoto: function switchPhoto(imageIdx) {\n\t        var _this3 = this;\n\t\n\t        var imagePos = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\n\t        this._imageIdx = imageIdx;\n\t        if (this.imageLayer) {\n\t            this.map.removeLayer(this.imageLayer);\n\t        }\n\t        var image = this.images[imageIdx];\n\t        var mapSize = this.map.getSize();\n\t        if (!mapSize.x || !mapSize.y) {\n\t            mapSize = { x: 500, y: 500 };\n\t        }\n\t        var maxZoom = Math.log2(Math.max(image.width / mapSize.x, image.height / mapSize.y)) + 2;\n\t        if (maxZoom < 1) {\n\t            maxZoom = 1;\n\t        }\n\t        var southWest = this.map.unproject([0, image.height], maxZoom - 2),\n\t            northEast = this.map.unproject([image.width, 0], maxZoom - 2);\n\t        var bounds = new _leaflet2.default.LatLngBounds(southWest, northEast);\n\t        this.map.setMaxZoom(maxZoom);\n\t        this.map.setMaxBounds(bounds);\n\t        if (imagePos) {\n\t            this.map.setView(imagePos.center, imagePos.zoom, { animate: false });\n\t        } else {\n\t            this.map.fitBounds(bounds, { animate: false });\n\t        }\n\t\n\t        this.imageLayer = _leaflet2.default.imageOverlay(null, bounds);\n\t        _leaflet2.default.DomUtil.addClass(this.mapContainer, 'loading');\n\t        this.imageLayer.on('load', function () {\n\t            _leaflet2.default.DomUtil.removeClass(_this3.mapContainer, 'loading');\n\t        });\n\t        this.imageLayer.setUrl(image.url);\n\t        this.imageLayer.addTo(this.map);\n\t        var caption = [];\n\t\n\t        if (image.timeOriginal) {\n\t            caption.push(formatDateTime(image.timeOriginal));\n\t        }\n\t        if (image.author) {\n\t            caption.push(image.author);\n\t        }\n\t        caption.push('<a href=\"' + image.pageUrl + '\">' + image.description + '</a>');\n\t        caption = caption.join('</br>');\n\t        this.infoLabel.innerHTML = caption;\n\t\n\t        if (imageIdx > 0) {\n\t            _leaflet2.default.DomUtil.addClass(this.prevPhotoButton, 'enabled');\n\t        } else {\n\t            _leaflet2.default.DomUtil.removeClass(this.prevPhotoButton, 'enabled');\n\t        }\n\t        if (imageIdx < this.images.length - 1) {\n\t            _leaflet2.default.DomUtil.addClass(this.nextPhotoButton, 'enabled');\n\t        } else {\n\t            _leaflet2.default.DomUtil.removeClass(this.nextPhotoButton, 'enabled');\n\t        }\n\t        var _iteratorNormalCompletion3 = true;\n\t        var _didIteratorError3 = false;\n\t        var _iteratorError3 = undefined;\n\t\n\t        try {\n\t            for (var _iterator3 = this._buttons.entries()[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                var _step3$value = _slicedToArray(_step3.value, 2),\n\t                    i = _step3$value[0],\n\t                    button = _step3$value[1];\n\t\n\t                (i === imageIdx ? _leaflet2.default.DomUtil.addClass : _leaflet2.default.DomUtil.removeClass)(button, 'active');\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError3 = true;\n\t            _iteratorError3 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                    _iterator3.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError3) {\n\t                    throw _iteratorError3;\n\t                }\n\t            }\n\t        }\n\t\n\t        this.notifyChange();\n\t    },\n\t\n\t    notifyChange: function notifyChange() {\n\t        if (this.images && this._active) {\n\t            var image = this.images[this._imageIdx];\n\t            this.fire('change', {\n\t                latlng: _leaflet2.default.latLng(image.lat, image.lng),\n\t                latlngs: this.images.map(function (image) {\n\t                    return _leaflet2.default.latLng(image.lat, image.lng);\n\t                })\n\t\n\t            });\n\t        }\n\t    },\n\t\n\t    _showPano: function _showPano(images) {\n\t        var imageIdx = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\t        var imagePos = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\n\t        this.images = images;\n\t        this.setupPageButtons(images.length);\n\t        this.switchPhoto(imageIdx, imagePos);\n\t    },\n\t\n\t    showPano: function showPano(images) {\n\t        this._showPano(images);\n\t    },\n\t\n\t    onCloseClick: function onCloseClick() {\n\t        this.fire('closeclick');\n\t    },\n\t\n\t    activate: function activate() {\n\t        this._active = true;\n\t    },\n\t\n\t    deactivate: function deactivate() {\n\t        this._active = false;\n\t    },\n\t\n\t    setState: function setState(state) {\n\t        var _this4 = this;\n\t\n\t        var lat = parseFloat(state[0]);\n\t        var lng = parseFloat(state[1]);\n\t        var pageId = state[2];\n\t        var y = parseFloat(state[3]);\n\t        var x = parseFloat(state[4]);\n\t        var zoom = parseFloat(state[5]);\n\t        if (!isNaN(lat) && !isNaN(lng) && !isNaN(x) && !isNaN(y) && !isNaN(zoom)) {\n\t            var imageIdx = -1;\n\t            getPanoramaAtPos({ lat: lat, lng: lng }, 0).then(function (resp) {\n\t                if (!resp.found) {\n\t                    return false;\n\t                }\n\t                var _iteratorNormalCompletion4 = true;\n\t                var _didIteratorError4 = false;\n\t                var _iteratorError4 = undefined;\n\t\n\t                try {\n\t                    for (var _iterator4 = resp.data.entries()[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t                        var _step4$value = _slicedToArray(_step4.value, 2),\n\t                            i = _step4$value[0],\n\t                            image = _step4$value[1];\n\t\n\t                        if (image.pageId === pageId) {\n\t                            imageIdx = i;\n\t                            break;\n\t                        }\n\t                    }\n\t                } catch (err) {\n\t                    _didIteratorError4 = true;\n\t                    _iteratorError4 = err;\n\t                } finally {\n\t                    try {\n\t                        if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                            _iterator4.return();\n\t                        }\n\t                    } finally {\n\t                        if (_didIteratorError4) {\n\t                            throw _iteratorError4;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                if (imageIdx > -1) {\n\t                    _this4._showPano(resp.data, imageIdx, { center: _leaflet2.default.latLng(y, x), zoom: zoom });\n\t                }\n\t            });\n\t            return true;\n\t        }\n\t        return false;\n\t    },\n\t\n\t    getState: function getState() {\n\t        if (!this.images) {\n\t            return [];\n\t        }\n\t        var center = this.map.getCenter();\n\t        return [this.images[0].lat.toFixed(6), this.images[0].lng.toFixed(6), this.images[this._imageIdx].pageId, center.lat.toFixed(2), center.lng.toFixed(2), this.map.getZoom().toFixed(1)];\n\t    }\n\t});\n\t\n\tfunction getViewer(container) {\n\t    return new Viewer(container);\n\t}\n\t\n\texports.default = {\n\t    getCoverageLayer: getCoverageLayer,\n\t    getPanoramaAtPos: getPanoramaAtPos,\n\t    getViewer: getViewer\n\t};\n\n/***/ },\n/* 200 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _knockout = __webpack_require__(51);\n\t\n\tvar _knockout2 = _interopRequireDefault(_knockout);\n\t\n\t__webpack_require__(113);\n\t\n\t__webpack_require__(38);\n\t\n\t__webpack_require__(458);\n\t\n\tvar _pageFeature = __webpack_require__(205);\n\t\n\tvar _pageFeature2 = _interopRequireDefault(_pageFeature);\n\t\n\tvar _contextmenu = __webpack_require__(56);\n\t\n\tvar _contextmenu2 = _interopRequireDefault(_contextmenu);\n\t\n\tvar _mapRender = __webpack_require__(204);\n\t\n\tvar _form = __webpack_require__(487);\n\t\n\tvar _form2 = _interopRequireDefault(_form);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _pdf = __webpack_require__(206);\n\t\n\tvar _browserFilesaver = __webpack_require__(64);\n\t\n\tvar _binaryStrings = __webpack_require__(50);\n\t\n\t__webpack_require__(61);\n\t\n\t__webpack_require__(31);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tvar _decoration = __webpack_require__(202);\n\t\n\tvar _decoration2 = __webpack_require__(203);\n\t\n\tvar _decoration3 = __webpack_require__(201);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\t_knockout2.default.extenders.checkNumberRange = function (target, range) {\n\t    return _knockout2.default.pureComputed({\n\t        read: target, //always return the original observables value\n\t        write: function write(newValue) {\n\t            newValue = parseFloat(newValue);\n\t            if (newValue >= range[0] && newValue <= range[1]) {\n\t                target(newValue);\n\t            } else {\n\t                target.notifySubscribers(target());\n\t            }\n\t        }\n\t    }).extend({ notify: 'always' });\n\t};\n\t\n\tfunction savePagesPdf(imagesInfo, resolution) {\n\t    var pdf = (0, _pdf.makePdf)(imagesInfo, resolution);\n\t    pdf = (0, _binaryStrings.blobFromString)(pdf);\n\t    (0, _browserFilesaver.saveAs)(pdf, 'map.pdf', true);\n\t}\n\t\n\tfunction _savePageJpg(page) {\n\t    (0, _browserFilesaver.saveAs)((0, _binaryStrings.blobFromString)(page.data), 'map.jpg', true);\n\t}\n\t\n\t_leaflet2.default.Control.PrintPages = _leaflet2.default.Control.extend({\n\t    options: { position: 'bottomleft' },\n\t\n\t    includes: [_leaflet2.default.Mixin.Events, _leaflet2.default.Mixin.HashState],\n\t\n\t    stateChangeEvents: ['change'],\n\t\n\t    pageSizes: [{ 'name': 'A1', width: 594, height: 841 }, { 'name': 'A2', width: 420, height: 594 }, { 'name': 'A3', width: 297, height: 420 }, { 'name': 'A4', width: 210, height: 297 }, { 'name': 'A5', width: 148, height: 210 }],\n\t\n\t    initialize: function initialize(options) {\n\t        _leaflet2.default.Control.prototype.initialize.call(this, options);\n\t        this.pages = [];\n\t        this.scale = _knockout2.default.observable(500).extend({ checkNumberRange: [1, 1000000] });\n\t        this.resolution = _knockout2.default.observable(300).extend({ checkNumberRange: [10, 9999] });\n\t        this.zoomLevel = _knockout2.default.observable('auto');\n\t        this.pageWidth = _knockout2.default.observable(210).extend({ checkNumberRange: [10, 9999] });\n\t        this.pageHeight = _knockout2.default.observable(297).extend({ checkNumberRange: [10, 9999] });\n\t        this.settingsExpanded = _knockout2.default.observable(false);\n\t        this.makingPdf = _knockout2.default.observable(false);\n\t        this.downloadProgressRange = _knockout2.default.observable();\n\t        this.downloadProgressDone = _knockout2.default.observable();\n\t        this.marginLeft = _knockout2.default.observable(3).extend({ checkNumberRange: [0, 99] });\n\t        this.marginRight = _knockout2.default.observable(3).extend({ checkNumberRange: [0, 99] });\n\t        this.marginTop = _knockout2.default.observable(3).extend({ checkNumberRange: [0, 99] });\n\t        this.marginBottom = _knockout2.default.observable(3).extend({ checkNumberRange: [0, 99] });\n\t        this.autoZoomLevels = _knockout2.default.observable({});\n\t        this.printSize = _knockout2.default.pureComputed(this._printSize, this);\n\t        this.printSize.subscribe(this.onPageSizeChanged, this);\n\t        this.scale.subscribe(this.onPageSizeChanged, this);\n\t        this.resolution.subscribe(this.onPageSizeChanged, this);\n\t        this.pageSizeDescription = _knockout2.default.pureComputed(this._displayPageSize, this);\n\t        this.pagesNum = _knockout2.default.observable(0);\n\t        this.pagesNumLabel = _knockout2.default.pureComputed(this._pagesNumLabel, this);\n\t        this.gridOn = _knockout2.default.observable(false);\n\t        this.magneticMerisiansdOn = _knockout2.default.observable(false);\n\t\n\t        //hash state notifications\n\t        this.scale.subscribe(this.notifyChange, this);\n\t        this.printSize.subscribe(this.notifyChange, this);\n\t        this.resolution.subscribe(this.notifyChange, this);\n\t        this.zoomLevel.subscribe(this.notifyChange, this);\n\t        this.gridOn.subscribe(this.notifyChange, this);\n\t        this.magneticMerisiansdOn.subscribe(this.notifyChange, this);\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'leaflet-control control-form control-print-pages');\n\t        this._stopContainerEvents();\n\t\n\t        map.on('move', this.updateFormZooms, this);\n\t        container.innerHTML = _form2.default;\n\t        _knockout2.default.applyBindings(this, container);\n\t        this.updateFormZooms();\n\t        return container;\n\t    },\n\t\n\t    setExpanded: function setExpanded() {\n\t        _leaflet2.default.DomUtil.removeClass(this._container, 'minimized');\n\t    },\n\t\n\t    setMinimized: function setMinimized() {\n\t        _leaflet2.default.DomUtil.addClass(this._container, 'minimized');\n\t    },\n\t\n\t    addPage: function addPage(isLandsacape, center) {\n\t        var _printSize = this.printSize(),\n\t            _printSize2 = _slicedToArray(_printSize, 2),\n\t            pageWidth = _printSize2[0],\n\t            pageHeight = _printSize2[1];\n\t\n\t        if (isLandsacape) {\n\t            var _ref = [pageHeight, pageWidth];\n\t            pageWidth = _ref[0];\n\t            pageHeight = _ref[1];\n\t        }\n\t        if (!center) {\n\t            center = this._map.getCenter();\n\t        }\n\t        var page = new _pageFeature2.default(center, [pageWidth, pageHeight], this.scale(), (this.pages.length + 1).toString());\n\t        page._rotated = isLandsacape;\n\t        page.addTo(this._map);\n\t        this.pages.push(page);\n\t        this.pagesNum(this.pages.length);\n\t        var cm = new _contextmenu2.default(this.makePageContexmenuItems.bind(this, page));\n\t        page.on('contextmenu', cm.show, cm);\n\t        page.on('click', this.rotatePage.bind(this, page));\n\t        page.on('move', this.updateFormZooms, this);\n\t        page.on('moveend', this.notifyChange, this);\n\t        this.updateFormZooms();\n\t        this.notifyChange();\n\t        return page;\n\t    },\n\t\n\t    addLandscapePage: function addLandscapePage() {\n\t        this.addPage(true);\n\t    },\n\t\n\t    addPortraitPage: function addPortraitPage() {\n\t        this.addPage(false);\n\t    },\n\t\n\t    removePage: function removePage(page) {\n\t        var i = this.pages.indexOf(page);\n\t        this.pages.splice(i, 1);\n\t        this.pagesNum(this.pages.length);\n\t        this._map.removeLayer(page);\n\t        for (; i < this.pages.length; i++) {\n\t            this.pages[i].setLabel((i + 1).toString());\n\t        }\n\t        this.notifyChange();\n\t        this.updateFormZooms();\n\t    },\n\t\n\t    removePages: function removePages() {\n\t        var _this = this;\n\t\n\t        this.pages.forEach(function (page) {\n\t            return page.removeFrom(_this._map);\n\t        });\n\t        this.pages = [];\n\t        this.pagesNum(this.pages.length);\n\t        this.notifyChange();\n\t        this.updateFormZooms();\n\t    },\n\t\n\t    onSavePdfClicked: function onSavePdfClicked() {\n\t        if (!this.pages.length) {\n\t            (0, _notifications.notify)('Add some pages to print');\n\t            return;\n\t        }\n\t        this.savePdf();\n\t    },\n\t\n\t    zoomForPrint: function zoomForPrint() {\n\t        var zoom = this.zoomLevel();\n\t        if (zoom === 'auto') {\n\t            zoom = this.suggestZooms();\n\t        } else {\n\t            zoom = { mapZoom: zoom, satZoom: zoom };\n\t        }\n\t        return zoom;\n\t    },\n\t\n\t    incrementProgress: function incrementProgress(inc, range) {\n\t        this.downloadProgressRange(range);\n\t        this.downloadProgressDone((this.downloadProgressDone() || 0) + inc);\n\t    },\n\t\n\t    savePdf: function savePdf() {\n\t        var _this2 = this;\n\t\n\t        _logging2.default.captureBreadcrumbWithUrl({ message: 'start save pdf' });\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        this.downloadProgressRange(1000);\n\t        this.downloadProgressDone(undefined);\n\t        this.makingPdf(true);\n\t        var pages = this.pages.map(function (page) {\n\t            return {\n\t                latLngBounds: page.getLatLngBounds(),\n\t                printSize: page.getPrintSize(),\n\t                label: page.getLabel()\n\t            };\n\t        });\n\t        var resolution = this.resolution();\n\t        var decorationLayers = [];\n\t        if (this.gridOn()) {\n\t            decorationLayers.push(new _decoration3.Grid());\n\t        }\n\t        if (this.magneticMerisiansdOn()) {\n\t            decorationLayers.push(new _decoration.MagneticMeridians());\n\t        }\n\t        decorationLayers.push(new _decoration2.OverlayScale());\n\t        (0, _mapRender.renderPages)({\n\t            map: this._map,\n\t            pages: pages,\n\t            zooms: this.zoomForPrint(),\n\t            resolution: resolution,\n\t            scale: this.scale(),\n\t            decorationLayers: decorationLayers,\n\t            progressCallback: this.incrementProgress.bind(this)\n\t        }).then(function (images) {\n\t            if (images) {\n\t                savePagesPdf(images, resolution);\n\t            }\n\t        }).catch(function (e) {\n\t            _logging2.default.captureException(e);\n\t            (0, _notifications.notify)('Failed to create PDF: ' + e.message);\n\t        }).then(function () {\n\t            return _this2.makingPdf(false);\n\t        });\n\t    },\n\t\n\t    savePageJpg: function savePageJpg(page) {\n\t        var _this3 = this;\n\t\n\t        _logging2.default.captureBreadcrumbWithUrl({ message: 'start save page jpg', data: { pageNumber: page.getLabel() } });\n\t        var pages = [{\n\t            latLngBounds: page.getLatLngBounds(),\n\t            printSize: page.getPrintSize(),\n\t            label: page.getLabel()\n\t        }];\n\t        var decorationLayers = [];\n\t        if (this.gridOn()) {\n\t            decorationLayers.push(new _decoration3.Grid());\n\t        }\n\t        if (this.magneticMerisiansdOn()) {\n\t            decorationLayers.push(new _decoration.MagneticMeridians());\n\t        }\n\t        decorationLayers.push(new _decoration2.OverlayScale());\n\t        this.downloadProgressRange(1000);\n\t        this.downloadProgressDone(undefined);\n\t        this.makingPdf(true);\n\t        (0, _mapRender.renderPages)({\n\t            map: this._map,\n\t            pages: pages,\n\t            zooms: this.zoomForPrint(),\n\t            resolution: this.resolution(),\n\t            scale: this.scale(),\n\t            decorationLayers: decorationLayers,\n\t            progressCallback: this.incrementProgress.bind(this)\n\t        }).then(function (images) {\n\t            return _savePageJpg(images[0]);\n\t        }).catch(function (e) {\n\t            _logging2.default.captureException(e);\n\t            (0, _notifications.notify)('Failed to create JPEG from page: ' + e.message);\n\t        }).then(function () {\n\t            return _this3.makingPdf(false);\n\t        });\n\t    },\n\t\n\t    onPageSizeChanged: function onPageSizeChanged() {\n\t        var _this4 = this;\n\t\n\t        var _printSize3 = this.printSize(),\n\t            _printSize4 = _slicedToArray(_printSize3, 2),\n\t            pageWidth = _printSize4[0],\n\t            pageHeight = _printSize4[1];\n\t\n\t        this.pages.forEach(function (page) {\n\t            var w = pageWidth,\n\t                h = pageHeight;\n\t\n\t            if (page._rotated) {\n\t                var _ref2 = [h, w];\n\t                w = _ref2[0];\n\t                h = _ref2[1];\n\t            }\n\t            page.setSize([w, h], _this4.scale());\n\t        });\n\t        this.updateFormZooms();\n\t    },\n\t\n\t    makePageContexmenuItems: function makePageContexmenuItems(page) {\n\t        var _this5 = this;\n\t\n\t        var items = [{ text: 'Rotate', callback: this.rotatePage.bind(this, page) }, '-', { text: 'Delete', callback: this.removePage.bind(this, page) }, '-', { text: 'Save image', callback: this.savePageJpg.bind(this, page), disabled: this.makingPdf() }];\n\t        if (this.pages.length > 1) {\n\t            items.push({ text: 'Change order', separator: true });\n\t            this.pages.forEach(function (p, i) {\n\t                if (p !== page) {\n\t                    items.push({\n\t                        text: (i + 1).toString(),\n\t                        callback: _this5.renumberPage.bind(_this5, page, i)\n\t                    });\n\t                }\n\t            });\n\t        }\n\t        return items;\n\t    },\n\t\n\t    rotatePage: function rotatePage(page) {\n\t        page._rotated = !page._rotated;\n\t        page.rotate();\n\t        this.notifyChange();\n\t    },\n\t\n\t    renumberPage: function renumberPage(page, newIndex) {\n\t        var oldIndex = this.pages.indexOf(page);\n\t        this.pages.splice(oldIndex, 1);\n\t        this.pages.splice(newIndex, 0, page);\n\t        for (var i = Math.min(oldIndex, newIndex); i < this.pages.length; i++) {\n\t            this.pages[i].setLabel((i + 1).toString());\n\t        }\n\t        this.notifyChange();\n\t    },\n\t\n\t    _printSize: function _printSize() {\n\t        return [this.pageWidth() - this.marginLeft() - this.marginRight(), this.pageHeight() - this.marginTop() - this.marginBottom()];\n\t    },\n\t\n\t    suggestZooms: function suggestZooms() {\n\t        var scale = this.scale(),\n\t            resolution = this.resolution();\n\t        var referenceLat = void 0;\n\t        if (this.pages.length > 0) {\n\t            var absLats = this.pages.map(function (page) {\n\t                return Math.abs(page.getLatLngBounds().getCenter().lat);\n\t            });\n\t            referenceLat = Math.min.apply(Math, _toConsumableArray(absLats));\n\t        } else {\n\t            if (!this._map) {\n\t                return [null, null];\n\t            }\n\t            referenceLat = this._map.getCenter().lat;\n\t        }\n\t        var targetMetersPerPixel = scale / (resolution / 2.54);\n\t        var mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n\t        var satZoom = Math.ceil(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n\t\n\t        targetMetersPerPixel = scale / (90 / 2.54) / 1.5;\n\t        mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n\t        var mapZoom = Math.round(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n\t        mapZoom = Math.min(mapZoom, 18);\n\t        satZoom = Math.min(satZoom, 18);\n\t        mapZoom = Math.max(mapZoom, 0);\n\t        satZoom = Math.max(satZoom, 0);\n\t        return { mapZoom: mapZoom, satZoom: satZoom };\n\t    },\n\t\n\t    updateFormZooms: function updateFormZooms() {\n\t        this.autoZoomLevels(this.suggestZooms());\n\t    },\n\t\n\t    _displayPageSize: function _displayPageSize() {\n\t        var width = this.pageWidth(),\n\t            height = this.pageHeight();\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = this.pageSizes[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var size = _step.value;\n\t\n\t                if (size.width === width && size.height === height) {\n\t                    return size.name;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        return width + ' x ' + height + ' mm';\n\t    },\n\t\n\t    notifyChange: function notifyChange() {\n\t        this.fire('change');\n\t    },\n\t\n\t    hasPages: function hasPages() {\n\t        return !!this.pages.length;\n\t    },\n\t\n\t    _pagesNumLabel: function _pagesNumLabel() {\n\t        var n = this.pagesNum();\n\t        var label = '';\n\t        if (n) {\n\t            label += n;\n\t        } else {\n\t            label = 'No';\n\t        }\n\t        label += ' page';\n\t        if (n === 0 || n > 1) {\n\t            label += 's';\n\t        }\n\t        return label;\n\t    },\n\t\n\t    serializeState: function serializeState() {\n\t        var pages = this.pages;\n\t        var state = null;\n\t        if (pages.length) {\n\t            state = [];\n\t            state.push(this.scale().toString());\n\t            state.push(this.resolution().toString());\n\t            state.push(this.zoomLevel().toString());\n\t            state.push(this.pageWidth().toString());\n\t            state.push(this.pageHeight().toString());\n\t            state.push(this.marginLeft().toString());\n\t            state.push(this.marginRight().toString());\n\t            state.push(this.marginTop().toString());\n\t            state.push(this.marginBottom().toString());\n\t            var _iteratorNormalCompletion2 = true;\n\t            var _didIteratorError2 = false;\n\t            var _iteratorError2 = undefined;\n\t\n\t            try {\n\t                for (var _iterator2 = pages[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                    var page = _step2.value;\n\t\n\t                    var latLng = page.getLatLng();\n\t                    state.push(latLng.lat.toFixed(5));\n\t                    state.push(latLng.lng.toFixed(5));\n\t                    state.push(page._rotated ? '1' : '0');\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError2 = true;\n\t                _iteratorError2 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                        _iterator2.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError2) {\n\t                        throw _iteratorError2;\n\t                    }\n\t                }\n\t            }\n\t\n\t            var flags = (this.magneticMerisiansdOn() ? 1 : 0) | (this.gridOn() ? 2 : 0);\n\t            state.push(flags);\n\t        }\n\t        return state;\n\t    },\n\t\n\t    unserializeState: function unserializeState(state) {\n\t        if (!state || !state.length) {\n\t            return false;\n\t        }\n\t        this.removePages();\n\t        state = [].concat(_toConsumableArray(state));\n\t        this.scale(state.shift());\n\t        this.resolution(state.shift());\n\t        this.zoomLevel(state.shift());\n\t        this.pageWidth(state.shift());\n\t        this.pageHeight(state.shift());\n\t        this.marginLeft(state.shift());\n\t        this.marginRight(state.shift());\n\t        this.marginTop(state.shift());\n\t        this.marginBottom(state.shift());\n\t        var lat = void 0,\n\t            lng = void 0,\n\t            rotated = void 0;\n\t        while (state.length >= 3) {\n\t            lat = parseFloat(state.shift());\n\t            lng = parseFloat(state.shift());\n\t            rotated = parseInt(state.shift(), 10);\n\t            if (isNaN(lat) || isNaN(lng) || lat < -85 || lat > 85 || lng < -180 || lng > 180) {\n\t                break;\n\t            }\n\t            this.addPage(!!rotated, _leaflet2.default.latLng(lat, lng));\n\t        }\n\t        if (state.length) {\n\t            var flags = parseInt(state.shift(), 10);\n\t            if (flags >= 0 && flags <= 3) {\n\t                this.magneticMerisiansdOn(!!(flags & 1));\n\t                this.gridOn(!!(flags & 2));\n\t            }\n\t        }\n\t        return true;\n\t    }\n\t});\n\n/***/ },\n/* 201 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.Grid = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _decorations = __webpack_require__(80);\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction radians(degrees) {\n\t    return degrees * Math.PI / 180;\n\t}\n\t\n\tvar Grid = function (_PrintStaticLayer) {\n\t    _inherits(Grid, _PrintStaticLayer);\n\t\n\t    function Grid() {\n\t        var _ref;\n\t\n\t        var _temp, _this, _ret;\n\t\n\t        _classCallCheck(this, Grid);\n\t\n\t        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t            args[_key] = arguments[_key];\n\t        }\n\t\n\t        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Grid.__proto__ || Object.getPrototypeOf(Grid)).call.apply(_ref, [this].concat(args))), _this), _this.minGridIntervalMm = 15, _this.fontSizeMm = 3, _this.font = 'verdana', _this.paddingMm = 1, _this.intervals = [1, 1.5, 2, 3.3, 5, 7.5, 10, 15, 20, 33, 50, 75, 100, 150, 200, 333, 500, 750, 1000, 1500, 2000, 4000, 5000, 7500, 10000, 15000, 20000, 40000, 50000, 75000, 100000, 150000, 200000, 400000, 500000, 750000, 1000000, 1500000, 2000000, 4000000, 5000000, 7500000], _temp), _possibleConstructorReturn(_this, _ret);\n\t    }\n\t\n\t    _createClass(Grid, [{\n\t        key: 'getGridInterval',\n\t        value: function getGridInterval(printOptions) {\n\t            var minGridIntervalM = this.minGridIntervalMm / 10 * printOptions.scale;\n\t            var intervalM = void 0;\n\t            var _iteratorNormalCompletion = true;\n\t            var _didIteratorError = false;\n\t            var _iteratorError = undefined;\n\t\n\t            try {\n\t                for (var _iterator = this.intervals[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                    intervalM = _step.value;\n\t\n\t                    if (intervalM > minGridIntervalM) {\n\t                        break;\n\t                    }\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError = true;\n\t                _iteratorError = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion && _iterator.return) {\n\t                        _iterator.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError) {\n\t                        throw _iteratorError;\n\t                    }\n\t                }\n\t            }\n\t\n\t            return intervalM;\n\t        }\n\t    }, {\n\t        key: 'formatDistance',\n\t        value: function formatDistance(x) {\n\t            var unit = void 0;\n\t            if (x < 1000) {\n\t                unit = 'm';\n\t            } else {\n\t                x /= 1000;\n\t                unit = 'km';\n\t            }\n\t            if (x % 1) {\n\t                x = x.toFixed(1);\n\t            }\n\t            return x + ' ' + unit;\n\t        }\n\t    }, {\n\t        key: '_drawGrid',\n\t        value: function _drawGrid(canvas, printOptions) {\n\t            var metersPerDegree = _leaflet2.default.Projection.SphericalMercator.R * Math.PI / 180;\n\t            var ctx = canvas.getContext('2d');\n\t            ctx.beginPath();\n\t            var pixelsPerMm = 1 / 25.4 * printOptions.resolution;\n\t            var intervalM = this.getGridInterval(printOptions);\n\t            var width = printOptions.destPixelSize.x;\n\t            var height = printOptions.destPixelSize.y;\n\t            var mercatorBounds = _leaflet2.default.bounds(_leaflet2.default.Projection.SphericalMercator.project(printOptions.latLngBounds.getNorthWest()), _leaflet2.default.Projection.SphericalMercator.project(printOptions.latLngBounds.getSouthEast()));\n\t            var canvasToMercatorScale = mercatorBounds.getSize().unscaleBy(printOptions.destPixelSize);\n\t            var rows = [];\n\t            var y = height;\n\t            while (true) {\n\t                var yMerc = mercatorBounds.max.y - y * canvasToMercatorScale.y;\n\t                var lat = _leaflet2.default.Projection.SphericalMercator.unproject(_leaflet2.default.point(0, yMerc)).lat;\n\t                rows.push({ lat: lat, y: y });\n\t                if (y < 0) {\n\t                    break;\n\t                }\n\t                var lat2 = lat + intervalM / metersPerDegree;\n\t                var yMerc2 = _leaflet2.default.Projection.SphericalMercator.project(_leaflet2.default.latLng(lat2, 0)).y;\n\t                y = (mercatorBounds.max.y - yMerc2) / canvasToMercatorScale.y;\n\t            }\n\t            var lineWidthMm = 0.15;\n\t            var lineWidthPx = lineWidthMm * pixelsPerMm;\n\t            var _arr = [{ color: '#D9D9D9', offset: lineWidthPx / 2 }, { color: '#8C8C8C', offset: -lineWidthPx / 2 }];\n\t            for (var _i = 0; _i < _arr.length; _i++) {\n\t                var _arr$_i = _arr[_i],\n\t                    color = _arr$_i.color,\n\t                    offset = _arr$_i.offset;\n\t\n\t                ctx.beginPath();\n\t\n\t                ctx.lineWidth = lineWidthPx;\n\t                ctx.strokeStyle = color;\n\t\n\t                var _iteratorNormalCompletion2 = true;\n\t                var _didIteratorError2 = false;\n\t                var _iteratorError2 = undefined;\n\t\n\t                try {\n\t                    for (var _iterator2 = rows[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                        y = _step2.value.y;\n\t\n\t                        ctx.moveTo(0, y + offset);\n\t                        ctx.lineTo(width, y + offset);\n\t                    }\n\t                } catch (err) {\n\t                    _didIteratorError2 = true;\n\t                    _iteratorError2 = err;\n\t                } finally {\n\t                    try {\n\t                        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                            _iterator2.return();\n\t                        }\n\t                    } finally {\n\t                        if (_didIteratorError2) {\n\t                            throw _iteratorError2;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                var pageCanvasCenterX = printOptions.destPixelSize.x / 2;\n\t                var _arr2 = [-1, 1];\n\t                for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n\t                    var direction = _arr2[_i2];\n\t                    var colN = 0;\n\t                    while (true) {\n\t                        var firstRow = true;\n\t                        var hasPointInPage = false;\n\t                        var _iteratorNormalCompletion3 = true;\n\t                        var _didIteratorError3 = false;\n\t                        var _iteratorError3 = undefined;\n\t\n\t                        try {\n\t                            for (var _iterator3 = rows[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                                var _step3$value = _step3.value,\n\t                                    _lat = _step3$value.lat,\n\t                                    _y = _step3$value.y;\n\t\n\t                                var dx = colN * intervalM / Math.cos(radians(_lat)) / canvasToMercatorScale.x;\n\t                                if (dx < pageCanvasCenterX) {\n\t                                    hasPointInPage = true;\n\t                                }\n\t                                if (firstRow) {\n\t                                    ctx.moveTo(pageCanvasCenterX + dx * direction + offset, _y);\n\t                                } else {\n\t                                    ctx.lineTo(pageCanvasCenterX + dx * direction + offset, _y);\n\t                                }\n\t                                firstRow = false;\n\t                            }\n\t                        } catch (err) {\n\t                            _didIteratorError3 = true;\n\t                            _iteratorError3 = err;\n\t                        } finally {\n\t                            try {\n\t                                if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                                    _iterator3.return();\n\t                                }\n\t                            } finally {\n\t                                if (_didIteratorError3) {\n\t                                    throw _iteratorError3;\n\t                                }\n\t                            }\n\t                        }\n\t\n\t                        if (!hasPointInPage) {\n\t                            break;\n\t                        }\n\t                        colN += 1;\n\t                    }\n\t                }\n\t                ctx.stroke();\n\t            }\n\t        }\n\t    }, {\n\t        key: '_drawLabel',\n\t        value: function _drawLabel(canvas, printOptions) {\n\t            var intervalM = this.getGridInterval(printOptions);\n\t            var height = printOptions.destPixelSize.y;\n\t            var ctx = canvas.getContext('2d');\n\t            var caption = 'Grid ' + this.formatDistance(intervalM);\n\t            var fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n\t            var padding = this.paddingMm / 25.4 * printOptions.resolution;\n\t            ctx.font = fontSize + 'px ' + this.font;\n\t            var textWidth = ctx.measureText(caption).width;\n\t            ctx.textBaseline = 'bottom';\n\t            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n\t            ctx.fillRect(0, height - fontSize - 2 * padding, textWidth + 2 * padding, fontSize + 2 * padding);\n\t            ctx.fillStyle = '#000000';\n\t            ctx.fillText(caption, padding, height - padding);\n\t        }\n\t    }, {\n\t        key: 'getTilesInfo',\n\t        value: function () {\n\t            var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(printOptions) {\n\t                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                    while (1) {\n\t                        switch (_context2.prev = _context2.next) {\n\t                            case 0:\n\t                                return _context2.abrupt('return', {\n\t                                    iterateTilePromises: /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t                                        var _this2 = this;\n\t\n\t                                        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                                            while (1) {\n\t                                                switch (_context.prev = _context.next) {\n\t                                                    case 0:\n\t                                                        _context.next = 2;\n\t                                                        return {\n\t                                                            tilePromise: Promise.resolve({\n\t                                                                draw: function draw(canvas) {\n\t                                                                    return _this2._drawGrid(canvas, printOptions);\n\t                                                                },\n\t                                                                isOverlay: true,\n\t                                                                overlaySolid: false\n\t                                                            }),\n\t                                                            abortLoading: function abortLoading() {}\n\t                                                        };\n\t\n\t                                                    case 2:\n\t                                                        _context.next = 4;\n\t                                                        return {\n\t                                                            tilePromise: Promise.resolve({\n\t                                                                draw: function draw(canvas) {\n\t                                                                    return _this2._drawLabel(canvas, printOptions);\n\t                                                                },\n\t                                                                isOverlay: true,\n\t                                                                overlaySolid: true\n\t                                                            }),\n\t                                                            abortLoading: function abortLoading() {}\n\t                                                        };\n\t\n\t                                                    case 4:\n\t                                                    case 'end':\n\t                                                        return _context.stop();\n\t                                                }\n\t                                            }\n\t                                        }, _callee, this);\n\t                                    }).bind(this),\n\t                                    count: 2\n\t                                });\n\t\n\t                            case 1:\n\t                            case 'end':\n\t                                return _context2.stop();\n\t                        }\n\t                    }\n\t                }, _callee2, this);\n\t            }));\n\t\n\t            function getTilesInfo(_x) {\n\t                return _ref2.apply(this, arguments);\n\t            }\n\t\n\t            return getTilesInfo;\n\t        }()\n\t    }]);\n\t\n\t    return Grid;\n\t}(_decorations.PrintStaticLayer);\n\t\n\texports.Grid = Grid;\n\n/***/ },\n/* 202 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.MagneticMeridians = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _magneticDeclination = __webpack_require__(127);\n\t\n\tvar _decorations = __webpack_require__(80);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction radians(degrees) {\n\t    return degrees * Math.PI / 180;\n\t}\n\t\n\tfunction movePoint(p, angle, dist) {\n\t    angle = radians(angle);\n\t    return new _leaflet2.default.point(p.x + Math.sin(angle) * dist, p.y - Math.cos(angle) * dist);\n\t}\n\t\n\tvar MagneticMeridians = function (_PrintStaticLayer) {\n\t    _inherits(MagneticMeridians, _PrintStaticLayer);\n\t\n\t    function MagneticMeridians() {\n\t        var _ref;\n\t\n\t        var _temp, _this, _ret;\n\t\n\t        _classCallCheck(this, MagneticMeridians);\n\t\n\t        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t            args[_key] = arguments[_key];\n\t        }\n\t\n\t        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = MagneticMeridians.__proto__ || Object.getPrototypeOf(MagneticMeridians)).call.apply(_ref, [this].concat(args))), _this), _this.lineThicknessMm = 0.2, _this.lineIntervalMm = 50, _this.samplingIntervalMm = 15, _this.color = '#66c2ff', _this.overlaySolid = false, _temp), _possibleConstructorReturn(_this, _ret);\n\t    }\n\t\n\t    _createClass(MagneticMeridians, [{\n\t        key: '_makeCanvasToLatLngTransformer',\n\t        value: function _makeCanvasToLatLngTransformer(printOptions) {\n\t            var projectedBounds = printOptions.pixelBounds;\n\t            var scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n\t            var origin = projectedBounds.min;\n\t            return function (pixel) {\n\t                return _leaflet2.default.CRS.EPSG3857.pointToLatLng(pixel.scaleBy(scale).add(origin), printOptions.zoom);\n\t            };\n\t        }\n\t    }, {\n\t        key: '_drawRaster',\n\t        value: function _drawRaster(canvas, printOptions) {\n\t            var toLatLng = this._makeCanvasToLatLngTransformer(printOptions);\n\t            var ctx = canvas.getContext('2d');\n\t            ctx.beginPath();\n\t            ctx.strokeStyle = this.color;\n\t            ctx.lineWidth = this.lineThicknessMm / 25.4 * printOptions.resolution;\n\t            var intervalPx = this.lineIntervalMm / 25.4 * printOptions.resolution;\n\t            var samplingPx = this.samplingIntervalMm / 25.4 * printOptions.resolution;\n\t            var pageDiagonal = Math.sqrt(printOptions.destPixelSize.x * printOptions.destPixelSize.x + printOptions.destPixelSize.y * printOptions.destPixelSize.y);\n\t            var maxSegments = pageDiagonal / 2 / samplingPx;\n\t\n\t            function drawLine(p, directionDown) {\n\t                ctx.moveTo(p.x, p.y);\n\t\n\t                for (var i = 0; i <= maxSegments; i++) {\n\t                    var latLng = toLatLng(p);\n\t                    var declination = (0, _magneticDeclination.getDeclination)(latLng.lat, latLng.lng);\n\t                    if (declination === null) {\n\t                        break;\n\t                    }\n\t                    if (directionDown) {\n\t                        declination += 180;\n\t                    }\n\t                    p = movePoint(p, declination, samplingPx);\n\t                    ctx.lineTo(p.x, p.y);\n\t                }\n\t            }\n\t\n\t            var center = printOptions.destPixelSize.divideBy(2);\n\t            var maxLines = pageDiagonal / 2 / intervalPx;\n\t\n\t            drawLine(center);\n\t            drawLine(center, true);\n\t\n\t            var p = center;\n\t            for (var i = 0; i <= maxLines; i++) {\n\t                var latLng = toLatLng(p);\n\t                var declination = (0, _magneticDeclination.getDeclination)(latLng.lat, latLng.lng);\n\t                if (declination === null) {\n\t                    declination = 0;\n\t                }\n\t                p = movePoint(p, declination + 90, intervalPx);\n\t                drawLine(p);\n\t                drawLine(p, true);\n\t            }\n\t            p = center;\n\t            for (var _i = 0; _i <= maxLines; _i++) {\n\t                var _latLng = toLatLng(p);\n\t                var _declination = (0, _magneticDeclination.getDeclination)(_latLng.lat, _latLng.lng);\n\t                if (_declination === null) {\n\t                    _declination = 0;\n\t                }\n\t                p = movePoint(p, _declination - 90, intervalPx);\n\t                drawLine(p);\n\t                drawLine(p, true);\n\t            }\n\t\n\t            ctx.stroke();\n\t        }\n\t    }]);\n\t\n\t    return MagneticMeridians;\n\t}(_decorations.PrintStaticLayer);\n\t\n\texports.MagneticMeridians = MagneticMeridians;\n\n/***/ },\n/* 203 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.OverlayScale = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _decorations = __webpack_require__(80);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction pageScaleRange(printOptions) {\n\t    var pageSize = printOptions.destPixelSize.divideBy(printOptions.resolution / 25.4);\n\t    var bounds = printOptions.latLngBounds;\n\t    var southLen = bounds.getSouthEast().distanceTo(bounds.getSouthWest());\n\t    var northLen = bounds.getNorthEast().distanceTo(bounds.getNorthWest());\n\t    var nScale = Math.round(northLen / pageSize.x * 10);\n\t    var sScale = Math.round(southLen / pageSize.x * 10);\n\t    return {\n\t        min: Math.min(nScale, sScale, printOptions.scale),\n\t        max: Math.max(nScale, sScale, printOptions.scale)\n\t    };\n\t}\n\t\n\tfunction formatScale(nominalScale, scaleRange) {\n\t    var threshold = 0.05;\n\t    if (Math.abs(nominalScale - scaleRange.min) / nominalScale > threshold || Math.abs(nominalScale - scaleRange.max) / nominalScale > threshold) {\n\t        var unit = void 0;\n\t        scaleRange = Object.assign({}, scaleRange);\n\t        if (scaleRange.min >= 1000) {\n\t            scaleRange.min /= 1000;\n\t            scaleRange.max /= 1000;\n\t            unit = 'km';\n\t        } else {\n\t            unit = 'm';\n\t        }\n\t        return scaleRange.min + ' \\u2013 ' + scaleRange.max + ' ' + unit + ' in 1 cm';\n\t    } else {\n\t        var _unit = void 0;\n\t        if (nominalScale >= 1000) {\n\t            nominalScale /= 1000;\n\t            _unit = 'km';\n\t        } else {\n\t            _unit = 'm';\n\t        }\n\t        return nominalScale + ' ' + _unit + ' in 1 cm';\n\t    }\n\t}\n\t\n\tvar OverlayScale = function (_PrintStaticLayer) {\n\t    _inherits(OverlayScale, _PrintStaticLayer);\n\t\n\t    function OverlayScale() {\n\t        var _ref;\n\t\n\t        var _temp, _this, _ret;\n\t\n\t        _classCallCheck(this, OverlayScale);\n\t\n\t        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t            args[_key] = arguments[_key];\n\t        }\n\t\n\t        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = OverlayScale.__proto__ || Object.getPrototypeOf(OverlayScale)).call.apply(_ref, [this].concat(args))), _this), _this.fontSizeMm = 3, _this.font = 'verdana', _this.paddingMm = 1, _this.overlaySolid = true, _temp), _possibleConstructorReturn(_this, _ret);\n\t    }\n\t\n\t    _createClass(OverlayScale, [{\n\t        key: '_drawRaster',\n\t        value: function _drawRaster(canvas, printOptions) {\n\t            var ctx = canvas.getContext('2d');\n\t            var caption = formatScale(printOptions.scale, pageScaleRange(printOptions));\n\t            if (printOptions.pagesCount > 1) {\n\t                caption += ' | Page ' + printOptions.pageLabel + ' / ' + printOptions.pagesCount;\n\t            }\n\t            var fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n\t            var padding = this.paddingMm / 25.4 * printOptions.resolution;\n\t            ctx.font = fontSize + 'px ' + this.font;\n\t            var textWidth = ctx.measureText(caption).width;\n\t            ctx.textBaseline = 'bottom';\n\t            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n\t            ctx.fillRect(0, 0, textWidth + 2 * padding, fontSize + 2 * padding);\n\t            ctx.fillStyle = '#000000';\n\t            ctx.fillText(caption, padding, fontSize + padding);\n\t        }\n\t    }]);\n\t\n\t    return OverlayScale;\n\t}(_decorations.PrintStaticLayer);\n\t\n\texports.OverlayScale = OverlayScale;\n\n/***/ },\n/* 204 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.renderPages = undefined;\n\t\n\tvar _asyncGenerator = function () { function AwaitValue(value) { this.value = value; } function AsyncGenerator(gen) { var front, back; function send(key, arg) { return new Promise(function (resolve, reject) { var request = { key: key, arg: arg, resolve: resolve, reject: reject, next: null }; if (back) { back = back.next = request; } else { front = back = request; resume(key, arg); } }); } function resume(key, arg) { try { var result = gen[key](arg); var value = result.value; if (value instanceof AwaitValue) { Promise.resolve(value.value).then(function (arg) { resume(\"next\", arg); }, function (arg) { resume(\"throw\", arg); }); } else { settle(result.done ? \"return\" : \"normal\", result.value); } } catch (err) { settle(\"throw\", err); } } function settle(type, value) { switch (type) { case \"return\": front.resolve({ value: value, done: true }); break; case \"throw\": front.reject(value); break; default: front.resolve({ value: value, done: false }); break; } front = front.next; if (front) { resume(front.key, front.arg); } else { back = null; } } this._invoke = send; if (typeof gen.return !== \"function\") { this.return = undefined; } } if (typeof Symbol === \"function\" && Symbol.asyncIterator) { AsyncGenerator.prototype[Symbol.asyncIterator] = function () { return this; }; } AsyncGenerator.prototype.next = function (arg) { return this._invoke(\"next\", arg); }; AsyncGenerator.prototype.throw = function (arg) { return this._invoke(\"throw\", arg); }; AsyncGenerator.prototype.return = function (arg) { return this._invoke(\"return\", arg); }; return { wrap: function wrap(fn) { return function () { return new AsyncGenerator(fn.apply(this, arguments)); }; }, await: function _await(value) { return new AwaitValue(value); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar iterateLayersTiles = function () {\n\t    var _ref = _asyncGenerator.wrap( /*#__PURE__*/regeneratorRuntime.mark(function _callee(layers, latLngBounds, destPixelSize, resolution, scale, zooms, pageLabel, pagesCount) {\n\t        var _this = this;\n\t\n\t        var defaultXHROptions, doStop, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _loop, _iterator, _step, _ret;\n\t\n\t        return regeneratorRuntime.wrap(function _callee$(_context3) {\n\t            while (1) {\n\t                switch (_context3.prev = _context3.next) {\n\t                    case 0:\n\t                        defaultXHROptions = {\n\t                            responseType: 'blob',\n\t                            timeout: 20000,\n\t                            isResponseSuccess: function isResponseSuccess(xhr) {\n\t                                return xhr.status === 200 || xhr.status === 404;\n\t                            }\n\t                        };\n\t                        doStop = void 0;\n\t                        _iteratorNormalCompletion = true;\n\t                        _didIteratorError = false;\n\t                        _iteratorError = undefined;\n\t                        _context3.prev = 5;\n\t                        _loop = /*#__PURE__*/regeneratorRuntime.mark(function _loop() {\n\t                            var layer, zoom, pixelBounds, map, _ref2, iterateTilePromises, count, layerPromises, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _loop2, _iterator2, _step2, _ret2;\n\t\n\t                            return regeneratorRuntime.wrap(function _loop$(_context2) {\n\t                                while (1) {\n\t                                    switch (_context2.prev = _context2.next) {\n\t                                        case 0:\n\t                                            layer = _step.value;\n\t                                            zoom = void 0;\n\t\n\t                                            if (layer.options && layer.options.scaleDependent) {\n\t                                                zoom = zooms.mapZoom;\n\t                                            } else {\n\t                                                zoom = zooms.satZoom;\n\t                                            }\n\t                                            pixelBounds = _leaflet2.default.bounds(_leaflet2.default.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(), _leaflet2.default.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round());\n\t                                            map = void 0;\n\t\n\t                                            if (!layer._layerDummy) {\n\t                                                map = (0, _leafletLayer.getTempMap)(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n\t                                                map.addLayer(layer);\n\t                                            }\n\t                                            _context2.next = 8;\n\t                                            return _asyncGenerator.await(layer.getTilesInfo({\n\t                                                xhrOptions: defaultXHROptions,\n\t                                                pixelBounds: pixelBounds,\n\t                                                latLngBounds: latLngBounds,\n\t                                                destPixelSize: destPixelSize,\n\t                                                resolution: resolution,\n\t                                                scale: scale,\n\t                                                zoom: zoom,\n\t                                                pageLabel: pageLabel,\n\t                                                pagesCount: pagesCount\n\t                                            }));\n\t\n\t                                        case 8:\n\t                                            _ref2 = _context2.sent;\n\t                                            iterateTilePromises = _ref2.iterateTilePromises;\n\t                                            count = _ref2.count;\n\t                                            layerPromises = [];\n\t                                            _iteratorNormalCompletion2 = true;\n\t                                            _didIteratorError2 = false;\n\t                                            _iteratorError2 = undefined;\n\t                                            _context2.prev = 15;\n\t                                            _loop2 = /*#__PURE__*/regeneratorRuntime.mark(function _loop2() {\n\t                                                var tilePromise, progressInc;\n\t                                                return regeneratorRuntime.wrap(function _loop2$(_context) {\n\t                                                    while (1) {\n\t                                                        switch (_context.prev = _context.next) {\n\t                                                            case 0:\n\t                                                                tilePromise = _step2.value;\n\t\n\t                                                                layerPromises.push(tilePromise.tilePromise);\n\t                                                                progressInc = (layer._printProgressWeight || 1) / count;\n\t\n\t                                                                tilePromise.tilePromise = tilePromise.tilePromise.then(function (tileInfo) {\n\t                                                                    return Object.assign({ zoom: zoom, progressInc: progressInc }, tileInfo);\n\t                                                                });\n\t                                                                _context.next = 6;\n\t                                                                return tilePromise;\n\t\n\t                                                            case 6:\n\t                                                                doStop = _context.sent;\n\t\n\t                                                                if (!doStop) {\n\t                                                                    _context.next = 10;\n\t                                                                    break;\n\t                                                                }\n\t\n\t                                                                tilePromise.abortLoading();\n\t                                                                return _context.abrupt('return', 'break');\n\t\n\t                                                            case 10:\n\t                                                            case 'end':\n\t                                                                return _context.stop();\n\t                                                        }\n\t                                                    }\n\t                                                }, _loop2, _this);\n\t                                            });\n\t                                            _iterator2 = iterateTilePromises()[Symbol.iterator]();\n\t\n\t                                        case 18:\n\t                                            if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n\t                                                _context2.next = 26;\n\t                                                break;\n\t                                            }\n\t\n\t                                            return _context2.delegateYield(_loop2(), 't0', 20);\n\t\n\t                                        case 20:\n\t                                            _ret2 = _context2.t0;\n\t\n\t                                            if (!(_ret2 === 'break')) {\n\t                                                _context2.next = 23;\n\t                                                break;\n\t                                            }\n\t\n\t                                            return _context2.abrupt('break', 26);\n\t\n\t                                        case 23:\n\t                                            _iteratorNormalCompletion2 = true;\n\t                                            _context2.next = 18;\n\t                                            break;\n\t\n\t                                        case 26:\n\t                                            _context2.next = 32;\n\t                                            break;\n\t\n\t                                        case 28:\n\t                                            _context2.prev = 28;\n\t                                            _context2.t1 = _context2['catch'](15);\n\t                                            _didIteratorError2 = true;\n\t                                            _iteratorError2 = _context2.t1;\n\t\n\t                                        case 32:\n\t                                            _context2.prev = 32;\n\t                                            _context2.prev = 33;\n\t\n\t                                            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                                                _iterator2.return();\n\t                                            }\n\t\n\t                                        case 35:\n\t                                            _context2.prev = 35;\n\t\n\t                                            if (!_didIteratorError2) {\n\t                                                _context2.next = 38;\n\t                                                break;\n\t                                            }\n\t\n\t                                            throw _iteratorError2;\n\t\n\t                                        case 38:\n\t                                            return _context2.finish(35);\n\t\n\t                                        case 39:\n\t                                            return _context2.finish(32);\n\t\n\t                                        case 40:\n\t                                            if (layer._layerDummy) {\n\t                                                _context2.next = 47;\n\t                                                break;\n\t                                            }\n\t\n\t                                            if (!doStop) {\n\t                                                _context2.next = 46;\n\t                                                break;\n\t                                            }\n\t\n\t                                            (0, _leafletLayer.disposeMap)(map);\n\t                                            return _context2.abrupt('return', 'break');\n\t\n\t                                        case 46:\n\t                                            Promise.all(layerPromises).then(function () {\n\t                                                return (0, _leafletLayer.disposeMap)(map);\n\t                                            });\n\t\n\t                                        case 47:\n\t                                        case 'end':\n\t                                            return _context2.stop();\n\t                                    }\n\t                                }\n\t                            }, _loop, _this, [[15, 28, 32, 40], [33,, 35, 39]]);\n\t                        });\n\t                        _iterator = layers[Symbol.iterator]();\n\t\n\t                    case 8:\n\t                        if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n\t                            _context3.next = 16;\n\t                            break;\n\t                        }\n\t\n\t                        return _context3.delegateYield(_loop(), 't0', 10);\n\t\n\t                    case 10:\n\t                        _ret = _context3.t0;\n\t\n\t                        if (!(_ret === 'break')) {\n\t                            _context3.next = 13;\n\t                            break;\n\t                        }\n\t\n\t                        return _context3.abrupt('break', 16);\n\t\n\t                    case 13:\n\t                        _iteratorNormalCompletion = true;\n\t                        _context3.next = 8;\n\t                        break;\n\t\n\t                    case 16:\n\t                        _context3.next = 22;\n\t                        break;\n\t\n\t                    case 18:\n\t                        _context3.prev = 18;\n\t                        _context3.t1 = _context3['catch'](5);\n\t                        _didIteratorError = true;\n\t                        _iteratorError = _context3.t1;\n\t\n\t                    case 22:\n\t                        _context3.prev = 22;\n\t                        _context3.prev = 23;\n\t\n\t                        if (!_iteratorNormalCompletion && _iterator.return) {\n\t                            _iterator.return();\n\t                        }\n\t\n\t                    case 25:\n\t                        _context3.prev = 25;\n\t\n\t                        if (!_didIteratorError) {\n\t                            _context3.next = 28;\n\t                            break;\n\t                        }\n\t\n\t                        throw _iteratorError;\n\t\n\t                    case 28:\n\t                        return _context3.finish(25);\n\t\n\t                    case 29:\n\t                        return _context3.finish(22);\n\t\n\t                    case 30:\n\t                    case 'end':\n\t                        return _context3.stop();\n\t                }\n\t            }\n\t        }, _callee, this, [[5, 18, 22, 30], [23,, 25, 29]]);\n\t    }));\n\t\n\t    return function iterateLayersTiles(_x, _x2, _x3, _x4, _x5, _x6, _x7, _x8) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar promiseQueueBuffer = function () {\n\t    var _ref3 = _asyncGenerator.wrap( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(source, maxActive) {\n\t        var queue, _ref4, value, done, doStop, _ref5, _value, _done, _iteratorNormalCompletion3, _didIteratorError3, _iteratorError3, _iterator3, _step3, abortLoading, _ref6;\n\t\n\t        return regeneratorRuntime.wrap(function _callee2$(_context4) {\n\t            while (1) {\n\t                switch (_context4.prev = _context4.next) {\n\t                    case 0:\n\t                        queue = [];\n\t\n\t                    case 1:\n\t                        if (!(queue.length < maxActive)) {\n\t                            _context4.next = 12;\n\t                            break;\n\t                        }\n\t\n\t                        _context4.next = 4;\n\t                        return _asyncGenerator.await(source.next());\n\t\n\t                    case 4:\n\t                        _ref4 = _context4.sent;\n\t                        value = _ref4.value;\n\t                        done = _ref4.done;\n\t\n\t                        if (!done) {\n\t                            _context4.next = 9;\n\t                            break;\n\t                        }\n\t\n\t                        return _context4.abrupt('break', 12);\n\t\n\t                    case 9:\n\t                        queue.push(value);\n\t                        _context4.next = 1;\n\t                        break;\n\t\n\t                    case 12:\n\t                        if (!queue.length) {\n\t                            _context4.next = 51;\n\t                            break;\n\t                        }\n\t\n\t                        _context4.next = 15;\n\t                        return queue.shift();\n\t\n\t                    case 15:\n\t                        doStop = _context4.sent;\n\t\n\t                        if (!doStop) {\n\t                            _context4.next = 43;\n\t                            break;\n\t                        }\n\t\n\t                        _context4.next = 19;\n\t                        return _asyncGenerator.await(source.next(true));\n\t\n\t                    case 19:\n\t                        _ref5 = _context4.sent;\n\t                        _value = _ref5.value;\n\t                        _done = _ref5.done;\n\t\n\t                        if (!_done) {\n\t                            queue.push(_value);\n\t                        }\n\t                        _iteratorNormalCompletion3 = true;\n\t                        _didIteratorError3 = false;\n\t                        _iteratorError3 = undefined;\n\t                        _context4.prev = 26;\n\t                        for (_iterator3 = queue[Symbol.iterator](); !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                            abortLoading = _step3.value.abortLoading;\n\t\n\t                            abortLoading();\n\t                        }\n\t\n\t                        _context4.next = 34;\n\t                        break;\n\t\n\t                    case 30:\n\t                        _context4.prev = 30;\n\t                        _context4.t0 = _context4['catch'](26);\n\t                        _didIteratorError3 = true;\n\t                        _iteratorError3 = _context4.t0;\n\t\n\t                    case 34:\n\t                        _context4.prev = 34;\n\t                        _context4.prev = 35;\n\t\n\t                        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                            _iterator3.return();\n\t                        }\n\t\n\t                    case 37:\n\t                        _context4.prev = 37;\n\t\n\t                        if (!_didIteratorError3) {\n\t                            _context4.next = 40;\n\t                            break;\n\t                        }\n\t\n\t                        throw _iteratorError3;\n\t\n\t                    case 40:\n\t                        return _context4.finish(37);\n\t\n\t                    case 41:\n\t                        return _context4.finish(34);\n\t\n\t                    case 42:\n\t                        return _context4.abrupt('return');\n\t\n\t                    case 43:\n\t                        _context4.next = 45;\n\t                        return _asyncGenerator.await(source.next());\n\t\n\t                    case 45:\n\t                        _ref6 = _context4.sent;\n\t                        value = _ref6.value;\n\t                        done = _ref6.done;\n\t\n\t                        if (!done) {\n\t                            queue.push(value);\n\t                        }\n\t                        _context4.next = 12;\n\t                        break;\n\t\n\t                    case 51:\n\t                    case 'end':\n\t                        return _context4.stop();\n\t                }\n\t            }\n\t        }, _callee2, this, [[26, 30, 34, 42], [35,, 37, 41]]);\n\t    }));\n\t\n\t    return function promiseQueueBuffer(_x9, _x10) {\n\t        return _ref3.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar renderPages = function () {\n\t    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref8) {\n\t        var map = _ref8.map,\n\t            pages = _ref8.pages,\n\t            zooms = _ref8.zooms,\n\t            resolution = _ref8.resolution,\n\t            scale = _ref8.scale,\n\t            progressCallback = _ref8.progressCallback,\n\t            decorationLayers = _ref8.decorationLayers;\n\t\n\t        var xhrQueue, layers, progressRange, _iteratorNormalCompletion4, _didIteratorError4, _iteratorError4, _iterator4, _step4, _layer, pageImagesInfo, _iteratorNormalCompletion5, _didIteratorError5, _iteratorError5, _iterator5, _step5, page, destPixelSize, _pixelBounds, composer, tilesIterator, queuedTilesIterator, _ref9, _tilePromise, done, tileInfo, dataUrl, data;\n\t\n\t        return regeneratorRuntime.wrap(function _callee3$(_context5) {\n\t            while (1) {\n\t                switch (_context5.prev = _context5.next) {\n\t                    case 0:\n\t                        xhrQueue = new _xhrPromise.XHRQueue();\n\t                        layers = getLayersForPrint(map, xhrQueue);\n\t\n\t                        layers.push.apply(layers, _toConsumableArray(decorationLayers));\n\t                        progressRange = 0;\n\t                        _iteratorNormalCompletion4 = true;\n\t                        _didIteratorError4 = false;\n\t                        _iteratorError4 = undefined;\n\t                        _context5.prev = 7;\n\t\n\t                        for (_iterator4 = layers[Symbol.iterator](); !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n\t                            _layer = _step4.value;\n\t\n\t                            progressRange += _layer._printProgressWeight || 1;\n\t                        }\n\t                        _context5.next = 15;\n\t                        break;\n\t\n\t                    case 11:\n\t                        _context5.prev = 11;\n\t                        _context5.t0 = _context5['catch'](7);\n\t                        _didIteratorError4 = true;\n\t                        _iteratorError4 = _context5.t0;\n\t\n\t                    case 15:\n\t                        _context5.prev = 15;\n\t                        _context5.prev = 16;\n\t\n\t                        if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                            _iterator4.return();\n\t                        }\n\t\n\t                    case 18:\n\t                        _context5.prev = 18;\n\t\n\t                        if (!_didIteratorError4) {\n\t                            _context5.next = 21;\n\t                            break;\n\t                        }\n\t\n\t                        throw _iteratorError4;\n\t\n\t                    case 21:\n\t                        return _context5.finish(18);\n\t\n\t                    case 22:\n\t                        return _context5.finish(15);\n\t\n\t                    case 23:\n\t                        progressRange *= pages.length;\n\t                        pageImagesInfo = [];\n\t                        _iteratorNormalCompletion5 = true;\n\t                        _didIteratorError5 = false;\n\t                        _iteratorError5 = undefined;\n\t                        _context5.prev = 28;\n\t                        _iterator5 = pages[Symbol.iterator]();\n\t\n\t                    case 30:\n\t                        if (_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done) {\n\t                            _context5.next = 69;\n\t                            break;\n\t                        }\n\t\n\t                        page = _step5.value;\n\t                        destPixelSize = page.printSize.multiplyBy(resolution / 25.4).round();\n\t                        _pixelBounds = _leaflet2.default.bounds(map.project(page.latLngBounds.getNorthWest(), 24).round(), map.project(page.latLngBounds.getSouthEast(), 24).round());\n\t                        composer = new PageComposer(destPixelSize, _pixelBounds);\n\t                        _context5.next = 37;\n\t                        return iterateLayersTiles(layers, page.latLngBounds, destPixelSize, resolution, scale, zooms, page.label, pages.length);\n\t\n\t                    case 37:\n\t                        tilesIterator = _context5.sent;\n\t                        queuedTilesIterator = promiseQueueBuffer(tilesIterator, 20);\n\t\n\t                    case 39:\n\t                        if (false) {\n\t                            _context5.next = 62;\n\t                            break;\n\t                        }\n\t\n\t                        _context5.next = 42;\n\t                        return queuedTilesIterator.next();\n\t\n\t                    case 42:\n\t                        _ref9 = _context5.sent;\n\t                        _tilePromise = _ref9.value;\n\t                        done = _ref9.done;\n\t\n\t                        if (!done) {\n\t                            _context5.next = 47;\n\t                            break;\n\t                        }\n\t\n\t                        return _context5.abrupt('break', 62);\n\t\n\t                    case 47:\n\t                        tileInfo = void 0;\n\t                        _context5.prev = 48;\n\t                        _context5.next = 51;\n\t                        return _tilePromise.tilePromise;\n\t\n\t                    case 51:\n\t                        tileInfo = _context5.sent;\n\t                        _context5.next = 58;\n\t                        break;\n\t\n\t                    case 54:\n\t                        _context5.prev = 54;\n\t                        _context5.t1 = _context5['catch'](48);\n\t\n\t                        queuedTilesIterator.next(true);\n\t                        throw _context5.t1;\n\t\n\t                    case 58:\n\t                        progressCallback(tileInfo.progressInc, progressRange);\n\t                        composer.putTile(tileInfo);\n\t                        _context5.next = 39;\n\t                        break;\n\t\n\t                    case 62:\n\t                        dataUrl = composer.getDataUrl();\n\t                        data = dataUrl.substring(dataUrl.indexOf(',') + 1);\n\t\n\t                        data = atob(data);\n\t                        pageImagesInfo.push({\n\t                            data: data,\n\t                            width: destPixelSize.x,\n\t                            height: destPixelSize.y\n\t                        });\n\t\n\t                    case 66:\n\t                        _iteratorNormalCompletion5 = true;\n\t                        _context5.next = 30;\n\t                        break;\n\t\n\t                    case 69:\n\t                        _context5.next = 75;\n\t                        break;\n\t\n\t                    case 71:\n\t                        _context5.prev = 71;\n\t                        _context5.t2 = _context5['catch'](28);\n\t                        _didIteratorError5 = true;\n\t                        _iteratorError5 = _context5.t2;\n\t\n\t                    case 75:\n\t                        _context5.prev = 75;\n\t                        _context5.prev = 76;\n\t\n\t                        if (!_iteratorNormalCompletion5 && _iterator5.return) {\n\t                            _iterator5.return();\n\t                        }\n\t\n\t                    case 78:\n\t                        _context5.prev = 78;\n\t\n\t                        if (!_didIteratorError5) {\n\t                            _context5.next = 81;\n\t                            break;\n\t                        }\n\t\n\t                        throw _iteratorError5;\n\t\n\t                    case 81:\n\t                        return _context5.finish(78);\n\t\n\t                    case 82:\n\t                        return _context5.finish(75);\n\t\n\t                    case 83:\n\t                        return _context5.abrupt('return', pageImagesInfo);\n\t\n\t                    case 84:\n\t                    case 'end':\n\t                        return _context5.stop();\n\t                }\n\t            }\n\t        }, _callee3, this, [[7, 11, 15, 23], [16,, 18, 22], [28, 71, 75, 83], [48, 54], [76,, 78, 82]]);\n\t    }));\n\t\n\t    return function renderPages(_x11) {\n\t        return _ref7.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _leafletLayer = __webpack_require__(122);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction getLayersForPrint(map, xhrQueue) {\n\t    function getZIndex(el) {\n\t        return parseInt(window.getComputedStyle(el).zIndex, 10) || 0;\n\t    }\n\t\n\t    function compare(i1, i2) {\n\t        if (i1 < i2) {\n\t            return -1;\n\t        } else if (i1 > i2) {\n\t            return 1;\n\t        }\n\t        return 0;\n\t    }\n\t\n\t    function compareLayersOrder(layer1, layer2) {\n\t        return compareArrays(getLayerZOrder(layer1), getLayerZOrder(layer2));\n\t    }\n\t\n\t    function getLayerZOrder(layer) {\n\t        var el = layer._container || layer._path;\n\t        if (!el) {\n\t            throw TypeError('Unsupported layer type');\n\t        }\n\t        var order = [];\n\t        while (el !== layer._map._container) {\n\t            order.push(getZIndex(el));\n\t            el = el.parentNode;\n\t        }\n\t        return order.reverse();\n\t    }\n\t\n\t    function compareArrays(ar1, ar2) {\n\t        var len = Math.min(ar1.length, ar2.length);\n\t        for (var i = 0; i < len; i++) {\n\t            var c = compare(ar1[i], ar2[i]);\n\t            if (c) {\n\t                return c;\n\t            }\n\t        }\n\t        return compare(ar1.length, ar2.length);\n\t    }\n\t\n\t    var layers = [];\n\t    map.eachLayer(function (layer) {\n\t        if (layer.options.print) {\n\t            layers.push(layer);\n\t        }\n\t    });\n\t    layers.sort(compareLayersOrder);\n\t    layers = layers.map(function (l) {\n\t        return l.cloneForPrint({ xhrQueue: xhrQueue });\n\t    });\n\t    return layers;\n\t}\n\t\n\tfunction blendMultiplyCanvas(src, dest) {\n\t    if (src.width !== dest.width || src.height !== dest.height) {\n\t        throw new Error('Canvas size mismatch');\n\t    }\n\t    var s_data = src.getContext('2d').getImageData(0, 0, src.width, src.height).data;\n\t    src.width = 0;\n\t    src.height = 0;\n\t    var d_image_data = dest.getContext('2d').getImageData(0, 0, dest.width, dest.height);\n\t    var d_data = d_image_data.data;\n\t    var data_length = s_data.length,\n\t        sr,\n\t        sg,\n\t        sb,\n\t        sa,\n\t        sa1,\n\t        dr,\n\t        dg,\n\t        db,\n\t        l;\n\t    for (var i = 0; i < data_length; i += 4) {\n\t        sa = s_data[i + 3] / 255;\n\t        if (sa) {\n\t            sr = s_data[i];\n\t            sg = s_data[i + 1];\n\t            sb = s_data[i + 2];\n\t            dr = d_data[i];\n\t            dg = d_data[i + 1];\n\t            db = d_data[i + 2];\n\t\n\t            l = (dr + dg + db) / 3;\n\t            l = l / 255 * 0.5 + 0.5;\n\t            sa1 = 1 - sa;\n\t            dr = sr * l * sa + sa1 * dr;\n\t            dg = sg * l * sa + sa1 * dg;\n\t            db = sb * l * sa + sa1 * db;\n\t\n\t            d_data[i] = dr;\n\t            d_data[i + 1] = dg;\n\t            d_data[i + 2] = db;\n\t        }\n\t    }\n\t    s_data = null;\n\t    dest.getContext('2d').putImageData(d_image_data, 0, 0);\n\t}\n\t\n\tvar PageComposer = function () {\n\t    function PageComposer(destSize, pixelBoundsAtZoom24) {\n\t        _classCallCheck(this, PageComposer);\n\t\n\t        this.destSize = destSize;\n\t        this.projectedBounds = pixelBoundsAtZoom24;\n\t        this.currentCanvas = null;\n\t        this.currentZoom = null;\n\t        this.targetCanvas = this.createCanvas(destSize);\n\t    }\n\t\n\t    _createClass(PageComposer, [{\n\t        key: 'createCanvas',\n\t        value: function createCanvas(size) {\n\t            var canvas = _leaflet2.default.DomUtil.create('canvas');\n\t            canvas.width = size.x;\n\t            canvas.height = size.y;\n\t            return canvas;\n\t        }\n\t    }, {\n\t        key: 'putTile',\n\t        value: function putTile(tileInfo) {\n\t            if (!tileInfo.isOverlay && !tileInfo.image) {\n\t                return;\n\t            }\n\t            var zoom = void 0;\n\t            if (tileInfo.isOverlay) {\n\t                zoom = tileInfo.overlaySolid ? 'solidOverlay' : 'overlay';\n\t            } else {\n\t                zoom = tileInfo.zoom;\n\t            }\n\t            if (zoom !== this.currentZoom) {\n\t                this.mergeCurrentCanvas();\n\t                this.setupCurrentCanvas(zoom);\n\t            }\n\t            if (tileInfo.isOverlay) {\n\t                tileInfo.draw(this.currentCanvas);\n\t            } else {\n\t                var ctx = this.currentCanvas.getContext('2d');\n\t                var tilePos = tileInfo.tilePos,\n\t                    tileSize = tileInfo.tileSize;\n\t\n\t                ctx.drawImage(tileInfo.image, tilePos.x, tilePos.y, tileSize.x, tileSize.y);\n\t            }\n\t        }\n\t    }, {\n\t        key: 'setupCurrentCanvas',\n\t        value: function setupCurrentCanvas(zoom) {\n\t            var size = void 0;\n\t            if (zoom === 'overlay' || zoom === 'solidOverlay') {\n\t                size = this.destSize;\n\t            } else {\n\t                var q = 1 << 24 - zoom;\n\t                var topLeft = this.projectedBounds.min.divideBy(q).round(),\n\t                    bottomRight = this.projectedBounds.max.divideBy(q).round();\n\t                size = bottomRight.subtract(topLeft);\n\t            }\n\t            this.currentCanvas = this.createCanvas(size);\n\t            this.currentZoom = zoom;\n\t        }\n\t    }, {\n\t        key: 'mergeCurrentCanvas',\n\t        value: function mergeCurrentCanvas() {\n\t            if (!this.currentCanvas) {\n\t                return;\n\t            }\n\t            if (this.currentZoom === 'overlay') {\n\t                blendMultiplyCanvas(this.currentCanvas, this.targetCanvas);\n\t            } else {\n\t                this.targetCanvas.getContext('2d').drawImage(this.currentCanvas, 0, 0, this.destSize.x, this.destSize.y);\n\t            }\n\t            this.currentCanvas.width = 0;\n\t            this.currentCanvas.height = 0;\n\t            this.currentCanvas = null;\n\t        }\n\t    }, {\n\t        key: 'getDataUrl',\n\t        value: function getDataUrl() {\n\t            this.mergeCurrentCanvas();\n\t            var dataUrl = this.targetCanvas.toDataURL(\"image/jpeg\");\n\t            this.targetCanvas.width = 0;\n\t            this.targetCanvas.height = 0;\n\t            this.targetCanvas = null;\n\t            return dataUrl;\n\t        }\n\t    }]);\n\t\n\t    return PageComposer;\n\t}();\n\t\n\texports.renderPages = renderPages;\n\n/***/ },\n/* 205 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(459);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tvar PageFeature = _leaflet2.default.Marker.extend({\n\t    initialize: function initialize(centerLatLng, paperSize, scale, label) {\n\t        this.paperSize = paperSize;\n\t        this.scale = scale;\n\t        var icon = _leaflet2.default.divIcon({ className: \"print-page-marker\", html: label });\n\t        _leaflet2.default.Marker.prototype.initialize.call(this, centerLatLng, {\n\t            icon: icon,\n\t            draggable: true,\n\t            title: 'Left click to rotate, right click for menu'\n\t        });\n\t        this.on('drag', this.updateView.bind(this, undefined));\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        var _this = this;\n\t\n\t        _leaflet2.default.Marker.prototype.onAdd.call(this, map);\n\t        map.on('viewreset', function () {\n\t            return _this.updateView();\n\t        });\n\t        this.rectangle = _leaflet2.default.rectangle([[0, 0], [0, 0]], { color: '#ff7800', weight: 2, opacity: 0.7, fillOpacity: 0.2 }).addTo(map);\n\t        this.updateView();\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        map.off('viewreset', this.updateView, this);\n\t        _leaflet2.default.Marker.prototype.onRemove.call(this, map);\n\t        this.rectangle.removeFrom(map);\n\t    },\n\t\n\t    getLatLngBounds: function getLatLngBounds() {\n\t        return this.latLngBounds;\n\t    },\n\t\n\t    _getLatLngBounds: function _getLatLngBounds() {\n\t\n\t        var centerLatLng = this.getLatLng();\n\t        var centerMerc = _leaflet2.default.Projection.SphericalMercator.project(centerLatLng);\n\t        var mercatorScale = Math.cos(centerLatLng.lat * Math.PI / 180) * _leaflet2.default.CRS.Earth.R / _leaflet2.default.Projection.SphericalMercator.R;\n\t        var mercatorPageSize = _leaflet2.default.point.apply(_leaflet2.default, _toConsumableArray(this.paperSize)).multiplyBy(this.scale / 10 / mercatorScale);\n\t        var sw = centerMerc.subtract(mercatorPageSize.divideBy(2));\n\t        var ne = centerMerc.add(mercatorPageSize.divideBy(2));\n\t        sw = _leaflet2.default.Projection.SphericalMercator.unproject(sw);\n\t        ne = _leaflet2.default.Projection.SphericalMercator.unproject(ne);\n\t        return _leaflet2.default.latLngBounds([sw, ne]);\n\t    },\n\t\n\t    _animateZoom: function _animateZoom(e) {\n\t        _leaflet2.default.Marker.prototype._animateZoom.call(this, e);\n\t        this.updateView(e.zoom);\n\t    },\n\t\n\t    updateView: function updateView(newZoom) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        if (newZoom === undefined) {\n\t            newZoom = this._map.getZoom();\n\t        }\n\t        var bounds = this.latLngBounds = this._getLatLngBounds();\n\t        var pixel_sw = this._map.project(bounds.getSouthWest(), newZoom);\n\t        var pixel_ne = this._map.project(bounds.getNorthEast(), newZoom);\n\t        var pixel_center = this._map.project(this.getLatLng(), newZoom);\n\t        var st = this._icon.style;\n\t        var pixel_width = pixel_ne.x - pixel_sw.x;\n\t        var pixel_height = pixel_sw.y - pixel_ne.y;\n\t        st.width = pixel_width + 'px';\n\t        st.height = pixel_height + 'px';\n\t        st.marginLeft = pixel_sw.x - pixel_center.x + 'px';\n\t        st.marginTop = pixel_ne.y - pixel_center.y + 'px';\n\t        st.fontSize = Math.min(pixel_width, pixel_height, 500) / 2 + 'px';\n\t        st.lineHeight = pixel_height + 'px';\n\t        this.rectangle.setBounds(bounds);\n\t    },\n\t\n\t    setLabel: function setLabel(s) {\n\t        this._icon.innerHTML = s;\n\t    },\n\t\n\t    getLabel: function getLabel() {\n\t        return this._icon.innerHTML;\n\t    },\n\t\n\t    setSize: function setSize(paperSize, scale) {\n\t        this.paperSize = paperSize;\n\t        this.scale = scale;\n\t        this.updateView();\n\t    },\n\t\n\t    getPrintSize: function getPrintSize() {\n\t        return _leaflet2.default.point.apply(_leaflet2.default, _toConsumableArray(this.paperSize));\n\t    },\n\t\n\t    rotate: function rotate(e) {\n\t        this.paperSize = [this.paperSize[1], this.paperSize[0]];\n\t        this.updateView();\n\t    }\n\t\n\t});\n\t\n\texports.default = PageFeature;\n\n/***/ },\n/* 206 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tfunction header() {\n\t    return '%PDF-1.3';\n\t}\n\t\n\tfunction eof() {\n\t    return '%%EOF\\n';\n\t}\n\t\n\tfunction recCatalog() {\n\t    return '1 0 obj\\n<< /Type /Catalog\\n/Pages 2 0 R\\n>>\\nendobj';\n\t}\n\t\n\tfunction recPages(count) {\n\t    var kidsIds = [];\n\t    for (var i = 0; i < count; i++) {\n\t        kidsIds.push(i * 3 + 3 + ' 0 R');\n\t    }\n\t    kidsIds = kidsIds.join(' ');\n\t    return '2 0 obj\\n<< /Type /Pages        \\n/Kids [ ' + kidsIds + ' ]\\n/Count ' + count + '\\n>>\\nendobj';\n\t}\n\t\n\tfunction recPage(serialNum, width, height) {\n\t    var pageRecId = serialNum * 3 + 3;\n\t    var contentRecId = pageRecId + 1;\n\t    var imageRecId = pageRecId + 2;\n\t    return pageRecId + ' 0 obj\\n<< /Type /Page\\n/Parent 2 0 R\\n/MediaBox [0 0 ' + width + ' ' + height + ']\\n/Contents ' + contentRecId + ' 0 R\\n/Resources <<\\n    /XObject << /Im' + serialNum + ' ' + imageRecId + ' 0 R >>\\n    /ProcSet [ /PDF /Text /ImageC ] \\n    >>\\n>>\\nendobj';\n\t}\n\t\n\tfunction recContent(serialNum, width, height) {\n\t    var pageRecId = serialNum * 3 + 3;\n\t    var contentRecId = pageRecId + 1;\n\t    var contents = 'q\\n' + width + ' 0 0 ' + height + ' 0 0 cm\\n/Im' + serialNum + ' Do\\nQ   ';\n\t    return contentRecId + ' 0 obj\\n<<\\n/Length ' + (contents.length + 1) + '\\n>>\\nstream\\n' + contents + '   \\nendstream\\nendobj';\n\t}\n\t\n\tfunction recImage(serialNum, widthPixels, heightPixels, data) {\n\t    var pageRecId = serialNum * 3 + 3;\n\t    var imageRecId = pageRecId + 2;\n\t\n\t    return imageRecId + ' 0 obj\\n<< /Type /XObject\\n/Subtype /Image\\n/Name /Im' + serialNum + '\\n/Filter [ /DCTDecode ]\\n/Width ' + widthPixels + '\\n/Height ' + heightPixels + '\\n/ColorSpace /DeviceRGB\\n/BitsPerComponent 8\\n/Length ' + data.length + '\\n>>\\nstream\\n' + data + '\\nendstream\\nendobj';\n\t}\n\t\n\tfunction recTrailer(recOffsets, currentOffset) {\n\t    var trailer = [];\n\t    trailer.push('xref\\n0 ' + (recOffsets.length + 1) + '\\n0000000000 65535 f ');\n\t    var zeroes = '0000000000';\n\t    var _iteratorNormalCompletion = true;\n\t    var _didIteratorError = false;\n\t    var _iteratorError = undefined;\n\t\n\t    try {\n\t        for (var _iterator = recOffsets[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t            var offset = _step.value;\n\t\n\t            offset = offset.toString();\n\t            var padding = zeroes.substr(offset.length);\n\t            trailer.push('' + padding + offset + ' 00000 n ');\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion && _iterator.return) {\n\t                _iterator.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError) {\n\t                throw _iteratorError;\n\t            }\n\t        }\n\t    }\n\t\n\t    trailer.push('trailer\\n<< /Root 1 0 R\\n/Size ' + (recOffsets.length + 1) + '\\n>>\\nstartxref\\n' + currentOffset);\n\t    return trailer.join('\\n');\n\t}\n\t\n\tfunction makePdf(imagesInfo, resolution) {\n\t    var offset = 0;\n\t    var offsets = [];\n\t    var pdf = [];\n\t\n\t    function addRec(s, skipOffset) {\n\t        pdf.push(s);\n\t        if (!skipOffset) {\n\t            offsets.push(offset);\n\t        }\n\t        offset += s.length;\n\t    }\n\t\n\t    addRec(header(), true);\n\t    addRec(recCatalog());\n\t    addRec(recPages(imagesInfo.length));\n\t    var _iteratorNormalCompletion2 = true;\n\t    var _didIteratorError2 = false;\n\t    var _iteratorError2 = undefined;\n\t\n\t    try {\n\t        for (var _iterator2 = imagesInfo.entries()[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t            var _step2$value = _slicedToArray(_step2.value, 2),\n\t                i = _step2$value[0],\n\t                _step2$value$ = _step2$value[1],\n\t                data = _step2$value$.data,\n\t                width = _step2$value$.width,\n\t                height = _step2$value$.height;\n\t\n\t            var widthPoints = width / resolution * 72,\n\t                heightPoints = height / resolution * 72;\n\t            addRec(recPage(i, widthPoints, heightPoints));\n\t            addRec(recContent(i, widthPoints, heightPoints));\n\t            addRec(recImage(i, width, height, data));\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError2 = true;\n\t        _iteratorError2 = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                _iterator2.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError2) {\n\t                throw _iteratorError2;\n\t            }\n\t        }\n\t    }\n\t\n\t    addRec(recTrailer(offsets, offset), true);\n\t    addRec(eof(), true);\n\t\n\t    pdf = pdf.join('\\n');\n\t    return pdf;\n\t}\n\t\n\texports.makePdf = makePdf;\n\n/***/ },\n/* 207 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(82);\n\t\n\t__webpack_require__(460);\n\t\n\t__webpack_require__(38);\n\t\n\t__webpack_require__(31);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.TrackList.Ruler = _leaflet2.default.Control.extend({\n\t    options: {\n\t        position: 'topleft'\n\t    },\n\t\n\t    initialize: function initialize(trackList, options) {\n\t        _leaflet2.default.Control.prototype.initialize.call(this, options);\n\t        this._trackList = trackList;\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        var container = this._container = _leaflet2.default.DomUtil.create('div', 'leaflet-control leaflet-control-button leaflet-control-ruler');\n\t        container.title = \"Measure distance\";\n\t        this._stopContainerEvents();\n\t        _leaflet2.default.DomEvent.on(container, 'click', this.onClick, this);\n\t        return container;\n\t    },\n\t\n\t    onClick: function onClick() {\n\t        this._trackList.setExpanded();\n\t        this._trackList.addNewTrack('Ruler').measureTicksShown(true);\n\t    }\n\t\n\t});\n\n/***/ },\n/* 208 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _utf = __webpack_require__(110);\n\t\n\tvar _utf2 = _interopRequireDefault(_utf);\n\t\n\tvar _escapeHtml = __webpack_require__(164);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction saveGpx(segments, name, points) {\n\t    var gpx = [],\n\t        x,\n\t        y;\n\t\n\t    gpx.push('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>');\n\t    gpx.push('<gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.tk\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\">');\n\t    if (segments.length) {\n\t        name = name || 'Track';\n\t        name = (0, _escapeHtml2.default)(name);\n\t        name = _utf2.default.encode(name);\n\t        gpx.push('\\t<trk>');\n\t        gpx.push('\\t\\t<name>' + name + '</name>');\n\t\n\t        segments.forEach(function (points) {\n\t            if (points.length > 1) {\n\t                gpx.push('\\t\\t<trkseg>');\n\t                points.forEach(function (p) {\n\t                    x = p.lng.toFixed(6);\n\t                    y = p.lat.toFixed(6);\n\t                    gpx.push('\\t\\t\\t<trkpt lat=\"' + y + '\" lon=\"' + x + '\"></trkpt>');\n\t                });\n\t                gpx.push('\\t\\t</trkseg>');\n\t            }\n\t        });\n\t        gpx.push('\\t</trk>');\n\t    }\n\t    points.forEach(function (marker) {\n\t        var label = marker.label;\n\t        label = (0, _escapeHtml2.default)(label);\n\t        label = _utf2.default.encode(label);\n\t        gpx.push('\\t<wpt lat=\"' + marker.latlng.lat.toFixed(6) + '\" lon=\"' + marker.latlng.lng.toFixed(6) + '\">');\n\t        gpx.push('\\t\\t<name>' + label + '</name>');\n\t        gpx.push('\\t</wpt>');\n\t    });\n\t    gpx.push('</gpx>');\n\t    gpx = gpx.join('\\n');\n\t    return gpx;\n\t}\n\t\n\tfunction saveKml(segments, name, points) {\n\t    var kml = [],\n\t        x,\n\t        y;\n\t\n\t    name = name || 'Track';\n\t    name = (0, _escapeHtml2.default)(name);\n\t    name = _utf2.default.encode(name);\n\t\n\t    kml.push('<?xml version=\"1.0\" encoding=\"UTF-8\"?>');\n\t    kml.push('<kml xmlns=\"http://earth.google.com/kml/2.2\">');\n\t    kml.push('\\t<Document>');\n\t    kml.push('\\t\\t<name>' + name + '</name>');\n\t\n\t    segments.forEach(function (points, i) {\n\t        if (points.length > 1) {\n\t            kml.push('\\t\\t<Placemark>', '\\t\\t\\t<name>Line ' + (i + 1) + '</name>', '\\t\\t\\t<LineString>', '\\t\\t\\t\\t<tessellate>1</tessellate>', '\\t\\t\\t\\t<coordinates>');\n\t            points.forEach(function (p) {\n\t                x = p.lng.toFixed(6);\n\t                y = p.lat.toFixed(6);\n\t                kml.push('\\t\\t\\t\\t\\t' + x + ',' + y);\n\t            });\n\t            kml.push('\\t\\t\\t\\t</coordinates>', '\\t\\t\\t</LineString>', '\\t\\t</Placemark>');\n\t        }\n\t    });\n\t    points.forEach(function (marker) {\n\t        var label = marker.label;\n\t        label = (0, _escapeHtml2.default)(label);\n\t        label = _utf2.default.encode(label);\n\t        var coordinates = marker.latlng.lng.toFixed(6) + ',' + marker.latlng.lat.toFixed(6) + ',0';\n\t\n\t        kml.push('\\t\\t<Placemark>');\n\t        kml.push('\\t\\t\\t<name>' + label + '</name>');\n\t        kml.push('\\t\\t\\t<Point>');\n\t        kml.push('\\t\\t\\t\\t<coordinates>' + coordinates + '</coordinates>');\n\t        kml.push('\\t\\t\\t</Point>');\n\t        kml.push('\\t\\t</Placemark>');\n\t    });\n\t\n\t    kml.push('\\t</Document>');\n\t    kml.push('\\t</kml>');\n\t\n\t    kml = kml.join('\\n');\n\t    return kml;\n\t}\n\t\n\tfunction packNumber(n) {\n\t    var bytes = [];\n\t    if (n >= -64 && n <= 63) {\n\t        n += 64;\n\t        bytes.push(n);\n\t    } else if (n >= -8192 && n <= 8191) {\n\t        n += 8192;\n\t        bytes.push(n & 0x7f | 0x80);\n\t        bytes.push(n >> 7);\n\t        /*        } else if (n >= -2097152 && n <= 2097151) {\n\t         n += 2097152;\n\t         bytes.push((n & 0x7f) | 0x80);\n\t         bytes.push(((n >> 7) & 0x7f) | 0x80);\n\t         bytes.push(n >> 14);\n\t         */\n\t    } else if (n >= -1048576 && n <= 1048575) {\n\t        n += 1048576;\n\t        bytes.push(n & 0x7f | 0x80);\n\t        bytes.push(n >> 7 & 0x7f | 0x80);\n\t        bytes.push(n >> 14);\n\t    } else if (n >= -268435456 && n <= 268435455) {\n\t        n += 268435456;\n\t        bytes.push(n & 0x7f | 0x80);\n\t        bytes.push(n >> 7 & 0x7f | 0x80);\n\t        bytes.push(n >> 14 & 0x7f | 0x80);\n\t        bytes.push(n >> 21);\n\t    } else {\n\t        throw new Error('Number ' + n + ' too big to pack in 29 bits');\n\t    }\n\t    return String.fromCharCode.apply(null, bytes);\n\t}\n\t\n\tfunction encodeUrlSafeBase64(s) {\n\t    return btoa(s).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n\t}\n\t\n\tfunction saveToString(segments, name, color, measureTicksShown, wayPoints, trackHidden) {\n\t    var stringified = [];\n\t    stringified.push(packNumber(3)); // version\n\t    name = _utf2.default.encode(name);\n\t    stringified.push(packNumber(name.length));\n\t    stringified.push(name);\n\t\n\t    var arcUnit = ((1 << 24) - 1) / 360;\n\t    segments = segments.filter(function (segment) {\n\t        return segment.length > 1;\n\t    });\n\t\n\t    stringified.push(packNumber(segments.length));\n\t    segments.forEach(function (points) {\n\t        var lastX = 0,\n\t            lastY = 0,\n\t            x,\n\t            y,\n\t            deltaX,\n\t            deltaY,\n\t            p;\n\t        stringified.push(packNumber(points.length));\n\t        for (var i = 0, len = points.length; i < len; i++) {\n\t            p = points[i];\n\t            x = Math.round(p.lng * arcUnit);\n\t            y = Math.round(p.lat * arcUnit);\n\t            deltaX = x - lastX;\n\t            deltaY = y - lastY;\n\t            stringified.push(packNumber(deltaX));\n\t            stringified.push(packNumber(deltaY));\n\t            lastX = x;\n\t            lastY = y;\n\t        }\n\t    });\n\t    stringified.push(packNumber(+color || 0));\n\t    stringified.push(packNumber(measureTicksShown ? 1 : 0));\n\t    stringified.push(packNumber(trackHidden ? 1 : 0));\n\t\n\t    stringified.push(packNumber(wayPoints.length));\n\t    if (wayPoints.length) {\n\t        var midX = 0,\n\t            midY = 0;\n\t        wayPoints.forEach(function (p) {\n\t            midX += p.latlng.lng;\n\t            midY += p.latlng.lat;\n\t        });\n\t        midX = Math.round(midX * arcUnit / wayPoints.length);\n\t        midY = Math.round(midY * arcUnit / wayPoints.length);\n\t        stringified.push(packNumber(midX));\n\t        stringified.push(packNumber(midY));\n\t        wayPoints.forEach(function (p) {\n\t            var deltaX = Math.round(p.latlng.lng * arcUnit) - midX,\n\t                deltaY = Math.round(p.latlng.lat * arcUnit) - midY,\n\t                symbol = 1,\n\t                name = _utf2.default.encode(p.label);\n\t            stringified.push(packNumber(name.length));\n\t            stringified.push(name);\n\t            stringified.push(packNumber(symbol));\n\t            stringified.push(packNumber(deltaX));\n\t            stringified.push(packNumber(deltaY));\n\t        });\n\t    }\n\t\n\t    return encodeUrlSafeBase64(stringified.join(''));\n\t}\n\t\n\texports.default = { saveGpx: saveGpx, saveKml: saveKml, saveToString: saveToString };\n\n/***/ },\n/* 209 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.isGpsiesUrl = exports.gpsiesXhrOptions = undefined;\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _CORSProxy = __webpack_require__(60);\n\t\n\tvar _CORSProxy2 = _interopRequireDefault(_CORSProxy);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction urlEncode(d) {\n\t    return Object.entries(d).map(function (_ref) {\n\t        var _ref2 = _slicedToArray(_ref, 2),\n\t            k = _ref2[0],\n\t            v = _ref2[1];\n\t\n\t        return k + '=' + encodeURIComponent(v);\n\t    }).join('&');\n\t}\n\t\n\tvar re = /^https?:\\/\\/www\\.gpsies\\.com\\/map\\.do\\?fileId=([a-z]+)/;\n\t\n\tfunction isGpsiesUrl(url) {\n\t    return re.test(url);\n\t}\n\t\n\tfunction gpsiesXhrOptions(url, options) {\n\t    var m = re.exec(url);\n\t    if (!m) {\n\t        throw new Error('Invalid gpsies url');\n\t    }\n\t    var trackId = m[1];\n\t    var newUrl = (0, _CORSProxy2.default)('http://www.gpsies.com/download.do');\n\t    return [newUrl, {\n\t        method: 'POST',\n\t        data: urlEncode({\n\t            fileId: trackId,\n\t            speed: '10',\n\t            dataType: '3',\n\t            filetype: 'gpxTrk',\n\t            submitButton: '',\n\t            inappropriate: ''\n\t        }),\n\t        headers: [[\"Content-type\", \"application/x-www-form-urlencoded\"]],\n\t        responseType: 'binarystring'\n\t    }];\n\t}\n\t\n\texports.gpsiesXhrOptions = gpsiesXhrOptions;\n\texports.isGpsiesUrl = isGpsiesUrl;\n\n/***/ },\n/* 210 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _geo_file_formats = __webpack_require__(81);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.TrackList.include(_leaflet2.default.Mixin.HashState);\n\t_leaflet2.default.Control.TrackList.include({\n\t    stateChangeEvents: [],\n\t\n\t    serializeState: function serializeState(e) {\n\t        return null;\n\t    },\n\t\n\t    unserializeState: function unserializeState(values) {\n\t        if (values && values.length) {\n\t            var geodata = (0, _geo_file_formats.parseGeoFile)('', window.location.href);\n\t            var notEmpty = this.addTracksFromGeodataArray(geodata);\n\t            if (notEmpty) {\n\t                this.setExpanded();\n\t            }\n\t        }\n\t        return false;\n\t    }\n\t});\n\n/***/ },\n/* 211 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(82);\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _geo_file_formats = __webpack_require__(81);\n\t\n\tvar _safeLocalstorage = __webpack_require__(63);\n\t\n\tvar _safeLocalstorage2 = _interopRequireDefault(_safeLocalstorage);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.TrackList.include({\n\t    maxLocalStorageSessions: 5,\n\t\n\t    saveTracksToStorage: function saveTracksToStorage() {\n\t        var tracks = this.tracks(),\n\t            serialized = [],\n\t            maxKey = -1,\n\t            i,\n\t            track,\n\t            s,\n\t            key,\n\t            m,\n\t            keys = [];\n\t\n\t        for (i = 0; i < _safeLocalstorage2.default.length; i++) {\n\t            key = _safeLocalstorage2.default.key(i);\n\t            m = key.match(/^trackList_(\\d+)$/);\n\t            if (m && m[1] !== undefined) {\n\t                if (+m[1] > maxKey) {\n\t                    maxKey = +m[1];\n\t                }\n\t            }\n\t        }\n\t        key = 'trackList_' + (maxKey + 1);\n\t\n\t        if (tracks.length === 0) {\n\t            _safeLocalstorage2.default.setItem(key, '');\n\t            return;\n\t        }\n\t        for (i = 0; i < tracks.length; i++) {\n\t            track = tracks[i];\n\t            s = this.trackToString(track);\n\t            serialized.push(s);\n\t        }\n\t        if (serialized.length === 0) {\n\t            return;\n\t        }\n\t        s = '#nktk=' + serialized.join('/');\n\t\n\t        _safeLocalstorage2.default.setItem(key, s);\n\t\n\t        //cleanup stale records\n\t        for (i = 0; i < _safeLocalstorage2.default.length; i++) {\n\t            key = _safeLocalstorage2.default.key(i);\n\t            m = key.match(/^trackList_(\\d+)$/);\n\t            if (m && m[1] !== undefined) {\n\t                keys.push(+m[1]);\n\t            }\n\t        }\n\t        if (keys.length > this.maxLocalStorageSessions) {\n\t            keys.sort(function (a, b) {\n\t                return a - b;\n\t            });\n\t            for (i = 0; i < keys.length - this.maxLocalStorageSessions; i++) {\n\t                key = 'trackList_' + keys[i];\n\t                _safeLocalstorage2.default.removeItem(key);\n\t            }\n\t        }\n\t    },\n\t\n\t    loadTracksFromStorage: function loadTracksFromStorage() {\n\t        var i,\n\t            key,\n\t            m,\n\t            s,\n\t            geodata,\n\t            maxKey = -1;\n\t\n\t        for (i = 0; i < _safeLocalstorage2.default.length; i++) {\n\t            key = _safeLocalstorage2.default.key(i);\n\t            m = key.match(/^trackList_(\\d+)$/);\n\t            if (m && m[1] !== undefined) {\n\t                if (+m[1] > maxKey) {\n\t                    maxKey = +m[1];\n\t                }\n\t            }\n\t        }\n\t        if (maxKey > -1) {\n\t            key = 'trackList_' + maxKey;\n\t            s = _safeLocalstorage2.default.getItem(key);\n\t            _safeLocalstorage2.default.removeItem(key);\n\t            if (s) {\n\t                geodata = (0, _geo_file_formats.parseGeoFile)('', s);\n\t                this.addTracksFromGeodataArray(geodata);\n\t            }\n\t        }\n\t    }\n\t});\n\n/***/ },\n/* 212 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\t__webpack_require__(462);\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction raiseControlsOnFocus(map) {\n\t    var selectors = ['.leaflet-top.leaflet-right', '.leaflet-bottom.leaflet-right', '.leaflet-top.leaflet-left', '.leaflet-bottom.leaflet-left'];\n\t    var elements = map._container.querySelectorAll(selectors.join(','));\n\t\n\t    function raise(target) {\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = elements[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var cornerDiv = _step.value;\n\t\n\t                if (cornerDiv === target) {\n\t                    _leaflet2.default.DomUtil.addClass(cornerDiv, 'leaflet-controls-corner-raised');\n\t                } else {\n\t                    _leaflet2.default.DomUtil.removeClass(cornerDiv, 'leaflet-controls-corner-raised');\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t    }\n\t\n\t    [].concat(_toConsumableArray(elements)).forEach(function (el) {\n\t        return _leaflet2.default.DomEvent.on(el, 'mouseenter', raise.bind(null, el));\n\t    });\n\t}\n\t\n\texports.default = raiseControlsOnFocus;\n\n/***/ },\n/* 213 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.fixAll = undefined;\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(463);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction fixAll() {\n\t    fixPanAnimationBug();\n\t    fixTouchDetection();\n\t    fixMapKeypressEvent();\n\t}\n\t\n\t// https://github.com/Leaflet/Leaflet/issues/3575\n\tfunction fixPanAnimationBug() {\n\t    if (!_leaflet2.default.Browser.chrome) {\n\t        return;\n\t    }\n\t    if (_leaflet2.default.PosAnimation.prototype.__panAnimationFixed) {\n\t        return;\n\t    }\n\t\n\t    var originalStep = _leaflet2.default.PosAnimation.prototype._step;\n\t    _leaflet2.default.PosAnimation.prototype._step = function () {\n\t        return originalStep.call(this, true);\n\t    };\n\t    _leaflet2.default.PosAnimation.prototype.__panAnimationFixed = true;\n\t}\n\t\n\tfunction fixTouchDetection() {\n\t    _leaflet2.default.Browser.touch &= navigator.pointerEnabled && !_leaflet2.default.Browser.ie || navigator.maxTouchPoints;\n\t}\n\t\n\tfunction fixMapKeypressEvent() {\n\t    var originalHandleDOMEvent = _leaflet2.default.Map.prototype._handleDOMEvent;\n\t    _leaflet2.default.Map.prototype._handleDOMEvent = function (e) {\n\t        if (e.type === 'keypress' && e.keyCode === 13) {\n\t            this._fireDOMEvent(e, e.type);\n\t        } else {\n\t            originalHandleDOMEvent.call(this, e);\n\t        }\n\t    };\n\t}\n\t\n\texports.fixAll = fixAll;\n\n/***/ },\n/* 214 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(61);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Control.Layers.include(_leaflet2.default.Mixin.HashState);\n\t\n\t_leaflet2.default.Control.Layers.include({\n\t    stateChangeEvents: ['baselayerchange', 'overlayadd', 'overlayremove'],\n\t    stateChangeEventsSource: '_map',\n\t\n\t    serializeState: function serializeState(e) {\n\t\n\t        var keys = [];\n\t        this._map.eachLayer(function (layer) {\n\t            var key = layer.options.code;\n\t            if (key) {\n\t                keys.push([key, layer.options.zIndex]);\n\t            }\n\t        });\n\t        keys.sort(function (k1, k2) {\n\t            return k1[1] - k2[1];\n\t        });\n\t        var state = keys.map(function (k) {\n\t            return k[0];\n\t        });\n\t        return state;\n\t    },\n\t\n\t    unserializeState: function unserializeState(values) {\n\t        if (!values || values.length === 0) {\n\t            return false;\n\t        }\n\t\n\t        var hasBaselayer = void 0;\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = this._layers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var layer = _step.value;\n\t\n\t                if (layer.layer.options && values.includes(layer.layer.options.code) && !layer.overlay) {\n\t                    hasBaselayer = true;\n\t                    break;\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        if (!hasBaselayer) {\n\t            return false;\n\t        }\n\t\n\t        var _iteratorNormalCompletion2 = true;\n\t        var _didIteratorError2 = false;\n\t        var _iteratorError2 = undefined;\n\t\n\t        try {\n\t            for (var _iterator2 = this._layers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                var _layer = _step2.value;\n\t\n\t                if (_layer.layer.options && values.includes(_layer.layer.options.code)) {\n\t                    this._map.addLayer(_layer.layer);\n\t                } else {\n\t                    this._map.removeLayer(_layer.layer);\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError2 = true;\n\t            _iteratorError2 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                    _iterator2.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError2) {\n\t                    throw _iteratorError2;\n\t                }\n\t            }\n\t        }\n\t\n\t        return true;\n\t    }\n\t});\n\n/***/ },\n/* 215 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(61);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Map.include(_leaflet2.default.Mixin.HashState);\n\t\n\t_leaflet2.default.Map.include({\n\t    stateChangeEvents: ['moveend'],\n\t\n\t    serializeState: function serializeState() {\n\t        var center = this.getCenter();\n\t        var zoom = this.getZoom();\n\t        var precision = 5;\n\t        var state = [zoom.toString(), center.lat.toFixed(precision), center.lng.toFixed(precision)];\n\t        return state;\n\t    },\n\t\n\t    unserializeState: function unserializeState(values) {\n\t        if (!values || values.length !== 3) {\n\t            return false;\n\t        }\n\t        var zoom = parseInt(values[0], 10),\n\t            lat = parseFloat(values[1]),\n\t            lng = parseFloat(values[2]);\n\t        if (isNaN(zoom) || isNaN(lat) || isNaN(lng) || zoom < 0 || zoom > 32 || lat < -90 || lat > 90) {\n\t            return false;\n\t        }\n\t        this.setView([lat, lng], zoom);\n\t        return true;\n\t    }\n\t});\n\n/***/ },\n/* 216 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Layer.GeoJSONAjax = _leaflet2.default.GeoJSON.extend({\n\t    options: {\n\t        requestTimeout: 30000\n\t    },\n\t\n\t    initialize: function initialize(url, options) {\n\t        _leaflet2.default.GeoJSON.prototype.initialize.call(this, null, options);\n\t        this.url = url;\n\t    },\n\t\n\t    // Promise can be rejected if json invalid or addData fails\n\t    loadData: function loadData() {\n\t        var _this = this;\n\t\n\t        if (this._loadStarted) {\n\t            return;\n\t        }\n\t        this._loadStarted = true;\n\t        (0, _xhrPromise.fetch)(this.url, { timeout: this.options.requestTimeout }).then(function (xhr) {\n\t            _this.addData(JSON.parse(xhr.response));\n\t        }, function (e) {\n\t            _logging2.default.captureException(e, { extra: {\n\t                    description: 'failed to get geojson',\n\t                    url: _this.url,\n\t                    status: e.xhr.status\n\t                } });\n\t            (0, _notifications.notify)('Failed to get GeoJSON data from ' + _this.url + ': ' + e.message);\n\t        });\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        _leaflet2.default.GeoJSON.prototype.onAdd.call(this, map);\n\t        this.loadData();\n\t    }\n\t});\n\n/***/ },\n/* 217 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _xhrPromise = __webpack_require__(24);\n\t\n\tvar _notifications = __webpack_require__(35);\n\t\n\tvar _logging = __webpack_require__(23);\n\t\n\tvar _logging2 = _interopRequireDefault(_logging);\n\t\n\tvar _safeLocalstorage = __webpack_require__(63);\n\t\n\tvar _safeLocalstorage2 = _interopRequireDefault(_safeLocalstorage);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction parseResponse(s) {\n\t    var data = void 0;\n\t    data = JSON.parse(s);\n\t    if (!data.token) {\n\t        throw new Error('no token in response');\n\t    }\n\t    return data.token;\n\t}\n\t\n\tfunction getToken() {\n\t    return (0, _xhrPromise.fetch)('https://www.ut.no/kart/HentBaatToken/', { timeout: 10000 }).then(function (xhr) {\n\t        try {\n\t            return { token: parseResponse(xhr.responseText) };\n\t        } catch (e) {\n\t            _logging2.default.captureException(e, { extra: {\n\t                    description: 'Invalid baat token',\n\t                    response: xhr.responseText.toString().slice(0, 100) } });\n\t            return { error: 'Server returned invalid token for Norway map' };\n\t        }\n\t    }, function (e) {\n\t        _logging2.default.captureException(e, { extra: { description: 'failed to download baat token' } });\n\t        return { error: 'Failed to token for Norway map: ' + e.message };\n\t    });\n\t}\n\t\n\t_leaflet2.default.TileLayer.Nordeskart = _leaflet2.default.TileLayer.extend({\n\t    options: {\n\t        tokenUpdateInterval: 5 * 60 * 1000\n\t    },\n\t\n\t    initialize: function initialize(url, options) {\n\t        this.__url = url;\n\t        _leaflet2.default.TileLayer.prototype.initialize.call(this, '', options);\n\t    },\n\t\n\t    baatTokenUpToDate: function baatTokenUpToDate() {\n\t        var nextUpdate = 0;\n\t        nextUpdate = parseInt(_safeLocalstorage2.default.getItem('baatTokenNextUpdate'), 10) || 0;\n\t        return Date.now() < nextUpdate && _safeLocalstorage2.default.getItem('baatToken');\n\t    },\n\t\n\t    storeBaatToken: function storeBaatToken(token) {\n\t        _safeLocalstorage2.default.setItem('baatToken', token);\n\t        _safeLocalstorage2.default.setItem('baatTokenNextUpdate', Date.now().toString() + this.options.tokenUpdateInterval);\n\t    },\n\t\n\t    periodicTokenUpdate: function periodicTokenUpdate() {\n\t        var _this = this;\n\t\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        getToken().then(function (data) {\n\t            if (data.error) {\n\t                (0, _notifications.notify)(data.error);\n\t            } else {\n\t                if (data.token !== _this.options.baatToken) {\n\t                    _this.options.baatToken = data.token;\n\t                    if (!_this._url) {\n\t                        _this.setUrl(_this.__url);\n\t                    }\n\t                }\n\t                _this.storeBaatToken(data.token);\n\t            }\n\t            setTimeout(function () {\n\t                return _this.periodicTokenUpdate();\n\t            }, _this.options.tokenUpdateInterval);\n\t        });\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        var token = this.baatTokenUpToDate();\n\t        if (token) {\n\t            this.options.baatToken = token;\n\t            this.setUrl(this.__url);\n\t        }\n\t        this.periodicTokenUpdate();\n\t        return _leaflet2.default.TileLayer.prototype.onAdd.call(this, map);\n\t    }\n\t});\n\n/***/ },\n/* 218 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(118);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.BingLayer.include({\n\t    waitTilesReadyToGrab: function waitTilesReadyToGrab() {\n\t        var _this = this;\n\t\n\t        if (this._url) {\n\t            return Promise.resolve();\n\t        } else {\n\t            return new Promise(function (resolve) {\n\t                var i = setInterval(function () {\n\t                    if (_this._url) {\n\t                        clearInterval(i);\n\t                        resolve();\n\t                    }\n\t                }, 50);\n\t            });\n\t        }\n\t    },\n\t\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        return new _leaflet2.default.BingLayer(this._key, _leaflet2.default.Util.extend({}, this.options, options));\n\t    }\n\t});\n\n/***/ },\n/* 219 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(119);\n\t\n\tvar _TileLayer = __webpack_require__(121);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar GooglePrint = _leaflet2.default.Layer.Google.extend({\n\t    includes: _TileLayer.TileLayerGrabMixin,\n\t\n\t    _rasterizeNeedsFullSizeMap: true,\n\t\n\t    _dummyTile: _leaflet2.default.DomUtil.create('div'),\n\t\n\t    onAdd: function onAdd(map) {\n\t        var _this = this;\n\t\n\t        this._waitTilesReadyToGrab = new Promise(function (resolve) {\n\t            _this._tilesReadyToGrab = resolve;\n\t        });\n\t        _leaflet2.default.Layer.Google.prototype.onAdd.call(this, map);\n\t    },\n\t\n\t    waitTilesReadyToGrab: function waitTilesReadyToGrab() {\n\t        return this._waitTilesReadyToGrab;\n\t    },\n\t\n\t    createTile: function createTile() {\n\t        return this._dummyTile;\n\t    },\n\t\n\t    _fullfillPendingTiles: function _fullfillPendingTiles() {\n\t        if (!Object.keys(this._readyTiles).length) {\n\t            return;\n\t        }\n\t        this._tilesReadyToGrab();\n\t    },\n\t\n\t    getTileUrl: function getTileUrl(coords) {\n\t        return this._readyTiles[this._tileCoordsToKey(coords)] || null;\n\t    }\n\t});\n\t\n\t_leaflet2.default.Layer.Google.include({\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        return new GooglePrint(this.mapType, _leaflet2.default.Util.extend({}, this.options, options));\n\t    }\n\t});\n\n/***/ },\n/* 220 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(126);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\t_leaflet2.default.Polyline.include({\n\t    _printProgressWeight: 0.1,\n\t    printWidthMm: 1,\n\t\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        options = _leaflet2.default.Util.extend({}, this.options, options);\n\t        var latlngs = this.getLatLngs().map(function (latlng) {\n\t            return latlng.clone();\n\t        });\n\t        return new _leaflet2.default.Polyline(latlngs, options);\n\t    },\n\t\n\t    _makelatLngToCanvasPixelTransformer: function _makelatLngToCanvasPixelTransformer(printOptions) {\n\t        var projectedBounds = printOptions.pixelBounds;\n\t        var scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n\t        var origin = projectedBounds.min;\n\t        return function (latlng) {\n\t            return _leaflet2.default.CRS.EPSG3857.latLngToPoint(latlng, printOptions.zoom).subtract(origin).unscaleBy(scale);\n\t        };\n\t    },\n\t\n\t    _drawRaster: function _drawRaster(canvas, printOptions) {\n\t        var latlngs = this.getLatLngs();\n\t        if (!latlngs.length || !this.getBounds().intersects(printOptions.latLngBounds)) {\n\t            return;\n\t        }\n\t\n\t        var ctx = canvas.getContext('2d');\n\t        ctx.lineWidth = this.printWidthMm / 25.4 * printOptions.resolution;\n\t        ctx.lineJoin = 'round';\n\t        ctx.strokeStyle = this.options.color;\n\t        var transform = this._makelatLngToCanvasPixelTransformer(printOptions);\n\t        var point = void 0;\n\t        ctx.beginPath();\n\t\n\t        point = transform(latlngs[0]);\n\t        ctx.moveTo(point.x, point.y);\n\t        for (var i = 1; i < latlngs.length; i++) {\n\t            point = transform(latlngs[i]);\n\t            ctx.lineTo(point.x, point.y);\n\t        }\n\t        ctx.stroke();\n\t        return true;\n\t    },\n\t\n\t    getTilesInfo: function () {\n\t        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(printOptions) {\n\t            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                while (1) {\n\t                    switch (_context2.prev = _context2.next) {\n\t                        case 0:\n\t                            return _context2.abrupt('return', {\n\t                                iterateTilePromises: /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t                                    var _this = this;\n\t\n\t                                    return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                                        while (1) {\n\t                                            switch (_context.prev = _context.next) {\n\t                                                case 0:\n\t                                                    _context.next = 2;\n\t                                                    return {\n\t                                                        tilePromise: Promise.resolve({\n\t                                                            draw: function draw(canvas) {\n\t                                                                return _this._drawRaster(canvas, printOptions);\n\t                                                            },\n\t                                                            isOverlay: true\n\t                                                        }),\n\t                                                        abortLoading: function abortLoading() {}\n\t                                                    };\n\t\n\t                                                case 2:\n\t                                                case 'end':\n\t                                                    return _context.stop();\n\t                                            }\n\t                                        }\n\t                                    }, _callee, this);\n\t                                }).bind(this),\n\t                                count: 1\n\t                            });\n\t\n\t                        case 1:\n\t                        case 'end':\n\t                            return _context2.stop();\n\t                    }\n\t                }\n\t            }, _callee2, this);\n\t        }));\n\t\n\t        function getTilesInfo(_x) {\n\t            return _ref.apply(this, arguments);\n\t        }\n\t\n\t        return getTilesInfo;\n\t    }()\n\t});\n\t\n\t_leaflet2.default.MeasuredLine.include({\n\t    tickFontSizeMm: 2.5,\n\t\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        options = _leaflet2.default.Util.extend({}, this.options, options);\n\t        var latlngs = this.getLatLngs().map(function (latlng) {\n\t            return latlng.clone();\n\t        });\n\t        return new _leaflet2.default.MeasuredLine(latlngs, options);\n\t    },\n\t\n\t    _drawRaster: function _drawRaster(canvas, printOptions) {\n\t        if (!_leaflet2.default.Polyline.prototype._drawRaster.call(this, canvas, printOptions)) {\n\t            return;\n\t        }\n\t        if (!this.options.measureTicksShown) {\n\t            return;\n\t        }\n\t        var minTicksIntervalMeters = printOptions.scale * 1.5;\n\t        var ctx = canvas.getContext('2d');\n\t        var ticks = this.getTicksPositions(minTicksIntervalMeters);\n\t        var ticksPixelSize = this.tickFontSizeMm / 25.4 * printOptions.resolution;\n\t        var transform = this._makelatLngToCanvasPixelTransformer(printOptions);\n\t        ctx.font = 'bold ' + ticksPixelSize + 'px verdana';\n\t        ctx.fillStyle = this.options.color;\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = ticks[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var tick = _step.value;\n\t\n\t                var m = tick.transformMatrix;\n\t                var label = '\\u2501\\u2501 ' + Math.round(tick.distanceValue / 10) / 100 + ' km';\n\t                var position = transform(tick.position);\n\t                ctx.setTransform(m[0], m[1], m[2], m[3], position.x, position.y);\n\t                ctx.fillText(label, 0, ticksPixelSize * 0.3);\n\t                ctx.setTransform(1, 0, 0, 1, 0, 0);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t    }\n\t});\n\n/***/ },\n/* 221 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(123);\n\t\n\tvar _westraPassesMarkers = __webpack_require__(124);\n\t\n\t__webpack_require__(62);\n\t\n\t__webpack_require__(120);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\t_leaflet2.default.Layer.WestraPasses.addInitHook(function () {\n\t    this.markers.options.print = this.options.print;\n\t    this.options.print = false;\n\t});\n\t\n\t_westraPassesMarkers.WestraPassesMarkers.include({\n\t    waitDataReady: function waitDataReady() {\n\t        var _this = this;\n\t\n\t        if (this._dataLoaded) {\n\t            return Promise.resolve();\n\t        }\n\t        return new Promise(function (resolve) {\n\t            _this.on('data-loaded', resolve);\n\t        });\n\t    },\n\t\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        options = _leaflet2.default.Util.extend({}, options);\n\t        return new _westraPassesMarkers.WestraPassesMarkers(this._baseUrl, options);\n\t    },\n\t\n\t    getTilesInfo: function () {\n\t        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(printOptions) {\n\t            return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                while (1) {\n\t                    switch (_context.prev = _context.next) {\n\t                        case 0:\n\t                            _context.next = 2;\n\t                            return this.waitDataReady();\n\t\n\t                        case 2:\n\t                            _context.next = 4;\n\t                            return _leaflet2.default.Layer.CanvasMarkers.prototype.getTilesInfo.call(this, printOptions);\n\t\n\t                        case 4:\n\t                            return _context.abrupt('return', _context.sent);\n\t\n\t                        case 5:\n\t                        case 'end':\n\t                            return _context.stop();\n\t                    }\n\t                }\n\t            }, _callee, this);\n\t        }));\n\t\n\t        function getTilesInfo(_x) {\n\t            return _ref.apply(this, arguments);\n\t        }\n\t\n\t        return getTilesInfo;\n\t    }()\n\t});\n\n/***/ },\n/* 222 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(125);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Layer.Yandex.include({\n\t    cloneForPrint: function cloneForPrint(options) {\n\t        return new _leaflet2.default.Layer.Yandex(this._mapType, _leaflet2.default.Util.extend({}, this.options, options));\n\t    }\n\t});\n\n/***/ },\n/* 223 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tfunction imgFromDataString(xhr) {\n\t    if (xhr.status === 200 && xhr.response.size) {\n\t        var image = new Image();\n\t        var blobUrl = window.URL.createObjectURL(xhr.response);\n\t        var promise = new Promise(function (resolve, reject) {\n\t            image.onload = function () {\n\t                resolve(image);\n\t                window.URL.revokeObjectURL(blobUrl);\n\t            };\n\t            image.onerror = function () {\n\t                reject(new Error('Image corrupt'));\n\t            };\n\t        });\n\t        image.src = blobUrl;\n\t        return promise;\n\t    } else {\n\t        return null;\n\t    }\n\t}\n\t\n\texports.imgFromDataString = imgFromDataString;\n\n/***/ },\n/* 224 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(465);\n\t\n\tvar _contextmenu = __webpack_require__(56);\n\t\n\tvar _contextmenu2 = _interopRequireDefault(_contextmenu);\n\t\n\tvar _clipboardCopy = __webpack_require__(79);\n\t\n\tvar _clipboardCopy2 = _interopRequireDefault(_clipboardCopy);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction zeroPad(num, size) {\n\t    var s = num + \"\";\n\t    while (s.length < size) {\n\t        s = \"0\" + s;\n\t    }\n\t    return s;\n\t}\n\t\n\tvar bigLetterReplacers = [{\n\t    '1': 'А',\n\t    '2': 'Б',\n\t    '3': 'В',\n\t    '4': 'Г'\n\t}, {\n\t    '1': 'A',\n\t    '2': 'B',\n\t    '3': 'C',\n\t    '4': 'D'\n\t}];\n\t\n\tvar Nomenclature = {\n\t    getQuadName1m: function getQuadName1m(column, row, join) {\n\t        var name = '';\n\t        if (row < 0) {\n\t            row = -row - 1;\n\t            name += 'x';\n\t        }\n\t        column += 31;\n\t        name += 'ABCDEFGHIJKLMNOPQRSTUV'[row] + '-' + zeroPad(column, 2);\n\t        for (var n = 1; n <= join - 1; n++) {\n\t            name += ',' + zeroPad(column + n, 2);\n\t        }\n\t        return [name];\n\t    },\n\t\n\t    getQuadName500k: function getQuadName500k(column, row, join) {\n\t        var name1 = this.getQuadName1m(Math.floor(column / 2), Math.floor(row / 2), 1)[0];\n\t        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n\t        var name2 = '-' + subquad;\n\t        if (join > 1) {\n\t            name2 += ',' + (subquad + 1);\n\t        }\n\t        if (join === 4) {\n\t            name2 += ',' + this.getQuadName1m(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' + subquad + ',' + (subquad + 1);\n\t        }\n\t        var names = [name1 + name2];\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            var _loop = function _loop() {\n\t                var replacer = _step.value;\n\t\n\t                var name3 = name2.replace(/\\b[1-4]\\b/g, function (s) {\n\t                    return replacer[s];\n\t                });\n\t                names.push(name1 + name3);\n\t            };\n\t\n\t            for (var _iterator = bigLetterReplacers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                _loop();\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        return names;\n\t    },\n\t\n\t    getQuadName100k: function getQuadName100k(column, row, join) {\n\t        var name = this.getQuadName1m(Math.floor(column / 12), Math.floor(row / 12), 1);\n\t        var subRow = row - Math.floor(row / 12) * 12;\n\t        var subColumn = column - Math.floor(column / 12) * 12;\n\t        var subquad = 132 - subRow * 12 + subColumn + 1;\n\t        name = name + '-' + zeroPad(subquad, 3);\n\t        if (join > 1) {\n\t            name += ',' + zeroPad(subquad + 1, 3);\n\t        }\n\t        if (join === 4) {\n\t            name += ',' + zeroPad(subquad + 2, 3) + ',' + zeroPad(subquad + 3, 3);\n\t        }\n\t\n\t        return [name];\n\t    },\n\t\n\t    getQuadName050k: function getQuadName050k(column, row, join) {\n\t        var name1 = this.getQuadName100k(Math.floor(column / 2), Math.floor(row / 2), 1);\n\t        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n\t        var name2 = '-' + subquad;\n\t        if (join > 1) {\n\t            name2 += ',' + (subquad + 1);\n\t        }\n\t        if (join === 4) {\n\t            name2 += ',' + this.getQuadName100k(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' + subquad + ',' + (subquad + 1);\n\t        }\n\t        var names = [name1 + name2];\n\t        var _iteratorNormalCompletion2 = true;\n\t        var _didIteratorError2 = false;\n\t        var _iteratorError2 = undefined;\n\t\n\t        try {\n\t            var _loop2 = function _loop2() {\n\t                var replacer = _step2.value;\n\t\n\t                var name3 = name2.replace(/\\b[1-4]\\b/g, function (s) {\n\t                    return replacer[s];\n\t                });\n\t                names.push(name1 + name3);\n\t            };\n\t\n\t            for (var _iterator2 = bigLetterReplacers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t                _loop2();\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError2 = true;\n\t            _iteratorError2 = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                    _iterator2.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError2) {\n\t                    throw _iteratorError2;\n\t                }\n\t            }\n\t        }\n\t\n\t        return names;\n\t    },\n\t\n\t    _getQuads: function _getQuads(bounds, row_height, column_width, name_factory) {\n\t        bounds = _leaflet2.default.latLngBounds(bounds);\n\t        var quads = [];\n\t        var min_lat = Math.max(bounds.getSouth(), -84);\n\t        var max_lat = Math.min(bounds.getNorth(), 84);\n\t        var min_row = Math.floor(min_lat / row_height);\n\t        for (var row = min_row; row * row_height < max_lat; row++) {\n\t            var row_south = row * row_height;\n\t            var row_north = row_south + row_height;\n\t            var joined_quads;\n\t            if (row_south >= 76 || row_north <= -76) {\n\t                joined_quads = 4;\n\t            } else if (row_south >= 60 || row_north <= -60) {\n\t                joined_quads = 2;\n\t            } else {\n\t                joined_quads = 1;\n\t            }\n\t            var min_lon = Math.max(bounds.getWest(), -180);\n\t            var max_lon = Math.min(bounds.getEast(), 180);\n\t            var min_column = Math.floor((min_lon + 180) / column_width / joined_quads) * joined_quads - Math.round(180 / column_width);\n\t            for (var column = min_column; column * column_width < max_lon; column += joined_quads) {\n\t                var column_west = column * column_width;\n\t                var column_east = column_west + column_width * joined_quads;\n\t                var quad_bounds = _leaflet2.default.latLngBounds([[row_south, column_west], [row_north, column_east]]);\n\t                var names = name_factory(column, row, joined_quads);\n\t                quads.push({ 'names': names, 'bounds': quad_bounds });\n\t            }\n\t        }\n\t        return quads;\n\t    },\n\t\n\t    getQuads1m: function getQuads1m(bounds) {\n\t        return this._getQuads(bounds, 4, 6, this.getQuadName1m);\n\t    },\n\t\n\t    getQuads500k: function getQuads500k(bounds) {\n\t        return this._getQuads(bounds, 2, 3, this.getQuadName500k.bind(this));\n\t    },\n\t\n\t    getQuads100k: function getQuads100k(bounds) {\n\t        return this._getQuads(bounds, 4 / 12, 6 / 12, this.getQuadName100k.bind(this));\n\t    },\n\t\n\t    getQuads050k: function getQuads050k(bounds) {\n\t        return this._getQuads(bounds, 4 / 12 / 2, 6 / 12 / 2, this.getQuadName050k.bind(this));\n\t    }\n\t\n\t};\n\t\n\t_leaflet2.default.Layer.SovietTopoGrid = _leaflet2.default.LayerGroup.extend({\n\t    options: {},\n\t\n\t    initialize: function initialize(options) {\n\t        _leaflet2.default.LayerGroup.prototype.initialize.call(this);\n\t        _leaflet2.default.Util.setOptions(this, options);\n\t        this.renderer = _leaflet2.default.svg({ padding: 0.5 });\n\t        this._quads = {};\n\t        this._updateRenderer = _leaflet2.default.Util.throttle(this._updateRenderer, 100, this);\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        this._map = map;\n\t        map.on('zoomend', this._reset, this);\n\t        map.on('move', this._update, this);\n\t        map.on('move', this._updateRenderer, this);\n\t        this._update();\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        map.off('zoomend', this._reset, this);\n\t        map.off('move', this._update, this);\n\t        this._cleanupQuads(true);\n\t    },\n\t\n\t    _addQuad: function _addQuad(bounds, id, titles, color, layer, scale) {\n\t        if (id in this._quads) {\n\t            return;\n\t        }\n\t        var rect_options = {\n\t            smoothFactor: 0,\n\t            noClip: true,\n\t            clickable: false,\n\t            fill: false,\n\t            opacity: { 1: 0.7, 2: 0.4 }[layer],\n\t            color: color,\n\t            weight: { 1: 1, 2: 3 }[layer],\n\t            renderer: this.renderer\n\t        };\n\t\n\t        var rect = _leaflet2.default.rectangle(bounds, rect_options);\n\t        this.addLayer(rect);\n\t        if (layer === 1) {\n\t            rect.bringToBack();\n\t        }\n\t        var objects = [rect];\n\t        var title = titles[0].replace(/-/g, ' &ndash; ');\n\t        var html = _leaflet2.default.Util.template('<span style=\"color:{color}\">{title}</span>', { color: color, title: title });\n\t        var icon = _leaflet2.default.divIcon({ html: html, className: 'leaflet-sovietgrid-quadtitle-' + layer, iconSize: null });\n\t        var marker = _leaflet2.default.marker(_leaflet2.default.latLngBounds(bounds).getCenter(), { icon: icon });\n\t        this.addLayer(marker);\n\t        objects.push(marker);\n\t        this._quads[id] = objects;\n\t        marker.on('click contextmenu', this._showContextMenu.bind(this, scale, titles));\n\t    },\n\t\n\t    _showContextMenu: function _showContextMenu(scale, titles, e) {\n\t        var scaleString = {\n\t            '1m': '1:1 000 000',\n\t            '500k': '1:500 000',\n\t            '100k': '1:100 000',\n\t            '050k': '1:50 000'\n\t        }[scale];\n\t        var items = [{ 'text': scaleString, disabled: true }, { 'text': 'Click name to copy to clibpoard', disabled: true }, {\n\t            'text': titles[0], callback: function callback() {\n\t                (0, _clipboardCopy2.default)(titles[0], e.originalEvent);\n\t            }\n\t        }];\n\t        if (titles.length > 1) {\n\t            items.push({\n\t                'text': titles[1] + ' <span class=\"leaflet-sovietgrid-lang\">RUS</span>', callback: function callback() {\n\t                    (0, _clipboardCopy2.default)(titles[1], e.originalEvent);\n\t                }\n\t            });\n\t            items.push({\n\t                'text': titles[2] + ' <span class=\"leaflet-sovietgrid-lang\">LAT</span>', callback: function callback() {\n\t                    (0, _clipboardCopy2.default)(titles[2], e.originalEvent);\n\t                }\n\t            });\n\t        }\n\t        var menu = new _contextmenu2.default(items);\n\t        menu.show(e);\n\t    },\n\t\n\t    _removeQuad: function _removeQuad(id) {\n\t        this._quads[id].forEach(this.removeLayer.bind(this));\n\t        delete this._quads[id];\n\t    },\n\t\n\t    _addQuads: function _addQuads(quads, scale, color, layer) {\n\t        quads.forEach(function (quad) {\n\t            var id = scale + quad.names[0];\n\t            this._addQuad(quad.bounds, id, quad.names, color, layer, scale);\n\t        }.bind(this));\n\t    },\n\t\n\t    _addGrid: function _addGrid() {\n\t        var quads;\n\t        var layer;\n\t        var map_bbox = this._map.getBounds();\n\t        var zoom = this._map.getZoom();\n\t\n\t        if (zoom >= 10) {\n\t            quads = Nomenclature.getQuads050k(map_bbox);\n\t            layer = zoom >= 12 ? 2 : 1;\n\t            this._addQuads(quads, '050k', '#50d', layer);\n\t        }\n\t\n\t        if (zoom >= 8 && zoom < 12) {\n\t            quads = Nomenclature.getQuads100k(map_bbox);\n\t            layer = zoom >= 10 ? 2 : 1;\n\t            this._addQuads(quads, '100k', '#d50', layer);\n\t        }\n\t\n\t        if (zoom >= 6 && zoom < 10) {\n\t            quads = Nomenclature.getQuads500k(map_bbox);\n\t            layer = zoom >= 8 ? 2 : 1;\n\t            this._addQuads(quads, '500k', '#099', layer);\n\t        }\n\t\n\t        if (zoom >= 4 && zoom < 8) {\n\t            layer = zoom >= 6 ? 2 : 1;\n\t            quads = Nomenclature.getQuads1m(map_bbox);\n\t            this._addQuads(quads, '1m', 'blue', layer);\n\t        }\n\t    },\n\t\n\t    _reset: function _reset() {\n\t        this._update(true);\n\t    },\n\t\n\t    _cleanupQuads: function _cleanupQuads(reset) {\n\t        if (reset === true) {\n\t            this.clearLayers();\n\t            this._quads = {};\n\t        } else {\n\t            var map_bbox = this._map.getBounds();\n\t            var _iteratorNormalCompletion3 = true;\n\t            var _didIteratorError3 = false;\n\t            var _iteratorError3 = undefined;\n\t\n\t            try {\n\t                for (var _iterator3 = Object.keys(this._quads)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t                    var quad_id = _step3.value;\n\t\n\t                    var rect = this._quads[quad_id][0];\n\t                    if (!map_bbox.intersects(rect.getBounds())) {\n\t                        this._removeQuad(quad_id);\n\t                    }\n\t                }\n\t            } catch (err) {\n\t                _didIteratorError3 = true;\n\t                _iteratorError3 = err;\n\t            } finally {\n\t                try {\n\t                    if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                        _iterator3.return();\n\t                    }\n\t                } finally {\n\t                    if (_didIteratorError3) {\n\t                        throw _iteratorError3;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    },\n\t\n\t    _updateRenderer: function _updateRenderer() {\n\t        if (this.renderer._map) {\n\t            this.renderer._update();\n\t        }\n\t    },\n\t\n\t    _update: function _update(reset) {\n\t        this._cleanupQuads(reset);\n\t        this._addGrid();\n\t    }\n\t});\n\n/***/ },\n/* 225 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tvar _wikimapiaLoader = __webpack_require__(226);\n\t\n\t__webpack_require__(467);\n\t\n\tvar _popupWindow = __webpack_require__(128);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction isPointInPolygon(polygon, p) {\n\t    var inside = false;\n\t    var prevNode = polygon[polygon.length - 1],\n\t        node,\n\t        i;\n\t    for (i = 0; i < polygon.length; i++) {\n\t        node = polygon[i];\n\t        if ((node[0] <= p[0] && p[0] < prevNode[0] || prevNode[0] <= p[0] && p[0] < node[0]) && p[1] < (prevNode[1] - node[1]) * (p[0] - node[0]) / (prevNode[0] - node[0]) + node[1]) {\n\t            inside = !inside;\n\t        }\n\t        prevNode = node;\n\t    }\n\t    return inside;\n\t}\n\t\n\t_leaflet2.default.Wikimapia = _leaflet2.default.GridLayer.extend({\n\t    options: {\n\t        tileSize: 1024,\n\t        updateWhenIdle: true\n\t    },\n\t\n\t    initialize: function initialize(options) {\n\t        _leaflet2.default.GridLayer.prototype.initialize.call(this, options);\n\t        this.loader = null;\n\t    },\n\t\n\t    onAdd: function onAdd(map) {\n\t        if (!this.loader) {\n\t            this.loader = new _wikimapiaLoader.WikimapiaLoader(map);\n\t        }\n\t        _leaflet2.default.GridLayer.prototype.onAdd.call(this, map);\n\t        this.on('tileunload', this.onTileUnload, this);\n\t        map.on('mousemove', this.onMouseMove, this);\n\t        map.on('click', this.onClick, this);\n\t    },\n\t\n\t    onRemove: function onRemove(map) {\n\t        map.off('mousemove', this.onMouseMove, this);\n\t        map.off('click', this.onClick, this);\n\t        if (this.highlightedPlace) {\n\t            this._map.removeLayer(this.highlightedPlace.polygon);\n\t            this._map.removeLayer(this.highlightedPlace.label);\n\t            this.highlightedPlace = null;\n\t        }\n\t        _leaflet2.default.TileLayer.prototype.onRemove.call(this, map);\n\t        this.off('tileunload', this.onTileUnload, this);\n\t    },\n\t\n\t    drawTile: function drawTile(canvas) {\n\t        if (!this._map) {\n\t            return;\n\t        }\n\t        var tileData = canvas._tileData,\n\t            adjustment = canvas._adjustment;\n\t        if (!tileData) {\n\t            return;\n\t        }\n\t\n\t        var canvasCtx = canvas.getContext('2d');\n\t        canvasCtx.beginPath();\n\t        canvasCtx.strokeStyle = '#CFA600';\n\t        canvasCtx.lineWidth = 1;\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = tileData.places[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var place = _step.value;\n\t\n\t                var polygon = place.localPolygon;\n\t                if (!polygon) {\n\t                    continue;\n\t                }\n\t                if (adjustment) {\n\t                    var multiplier = adjustment.multiplier,\n\t                        offsetX = adjustment.offsetX,\n\t                        offsetY = adjustment.offsetY,\n\t                        polygon2 = [];\n\t\n\t                    for (var i = 0; i < polygon.length; i++) {\n\t                        var _p = polygon[i];\n\t                        polygon2.push({\n\t                            x: _p.x * multiplier - offsetX,\n\t                            y: _p.y * multiplier - offsetY\n\t                        });\n\t                    }\n\t                    polygon = polygon2;\n\t                }\n\t                canvasCtx.moveTo(polygon[0].x, polygon[0].y);\n\t                var p = void 0;\n\t                for (var _i = 1; _i < polygon.length; _i++) {\n\t                    p = polygon[_i];\n\t                    canvasCtx.lineTo(p.x, p.y);\n\t                }\n\t                canvasCtx.lineTo(polygon[0].x, polygon[0].y);\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t\n\t        canvasCtx.stroke();\n\t    },\n\t\n\t    createTile: function createTile(coords, done) {\n\t        var _this = this;\n\t\n\t        var canvas = _leaflet2.default.DomUtil.create('canvas', 'leaflet-tile');\n\t        canvas.width = this.options.tileSize;\n\t        canvas.height = this.options.tileSize;\n\t\n\t        var _loader$requestTileDa = this.loader.requestTileData(coords),\n\t            dataPromise = _loader$requestTileDa.dataPromise,\n\t            abortLoading = _loader$requestTileDa.abortLoading;\n\t\n\t        dataPromise.then(function (data) {\n\t            canvas._tileData = data.tileData;\n\t            canvas._adjustment = data.adjustment;\n\t            _this.drawTile(canvas);\n\t            _this._tileOnLoad(done, canvas);\n\t        });\n\t\n\t        canvas._abortLoading = abortLoading;\n\t        return canvas;\n\t    },\n\t\n\t    _tileOnLoad: function _tileOnLoad(done, tile) {\n\t        // For https://github.com/Leaflet/Leaflet/issues/3332\n\t        if (_leaflet2.default.Browser.ielt9) {\n\t            setTimeout(_leaflet2.default.bind(done, this, null, tile), 0);\n\t        } else {\n\t            done(null, tile);\n\t        }\n\t    },\n\t\n\t    onTileUnload: function onTileUnload(e) {\n\t        var tile = e.tile;\n\t        tile._abortLoading();\n\t        delete tile._tileData;\n\t        delete tile._adjustment;\n\t    },\n\t\n\t    _tileCoordsFromEvent: function _tileCoordsFromEvent(e) {\n\t        var layerPoint = this._map.getPixelOrigin().add(e.layerPoint);\n\t        var tileSize = this.options.tileSize;\n\t        var coords = {\n\t            x: Math.floor(layerPoint.x / tileSize),\n\t            y: Math.floor(layerPoint.y / tileSize),\n\t            z: this._map.getZoom()\n\t        };\n\t\n\t        return coords;\n\t    },\n\t\n\t    getPlaceAtMousePos: function getPlaceAtMousePos(e) {\n\t        var tileCoords = this._tileCoordsFromEvent(e);\n\t        var tile = this._tiles[this._tileCoordsToKey(tileCoords)];\n\t        if (!tile) {\n\t            return null;\n\t        }\n\t        var tileData = tile.el._tileData;\n\t        if (!tileData) {\n\t            return null;\n\t        }\n\t        return this.getPlaceAtLatlng(e.latlng, tileData.places);\n\t    },\n\t\n\t    onMouseMove: function onMouseMove(e) {\n\t        var place = this.getPlaceAtMousePos(e);\n\t        if (this.highlightedPlace && (!place || this.highlightedPlace.id !== place.id)) {\n\t            this._map.removeLayer(this.highlightedPlace.polygon);\n\t            this._map.removeLayer(this.highlightedPlace.label);\n\t            this.highlightedPlace = null;\n\t        }\n\t\n\t        if (place && !this.highlightedPlace) {\n\t            this.highlightedPlace = {\n\t                id: place.id,\n\t                polygon: _leaflet2.default.polygon(place.polygon, {\n\t                    weight: 0,\n\t                    color: '#E6B800'\n\t                }),\n\t                label: _leaflet2.default.tooltip({ className: 'wikimapia-tooltip-wrapper' }, null)\n\t            };\n\t            this.highlightedPlace.label.setLatLng(e.latlng);\n\t            this.highlightedPlace.polygon.addTo(this._map).bringToBack();\n\t            this.highlightedPlace.label.setContent('<div class=\"wikimapia-tooltip\">' + place.title + '</div>');\n\t            this._map.addLayer(this.highlightedPlace.label);\n\t        }\n\t        if (this.highlightedPlace) {\n\t            this.highlightedPlace.label.setLatLng(e.latlng);\n\t        }\n\t    },\n\t\n\t    onClick: function onClick(e) {\n\t        if (this._map.clickLocked) {\n\t            return;\n\t        }\n\t        var place = this.getPlaceAtMousePos(e);\n\t        if (place) {\n\t            var url = 'http://wikimapia.org/' + place.id + '/ru/';\n\t            (0, _popupWindow.openPopupWindow)(url, 564, 'wikimapia-details');\n\t        }\n\t    },\n\t\n\t    getPlaceAtLatlng: function getPlaceAtLatlng(latlng, places) {\n\t        var lat = latlng.lat,\n\t            lng = latlng.lng,\n\t            bounds = void 0,\n\t            place = void 0;\n\t\n\t        for (var i = places.length - 1; i >= 0; i--) {\n\t            place = places[i];\n\t            bounds = place.boundsWESN;\n\t            if (lng >= bounds[0] && lng <= bounds[1] && lat >= bounds[2] && lat <= bounds[3] && isPointInPolygon(place.polygon, [lat, lng])) {\n\t                return place;\n\t            }\n\t        }\n\t    }\n\t\n\t});\n\n/***/ },\n/* 226 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.WikimapiaLoader = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _tiledDataLoader = __webpack_require__(83);\n\t\n\tvar _wmUtils = __webpack_require__(227);\n\t\n\tvar _wmUtils2 = _interopRequireDefault(_wmUtils);\n\t\n\tvar _CORSProxy = __webpack_require__(60);\n\t\n\tvar _CORSProxy2 = _interopRequireDefault(_CORSProxy);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar WikimapiaLoader = function (_TiledDataLoader) {\n\t    _inherits(WikimapiaLoader, _TiledDataLoader);\n\t\n\t    function WikimapiaLoader(projectObj) {\n\t        _classCallCheck(this, WikimapiaLoader);\n\t\n\t        var _this = _possibleConstructorReturn(this, (WikimapiaLoader.__proto__ || Object.getPrototypeOf(WikimapiaLoader)).call(this));\n\t\n\t        _this.maxZoom = 15;\n\t        _this.tileSize = 1024;\n\t\n\t        _this._projectObj = projectObj;\n\t\n\t        return _this;\n\t    }\n\t\n\t    _createClass(WikimapiaLoader, [{\n\t        key: 'getFromCache',\n\t        value: function getFromCache(dataTileCoords) {\n\t            dataTileCoords = Object.assign({}, dataTileCoords);\n\t            var exactMatch = true;\n\t            while (dataTileCoords.z >= 0) {\n\t                var key = this.makeTileKey(dataTileCoords);\n\t                var res = this._cache.get(key);\n\t                if (res.found) {\n\t                    if (exactMatch || !res.value.hasChildren) {\n\t                        res['coords'] = dataTileCoords;\n\t                        return res;\n\t                    }\n\t                    break;\n\t                }\n\t                dataTileCoords.z -= 1;\n\t                dataTileCoords.x = Math.floor(dataTileCoords.x / 2);\n\t                dataTileCoords.y = Math.floor(dataTileCoords.y / 2);\n\t                exactMatch = false;\n\t            }\n\t            return { found: false };\n\t        }\n\t    }, {\n\t        key: 'layerTileToDataTileCoords',\n\t        value: function layerTileToDataTileCoords(layerTileCoords) {\n\t            var z = layerTileCoords.z - 2;\n\t            if (z > this.maxZoom) {\n\t                var z2 = this.maxZoom,\n\t                    multiplier = 1 << z - z2;\n\t                return {\n\t                    x: Math.floor(layerTileCoords.x / multiplier),\n\t                    y: Math.floor(layerTileCoords.y / multiplier),\n\t                    z: z2\n\t                };\n\t            } else {\n\t                if (z < 0) {\n\t                    return { z: 0, x: 0, y: 0 };\n\t                }\n\t                return { z: z, x: layerTileCoords.x, y: layerTileCoords.y };\n\t            }\n\t        }\n\t    }, {\n\t        key: 'makeRequestData',\n\t        value: function makeRequestData(dataTileCoords) {\n\t            var url = _wmUtils2.default.makeTileUrl(dataTileCoords);\n\t            url = (0, _CORSProxy2.default)(url);\n\t            return {\n\t                url: url,\n\t                options: { timeout: 20000 }\n\t            };\n\t        }\n\t    }, {\n\t        key: 'processResponse',\n\t        value: function processResponse(xhr) {\n\t            return _wmUtils2.default.parseTile(xhr.response, this._projectObj).then(function (tileData) {\n\t                return {\n\t                    tileData: tileData,\n\t                    coords: tileData.coords\n\t                };\n\t            });\n\t        }\n\t    }, {\n\t        key: 'calcAdjustment',\n\t        value: function calcAdjustment(layerTileCoords, dataTileCoords) {\n\t            var adjustment = _get(WikimapiaLoader.prototype.__proto__ || Object.getPrototypeOf(WikimapiaLoader.prototype), 'calcAdjustment', this).call(this, { x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2 }, dataTileCoords);\n\t            if (adjustment) {\n\t                adjustment.offsetX *= 1024;\n\t                adjustment.offsetY *= 1024;\n\t            }\n\t            return adjustment;\n\t        }\n\t    }]);\n\t\n\t    return WikimapiaLoader;\n\t}(_tiledDataLoader.TiledDataLoader);\n\t\n\texports.WikimapiaLoader = WikimapiaLoader;\n\n/***/ },\n/* 227 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar parseTile = function () {\n\t    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(s, projectObj) {\n\t        var tile, places, lines, fields, tileId, prevTime, _iteratorNormalCompletion4, _didIteratorError4, _iteratorError4, _iterator4, _step4, line, curTime, place, _fields, placeId, bounds, coords, polygon;\n\t\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        tile = {};\n\t                        places = tile.places = [];\n\t                        lines = s.split('\\n');\n\t\n\t                        if (!(lines.length < 1)) {\n\t                            _context.next = 5;\n\t                            break;\n\t                        }\n\t\n\t                        throw new Error('No data in tile');\n\t\n\t                    case 5:\n\t                        fields = lines[0].split('|');\n\t                        tileId = fields[0];\n\t\n\t                        if (!(!tileId || !tileId.match(/^[0-3]+$/))) {\n\t                            _context.next = 9;\n\t                            break;\n\t                        }\n\t\n\t                        throw new Error('Invalid tile header');\n\t\n\t                    case 9:\n\t                        tile.tileId = tileId;\n\t                        tile.coords = tileIdToCoords(tileId);\n\t                        tile.hasChildren = fields[1] === '1';\n\t\n\t                        //FIXME: ignore some errors\n\t                        prevTime = Date.now();\n\t                        _iteratorNormalCompletion4 = true;\n\t                        _didIteratorError4 = false;\n\t                        _iteratorError4 = undefined;\n\t                        _context.prev = 16;\n\t                        _iterator4 = lines.slice(2)[Symbol.iterator]();\n\t\n\t                    case 18:\n\t                        if (_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done) {\n\t                            _context.next = 51;\n\t                            break;\n\t                        }\n\t\n\t                        line = _step4.value;\n\t                        curTime = Date.now();\n\t\n\t                        if (!(curTime - prevTime > 20)) {\n\t                            _context.next = 25;\n\t                            break;\n\t                        }\n\t\n\t                        _context.next = 24;\n\t                        return asap();\n\t\n\t                    case 24:\n\t                        prevTime = Date.now();\n\t\n\t                    case 25:\n\t                        place = {};\n\t                        _fields = line.split('|');\n\t\n\t                        if (!(_fields.length < 6)) {\n\t                            _context.next = 29;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt('continue', 48);\n\t\n\t                    case 29:\n\t                        placeId = _fields[0];\n\t\n\t                        if (placeId.match(/^\\d+$/)) {\n\t                            _context.next = 32;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt('continue', 48);\n\t\n\t                    case 32:\n\t                        place.id = parseInt(placeId, 10);\n\t                        place.title = chooseTitle(decodeTitles(_fields[5]));\n\t\n\t                        if (!(_fields[6] !== '1')) {\n\t                            _context.next = 36;\n\t                            break;\n\t                        }\n\t\n\t                        throw new Error('Unknown wikimapia polygon encoding type: \"' + _fields[6] + '\"');\n\t\n\t                    case 36:\n\t                        bounds = _fields[2].match(/^([-\\d]+),([-\\d]+),([-\\d]+),([-\\d]+)$/);\n\t\n\t                        if (bounds) {\n\t                            _context.next = 39;\n\t                            break;\n\t                        }\n\t\n\t                        throw new Error('Invalid place bounds');\n\t\n\t                    case 39:\n\t                        place.boundsWESN = bounds.slice(1).map(function (x) {\n\t                            return parseInt(x, 10) / 1e7;\n\t                        });\n\t\n\t                        coords = _fields.slice(7).join('|');\n\t\n\t\n\t                        coords = decodePolygon(coords);\n\t\n\t                        if (!(coords.length < 3)) {\n\t                            _context.next = 44;\n\t                            break;\n\t                        }\n\t\n\t                        throw new Error('Polygon has ' + coords.length + ' points');\n\t\n\t                    case 44:\n\t                        polygon = simplifyPolygon(coords, tile.coords, tile.hasChildren, projectObj);\n\t\n\t                        place.polygon = polygon;\n\t                        place.localPolygon = makeCoordsLocal(polygon, tile.coords, projectObj);\n\t                        places.push(place);\n\t\n\t                    case 48:\n\t                        _iteratorNormalCompletion4 = true;\n\t                        _context.next = 18;\n\t                        break;\n\t\n\t                    case 51:\n\t                        _context.next = 57;\n\t                        break;\n\t\n\t                    case 53:\n\t                        _context.prev = 53;\n\t                        _context.t0 = _context['catch'](16);\n\t                        _didIteratorError4 = true;\n\t                        _iteratorError4 = _context.t0;\n\t\n\t                    case 57:\n\t                        _context.prev = 57;\n\t                        _context.prev = 58;\n\t\n\t                        if (!_iteratorNormalCompletion4 && _iterator4.return) {\n\t                            _iterator4.return();\n\t                        }\n\t\n\t                    case 60:\n\t                        _context.prev = 60;\n\t\n\t                        if (!_didIteratorError4) {\n\t                            _context.next = 63;\n\t                            break;\n\t                        }\n\t\n\t                        throw _iteratorError4;\n\t\n\t                    case 63:\n\t                        return _context.finish(60);\n\t\n\t                    case 64:\n\t                        return _context.finish(57);\n\t\n\t                    case 65:\n\t                        return _context.abrupt('return', tile);\n\t\n\t                    case 66:\n\t                    case 'end':\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this, [[16, 53, 57, 65], [58,, 60, 64]]);\n\t    }));\n\t\n\t    return function parseTile(_x, _x2) {\n\t        return _ref2.apply(this, arguments);\n\t    };\n\t}();\n\t\n\t// быстрое проектирование полигонов\n\t// TODO: каждые 50-100 мс отдавать управление\n\t// projectPlacesForZoom: function(tile, viewZoom) {\n\t//     if (viewZoom < tile.coords.z) {\n\t//         throw new Error('viewZoom < tile.zoom');\n\t//     }\n\t//     if (tile.places && tile.places[0] && tile.places[0].projectedPolygons &&\n\t//         tile.places[0].projectedPolygons[viewZoom]) {\n\t//         return;\n\t//     }\n\t//     const virtualTileSize = 256 * (2 ** (viewZoom - tile.coords.z));\n\t//     const p1 = L.point([tile.coords.x * virtualTileSize, tile.coords.y * virtualTileSize]),\n\t//         p2 = L.point([(tile.coords.x + 1) * virtualTileSize, (tile.coords.y + 1) * virtualTileSize]),\n\t//         latlng1 = this._map.unproject(p1, viewZoom),\n\t//         latlng2 = this._map.unproject(p2, viewZoom),\n\t//         lat0 = latlng1.lat,\n\t//         lng0 = latlng1.lng;\n\t//     const qx = (p2.x - p1.x) / (latlng2.lng - latlng1.lng),\n\t//         qy = (p2.y - p1.y) / (latlng2.lat - latlng1.lat);\n\t//\n\t//     const offsets = [],\n\t//         offsetsStep = virtualTileSize / 64;\n\t//     const y0 = p1.y;\n\t//     for (let y = -virtualTileSize; y <= 2 * virtualTileSize; y += offsetsStep) {\n\t//         let lat = y / qy + lat0;\n\t//         let offset = this._map.project([lat, lng0], viewZoom).y - y0 - y;\n\t//         offsets.push(offset);\n\t//     }\n\t//\n\t//     let ll, offset, offsetPos, offsetIndex, offsetIndexDelta, x, y;\n\t//     const x0 = p1.x;\n\t//     for (let place of tile.places) {\n\t//         let polygon = place.polygon;\n\t//         if (polygon.length < 3) {\n\t//             continue;\n\t//         }\n\t//         let projectedPolygon = [];\n\t//         for (let i = 0; i < polygon.length; i++) {\n\t//             ll = polygon[i];\n\t//             x = (ll[1] - lng0) * qx;\n\t//             y = (ll[0] - lat0) * qy;\n\t//             offsetPos = (y + virtualTileSize) / offsetsStep;\n\t//             offsetIndex = Math.floor(offsetPos);\n\t//             offsetIndexDelta = offsetPos - offsetIndex;\n\t//             offset = offsets[offsetIndex] * (1 - offsetIndexDelta) + offsets[offsetIndex + 1] * offsetIndexDelta;\n\t//             projectedPolygon.push([x + x0, y + offset + y0]);\n\t//         }\n\t//         projectedPolygon = projectedPolygon.map(L.point);\n\t//         projectedPolygon = L.LineUtil.simplify(projectedPolygon, 1.5);\n\t//         if (!place.projectedPolygons) {\n\t//             place.projectedPolygons = [];\n\t//         }\n\t//         place.projectedPolygons[viewZoom] = projectedPolygon;\n\t//     }\n\t// },\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\t// (1233,130,5) -> \"032203\"\n\tfunction getTileId(_ref) {\n\t    var x = _ref.x,\n\t        y = _ref.y,\n\t        z = _ref.z;\n\t\n\t    var id = [];\n\t    y = (1 << z) - y - 1;\n\t    z += 1;\n\t    while (z) {\n\t        id.push((x & 1) + (y & 1) * 2);\n\t        x >>= 1;\n\t        y >>= 1;\n\t        z--;\n\t    }\n\t    return id.reverse().join('');\n\t}\n\t\n\tfunction makeTileUrl(coords) {\n\t    var tileId = getTileId(coords),\n\t        urlPath = tileId.replace(/(\\d{3})(?!$)/g, '$1/'); // \"033331022\" -> \"033/331/022\"\n\t    return 'http://wikimapia.org/z1/itiles/' + urlPath + '.xy?342342';\n\t}\n\t\n\tfunction tileIdToCoords(tileId) {\n\t    var z = tileId.length - 1;\n\t    var x = 0,\n\t        y = 0;\n\t    for (var i = 0; i < tileId.length; i++) {\n\t        var c = parseInt(tileId[i], 10);\n\t        x <<= 1;\n\t        y <<= 1;\n\t        x += c & 1;\n\t        y += c >> 1;\n\t    }\n\t    y = (1 << z) - y - 1;\n\t    return { x: x, y: y, z: z };\n\t}\n\t\n\tfunction getWikimapiaTileCoords(coords, viewTileSize) {\n\t    var z = coords.z - 2;\n\t    if (z < 0) {\n\t        z = 0;\n\t    }\n\t    if (z > 15) {\n\t        z = 15;\n\t    }\n\t    var q = Math.pow(2, z - coords.z + Math.log2(viewTileSize / 256));\n\t    var x = Math.floor(coords.x * q),\n\t        y = Math.floor(coords.y * q);\n\t    return { x: x, y: y, z: z };\n\t}\n\t\n\tfunction decodeTitles(s) {\n\t    var titles = {};\n\t    var _iteratorNormalCompletion = true;\n\t    var _didIteratorError = false;\n\t    var _iteratorError = undefined;\n\t\n\t    try {\n\t        for (var _iterator = s.split('\\x1f')[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t            var title = _step.value;\n\t\n\t            if (title.length > 2) {\n\t                var langCode = title.charCodeAt(0) - 32;\n\t                titles[langCode.toString()] = title.substring(1);\n\t            }\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion && _iterator.return) {\n\t                _iterator.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError) {\n\t                throw _iteratorError;\n\t            }\n\t        }\n\t    }\n\t\n\t    return titles;\n\t}\n\t\n\tfunction chooseTitle(titles) {\n\t    var popularLanguages = ['1', '0', '3', '2', '5', '4', '9', '28', '17', '27'];\n\t    var _iteratorNormalCompletion2 = true;\n\t    var _didIteratorError2 = false;\n\t    var _iteratorError2 = undefined;\n\t\n\t    try {\n\t        for (var _iterator2 = popularLanguages[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t            var langCode = _step2.value;\n\t\n\t            if (langCode in titles) {\n\t                return titles[langCode];\n\t            }\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError2 = true;\n\t        _iteratorError2 = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t                _iterator2.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError2) {\n\t                throw _iteratorError2;\n\t            }\n\t        }\n\t    }\n\t\n\t    var _iteratorNormalCompletion3 = true;\n\t    var _didIteratorError3 = false;\n\t    var _iteratorError3 = undefined;\n\t\n\t    try {\n\t        for (var _iterator3 = Object.keys(titles)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t            var _langCode = _step3.value;\n\t\n\t            return titles[_langCode];\n\t        }\n\t    } catch (err) {\n\t        _didIteratorError3 = true;\n\t        _iteratorError3 = err;\n\t    } finally {\n\t        try {\n\t            if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t                _iterator3.return();\n\t            }\n\t        } finally {\n\t            if (_didIteratorError3) {\n\t                throw _iteratorError3;\n\t            }\n\t        }\n\t    }\n\t}\n\t\n\tfunction decodePolygon(s) {\n\t    var i = 0,\n\t        coords = [],\n\t        lat = 0,\n\t        lng = 0;\n\t    while (i < s.length) {\n\t        var p,\n\t            l = 0,\n\t            c = 0;\n\t        do {\n\t            p = s.charCodeAt(i++) - 63;\n\t            c |= (p & 31) << l;\n\t            l += 5;\n\t        } while (p >= 32);\n\t        lng += c & 1 ? ~(c >> 1) : c >> 1;\n\t        l = 0;\n\t        c = 0;\n\t        do {\n\t            p = s.charCodeAt(i++) - 63;\n\t            c |= (p & 31) << l;\n\t            l += 5;\n\t        } while (p >= 32);\n\t        lat += c & 1 ? ~(c >> 1) : c >> 1;\n\t        coords.push([lat / 1e6, lng / 1e6]);\n\t    }\n\t    return coords;\n\t}\n\t\n\tfunction makeCoordsLocal(line, tileCoords, projectObj) {\n\t    var tileX = tileCoords.x,\n\t        tileY = tileCoords.y,\n\t        tileZ = tileCoords.z,\n\t        x0 = tileX * 1024,\n\t        y0 = tileY * 1024,\n\t        localCoords = [];\n\t\n\t    var latlon = void 0,\n\t        p = void 0;\n\t    for (var i = 0; i < line.length; i++) {\n\t        latlon = line[i];\n\t        p = projectObj.project(latlon, tileZ + 2);\n\t        p.x -= x0;\n\t        p.y -= y0;\n\t        localCoords.push(p);\n\t    }\n\t    return localCoords;\n\t}\n\t\n\tfunction asap() {\n\t    return new Promise(function (resolve) {\n\t        return setTimeout(resolve, 0);\n\t    });\n\t}\n\t\n\tfunction simplifyPolygon(latlngs, tileCoords, tileHasChildren, projectObj) {\n\t    var x = tileCoords.x * 1024,\n\t        y = tileCoords.y * 1024,\n\t        p0 = projectObj.unproject([x, y]),\n\t        p1 = projectObj.unproject([x + 1, y + 1]);\n\t    var pixelDegSize = p0.lat - p1.lat;\n\t    if (!tileHasChildren && tileCoords.z < 15) {\n\t        pixelDegSize /= 1 << 15 - tileCoords.z;\n\t    }\n\t    var points = [];\n\t    for (var i = 0; i < latlngs.length; i++) {\n\t        var ll = latlngs[i];\n\t        points.push({ x: ll[0], y: ll[1] });\n\t    }\n\t    points = _leaflet2.default.LineUtil.simplify(points, pixelDegSize * 2);\n\t    latlngs = [];\n\t    for (var _i = 0; _i < points.length; _i++) {\n\t        var p = points[_i];\n\t        latlngs.push([p.x, p.y]);\n\t    }\n\t    return latlngs;\n\t}\n\t\n\texports.default = { getTileId: getTileId, getWikimapiaTileCoords: getWikimapiaTileCoords, parseTile: parseTile, makeTileUrl: makeTileUrl };\n\n/***/ },\n/* 228 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.LineUtil.simplifyLatlngs = function simplifyLatlngs(points, tolerance) {\n\t    function latlngToXy(p) {\n\t        return {\n\t            x: p.lng,\n\t            y: p.lat\n\t        };\n\t    }\n\t\n\t    function xyToLatlng(p) {\n\t        return {\n\t            lat: p.y,\n\t            lng: p.x\n\t        };\n\t    }\n\t\n\t    points = points.map(latlngToXy);\n\t    points = _leaflet2.default.LineUtil.simplify(points, tolerance);\n\t    points = points.map(xyToLatlng);\n\t    return points;\n\t};\n\n/***/ },\n/* 229 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _leaflet = __webpack_require__(2);\n\t\n\tvar _leaflet2 = _interopRequireDefault(_leaflet);\n\t\n\t__webpack_require__(469);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_leaflet2.default.Polyline.EditMixinOptions = {\n\t    className: 'leaflet-editable-line'\n\t};\n\t\n\t_leaflet2.default.Polyline.EditMixin = {\n\t    _nodeMarkersZOffset: 10000,\n\t\n\t    startEdit: function startEdit() {\n\t        if (this._map && !this._editing) {\n\t            this._editing = true;\n\t            this._drawingDirection = 0;\n\t            this.setupMarkers();\n\t            this.on('remove', this.stopEdit.bind(this));\n\t            this._map.on('click', this.onMapClick, this).on('dragend', this.onMapEndDrag, this);\n\t            _leaflet2.default.DomEvent.on(document, 'keyup', this.onKeyPress, this);\n\t            this._storedStyle = { weight: this.options.weight, opacity: this.options.opacity };\n\t            this.setStyle({ weight: 1.5, opacity: 1 });\n\t            _leaflet2.default.DomUtil.addClass(this._map._container, 'leaflet-line-editing');\n\t        }\n\t    },\n\t\n\t    stopEdit: function stopEdit(userCancelled) {\n\t        if (this._editing) {\n\t            this.stopDrawingLine();\n\t            this._editing = false;\n\t            this.removeMarkers();\n\t            _leaflet2.default.DomEvent.off(document, 'keyup', this.onKeyPress, this);\n\t            this.off('remove', this.stopEdit.bind(this));\n\t            this._map.off('click', this.onMapClick, this).off('dragend', this.onMapEndDrag, this);\n\t            this.setStyle(this._storedStyle);\n\t            _leaflet2.default.DomUtil.removeClass(this._map._container, 'leaflet-line-editing');\n\t            this.fire('editend', { target: this, userCancelled: userCancelled });\n\t        }\n\t    },\n\t\n\t    removeMarkers: function removeMarkers() {\n\t        this.getLatLngs().forEach(function (node) {\n\t            if (node._nodeMarker) {\n\t                this._map.removeLayer(node._nodeMarker);\n\t                delete node._nodeMarker._lineNode;\n\t                delete node._nodeMarker;\n\t            }\n\t            if (node._segmentOverlay) {\n\t                this._map.removeLayer(node._segmentOverlay);\n\t                delete node._segmentOverlay._lineNode;\n\t                delete node._segmentOverlay;\n\t            }\n\t        }.bind(this));\n\t    },\n\t\n\t    onNodeMarkerDragEnd: function onNodeMarkerDragEnd(e) {\n\t        var marker = e.target,\n\t            nodeIndex = this.getLatLngs().indexOf(marker._lineNode);\n\t        this.replaceNode(nodeIndex, marker.getLatLng());\n\t    },\n\t\n\t    onNodeMarkerMovedChangeNode: function onNodeMarkerMovedChangeNode(e) {\n\t        var marker = e.target,\n\t            latlng = marker.getLatLng(),\n\t\n\t        //nodeIndex = this.getLatLngs().indexOf(marker._lineNode);\n\t        node = marker._lineNode;\n\t        node.lat = latlng.lat;\n\t        node.lng = latlng.lng;\n\t        this.redraw();\n\t        this.fire('nodeschanged');\n\t    },\n\t\n\t    onNodeMarkerDblClickedRemoveNode: function onNodeMarkerDblClickedRemoveNode(e) {\n\t        if (this.getLatLngs().length < 2 || this._drawingDirection && this.getLatLngs().length === 2) {\n\t            return;\n\t        }\n\t        var marker = e.target,\n\t            nodeIndex = this.getLatLngs().indexOf(marker._lineNode);\n\t        this.removeNode(nodeIndex);\n\t        this.fire('nodeschanged');\n\t    },\n\t\n\t    onMapClick: function onMapClick(e) {\n\t        if (this._drawingDirection) {\n\t            var newNodeIndex = this._drawingDirection === -1 ? 1 : this.getLatLngs().length - 1;\n\t            this.addNode(newNodeIndex, e.latlng);\n\t        } else {\n\t            if (!this.preventStopEdit) {\n\t                this.stopEdit(true);\n\t            }\n\t        }\n\t    },\n\t\n\t    onMapEndDrag: function onMapEndDrag(e) {\n\t        if (e.distance < 15) {\n\t            // get mouse position from map drag handler\n\t            var handler = e.target.dragging._draggable;\n\t            var mousePos = handler._startPoint.add(handler._newPos).subtract(handler._startPos);\n\t            var latlng = e.target.mouseEventToLatLng({ clientX: mousePos.x, clientY: mousePos.y });\n\t            this.onMapClick({ latlng: latlng });\n\t        }\n\t    },\n\t\n\t    startDrawingLine: function startDrawingLine(direction, e) {\n\t        if (!this._editing) {\n\t            return;\n\t        }\n\t        if (direction === undefined) {\n\t            direction = 1;\n\t        }\n\t        if (this._drawingDirection === direction) {\n\t            return;\n\t        }\n\t        this.stopDrawingLine();\n\t        this._drawingDirection = direction;\n\t\n\t        if (e) {\n\t            var newNodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length;\n\t            this.spliceLatLngs(newNodeIndex, 0, e.latlng);\n\t            this.fire('nodeschanged');\n\t        }\n\t\n\t        this._map.on('mousemove', this.onMouseMoveFollowEndNode, this);\n\t        _leaflet2.default.DomUtil.addClass(this._map._container, 'leaflet-line-drawing');\n\t        this._map.clickLocked = true;\n\t    },\n\t\n\t    stopDrawingLine: function stopDrawingLine() {\n\t        if (!this._drawingDirection) {\n\t            return;\n\t        }\n\t        this._map.off('mousemove', this.onMouseMoveFollowEndNode, this);\n\t        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n\t        this.spliceLatLngs(nodeIndex, 1);\n\t        this.fire('nodeschanged');\n\t        this._drawingDirection = 0;\n\t        _leaflet2.default.DomUtil.removeClass(this._map._container, 'leaflet-line-drawing');\n\t        this._map.clickLocked = false;\n\t        this.fire('drawend');\n\t    },\n\t\n\t    onKeyPress: function onKeyPress(e) {\n\t        if ('input' === e.target.tagName.toLowerCase()) {\n\t            return;\n\t        }\n\t        var code = e.keyCode;\n\t        switch (code) {\n\t            case 27:\n\t            case 13:\n\t                if (this._drawingDirection) {\n\t                    this.stopDrawingLine();\n\t                } else {\n\t                    if (!this.preventStopEdit) {\n\t                        this.stopEdit(true);\n\t                    }\n\t                }\n\t                _leaflet2.default.DomEvent.stop(e);\n\t                break;\n\t            case 8:\n\t            case 46:\n\t                if (this._drawingDirection && this.getLatLngs().length > 2) {\n\t                    var nodeIndex = this._drawingDirection === 1 ? this.getLatLngs().length - 2 : 1;\n\t                    this.removeNode(nodeIndex);\n\t                    this.fire('nodeschanged');\n\t                    _leaflet2.default.DomEvent.preventDefault(e);\n\t                }\n\t                break;\n\t\n\t            default:\n\t        }\n\t    },\n\t\n\t    onMouseMoveFollowEndNode: function onMouseMoveFollowEndNode(e) {\n\t        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n\t        this.spliceLatLngs(nodeIndex, 1, e.latlng);\n\t        this.fire('nodeschanged');\n\t    },\n\t\n\t    makeNodeMarker: function makeNodeMarker(nodeIndex) {\n\t        var node = this.getLatLngs()[nodeIndex],\n\t            marker = _leaflet2.default.marker(node.clone(), {\n\t            icon: _leaflet2.default.divIcon({ className: 'line-editor-node-marker-halo', 'html': '<div class=\"line-editor-node-marker\"></div>' }),\n\t            draggable: true,\n\t            zIndexOffset: this._nodeMarkersZOffset\n\t        });\n\t        marker.on('drag', this.onNodeMarkerMovedChangeNode, this)\n\t        //.on('dragstart', this.fire.bind(this, 'editingstart'))\n\t        .on('dragend', this.onNodeMarkerDragEnd, this).on('dblclick', this.onNodeMarkerDblClickedRemoveNode, this).on('click', this.onNodeMarkerClickStartStopDrawing, this).on('contextmenu', function (e) {\n\t            this.stopDrawingLine();\n\t            this.fire('noderightclick', {\n\t                nodeIndex: this.getLatLngs().indexOf(marker._lineNode),\n\t                line: this,\n\t                mouseEvent: e\n\t            });\n\t        }, this);\n\t        marker._lineNode = node;\n\t        node._nodeMarker = marker;\n\t        marker.addTo(this._map);\n\t    },\n\t\n\t    onNodeMarkerClickStartStopDrawing: function onNodeMarkerClickStartStopDrawing(e) {\n\t        var marker = e.target,\n\t            latlngs = this.getLatLngs(),\n\t            latlngs_n = latlngs.length,\n\t            nodeIndex = latlngs.indexOf(marker._lineNode);\n\t        if (this._drawingDirection === -1 && nodeIndex === 1 || this._drawingDirection === 1 && nodeIndex === latlngs_n - 2) {\n\t            this.stopDrawingLine();\n\t        } else if (nodeIndex === 0) {\n\t            this.startDrawingLine(-1, e);\n\t        } else if (nodeIndex === this.getLatLngs().length - 1) {\n\t            this.startDrawingLine(1, e);\n\t        }\n\t    },\n\t\n\t    makeSegmentOverlay: function makeSegmentOverlay(nodeIndex) {\n\t        var latlngs = this.getLatLngs(),\n\t            p1 = latlngs[nodeIndex],\n\t            p2 = latlngs[nodeIndex + 1];\n\t        if (!p2) {\n\t            return;\n\t        }\n\t        var segmentOverlay = _leaflet2.default.polyline([p1, p2], { weight: 10, opacity: 0.0 });\n\t        segmentOverlay.on('mousedown', this.onSegmentMouseDownAddNode, this);\n\t        segmentOverlay.on('contextmenu', function (e) {\n\t            this.stopDrawingLine();\n\t            this.fire('segmentrightclick', {\n\t                nodeIndex: this.getLatLngs().indexOf(segmentOverlay._lineNode),\n\t                mouseEvent: e,\n\t                line: this\n\t            });\n\t        }, this);\n\t        segmentOverlay._lineNode = p1;\n\t        p1._segmentOverlay = segmentOverlay;\n\t        segmentOverlay.addTo(this._map);\n\t    },\n\t\n\t    onSegmentMouseDownAddNode: function onSegmentMouseDownAddNode(e) {\n\t        if (e.originalEvent.button !== 0) {\n\t            return;\n\t        }\n\t        var segmentOverlay = e.target,\n\t            latlngs = this.getLatLngs(),\n\t            nodeIndex = latlngs.indexOf(segmentOverlay._lineNode) + 1;\n\t        this.addNode(nodeIndex, e.latlng);\n\t        if (_leaflet2.default.Draggable._dragging) {\n\t            _leaflet2.default.Draggable._dragging.finishDrag();\n\t        }\n\t        latlngs[nodeIndex]._nodeMarker.dragging._draggable._onDown(e.originalEvent);\n\t        this.fire('nodeschanged');\n\t    },\n\t\n\t    addNode: function addNode(index, latlng) {\n\t        var nodes = this.getLatLngs(),\n\t            isAddingLeft = index === 1 && this._drawingDirection === -1,\n\t            isAddingRight = index === nodes.length - 1 && this._drawingDirection === 1;\n\t        latlng = latlng.clone();\n\t        this.spliceLatLngs(index, 0, latlng);\n\t        this.makeNodeMarker(index);\n\t        if (!isAddingLeft && index >= 1) {\n\t            if (!isAddingRight) {\n\t                var prevNode = nodes[index - 1];\n\t                this._map.removeLayer(prevNode._segmentOverlay);\n\t                delete prevNode._segmentOverlay._lineNode;\n\t                delete prevNode._segmentOverlay;\n\t            }\n\t            this.makeSegmentOverlay(index - 1);\n\t        }\n\t        if (!isAddingRight) {\n\t            this.makeSegmentOverlay(index);\n\t        }\n\t    },\n\t\n\t    removeNode: function removeNode(index) {\n\t        var nodes = this.getLatLngs(),\n\t            node = nodes[index],\n\t            marker = node._nodeMarker;\n\t        delete node._nodeMarker;\n\t        delete marker._lineNode;\n\t        this.spliceLatLngs(index, 1);\n\t        this._map.removeLayer(marker);\n\t        if (node._segmentOverlay) {\n\t            this._map.removeLayer(node._segmentOverlay);\n\t            delete node._segmentOverlay._lineNode;\n\t            delete node._segmentOverlay;\n\t        }\n\t        var prevNode = nodes[index - 1];\n\t        if (prevNode && prevNode._segmentOverlay) {\n\t            this._map.removeLayer(prevNode._segmentOverlay);\n\t            delete prevNode._segmentOverlay._lineNode;\n\t            delete prevNode._segmentOverlay;\n\t            if (index < nodes.length - 1 || index < nodes.length && this._drawingDirection !== 1) {\n\t                this.makeSegmentOverlay(index - 1);\n\t            }\n\t        }\n\t    },\n\t\n\t    replaceNode: function replaceNode(index, latlng) {\n\t        var nodes = this.getLatLngs(),\n\t            oldNode = nodes[index],\n\t            oldMarker = oldNode._nodeMarker;\n\t        this._map.removeLayer(oldNode._nodeMarker);\n\t        delete oldNode._nodeMarker;\n\t        delete oldMarker._lineNode;\n\t        latlng = latlng.clone();\n\t        this.spliceLatLngs(index, 1, latlng);\n\t        this.makeNodeMarker(index);\n\t        if (oldNode._segmentOverlay) {\n\t            this._map.removeLayer(oldNode._segmentOverlay);\n\t            delete oldNode._segmentOverlay._lineNode;\n\t            delete oldNode._segmentOverlay;\n\t            this.makeSegmentOverlay(index);\n\t        }\n\t        var prevNode = nodes[index - 1];\n\t        if (prevNode && prevNode._segmentOverlay) {\n\t            this._map.removeLayer(prevNode._segmentOverlay);\n\t            delete prevNode._segmentOverlay._lineNode;\n\t            delete prevNode._segmentOverlay;\n\t            this.makeSegmentOverlay(index - 1);\n\t        }\n\t    },\n\t\n\t    setupMarkers: function setupMarkers() {\n\t        this.removeMarkers();\n\t        var latlngs = this.getLatLngs(),\n\t            startNode = 0,\n\t            endNode = latlngs.length - 1;\n\t        if (this._drawingDirection === -1) {\n\t            startNode += 1;\n\t        }\n\t        if (this._drawingDirection === 1) {\n\t            endNode -= 1;\n\t        }\n\t        for (var i = startNode; i <= endNode; i++) {\n\t            this.makeNodeMarker(i);\n\t            if (i < endNode) {\n\t                this.makeSegmentOverlay(i);\n\t            }\n\t        }\n\t    },\n\t\n\t    spliceLatLngs: function spliceLatLngs() {\n\t        var latlngs = this.getLatLngs();\n\t        var res = latlngs.splice.apply(latlngs, arguments);\n\t        this.setLatLngs(latlngs);\n\t        return res;\n\t        // this._latlngs.splice(...args);\n\t        // this.redraw();\n\t    }\n\t\n\t};\n\n/***/ },\n/* 230 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = stripBom;\n\tfunction stripBom(s) {\n\t    if (s.substr(0, 3) === '\\xef\\xbb\\xbf') {\n\t        s = s.substr(3);\n\t    }\n\t    return s;\n\t}\n\n/***/ },\n/* 231 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = {\n\t    bingKey: 'ArTkP-DmMk_eLjH_bqre-RDkN7_9JZ2QikvOTgD7NcePeL4ARw3CLRnzalMJQn32',\n\t    thunderforestKey: '00000000000000000000000000000000',\n\t    sentryDSN: '',\n\t    mapillary: 'azJWOG1CVHUtUjdlSkVTMUF2WG91dzoyZmNhZmFjMzMyMmU2YzNi'\n\t};\n\n/***/ },\n/* 232 */,\n/* 233 */,\n/* 234 */,\n/* 235 */,\n/* 236 */,\n/* 237 */,\n/* 238 */,\n/* 239 */,\n/* 240 */,\n/* 241 */,\n/* 242 */,\n/* 243 */,\n/* 244 */,\n/* 245 */,\n/* 246 */,\n/* 247 */,\n/* 248 */,\n/* 249 */,\n/* 250 */,\n/* 251 */,\n/* 252 */,\n/* 253 */,\n/* 254 */,\n/* 255 */,\n/* 256 */,\n/* 257 */,\n/* 258 */,\n/* 259 */,\n/* 260 */,\n/* 261 */,\n/* 262 */,\n/* 263 */,\n/* 264 */,\n/* 265 */,\n/* 266 */,\n/* 267 */,\n/* 268 */,\n/* 269 */,\n/* 270 */,\n/* 271 */,\n/* 272 */,\n/* 273 */,\n/* 274 */,\n/* 275 */,\n/* 276 */,\n/* 277 */,\n/* 278 */,\n/* 279 */,\n/* 280 */,\n/* 281 */,\n/* 282 */,\n/* 283 */,\n/* 284 */,\n/* 285 */,\n/* 286 */,\n/* 287 */,\n/* 288 */,\n/* 289 */,\n/* 290 */,\n/* 291 */,\n/* 292 */,\n/* 293 */,\n/* 294 */,\n/* 295 */,\n/* 296 */,\n/* 297 */,\n/* 298 */,\n/* 299 */,\n/* 300 */,\n/* 301 */,\n/* 302 */,\n/* 303 */,\n/* 304 */,\n/* 305 */,\n/* 306 */,\n/* 307 */,\n/* 308 */,\n/* 309 */,\n/* 310 */,\n/* 311 */,\n/* 312 */,\n/* 313 */,\n/* 314 */,\n/* 315 */,\n/* 316 */,\n/* 317 */,\n/* 318 */,\n/* 319 */,\n/* 320 */,\n/* 321 */,\n/* 322 */,\n/* 323 */,\n/* 324 */,\n/* 325 */,\n/* 326 */,\n/* 327 */,\n/* 328 */,\n/* 329 */,\n/* 330 */,\n/* 331 */,\n/* 332 */,\n/* 333 */,\n/* 334 */,\n/* 335 */,\n/* 336 */,\n/* 337 */,\n/* 338 */,\n/* 339 */,\n/* 340 */,\n/* 341 */,\n/* 342 */,\n/* 343 */,\n/* 344 */,\n/* 345 */,\n/* 346 */,\n/* 347 */,\n/* 348 */,\n/* 349 */,\n/* 350 */,\n/* 351 */,\n/* 352 */,\n/* 353 */,\n/* 354 */,\n/* 355 */,\n/* 356 */,\n/* 357 */,\n/* 358 */,\n/* 359 */,\n/* 360 */,\n/* 361 */,\n/* 362 */,\n/* 363 */,\n/* 364 */,\n/* 365 */,\n/* 366 */,\n/* 367 */,\n/* 368 */,\n/* 369 */,\n/* 370 */,\n/* 371 */,\n/* 372 */,\n/* 373 */,\n/* 374 */,\n/* 375 */,\n/* 376 */,\n/* 377 */,\n/* 378 */,\n/* 379 */,\n/* 380 */,\n/* 381 */,\n/* 382 */,\n/* 383 */,\n/* 384 */,\n/* 385 */,\n/* 386 */,\n/* 387 */,\n/* 388 */,\n/* 389 */,\n/* 390 */,\n/* 391 */,\n/* 392 */,\n/* 393 */,\n/* 394 */,\n/* 395 */,\n/* 396 */,\n/* 397 */,\n/* 398 */,\n/* 399 */,\n/* 400 */,\n/* 401 */,\n/* 402 */,\n/* 403 */,\n/* 404 */,\n/* 405 */,\n/* 406 */,\n/* 407 */,\n/* 408 */,\n/* 409 */,\n/* 410 */,\n/* 411 */,\n/* 412 */,\n/* 413 */,\n/* 414 */,\n/* 415 */,\n/* 416 */,\n/* 417 */,\n/* 418 */,\n/* 419 */,\n/* 420 */,\n/* 421 */,\n/* 422 */,\n/* 423 */,\n/* 424 */,\n/* 425 */,\n/* 426 */,\n/* 427 */,\n/* 428 */,\n/* 429 */,\n/* 430 */,\n/* 431 */,\n/* 432 */,\n/* 433 */,\n/* 434 */,\n/* 435 */,\n/* 436 */,\n/* 437 */,\n/* 438 */\n437,\n/* 439 */\n437,\n/* 440 */\n437,\n/* 441 */\n437,\n/* 442 */\n437,\n/* 443 */\n437,\n/* 444 */\n437,\n/* 445 */\n437,\n/* 446 */\n437,\n/* 447 */\n437,\n/* 448 */\n437,\n/* 449 */\n437,\n/* 450 */\n437,\n/* 451 */\n437,\n/* 452 */\n437,\n/* 453 */\n437,\n/* 454 */\n437,\n/* 455 */\n437,\n/* 456 */\n437,\n/* 457 */\n437,\n/* 458 */\n437,\n/* 459 */\n437,\n/* 460 */\n437,\n/* 461 */\n437,\n/* 462 */\n437,\n/* 463 */\n437,\n/* 464 */\n437,\n/* 465 */\n437,\n/* 466 */\n437,\n/* 467 */\n437,\n/* 468 */\n437,\n/* 469 */\n437,\n/* 470 */\n437,\n/* 471 */,\n/* 472 */,\n/* 473 */\n/***/ function(module, exports) {\n\n\tmodule.exports = {\n\t\t\"minLat\": -58,\n\t\t\"step\": 2,\n\t\t\"rowsCount\": 69,\n\t\t\"maxLat\": 78,\n\t\t\"valueOffset\": 76,\n\t\t\"array\": \"7u7t7e3s7Ozr6+rq6unp6Ojn5+fm5ubl5eTk5OPj4uHh4N/e3dzb2djW1dPRz83LycbEwb+8ube0sa+sqaekop+dm5mXlZORj42MiomHhoSCgX9+fHp4dnRyb21raGVjYF1aV1RRTktIRUI/PDk2MzEuKyknJCIgHhwaGBYVExIRDw4ODQwMDAwMDA0OEBEUFxsfJSw0PklWZHSDkqGtuMLK0Nbb3uLk5+jq6+zt7e7u7u7u5ubm5ubm5eXl5OTk5OPj4+Li4uHh4eHg4ODg39/f3t7d3dzb2tnY19bU09HPzcvJx8TCv726t7Wyr6ypp6Shn5yamJaTkpCOjIuJiIaFg4KBf358e3l3dXNxb21qaGVjYF1aV1RRTktIRUI/PDo3NDIvLSooJiQiIB4dGxoZFxYWFRQUFBQUFBUWFxkbHiElKS40O0NMVWBrd4OOmaOttbzDyM3R1djb3d/g4uPk5eXm5ubm4ODg4ODg4N/f39/e3t7e3t3d3d3c3Nzc3Nzc29vb29ra2dnY19fW1dPS0c/Ny8nHxcPAvbu4tbKvraqnpKGenJmXlZKQjoyLiYeGhYOCgYB+fXx6eXh2dHNxb2xqaGVjYF1aV1RRT0xJRkNAPTo4NTMwLiwqKCYkIyEgHx4dHBsbGhoaGxscHR8gIyUoLDA0OT9GTVVeZ3B5g4yVnaWss7i+wsfKztHT1dfZ2tzd3d7f39/g2tvb29vb29ra2tra2tnZ2dnZ2NjY2NjY2NjY2NfX19fX1tbV1dTT0tHQz83LycfFw8G+u7m2s7CtqqekoZ6bmZaUkY+Ni4mHhoSDgoB/fn18e3p5d3Z1c3JwbmxqaGVjYF1bWFVST0xJRkNBPjs5NjQyMC4sKignJSQjIiEhICAgICEhIiMlJigrLjE1OT1DSE5VXGNrc3uDipKZn6arsba6vsLFyMvNz9HT1NXX19jZ2dra1tbW1tbW1tbW1tbW1dXV1dXV1NTU1NTU1NTU1NTU1NTU09PT0tLR0M/OzMvJyMbEwb+8ure0sa6rqKShnpuYlpOQjoyJh4aEgoGAfn18e3p6eXh3dnVzcnFvbWxqZ2VjYF5bWFVSUE1KR0RCPz06ODYzMTAuLCsqKCgnJiYlJSUmJicoKistLzI1ODxARUpPVVthaG91fIOJj5aboaarr7O3u77BxMbIyszOz9DR0tPU1NXV0dLS0tLS0tLS0tLS0tHR0dHR0dHR0dHR0dHR0dHR0dHQ0NDQz8/Ozs3MysnHxsTCv726uLWyr6uopaKfm5iVkpCNioiGhIKAf358e3p5eHh3dnV1dHNycXBubWtpZ2VjYF5bWVZTUE5LSEVDQD48OTc1NDIwLy4tLCsrKioqKissLS4vMTM2ODw/Q0dLUFVaYGZrcXd9g4iOk5idoqaqrrG1uLu+wMLExsjJy8zNzs/Q0NHRzs7Ozs7Pz8/Pzs7Ozs7Ozs7Ozs3Nzc3Nzc3Nzc3Nzs7Nzc3NzczMy8rJyMfFxMLAvbu4trOwrKmmop+cmJWSj4yKh4WCgX99fHp5eHd2dnV0dHNycnFwb25tbGtpZ2VjYV5cWVdUUU9MSUdEQkA9Ozk4NjQzMjEwLy8vLy8vMDEyMzU3OTs+QUVITFFVWl9kaW50eX6DiI2RlpqeoqaprbCztri7vb/Bw8TGx8jJysvMzM3NysvLy8vLy8vLy8vLy8vLy8vLy8rKysrKysrKysrKy8vLy8rKysrJycjHxsXDwsC+vLm2tLGtqqejoJyZlZKPjImGhIF/fXt6eHd2dXRzc3JycXFwcG9vbm1sa2ppZ2VjYV9dWlhVU1BNS0hGREJAPjw6OTc2NTQ0MzMzNDQ1Njc4Ojw+QUNGSk1RVVpeY2hscXZ6f4SIjJCUmJyfoqaprK6xs7a4ury+wMHCxMXGx8jIycnKx8jIyMjIyMjIyMjIyMjIyMjIyMjIx8fHx8fHx8jIyMjIyMjIx8fHxsbFxMPBwL68ube0sa6rqKShnZqWk4+MiYaDgX58enh3dXRzcnFxcG9vb25ubm1tbGxra2ppZ2ZkYmBeXFlXVFJPTUtIRkRCQD89PDs6OTg4ODg4OTk6PD0/QUNFSEtOUlZaXmJma29zeHyAhIiMj5OWmZ2goqWoq62vsrS2uLq7vb7AwcLDxMXFxsbHxMXFxcXGxsbGxsbGxsbGxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXExMPCwsC/vby6t7Wyr6yppaKem5eTkIyJhoOAfnt5d3V0cnFwb29ubW1sbGxsbGtra2tqamlpaGZlY2JgXVtZVlRST01LSUdFREJBQD8+PT09PT09Pj9AQkNFSEpNUFNWWl1hZWltcXV5fYGFiIyPkpWYm52goqWnqqyusLK0tre5ury9vr/AwcLDw8TEwsLCw8PDw8PDw8PDw8PDw8PDw8PDwsLCwsLCwsLCwsLCwsLCwsLCwcHAv769u7q4tbOwraqno5+cmJSRjYqGg4B9e3h2dHNxcG9ubWxsa2tqampqampqampqamlpaGdmZWNiYF5bWVdVU1BOTEtJR0ZFRENCQkJCQkJDREVGSEpMTlFUV1pdYWRobHB0d3t/goWJjI6RlJeZm56goqSnqautrrCytLW3uLm7vL2+v7/AwcHCwMDAwMDBwcHBwcHBwcHBwcHBwcDAwMDAwMDAwMDAwMDAwMDAwMC/v76+vby7ube1s7Guq6ikoZ2ZlpKOi4eEgX57eHZ0cnBvbm1sa2pqaWloaGhoaGhpaWlpaWlpaWhoZ2VkYmFfXVpYVlRSUE9NTEpJSEhHR0dHR0hJSktNTlBTVVhaXWFkZ2tucnZ5fYCDhomMjpGTlpianJ6goqSmqKqrra+wsrO1tre5uru8vL2+vr+/vb6+vr6+v7+/v7+/v7+/v7+/v76+vr6+vr6+vr6+vr6+vr69vb29vby8u7q4t7Wzsa6sqaWinpuXk4+MiIWBfnt5dnRycG5tbGtqaWhoZ2dnZ2dnZ2doaGlpampqampqaWhnZmRiYV9dW1lXVVNSUE9OTU1MTExNTU5PUFFTVVdZW15hZGdqbXF0d3t+gYSHioyPkZOVl5mbnZ6goqSlp6mqrK2vsLKztLa3uLm6uru8vL29u7y8vLy8vb29vb29vb29vb29vby8vLy8vLy8vLu7u7u7u7u7u7u7urq5uLe2tbOxr6yqpqOgnJmVkY2KhoJ/fHl3dHJwbm1ramloaGdmZmZmZmZmZmdnaGlpamtsbGxsbGtramhnZWNiYF5cWllXVlVUU1JSUlJSU1RVVldZW11fYmRnam1wc3Z5fH+ChYiKjY+Rk5WWmJqbnZ6goqOlpqipq6yur7Cys7S1tre4uLm6uru7urq6urq6u7u7u7u7u7u7u7u7u7u7urq6urq6urm5ubm5ubm5ubm5uLi3trW0s7GvraqnpKGempaTj4uHhIB9end1cnBubWtqaWhnZ2ZmZWVlZWVlZmZnaGlqa2xtbm9vb29vbm1samlnZWNiYF5dXFtaWVhYWFhYWVpbXF1fYWNlZ2psb3J1eHt+gIOGiIuNj5GTlJaYmZqcnZ6goaOkpqeoqqusrq+wsbKztLW2t7e4uLm5uLi4uLm5ubm5ubm5ubm5ubm5ubm5ubm4uLi4uLi4t7e3t7e3t7e3tra1tLOysa+tq6ilop+cmJSRjYmFgn97eHZzcW9tbGppaGdmZmVlZWVkZWVlZmdoaWprbW5vcXJzc3Nzc3JxcG5ta2poZmVjYmFgX15eXl5eX2BhYmNlZ2hqbW9xdHd5fH+BhIeJi42PkZOUlpeYmpucnZ6goaKkpaanqaqrra6vsLGys7S0tba2t7e4tra3t7e3t7e3t7e4uLi4uLi4uLe3t7e3t7a2tra2tra1tbW1tbW1tLSzsrGwr62rqaajoJ2alpKPi4eEgH16d3RycG5sa2loZ2dmZWVlZWVlZWVmZ2hpamttb3BydHV2d3h4eHd3dnRzcXBubWtpaGdmZWRkZGRkZWVmZ2lqbG5vcXR2eHt9gIKFh4qMjpCRk5SWl5iZmpucnZ6foaKjpKWnqKmqq62ur7CxsbKztLS1tba2tbW1tbW1tra2tra2tra2tra2tra2trW1tbW1tbS0tLS0tLSzs7OzsrKxsbCuraupp6Sin5uYlJGNiYaCf3x5dnNxb21ramloZ2ZmZWVlZWVlZmZnaGlqbG1vcXN1d3h6e3x8fXx8e3p5eHZ0c3Fwbm1sa2pqampqamtsbW5vcXJ0dnh6fH6Bg4WIioyOkJKTlZaXmJmam5ucnZ6foKGipKWmp6ipqqytrq+vsLGysrOztLS1s7S0tLS0tLS0tLS0tbW1tbW1tbW0tLS0tLSzs7Ozs7KysrKysrKxsbCwr66tq6mnpaOgnZqWk4+LiISBfXp3dXJwbmxraWhnZ2ZmZmVlZWZmZ2doaWtsbnBydHZ4enx9f4CBgYGBgIB/fXx6eXd2dHNycXBwb29vcHBxcnN0dXd4enx+gIKEhoiKjI6QkpOVlpeYmZmam5ycnZ6foKGio6Slpqeoqqusra2ur7CxsbKys7OzsrKzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsrKysrKxsbGxsbGwsLCwr6+urayrqqimo6Gem5iVkY6KhoOAfHl2dHJvbWxqaWhnZ2ZmZmZmZmdnaGlqbG1vcHJ0d3l7fX+BgoSFhYaGhYWEg4GAfn17enl3dnV1dHR0dHV1dnd4eXp8fX+Bg4WHiYuNjpCSk5WWl5iZmZqam5ycnZ6fn6ChoqOlpqeoqaqrrKytrq+wsLGxsbKysbGxsbGysrKysrKysrKysrKysrKysrKxsbGxsbCwsLCwr6+vr6+urq2trKuqqKakop+dmpaTkIyJhYJ/e3h2c3FvbWxqaWhoZ2dnZ2dnaGhpamtsbnBxc3V3enx+gIKEhoeIiYqKiomIh4aFg4KBf358e3p6eXl5eXl6ent8fX5/gYKEhYeJi42OkJKTlZaXmJiZmpqbm5ycnZ2en6ChoqOkpaanqKmqq6ysra6vr7CwsLGxsLCwsLCwsLCwsbGxsbGxsbGxsbGxsbCwsLCwr6+vr6+urq6urq6traysq6qop6WjoJ6bmJWSjouIhIF+e3h1c3FvbWxqaWloaGhoaGhpaWprbG5vcXJ0dnh6fH+Bg4WHiYqLjI2NjY2MjIuJiIeFhIKBgH9+fn19fX19fn9/gIGCg4WGiImLjY6QkpOUlpeYmJmZmpqbm5ucnJ2en5+goaKjpKWmp6ipqqusrK2urq+vsLCwr6+vr6+vr6+vr6+wsLCwsLCwsLCwr6+vr6+vrq6urq6tra2traysrKuqqainpaShn52al5SRjYqHg4B9end1cnBubWxramlpaWlpaWpqa2xtb3Byc3V3eXt9f4GEhoiJi42Oj5CQkJCQj46NjIuJiIaFhIOCgYGBgYGBgYKCg4SFhoeIiouNjpCRk5SVlpeYmZmampqbm5ucnJ2dnp+goaKjpKWmp6eoqaqrrKytra6ur6+vrq+vr6+urq6urq6ur6+vr6+vr6+vrq6urq6ura2tra2srKysrKurq6qpqKempKKgnpuZlpOPjImGgn98eXd0cnBvbWxramppaWpqa2tsbW5wcXN0dnh6fH6AgoSGiIqMjY+QkZKSk5OTkpGQj46Ni4qJiIeGhYSEhISEhIWFhoaHiImKi42OkJGSlJWWl5iZmZqampqbm5ubnJydnp6foKGio6Slpqeoqamqq6ysra2urq6urq6urq6urq6urq6urq6urq6urq6urq2tra2traysrKysq6urq6uqqqmop6alo6GfnZqYlZKOi4iFgn98eXd0cnBvbWxra2pqamtrbG1ub3FydHV3eXt9foCChIaIioyOj5GSk5SUlZWVlJSTkpGQjo2Mi4qJiIeHh4eHh4eHiIiJiouMjY6PkZKTlJaXmJiZmZqampqam5ubm5ycnZ6foKGhoqOkpaanqKmqqqusrK2tra6ura2tra2tra2tra2tra2tra2tra2tra2srKysrKyrq6urq6uqqqqpqainpqWkoqCenJmWlJGOioeEgX57eXZ0cnBvbm1sbGtrbGxtbm9wcXN0dnh6e31/gYOFh4mKjI6PkZKTlZWWl5eXlpaVlJOSkZCOjYyLi4qKiYmJiYmKioqLjIyNjo+QkpOUlZaXmJmZmZqampqampqbm5ucnZ2en6ChoqOkpaamp6ipqqqrrKysra2tra2traysrKysrKysrKysrKysrKysrKysrKurq6urq6qqqqqqqampqKenpqSjoZ+dm5iWk5CNioeEgX57eXZ0cnFvbm1tbGxtbW5ub3Fyc3V3eHp8foCCg4WHiYqMjo+RkpSVlpeXmJiYmJiXlpWUk5KRkI+OjYyMjIuLi4uLjIyNjY6Pj5CRkpSVlpeXmJmZmZqampqampqam5ubnJ2enp+goaKjpKWmp6ioqaqqq6usrKytrKysrKysrKyrq6urq6urrKysrKysq6urq6urq6qqqqqqqqmpqaiop6empaOioJ6cmpeVko+MiYaDgH17eHZ0cnFwb25ubW1ubm9wcXJ0dnd5e31+gIKEhoeJi4yOj5GSk5WWl5iYmZmZmZmYmJeWlZSTkpGQj46Ojo2NjY2NjY6Oj4+QkJGSk5SVlpeYmJmZmZmampmZmZqampqbnJydnp+goaKio6SlpqeoqamqqqurrKysrKysrKurq6urq6urq6urq6urq6urq6urq6qqqqqqqqmpqampqKinp6alpKOhn52bmZaUkY6LiIWDgH17eHZ0c3Fwb29ubm9vcHFyc3R2eHl7fX+BgoSGiImLjI6PkZKTlZaXmJmZmpqampqamZiXlpWUk5KSkZCQj4+Pj4+Pj4+PkJCRkZKTlJWVlpeYmJmZmZmZmZmZmZmZmZqam5ycnZ6foKGio6SlpaanqKmpqqurq6ysq6urq6urq6urqqqqqqqqq6urq6urq6uqqqqqqqqpqampqamoqKenpqWko6Kgn52amJaTkI2LiIWCgH17eHZ1c3JxcHBvb3BwcXJzdXZ4eXt9f4GDhIaIiYuMjo+RkpOUlZeYmZmam5ubm5ubmpmZmJeWlZSTkpKRkZCQkJCQkJCQkZGSkpOTlJWWlpeYmJmZmZmZmZmZmZmZmZmampucnZ2en6ChoqOkpaanp6ipqqqrq6urq6urq6urqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqampqKioqKempqWko6Ggnpyal5WSkI2Kh4WCf317eHd1c3JxcXBwcHFycnN1dnh5e31/gYOEhoiJi4yOj5CSk5SVlpeYmZqbm5ycnJycm5qamZiXlpWUlJOTkpKSkZGRkZGRkpKSk5OUlZWWl5eYmJiZmZmZmJiYmJiYmJmZmpqbnJ2en5+goaKjpKWmp6ioqaqqqqurq6urq6uqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqampqKiop6empaSjoqGfnZuZlpSRj4yJh4SCf317eXd1dHNycnFxcnJzdHV2eHl7fX+BgoSGiImLjI6PkJKTlJWWl5iZmpubnJydnZ2cnJubmpmYl5aWlZSUk5OTkpKSkpKSk5OTk5SUlZaWl5eYmJiYmJiYmJiYl5eXmJiYmZmam5ydnp+goaKjpKSlpqeoqamqqqqrqqurqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqamoqKinp6ampaSjoaCenJqYlpORjoyJhoSBf317eXd2dHNzcnJyc3N0dXZ4eXt9foCChIaHiYuMjo+QkZOUlZaXmJmZmpucnJ2dnZ2dnJybm5qZmJeXlpWVlJSUk5OTk5OTk5OUlJSVlZaWl5eXmJiYmJiYl5eXl5eXl5eYmJmZmpucnZ6foKGio6SlpqenqKmpqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqamoqKinp6alpaOioZ+enJqXlZOQjouIhoOBf3x7eXd2dXRzc3NzdHR1dnh5e3x+gIKDhYeJioyNj5CRkpOUlZaXmJmam5ucnZ2dnp6dnZ2cm5qamZiXl5aWlZWVlJSUlJSUlJSUlZWVlpaWl5eXmJiYmJeXl5eWlpaWlpaXl5iZmZqbnJ2en6ChoqOkpaanqKipqaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpqampqKinp6alpKOioJ+dm5mXlJKPjYqIhYOBfnx7eXd2dXV0dHR0dXZ3eHl6fH5/gYOFhoiKjI2OkJGSk5SVlpeYmZqam5ycnZ2enp6enZ2cnJuampmYl5eWlpaVlZWVlZWVlZWVlZWWlpaWl5eXl5eXl5eXlpaWlZWVlZaWlpeYmJmam5ydnp+goaKjpKWmp6ioqamqqqqqqqqqqqqqqqqqqqqqqqqqq6urq6urq6qqqqqqqampqKinp6alpKOhoJ6cmpiWlJGPjIqHhYOAfnx7eXh3dnV1dXV1dnd4eXp8fX+BgoSGiImLjY6PkZKTlJWWl5iYmZqbm5ydnZ6enp6enp2dnJybmpmZmJiXl5aWlpaWlZWVlZWVlpaWlpaXl5eXl5eXl5aWlpWVlZWUlZWVlZaXl5iZmpucnZ6foKGio6SlpqeoqKmpqaqqqqqqqqqqqqqqqqqqqqurq6urq6urq6urq6qqqqmpqainp6alpKOhn56cmpiVk5GOjImHhIKAfnx7eXh3dnZ2dnZ2d3h5ent9foCCg4WHiYqMjY+QkpOUlZaXl5iZmpqbnJydnp6en5+enp6dnZybm5qZmZiYl5eXl5aWlpaWlpaWlpaWlpaXl5eXl5eWlpaVlZWUlJSUlJSUlJWWlpeYmZqbnJ2en6Cho6SlpqanqKmpqamqqqqqqqqqqqqqqqqrq6urq6usrKysrKurq6urqqqpqaiop6alpKKhn52bmZeVkpCNi4mGhIKAfnx7eXh3d3Z2dnd3eHl6e3x+f4GDhIaIiYuNjpCRkpOUlZaXmJmZmpubnJ2dnp6fn5+fn56enZ2cm5uamZmZmJiXl5eXl5eXlpaWlpaWl5eXl5eXl5aWlpWVlJSUk5OTk5OTk5SUlZaXmJmam5ydnp+goqOkpaanp6ipqampqqqqqqqqqqqqq6urq6usrKysrKysrKysrKurq6qqqamop6alpKKhn52bmZaUko+NioiGg4F/fnx7eXh4d3d3d3d4eXp7fH1/gIKEhYeJioyNj5CSk5SVlpeYmJmampucnJ2enp6fn5+fn5+enp2cnJubmpqZmZiYmJiYl5eXl5eXl5eXl5eXl5eWlpaWlZWUlJOTkpKSkpKSkpOTlJWWlpeYmpucnZ6foaKjpKWmp6eoqKmpqaqqqqqqqqurq6urrKysrK2tra2tra2trKysq6uqqqmop6alpKKgnp2amJaTkY+MioeFg4F/fXx7eXl4eHd4eHh5ent8fX6AgYOEhoiJi4yOj5GSk5SWlpeYmZqam5ucnZ2enp+fn5+fn5+fnp6dnJybm5qamZmZmZiYmJiYmJeXl5eXl5eXl5eWlpaVlZSUk5OSkpGRkZGRkZKSk5OUlZaXmJmbnJ2eoKGio6SlpqeoqKipqamqqqqqq6urq6ysrKytra2trq6urq6tra2srKyrqqmpqKalpKKgnpyamJWTkI6MiYeFgoB/fXx7enl4eHh4eHl6ent9fn+AgoOFh4iKi42PkJGTlJWWl5iZmZqbm5ycnZ6en5+foKCgoJ+fn56dnZycm5uampqZmZmZmZiYmJiYmJiXl5eXl5aWlpWVlJSTkpKRkZCQkJCQkJCRkZKTlJWWl5iZm5ydnqChoqOkpaanp6ioqamqqqqrq6urrKysra2trq6urq6urq6urq6traysq6qpqKelpKKgnpyal5WSkI2LiIaEgoB+fXt6enl4eHh5eXp6e3x9foCBg4SGh4mKjI2PkJKTlJWWl5iZmpqbnJydnZ6en5+goKCgoKCfn56enZ2cnJybm5qampqamZmZmZmYmJiYmJeXl5aWlpWUlJOSkpGQkI+Pj4+Pj4+QkJGSk5SVlpeYmZucnZ+goaKjpKWmpqeoqKmqqqqrq6ysrK2tra6urq+vr6+vr6+vr66ura2sq6qpqKelpKKgnpyZl5SSj42KiIaDgYB+fHt6eXl5eXl5eXp7fH1+f4CCg4WGiImLjI6PkZKTlZaXmJiZmpubnJydnp6fn5+goKCgoKCgn5+fnp6dnZycnJubm5qampqamZmZmZiYmJiXl5aWlZWUk5OSkZCQj46Ojo6Ojo6Oj5CQkZKTlJWXmJmbnJ2foKGipKWmpqenqKmpqqqrq6ysra2urq6vr7CwsLCwsLCwsK+vrq6trKuqqaempKKgnpuZl5SRj4yKh4WDgX99fHt6eXl5eXl5enp7fH1+gIGChIWHiIqLjY6QkZKUlZaXmJmampucnJ2dnp6fn6CgoKGhoaCgoKCfn56enZ2dnJycnJubm5uampqamZmZmJiXl5aWlZSUk5KRkJCPjo6NjY2MjY2Njo6PkJGSk5SVl5iZm5yen6Cho6SlpaanqKmpqqqrrKytra6ur6+wsLCxsbGxsbGxsLCwr66urayqqaimpKKgnpuZlpSRjoyJh4SCgH99fHt6eXl5eXl5ent8fH5/gIGDhIWHiIqLjY6QkZOUlZaXmJmam5ucnZ2enp+foKCgoaGhoaGhoKCgn5+fnp6enZ2dnJycnJubm5uampmZmZiYl5aWlZSTkpGRkI+OjY2MjIuLi4uMjI2Ojo+QkpOUlZeYmpucnp+goqOkpKWmp6ipqqurrK2trq6vr7CwsbGxsrKysrKysbGwsK+urayrqqimpKKgnpuZlpOQjouIhoSCgH58e3p5eXl5eXl5ent8fX5/gIGDhIaHiYqMjY+QkZOUlZaXmJmam5ycnZ2enp+goKChoaGhoaGhoaGhoKCgn5+fnp6enZ2dnZycnJubm5qamZiYl5aWlZSTkpGQj46NjIyLi4qKioqLi4yMjY6PkJGTlJWXmJqbnZ6foaKjpKWmp6ipqqurrK2urq+wsLGxsrKys7Ozs7OysrKxsbCvrq2rqqinpaKgnpuYlZOQjYqIhYOBf318e3p5eXh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkpOUlZaYmZmam5ycnZ6en5+goKGhoaKioqKioqKhoaGgoKCgn5+fnp6enp2dnZycm5uamZmYl5aVlZOSkZCPjo2Mi4uKiYmJiYmJioqLjI2Oj5CRk5SWl5mam52eoKGio6SlpqipqqurrK2ur6+wsbGysrOzs7S0tLSzs7OysbGwr62sqqmnpaKgnZuYlZKPjYqHhYKAfn17enl4eHh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkZOUlZeYmZqam5ydnZ6fn6CgoaGhoqKioqOjo6KioqKioaGhoKCgoJ+fn56enp2dnJubmpmYl5aVlJOSkZCOjYyLiomJiIiIiIiIiImKiouMjo+QkZOUlpeZmpydn6CioqOlpqeoqausra2ur7CxsbKzs7S0tLW1tbW0tLSzsrGwr66tq6mnpaOgnZuYlZKPjImGhIJ/fnx6eXh4eHd3eHh5eXp7fH5/gIGDhIaHiYqMjY+QkZOUlZeYmZqbm5ydnp6fn6CgoaGioqOjo6Ojo6Ojo6Ojo6KioqKhoaGgoKCfn56dnZybmpqZmJaVlJOSkI+OjYuKiYiIh4eGhoaHh4iIiYqLjI6PkJKTlZaYmZucnp+hoaOkpqeoqausra6vsLGxsrOztLW1tbW2trW1tbS0s7KxsK+tq6qnpaOgnZqXlJGOi4iGg4F/fXt6eXh3d3d3d3h4eXp7fH1+gIGChIWHiIqLjY6QkZOUlZaYmZqbm5ydnp6foKChoaKio6OkpKSkpKSkpKSkpKSjo6OjoqKioaGgoJ+enp2cm5qZmJeVlJORkI6NjIqJiIeHhoaFhYWFhoaHiImKi4yOj5CSlJWXmJqbnZ6goaKkpaeoqaqsra6vsLGys7S0tbW2tra2t7a2trW1tLOysa+urKqopaOgnZqXlJGOioiFgoB+fHp5eHd2dnZ2dnd4eHl6e31+f4GCg4WGiImLjI6PkZKUlZaXmZqbm5ydnp+foKGhoqKjo6SkpaWlpaWmpqalpaWlpaWkpKSjo6KioaCgn56dnJuZmJeVlJKRj46Mi4qIh4aFhYSEhISEhYWGh4iJiouMjo+RkpSWl5mbnJ6foKKjpaaoqaqsra6vsLKzs7S1tra3t7e3t7e3t7a2tbSzsbCurKqopaOgnZqXk5CNioeEgX98e3l4d3Z1dXV1dXZ3eHh6e3x9f4CBg4SGh4mKjI6PkZKTlZaXmJmbm5ydnp+goKGioqOkpKWlpqamp6enp6enp6enp6ampqWlpKSjoqKhoJ+enJuamJeVlJKQj42MiomHhoWEhIODg4ODg4SFhYaHiYqLjY6QkZOVlpiam52foKGjpaaoqaqsra6wsbKztLW2tre4uLi4uLi4uLe3trW0srGvrauopqOgnZmWk4+MiYaDgH17eXh2dXV0dHR0dHV2d3h5ent8fn+BgoSFh4iKi42PkJKTlJaXmJmam5ydnp+goaKio6Skpaamp6enqKioqampqampqaioqKenpqalpKOioaCfnZyamZeVk5KQjoyLiYiGhYSDgoKCgYKCgoODhIWGiImKjI2PkJKUlpeZm5yen6GjpKanqaqsra+wsbK0tba2t7i4ubm5ubm5ubi4t7a0s7GvrauppqOgnJmVko6LiISBf3x6eHZ1dHNzc3Nzc3R1dXZ3eXp7fX6AgYOEhoeJi4yOj5GSlJWXmJmam5ydnp+goaKjpKSlpqenqKipqaqqqqqrq6urq6qqqqmpqKenpqWkoqGgnpybmZeVk5GPjoyKiIeFhIOCgYGAgICBgYKCg4SFh4iJi4yOkJGTlZaYmpydn6GipKanqausrq+wsrO0tba3uLm5urq6urq6urm4uLe1tLKwrquppqOfnJiVkY2KhoOAfXt4dnVzcnJxcXFxcnJzdHV2d3l6e31+gIKDhYeIiouNj5CSk5WWmJmam5ydn6ChoqKjpKWmp6ioqaqqq6usrKytra2tra2srKyrqqqpqKelpKKhn52bmZeVk5GPjYuJh4aEg4KBgIB/f39/gICBgoOEhoeIiouNj5GSlJaYmZudnqCipKanqausrq+xsrO1tre4ubm6u7u7u7u7u7q5ube2tbOxrqyppqOfm5iUkIyIhYF+e3l3dXNycXBwb29wcHFycnR1dnd5enx9f4CChIWHiYuMjpCRk5SWl5iam5yen6ChoqOkpaanqKmqqqusra2urq+vr6+vr6+vrq6trayrqqinpqSioJ6cmpiWk5GPjIqIhoWDgoGAf35+fn5+f3+AgYKDhYaIiYuMjpCSk5WXmZudnqCipKWnqausrrCxsrS1tre4ubq7u7y8vLy8vLu7uri3tbOxr6yppqKfm5eTj4uHg4B8eXd0c3Fwb25ubW1ubm9wcXJzdHZ3eXp8fX+Bg4SGiIqLjY+QkpSVl5iam5yen6Cho6SlpqeoqaqrrK2urq+wsLGxsrKysrKxsbGwr66trKupp6akop+dm5iWk5GOjIqIhoSCgYB/fn19fX19fn5/gIGChIWHiIqMjY+Rk5WXmZqcnqCipKWnqautrrCxs7S2t7i5uru8vL29vb29vby8u7m4trSyr6yppqKempaRjYmFgX16d3RycG9tbGxra2tsbG1ub3BxcnR1d3h6fH5/gYOFh4iKjI6PkZOVlpiZm5yen6Cio6Smp6ipqqytrq+wsLGys7O0tLS1tbW0tLSzsrGwr62rqqilo6GenJmWk5GOjImHhYOBgH59fXx8fHx8fX1+f4CCg4SGiImLjY+RkpSWmJqcnqCipKWnqautrrCys7W2t7m6u7y9vb6+vr6+vr29vLq5t7WysK2ppaGdmZSQi4eDf3t3dHJvbWxramlpaWlpamtrbG5vcHJzdXd4enx+gIGDhYeJi42PkJKUlpeZm5yen6GipKWnqKmrrK2ur7Gys7S0tba2t7e4uLi3t7e2tbSzsbCurKqnpaKgnZqXlJGOi4mGhIKAf318fHt7e3t7fHx9fn+BgoSFh4mKjI6QkpSWmJqcnqCipKWnqautr7CytLW3uLm7vL29vr+/v8C/v7++vbu6uLWzsK2ppaGcl5OOiYSAfHh0cW9samloZ2ZmZmZnZ2hpamttbnBxc3V2eHp8foCChIaIioyOj5GTlZeZmpyeoKGjpKanqausra+wsbO0tba3uLm5urq7u7u7u7q5uLe2tbOxr6yqp6ShnpuXlJGOi4iGg4F/fnx7enp6enp6e3x8fX+AgYOFhoiKjI6QkpSWmJqcnZ+ho6Wnqautr7GytLa3ubq7vL2+v8DAwMHBwMC/vry7uLazsKyopKCblpCLhoF9eHRxbmtpZ2VkY2NjY2NkZGVmZ2lqbG1vcXN0dnh6fH6AgoSGiIuNj5GTlZaYmpyeoKKjpaepqqytr7Gys7W2t7m6u7y8vb6+vr6+vr69vLu6uLa0sq+tqqajoJyZlZGOi4iFg4B+fXt6eXl5eXl5ent8fX5/gYKEhoeJi42PkZOVl5mbnZ+ho6aoqqutr7Gztba4ubu8vb6/wMHBwsLCwcHAv727ubazsKyoo56Zk46Ig315dHBsaWdkY2FgYF9fX2BgYWJjZWZnaWttbnBydHZ4en1/gYOFh4mMjpCSlJaYmpyeoKKkpqiqq62vsbK0tre5uru9vr/AwMHCwsLCwsLBwL++vLq4trOwrammop6alpKPi4iFgoB+fHt5eXh4eHh4eXp7fH1/gIKDhYeJi42PkZOVl5mbnZ+ho6aoqqyur7Gztbe4uru9vr/AwcLCwsPDwsLBv768ubezr6umoZyWkIqEfnl0b2tnZGJgXl1cW1tbW1xdXl9gYmNlZmhqbG5wcnR2eXt9f4KEhoiLjY+RlJaYmpyeoaOlp6mrra+xs7S2uLq7vb7AwcLDxMXFxsbGxsbGxcTCwb+9ure0sK2ppaCcmJSQjIiFgn99e3p5eHd3d3d4eHl6e3x+f4GDhYaIioyOkJKVl5mbnZ+ho6aoqqyusLKztbe5ury9vsDBwsLDw8PDw8LBwL68ubazrqqkn5iSjIV/eXNuaWViX1xaWVhXV1dXV1hZWltdXmBiZGVnaWxucHJ0d3l7foCChYeKjI6Rk5WYmpyfoaOmqKqsrrCytLa4ury+v8HDxMXHyMnJysvLy8vKysnHxsTCv7y5tbGtqKOfmpaRjYmGgoB9e3l4d3d2dnZ3d3h5enx9f4CChIaIioyOkJKUlpmbnZ+ho6WoqqyusLK0tre5u7y+v8DBwsPExMTEw8PCwL68ubWxrKehm5SNhn94cmxnYl5bWFZUU1JSUlJSU1RVVlhZW11fYWNlZ2lrbnBzdXd6fH+BhIaJi46Qk5WYmp2foqSmqautsLK0tri7vb/AwsTGx8nKy83Ozs/Q0NDQz87NzMrHxcK+urayraijnpiUj4uHg4B9e3l4d3Z2dnZ2d3h5ent9foCCg4WHiYuOkJKUlpibnZ+ho6WoqqyusLK0tri5u72+v8HCw8PExMTEw8PBwL26t7OuqaOclY2FfnZwaWNeWldUUU9OTU1MTU1OT1BRU1RWWFpcXmBiZWdpbG5xc3Z4e36Ag4WIi42Qk5WYmp2goqWnqqyvsbS2uLu9v8HDxcfJy8zOz9HS09TU1dXV1dTT0tDOzMnFwb24s66oop2Xko2JhYJ/fHp4d3Z2dnZ2d3d4eXt8fn+Bg4WHiYuNj5GUlpianJ6ho6WnqqyusLK0tri5u72+v8HCw8PExMTDw8LAvru4tK+po5yUjIR7c2xlX1lVUU5LSUhHR0ZHR0hJSkxNT1FSVFdZW11gYmVnamxvcnR3enx/goWHio2QkpWYm52go6aoq66ws7W4ur2/wcTGyMrMztDS1NXW2Nna2tvb29va2djW1NHOysbBu7awqqOdl5KNiISBfnt6eHd2dnZ2d3d4eXp8fX+Bg4SGiIuNj5GTlZianJ6go6WnqauusLK0tbe5u7y+v8DBwsLDw8LCwb+9ureyraehmZGIf3ZtZV5YUk1JRkRCQUBAQEBBQkNERkdJS01PUVRWWFtdYGNlaGttcHN2eXx+gYSHio2Qk5WYm56hpKaprK+ytLe6vL/BxMbJy83Q0tTW2Nrb3d7f4OHi4uLi4eDf3dvY1NDMxsG6tK2moJmUjomFgn98enl4d3d3d3h4eXt8fX+BgoSGiIqMjpGTlZeam56goqSnqautr7Gztbe4uru9vr+/wMDAwL++vLq3s66popqSiX91bGNbU01IQ0A9Ozo5ODg4OTo7PD4/QUNFR0pMTlFTVllbXmFkZmlsb3J1eHt+gYSHio2Qk5aZnJ+ipaeqrbCztrm8vsHExsnMztHT1dja3N7g4uPl5ujp6erq6urp6Obk4d7a1dDKw7y1raafmJKNiYWBf317enl5eXl6ent9fn+Bg4SGiIqMjpCTlZeZ\",\n\t\t\"colsCount\": 180,\n\t\t\"valueScale\": 2\n\t};\n\n/***/ },\n/* 474 */,\n/* 475 */,\n/* 476 */,\n/* 477 */,\n/* 478 */,\n/* 479 */,\n/* 480 */,\n/* 481 */,\n/* 482 */,\n/* 483 */,\n/* 484 */,\n/* 485 */,\n/* 486 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"contents\\\">\\n    <div class=\\\"left-buttons\\\">\\n        <div class=\\\"button-minimize\\\" data-bind=\\\"click: onMinimizeButtonClick\\\"\\n             title=\\\"Minimize\\\"></div>\\n        <div class=\\\"button-minimize icon-on-off\\\"\\n             data-bind=\\\"click: onEnableButtonClick, css: {'state-on': _enabled()}\\\"\\n             title=\\\"Switch draw by click on/off\\\"></div>\\n    </div>\\n    <table>\\n        <tr>\\n            <td>True azimuth</td>\\n            <td data-bind=\\\"text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Magnetic azimuth</td>\\n            <td data-bind=\\\"text: magneticAzimuth() !== null ? magneticAzimuth() + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Distance</td>\\n            <td data-bind=\\\"text: distance() === null ? '--' :\\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + ' km' : Math.round(distance()) + ' m'\\\"></td>\\n        </tr>\\n    </table>\\n\\n    <div class=\\\"buttons\\\">\\n        <div class=\\\"button\\\" data-bind=\\\"click: onReverseButtonClick\\\">Reverse</div>\\n        <div class=\\\"button\\\" data-bind=\\\"click: onProfileButtonClick\\\">Elevation / Sightline</div>\\n    </div>\\n</div>\"\n\n/***/ },\n/* 487 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"leaflet-control-button-toggle\\\" title=\\\"Print map\\\"\\n     data-bind=\\\"click: setExpanded, css: {'icon-spinner-nuclear': makingPdf, 'icon-printer': !makingPdf()}\\\">\\n    </div>\\n<div class=\\\"leaflet-control-content\\\">\\n<table class=\\\"layout\\\">\\n    <tbody>\\n    <tr><td colspan=\\\"2\\\">\\n        <a title=\\\"Add page in portrait orientation\\\" class=\\\"button-add-page-vert image-button\\\"\\n           data-bind=\\\"click: addPortraitPage\\\"></a>\\n        <a title=\\\"Add page in landscape orientation\\\" class=\\\"button-add-page-horiz image-button\\\"\\n           data-bind=\\\"click: addLandscapePage\\\"></a>\\n        <span class=\\\"pages-num\\\" data-bind=\\\"text: pagesNumLabel\\\"></span>\\n        <a title=\\\"Remove all pages\\\" class=\\\"button-remove-pages image-button\\\"\\n           data-bind=\\\"click: removePages\\\"></a>\\n    </td></tr>\\n    <tr>\\n        <td class=\\\"label\\\">Print scale</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" >\\n                <a data-bind=\\\"click: function() {scale(100)}, css: {selected: scale() === 100}\\\">100 m</a>\\n                <a data-bind=\\\"click: function() {scale(500)}, css: {selected: scale() === 500}\\\">500 m</a>\\n                <a data-bind=\\\"click: function() {scale(1000)}, css: {selected: scale() === 1000}\\\">1 km</a>\\n            </div>\\n            <input type=\\\"text\\\" class=\\\"scale\\\" maxlength=\\\"6\\\" data-bind=\\\"value: scale\\\">&nbsp;m in 1 cm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Page size</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" data-bind=\\\"foreach: {data: pageSizes, as: 'size'}\\\">\\n                <a data-bind=\\\"click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\\n                              text: size.name,\\n                              css: {selected: size.name === $root.pageSizeDescription() }\\\"></a>\\n            </div>\\n            <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"width\\\" placeholder=\\\"width\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageWidth\\\">\\n            x <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"height\\\" placeholder=\\\"height\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageHeight\\\"> mm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label-high\\\">Margins</td>\\n        <td>\\n            <table class=\\\"margins\\\">\\n                <tr>\\n                    <td></td>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginTop\\\"></td>\\n                    <td></td>\\n                </tr>\\n                <tr>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginLeft\\\"></td>\\n                    <td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginRight\\\"> mm</td>\\n                </tr>\\n                <tr><td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginBottom\\\"></td><td></td></tr>\\n            </table>\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Resolution</td>\\n        <td><input type=\\\"text\\\" maxlength=\\\"4\\\" class=\\\"resolution\\\" data-bind=\\\"value: resolution\\\"> dpi</td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Source zoom<br />level</td>\\n        <td>\\n            <select name=\\\"srczoom\\\"\\n                    data-bind=\\\"options: ['auto', 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], value: zoomLevel\\\">\\n            </select>\\n        </td>\\n    </tr>\\n    <tr>\\n        <td colspan=\\\"2\\\">\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: magneticMerisiansdOn\\\"> Magnetic meridians</label>\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: gridOn\\\"> Kilometers grid</label>\\n        </td>\\n    </tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <a class=\\\"button-settings image-button\\\" data-bind=\\\"click: function() {settingsExpanded(!settingsExpanded())}\\\"\\n            title=\\\"More settings\\\"></a>\\n        <div class=\\\"settings-summary\\\">\\n            <span data-bind=\\\"text: pageSizeDescription\\\"></span><br/>\\n            <span data-bind=\\\"text: resolution\\\"></span>&nbsp;dpi,\\n            zoom&nbsp;<span data-bind=\\\"text: zoomLevel\\\"></span>\\n            <!-- ko if: zoomLevel()=== \\\"auto\\\" -->\\n            (<span title=\\\"Zoom for satellite and scanned imagery\\\" data-bind=\\\"text: autoZoomLevels().satZoom\\\"></span>&nbsp;\\n            /&nbsp;<span title=\\\"Zoom for maps like OSM and Google\\\" data-bind=\\\"text: autoZoomLevels().mapZoom\\\"></span>)\\n            <!-- /ko -->\\n        </div>\\n    </td></tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <div class=\\\"download-button-row\\\">\\n            <div class=\\\"button-minimize\\\" data-bind=\\\"click: setMinimized\\\"></div>\\n            <a class=\\\"text-button button-save\\\" data-bind=\\\"\\n                                click: onSavePdfClicked,\\n                                visible: !makingPdf()\\\">Save PDF</a>\\n            <div data-bind=\\\"\\n                                component: { \\n                                    name: 'progress-indicator',\\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\\n                                },\\n                                visible: makingPdf()\\\"></div>\\n        </div>\\n    </td></tr>\\n    </tbody>\\n</table>\\n</div>\"\n\n/***/ },\n/* 488 */,\n/* 489 */,\n/* 490 */,\n/* 491 */,\n/* 492 */,\n/* 493 */,\n/* 494 */,\n/* 495 */,\n/* 496 */,\n/* 497 */,\n/* 498 */,\n/* 499 */,\n/* 500 */,\n/* 501 */,\n/* 502 */,\n/* 503 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDQwIDQwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiICBjeT0iMjQuNSIgY3g9IjIwIiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxsaW5lIHgxPSIyMCIgeTE9IjIwIiB4Mj0iMjUiIHkyPSIzMCIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjE1IiB5Mj0iMzAiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMjAiIHgyPSIyMCIgeTI9IjM4IiBzdHJva2U9IiMzMzg4ZmYiIHN0cm9rZS13aWR0aD0iMS4yIi8+CiAgICA8L2c+Cjwvc3ZnPg==\"\n\n/***/ },\n/* 504 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDQwIDQwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiIGN5PSIyMiIgY3g9IjIwIiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgoKICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjIzIiB5Mj0iMjQiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjE3IiB5Mj0iMjQiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KCiAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMjAiIHgyPSIyMCIgeTI9IjciIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KICAgIDwvZz4KPC9zdmc+\"\n\n/***/ },\n/* 505 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDMwIDMwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxsaW5lIHgxPSIxMiIgeTE9IjEyIiB4Mj0iMTgiIHkyPSIxOCIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjEuNSIvPgogICAgICAgIDxsaW5lIHgxPSIxMiIgeTE9IjE4IiB4Mj0iMTgiIHkyPSIxMiIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjEuNSIvPgogICAgPC9nPgo8L3N2Zz4=\"\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** static/js/main.9b918799.js\n **/","import Raven from 'raven-js';\n\nfunction captureException(e, options) {\n    Raven.captureException(e, options)\n}\n\nfunction captureMessage(msg, options) {\n    Raven.captureMessage(msg, options)\n}\n\nfunction captureMessageWithUrl(msg) {\n    captureMessage(msg, {extra: {url: window.location.toString()}});\n}\n\nfunction setExtraContext(data) {\n    Raven.setExtraContext(data)\n}\n\nfunction captureBreadcrumb(crumb) {\n    Raven.captureBreadcrumb(crumb)\n}\n\nfunction captureBreadcrumbWithUrl(crumb) {\n    const data = Object.assign(crumb.data || {}, {'url': window.location.toString()});\n    crumb = Object.assign({}, crumb, {data});\n    captureBreadcrumb(crumb);\n\n}\n\nexport default {captureMessage, captureException, setExtraContext, captureBreadcrumbWithUrl, captureBreadcrumb, captureMessageWithUrl}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/logging/index.js\n **/","import {arrayBufferToString} from 'lib/binary-strings';\n\nfunction successIfStatus200(xhr) {\n    return xhr.status >= 200 && xhr.status <= 299;\n}\n\nfunction retryIfNetworkErrorOrServerError(xhr) {\n    return (xhr.status === 0 || xhr.status >= 500);\n}\n\nclass XMLHttpRequestPromiseError extends Error {\n    constructor(xhr) {\n        super();\n        this.xhr = xhr;\n        this.name = 'XMLHttpRequestPromiseError';\n\n        this.message = xhr.status === 0 ? 'network error' : `server response is ${xhr.status}`;\n    }\n}\n\nclass XMLHttpRequestPromise {\n    constructor(\n        url, {method='GET', data=null, responseType='', timeout=30000, maxTries=3, retryTimeWait=500,\n            isResponseSuccess=successIfStatus200, responseNeedsRetry=retryIfNetworkErrorOrServerError,\n        headers=null} = {}) {\n        // console.log('promise constructor', url);\n        const promise = new Promise((resolve, reject) => {\n                this._resolve = resolve;\n                this._reject = reject;\n            }\n        );\n        this.then = promise.then.bind(promise);\n        this.catch = promise.catch.bind(promise);\n        this.method = method;\n        this.url = url;\n        this.responseType = responseType;\n        this.postData = data;\n        this._isResponseSuccess = isResponseSuccess;\n        this._responseNeedsRetry = responseNeedsRetry;\n        this._retryTimeWait = retryTimeWait;\n        this.triesLeft = maxTries;\n\n        const xhr = this.xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => this._onreadystatechange();\n        this._open();\n        xhr.timeout = timeout;\n        if (responseType === 'binarystring') {\n            xhr.responseType = 'arraybuffer';\n        } else {\n            xhr.responseType = responseType;\n        }\n        if (headers) {\n            for (let [k, v] of headers) {\n                xhr.setRequestHeader(k, v);\n            }\n        }\n    }\n\n    _open() {\n        // console.log('open', this.url);\n        this.xhr.open(this.method, this.url);\n    }\n\n    _onreadystatechange() {\n        const xhr = this.xhr;\n        if (xhr.readyState === 4 && !this._aborted) {\n            // console.log('ready state 4', this.url);\n            xhr.responseBinaryText = '';\n            if (this.responseType === 'binarystring' && xhr.response && xhr.response.byteLength) {\n                xhr.responseBinaryText = arrayBufferToString(xhr.response);\n            }\n            // IE doesnot support responseType=json\n            if (this.responseType === 'json' && (typeof xhr.response) === 'string') {\n                try {\n                    // xhr.response is readonly\n                    xhr.responseJSON = JSON.parse(xhr.response);\n                } catch (e) {\n                }\n            } else {\n                xhr.responseJSON = xhr.response;\n            }\n            if (this._isResponseSuccess(xhr)) {\n                // console.log('success', this.url);\n                this._resolve(xhr);\n            } else {\n                if (this.triesLeft > 0 && this._responseNeedsRetry(xhr)) {\n                    // console.log('retry', this.url);\n                    this._open();\n                    this._timerId = setTimeout(() => this.send(), this._retryTimeWait);\n                } else {\n                    // console.log('failed', this.url);\n                    this._reject(new XMLHttpRequestPromiseError(xhr));\n                }\n            }\n        }\n    }\n\n    abort() {\n        // console.log('abort', this.url);\n        this._aborted = true;\n        clearTimeout(this._timerId);\n        this.xhr.abort();\n    }\n\n    send() {\n        // console.log('send', this.url);\n        this.triesLeft -= 1;\n        this.xhr.send(this.postData);\n    }\n}\n\n\nclass XHRQueue {\n    constructor(maxSimultaneousRequests=6) {\n        this._maxConnections = maxSimultaneousRequests;\n        this._queue = [];\n        this._activeCount = 0;\n    }\n\n    put(url, options) {\n        const promise = new XMLHttpRequestPromise(url, options);\n        promise._originalAbort = promise.abort;\n        promise.abort = () => this._abortPromise(promise);\n        this._queue.push(promise);\n        this._processQueue();\n        return promise;\n    }\n\n    _abortPromise(promise) {\n        const i = this._queue.indexOf(promise);\n        if (i > -1) {\n            // console.log('ABORT IN QUEUE');\n            this._queue.splice(i, 1);\n        } else {\n            if (promise.xhr.readyState === 4) {\n                // console.log('ABORT COMPLETED');\n            } else {\n                // console.log('ABORT ACTIVE');\n                promise._originalAbort();\n                this._activeCount -= 1;\n                setTimeout(() => this._processQueue(), 0);\n            }\n        }\n    }\n\n    _processQueue() {\n        if (this._activeCount >= this._maxConnections || this._queue.length === 0) {\n            return;\n        }\n        const promise = this._queue.shift();\n        promise\n            .catch(() => {})\n            .then(() => this._onRequestReady(promise));\n        this._activeCount += 1;\n        promise.send()\n    }\n\n    _onRequestReady(promise) {\n        if (!promise._aborted) {\n            this._activeCount -= 1;\n        }\n        setTimeout(() => this._processQueue(), 0);\n    }\n}\n\n\nfunction fetch(url, options) {\n    // console.log('fetch', url);\n    const promise = new XMLHttpRequestPromise(url, options);\n    promise.send();\n    return promise;\n}\n\n\nexport {fetch, XHRQueue};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/xhr-promise/index.js\n **/","import L from 'leaflet';\n\nL.Control.include({\n    _stopContainerEvents: function() {\n        const container = this._container;\n        L.DomEvent.disableClickPropagation(container);\n        L.DomEvent.disableScrollPropagation(container);\n        L.DomEvent.on(container, 'mousemove contextmenu', L.DomEvent.stop);\n\n    }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.commons/index.js\n **/","import secrets from './secrets';\n\nexport default Object.assign({\n    email: 'nakarte@nakarte.tk',\n    googleApiUrl: 'https://maps.googleapis.com/maps/api/js?key=AIzaSyDleuw7YtJifzC1OI2nSah74KJfGiziHXY#v=3',\n    westraDataBaseUrl: 'http://nakarte.tk/westraPasses/',\n    CORSProxyUrl: 'http://proxy.nakarte.tk/',\n    elevationsServer: 'http://elevation.nakarte.tk/',\n    newsUrl: 'http://about.nakarte.tk',\n    wikimediaCommonsCoverageUrl: 'http://tiles.nakarte.tk/wikimedia_commons_images/{z}/{x}/{y}'\n}, secrets);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/config.js\n **/","function notify(message, level) {\n    setTimeout(() => window.alert(message), 0);\n}\n\nfunction prompt(message, value) {\n    return window.prompt(message, value);\n}\n\nexport {notify, prompt};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/notifications/index.js\n **/","function arrayBufferToString(arBuf) {\n    const\n        arr = new Uint8Array(arBuf),\n        s = [];\n    for (let i = 0; i < arr.length; i += 4096) {\n        let chunk = arr.subarray(i, i + 4096);\n        chunk = String.fromCharCode.apply(null, chunk);\n        s.push(chunk);\n    }\n    return s.join('');\n}\n\nfunction stringToArrayBuffer(s) {\n    const\n        length = s.length,\n        buf = new ArrayBuffer(length),\n        arr = new Uint8Array(buf);\n    for (let i = 0; i < length; i++) {\n        arr[i] = s.charCodeAt(i);\n    }\n    return buf;\n}\n\nfunction blobFromString(s) {\n    const arr = stringToArrayBuffer(s);\n    return new Blob([arr]);\n}\n\nexport {arrayBufferToString, blobFromString, stringToArrayBuffer};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/binary-strings/index.js\n **/","import './contextmenu.css';\n\n/*\n    items = [\n        {text: 'Hello', disabled: true},\n        '-',\n        {text: 'World', callback: fn},\n        {text: 'section', separator: true},\n    ]\n */\n\nfunction isDescendant(parent, child) {\n    if (!parent) {\n        return false;\n    }\n    while (child) {\n        if (child === parent) {\n            return true;\n        }\n        child = child.parentNode;\n    }\n}\n\n\nclass Contextmenu {\n    constructor(items) {\n        this.items = items;\n    }\n\n    show(e) {\n        if (this._container) {\n            return;\n        }\n        if (e.originalEvent) {\n            e = e.originalEvent;\n        }\n        if (e.preventDefault) {\n            e.preventDefault();\n        } else {\n            e.returnValue = false;\n        }\n\n        const {clientX: x, clientY: y} = e;\n\n        const container = this._container = document.createElement('div');\n        document.body.appendChild(container);\n        container.className = 'contextmenu';\n        container.style.zIndex = 10000;\n\n        window.addEventListener('keydown', this.onKeyDown, true);\n        window.addEventListener('mousedown', this.onMouseDown, true);\n        window.addEventListener('touchstart', this.onMouseDown, true);\n\n        for (let item of this.createItems()) {\n            container.appendChild(item);\n        }\n        this.setPosition(x, y);\n    }\n\n    hide() {\n        if (!this._container) {\n            return;\n        }\n        document.body.removeChild(this._container);\n        this._container = null;\n\n        window.removeEventListener('keydown', this.onKeyDown, true);\n        window.removeEventListener('mousedown', this.onMouseDown, true);\n        window.removeEventListener('touchstart', this.onMouseDown, true);\n    }\n\n    onKeyDown = (e) => {\n        if (e.keyCode === 27) {\n            this.hide();\n        }\n    };\n\n    onMouseDown = (e) => {\n        if (!isDescendant(this._container, e.target)) {\n            this.hide();\n        }\n    };\n\n    setPosition(x, y) {\n        const window_width = window.innerWidth,\n            window_height = window.innerHeight,\n            menu_width = this._container.offsetWidth,\n            menu_height = this._container.offsetHeight;\n        if (x + menu_width >= window_width) {\n            x -= menu_width;\n        }\n        if (y + menu_height >= window_height) {\n            y -= menu_height;\n        }\n        this._container.style.left = `${x}px`;\n        this._container.style.top = `${y}px`;\n    }\n\n    *createItems() {\n        let items = this.items;\n        if (typeof items === 'function') {\n            items = items();\n        }\n        for (let itemOptions of items) {\n            if (typeof itemOptions === 'function') {\n                itemOptions = itemOptions();\n            }\n            if (itemOptions === '-' || itemOptions.separator) {\n                yield this.createSeparator(itemOptions);\n            } else {\n                yield this.createItem(itemOptions);\n            }\n        }\n    }\n\n    createItem(itemOptions) {\n        const el = document.createElement('a');\n        let className = 'item';\n        if (itemOptions.disabled) {\n            className += ' disabled';\n        }\n        if (itemOptions.header) {\n            className += ' header';\n        }\n        el.className = className;\n        el.innerHTML = itemOptions.text;\n\n        const callback = itemOptions.callback;\n        if (callback && !itemOptions.disabled) {\n            el.addEventListener('click', this.onItemClick.bind(this, callback));\n        }\n        return el;\n    }\n\n    onItemClick(callback, e) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.hide();\n        callback(e);\n    }\n\n    createSeparator(itemOptions) {\n        const el = document.createElement('div');\n        el.className = 'separator';\n        if (itemOptions.text) {\n            el.innerHTML = `<span>${itemOptions.text}</span>`;\n        }\n        return el;\n    }\n\n}\n\nexport default Contextmenu;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/contextmenu/index.js\n **/","import config from 'config';\n\nexport default function urlViaCorsProxy(url) {\n    return config.CORSProxyUrl + url.replace(/^(https?):\\/\\//, '$1/');\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/CORSProxy/index.js\n **/","import L from 'leaflet';\nimport hashState from './hashState';\nimport logging from 'lib/logging';\n\nL.Mixin.HashState = {\n    enableHashState: function(key, defaultInitialState = null) {\n        this._hashStateKey = key;\n        const eventSource = this.stateChangeEventsSource ? this[this.stateChangeEventsSource] : this;\n\n        // setup event listeners\n        if (this.stateChangeEvents) {\n            this.stateChangeEvents.forEach((event) => {\n                    eventSource.on(event, this._onControlStateChanged, this);\n                }\n            );\n        }\n\n        hashState.addEventListener(key, (state) => this._onExternalStateChanged(state));\n\n        // initialize control state from hash\n\n        const state = hashState.getState(key) || defaultInitialState;\n        this._ignoreStateChange = true;\n        if (!this.unserializeState(state) && !this.unserializeState(defaultInitialState)) { // state from hash is invalid, update hash from default state\n            hashState.updateState(key, this.serializeState());\n        }\n        hashState.updateState(this._hashStateKey, this.serializeState());\n        this._ignoreStateChange = false;\n\n        return this;\n    },\n\n    _onControlStateChanged: function() {\n        if (this._ignoreStateChange) {\n            return;\n        }\n        const state = this.serializeState();\n        hashState.updateState(this._hashStateKey, state);\n    },\n\n    _onExternalStateChanged: function(state) {\n        this._ignoreStateChange = true;\n        if (!this.unserializeState(state)) { // state from hash is invalid, update hash from component state\n            logging.captureMessageWithUrl(`Invalid state in hash string (key \"${this._hashStateKey}\")`);\n            hashState.updateState(this._hashStateKey, this.serializeState());\n        }\n        this._ignoreStateChange = false;\n    }\n\n\n    // TODO: disableHashState\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.hashState/leaflet.hashState.js\n **/","import L from 'leaflet';\nimport './canvasMarkers.css';\nimport rbush from 'rbush';\nimport loadImage from 'image-promise';\n\n/*\n Marker definition:\n {\n latlng: L.Latlng,\n icon: {url: string, center: [x, y]} or function(marker) returning icon,\n label: string or function,\n tooltip: string or function,\n any other fields\n }\n */\n\nfunction calcIntersectionSum(rect, rects) {\n    let sum = 0,\n        left, right, top, bottom, rect2;\n\n    for (rect2 of rects) {\n        left = Math.max(rect.minX, rect2.minX);\n        right = Math.min(rect.maxX, rect2.maxX);\n        top = Math.max(rect.minY, rect2.minY);\n        bottom = Math.min(rect.maxY, rect2.maxY);\n        if (top < bottom && left < right) {\n            sum += ((right - left) * (bottom - top));\n        }\n    }\n    return sum;\n}\n\nL.Layer.CanvasMarkers = L.GridLayer.extend({\n        options: {\n            async: true,\n            labelFontName: 'Verdana, Arial, sans-serif',\n            labelFontSize: 10,\n            iconScale: 1,\n            pane: 'rasterMarker',\n            updateWhenZooming: !L.Browser.mobile,\n            iconsOpacity: 1\n        },\n\n        initialize: function(markers, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.rtree = rbush(9, ['.latlng.lng', '.latlng.lat', '.latlng.lng', '.latlng.lat']);\n            this._regions = rbush();\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._labelPositionsZoom = null;\n            this.addMarkers(markers);\n            this._images = {};\n            this._tileQueue = [];\n            this._hoverMarker = null;\n            this.on('markerenter', this.onMarkerEnter, this);\n            this.on('markerleave', this.onMarkerLeave, this);\n        },\n\n        addMarkers: function(markers) {\n            if (markers) {\n                this.rtree.load(markers);\n                this.resetLabels();\n                setTimeout(() => this.redraw(), 0);\n            }\n        },\n\n        addMarker: function(marker) {\n            // FIXME: adding existing marker must be be noop\n            this.rtree.insert(marker);\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        removeMarker: function(marker) {\n            this.removeMarkers([marker]);\n        },\n\n        removeMarkers: function(markers) {\n            markers.forEach((marker) => this.rtree.remove(marker));\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        updateMarkers: function(markers) {\n            this.removeMarkers(markers);\n            this.addMarkers(markers);\n        },\n\n        updateMarker: function(marker) {\n            this.updateMarkers([marker]);\n        },\n\n        setMarkerPosition: function(marker, latlng) {\n            this.removeMarker(marker);\n            marker.latlng = latlng;\n            this.addMarker(marker);\n        },\n\n        getMarkers: function() {\n            return this.rtree.all();\n        },\n\n        findLabelPosition: function(iconCenter, iconSize, textWidth, textHeight, pixelExtents) {\n            const\n                verticalPadding = 0,\n                xPositions = [iconCenter[0] + iconSize[0] / 2 + 2, iconCenter[0] - iconSize[0] / 2 - textWidth - 2],\n                yPositions = [\n                    iconCenter[1] - textHeight / 2 + verticalPadding,\n                    iconCenter[1] - textHeight * .75 - iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight / 4 + iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight - iconSize[1] / 2 + verticalPadding,\n                    iconCenter[1] + iconSize[1] / 2 + verticalPadding\n                ];\n\n            let minIntersectionSum = +Infinity;\n            let bestX = xPositions[0],\n                bestY = yPositions[0];\n            for (let x of xPositions) {\n                for (let y of yPositions) {\n                    const rect = {minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight};\n                    if (pixelExtents && (rect.minX < pixelExtents.tileW || rect.maxX > pixelExtents.tileE ||\n                        rect.minY < pixelExtents.tileN || rect.maxY > pixelExtents.tileS)) {\n                        continue;\n                    }\n                    let intersectionSum = calcIntersectionSum(rect, this._regions.search(rect));\n                    if (intersectionSum < minIntersectionSum) {\n                        minIntersectionSum = intersectionSum;\n                        bestX = x;\n                        bestY = y;\n                        if (minIntersectionSum === 0) {\n                            break;\n                        }\n                    }\n                }\n                if (minIntersectionSum === 0) {\n                    break;\n                }\n\n            }\n            return [bestX, bestY];\n        },\n\n        preloadIcons: function(urls) {\n            const newUrls = urls.filter((url) => !(url in this._images));\n            if (newUrls.length) {\n                return loadImage(newUrls).then((images) => {\n                        for (let image of images) {\n                            this._images[image.src] = image;\n                        }\n                    }\n                )\n            } else {\n                return Promise.resolve();\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            L.Util.requestAnimFrame(() => {\n                    this.drawTile(canvas, coords).then(() => done(null, canvas));\n                }\n            );\n            return canvas;\n        },\n\n        selectMarkersForDraw: function({tileN, tileS, tileE, tileW}, zoom, withoutPadding) {\n            // FIXME: padding should depend on options.iconScale and fontSize\n            if (!this._map) {\n                return {};\n            }\n            const\n                iconsHorPad = withoutPadding ? 0 : 520,\n                iconsVertPad = withoutPadding ? 0 :  50,\n                labelsHorPad = withoutPadding ? 0 : 256,\n                labelsVertPad = withoutPadding ? 0 : 20;\n            const\n                iconsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - iconsHorPad, tileS + iconsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + iconsHorPad, tileN - iconsVertPad), zoom)\n                ),\n                labelsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - labelsHorPad, tileS + labelsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + labelsHorPad, tileN - labelsVertPad), zoom)\n                );\n            const\n                iconUrls = [],\n                markerJobs = {};\n\n            // used only to preload icons\n            const pointsForMarkers = this.rtree.search({\n                    minX: iconsBounds.getWest(),\n                    minY: iconsBounds.getSouth(),\n                    maxX: iconsBounds.getEast(),\n                    maxY: iconsBounds.getNorth()\n                }\n            );\n\n            // used to place labels\n            const pointsForLabels = this.rtree.search({\n                    minX: labelsBounds.getWest(), minY: labelsBounds.getSouth(),\n                    maxX: labelsBounds.getEast(), maxY: labelsBounds.getNorth()\n                }\n            );\n\n            for (let marker of pointsForMarkers) {\n                const p = this._map.project(marker.latlng, zoom);\n                let icon = marker.icon;\n                if (typeof icon === 'function') {\n                    icon = icon(marker);\n                }\n                iconUrls.push(icon.url);\n                let markerId = L.stamp(marker);\n                markerJobs[markerId] = {marker: marker, icon: icon, projectedXY: p};\n            }\n            return {iconUrls, markerJobs, pointsForLabels};\n        },\n\n        drawSelectedMarkers: function(canvas, pixelExtents, markerJobs, pointsForLabels, zoom, limitLabelsToImage) {\n            const {tileN, tileW, tileS, tileE} = pixelExtents;\n            const textHeight = this.options.labelFontSize * this.options.iconScale;\n            if (this._labelPositionsZoom !== zoom) {\n                this._labelPositionsZoom = zoom;\n                this.resetLabels();\n            }\n            const ctx = canvas.getContext('2d');\n            ctx.font = L.Util.template('bold {size}px {name}',\n                {'name': this.options.labelFontName, 'size': this.options.labelFontSize * this.options.iconScale}\n            );\n            for (let [markerId, job] of Object.entries(markerJobs)) {\n                let img = this._images[job.icon.url];\n                job.img = img;\n                const imgW = Math.round(img.width * this.options.iconScale);\n                const imgH = Math.round(img.height * this.options.iconScale);\n                if (!(markerId in this._iconPositions)) {\n                    let x = job.projectedXY.x - job.icon.center[0] * this.options.iconScale;\n                    let y = job.projectedXY.y - job.icon.center[1] * this.options.iconScale;\n                    x = Math.round(x);\n                    y = Math.round(y);\n                    this._iconPositions[markerId] = [x, y];\n                    this._regions.insert({\n                            minX: x, minY: y, maxX: x + imgW, maxY: y + imgH,\n                            marker: job.marker, isLabel: false\n                        }\n                    );\n                }\n                let [x, y] = this._iconPositions[markerId];\n                job.iconCenter = [x + imgW / 2, y + imgH / 2];\n                job.iconSize = [imgW, imgH];\n            }\n            for (let marker of pointsForLabels) {\n                const markerId = L.stamp(marker);\n                const job = markerJobs[markerId];\n                let label = job.marker.label;\n                if (label) {\n                    if (typeof label === 'function') {\n                        label = label(job.marker);\n                    }\n                    job.label = label;\n                    if (!(markerId in this._labelPositions)) {\n                        const textWidth = ctx.measureText(label).width;\n                        const p = this.findLabelPosition(job.iconCenter, job.iconSize, textWidth, textHeight,\n                            limitLabelsToImage ? pixelExtents : null);\n                        this._labelPositions[markerId] = p;\n                        let [x, y] = p;\n                        this._regions.insert({\n                                minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight,\n                                marker: job.marker, isLabel: true\n                            }\n                        );\n\n                    }\n                } else {\n                    this._labelPositions[markerId] = null;\n                }\n            }\n\n            const regionsInTile = this._regions.search({minX: tileW, minY: tileN, maxX: tileE, maxY: tileS});\n            // draw labels\n            for (let region of regionsInTile) {\n                if (region.isLabel) {\n                    //TODO: set font name ant size in options\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._labelPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.textBaseline = 'bottom';\n                    ctx.shadowColor = '#fff';\n                    ctx.strokeStyle = '#fff';\n                    ctx.fillStyle = '#000';\n                    ctx.lineWidth = 1.2 * this.options.iconScale;\n                    ctx.shadowBlur = 1 * this.options.iconScale;\n                    ctx.strokeText(job.label, x, y + textHeight);\n                    ctx.shadowBlur = 0;\n                    ctx.fillText(job.label, x, y + textHeight);\n                }\n            }\n            ctx.globalAlpha = this.options.iconsOpacity;\n            // draw icons\n            for (let region of regionsInTile) {\n                if (!region.isLabel) {\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._iconPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.drawImage(job.img, x, y, job.iconSize[0], job.iconSize[1]);\n                }\n            }\n            ctx.globalAlpha = 1;\n        },\n\n        drawTile: async function(canvas, coords) {\n            const\n                zoom = coords.z,\n                tileSize = this.options.tileSize,\n                tileN = coords.y * tileSize,\n                tileW = coords.x * tileSize,\n                tileS = tileN + tileSize,\n                tileE = tileW + tileSize;\n            const pixelExtents = {tileN, tileS, tileE, tileW};\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom);\n            if (!markerJobs) {\n                return;\n            }\n            await this.preloadIcons(iconUrls);\n            this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom);\n        },\n\n        resetLabels: function() {\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._regions.clear();\n        },\n\n        findMarkerFromMouseEvent: function(e) {\n            const\n                p = this._map.project(e.latlng),\n                region = this._regions.search({minX: p.x, minY: p.y, maxX: p.x, maxY: p.y})[0];\n            let marker;\n            if (region) {\n                marker = region.marker;\n            } else {\n                marker = null;\n            }\n            return marker;\n        },\n\n        onMouseMove: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (this._hoverMarker !== marker) {\n                if (this._hoverMarker) {\n                    this.fire('markerleave', {marker: this._hoverMarker});\n                }\n                if (marker) {\n                    this.fire('markerenter', {marker: marker});\n                }\n                this._hoverMarker = marker;\n            }\n        },\n\n        showTooltip: function(e) {\n            if (!e.marker.tooltip) {\n                return;\n            }\n            let text = e.marker.tooltip;\n            if (typeof text === 'function') {\n                text = text(e.marker);\n                if (!e.marker.tooltip) {\n                    return;\n                }\n            }\n            this.toolTip.innerHTML = text;\n            const p = this._map.latLngToLayerPoint(e.marker.latlng);\n            L.DomUtil.setPosition(this.toolTip, p);\n            L.DomUtil.addClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMarkerEnter: function(e) {\n            this._map._container.style.cursor = 'pointer';\n            this.showTooltip(e);\n\n        },\n\n        onMarkerLeave: function() {\n            this._map._container.style.cursor = '';\n            L.DomUtil.removeClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMouseOut: function() {\n            if (this._hoverMarker) {\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker: this._hoverMarker});\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markerclick', e);\n            }\n        },\n\n        onRightClick: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markercontextmenu', e);\n            }\n        },\n\n        onAdd: function(map) {\n            if (this.options.pane === 'rasterMarker' && !map.getPane('rasterMarker')) {\n                map.createPane('rasterMarker').style.zIndex = 550;\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('mouseout', this.onMouseOut, this);\n            map.on('click', this.onClick, this);\n            map.on('contextmenu', this.onRightClick, this);\n            this.toolTip = L.DomUtil.create('div', 'canvas-marker-tooltip', this._map.getPanes().markerPane);\n        },\n\n        onRemove: function(map) {\n            this._map.off('mousemove', this.onMouseMove, this);\n            this._map.off('mouseout', this.onMouseOut, this);\n            this._map.off('click', this.onClick, this);\n            this._map.off('contextmenu', this.onRightClick, this);\n            if (this._hoverMarker) {\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker: this._hoverMarker})\n            }\n            this._map.getPanes().markerPane.removeChild(this.toolTip);\n            L.GridLayer.prototype.onRemove.call(this, map);\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.canvasMarkers/index.js\n **/","function localStorageWorks() {\n    try {\n        window.localStorage.setItem('_testDummy', 'TEST');\n        return window.localStorage.getItem('_testDummy') === 'TEST';\n    } catch (e) {\n        return false;\n    }\n}\n\n\nlet storage;\n\nif (localStorageWorks()) {\n    storage = window.localStorage;\n} else {\n    let _storage = {};\n    storage = {\n        length: 0,\n\n        key: function(n) {\n            return Object.keys(_storage)[n];\n        },\n\n        removeItem: function(key) {\n            delete _storage[key];\n        },\n\n        getItem: function(key) {\n            return storage[key];\n        },\n\n        setItem: function(key, value) {\n            storage[key] = value;\n        },\n\n        clear: function() {\n            _storage = {};\n        }\n    }\n}\n\nexport default storage;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/safe-localstorage/index.js\n **/","import './style.css';\nimport logging from 'lib/logging';\n\nfunction showNotification(message, mouseEvent) {\n    var el = document.createElement('div');\n    el.innerHTML = message;\n    el.className = 'copy-clipboard-notification';\n    document.body.appendChild(el);\n    var w = el.offsetWidth,\n        h = el.offsetHeight,\n        x = mouseEvent.clientX - w - 8,\n        y = mouseEvent.clientY - h / 2;\n    if (x < 0) {\n        x = 0\n    }\n    if (y < 0) {\n        y = 0\n    }\n    el.style.top = y + 'px';\n    el.style.left = x + 'px';\n    setTimeout(function() {\n        document.body.removeChild(el);\n    }, 1000);\n\n}\n\nfunction copyToClipboard(s, mouseEvent) {\n    try {\n        var ta = document.createElement('textarea');\n        ta.value = s;\n        document.body.appendChild(ta);\n        ta.select();\n        document.execCommand('copy');\n        showNotification('Copied', mouseEvent);\n    } catch (e) {\n        logging.captureException(e, {extra: {description: 'clipborad to copy failed'}});\n        prompt(\"Copy to clipboard: Ctrl+C, Enter\", s);\n    } finally {\n        document.body.removeChild(ta);\n    }\n}\n\nexport default copyToClipboard;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/clipboardCopy/index.js\n **/","class PrintStaticLayer {\n    _layerDummy = true;\n    _printProgressWeight = 0.01;\n\n    cloneForPrint() {\n        return this;\n    };\n\n    // printOptions = {\n    //     xhrOptions,\n    //     pixelBounds,\n    //     latLngBounds,\n    //     destPixelSize,\n    //     resolution,\n    //     scale,\n    //     zoom\n    // }\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawRaster(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: this.overlaySolid\n                        }\n                    ),\n                    abortLoading: () => {\n                    }\n                }\n            }).bind(this),\n            count: 1\n        };\n    }\n\n    _drawRaster(canvas, printOptions) {\n        return;\n    }\n}\n\nexport {PrintStaticLayer};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/decorations.js\n **/","import JSUnzip from 'vendored/github.com/augustl/js-unzip/js-unzip';\nimport RawDeflate from 'vendored/github.com/dankogai/js-deflate/rawinflate';\nimport stripBom from 'lib/stripBom';\n\nimport {decode as utf8_decode} from 'utf8';\n\nfunction xmlGetNodeText(node) {\n    if (node) {\n        return Array.prototype.slice.call(node.childNodes)\n            .map(function(node) {\n                    return node.nodeValue;\n                }\n            )\n            .join('');\n    }\n}\n\n\nfunction parseGpx(txt, name, preferNameFromFile) {\n    var error;\n\n    function getSegmentPoints(segment_element) {\n        var points_elements = segment_element.getElementsByTagName('trkpt');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    var getTrackSegments = function(xml) {\n        var segments = [];\n        var segments_elements = xml.getElementsByTagName('trkseg');\n        for (var i = 0; i < segments_elements.length; i++) {\n            var segment_points = getSegmentPoints(segments_elements[i]);\n            if (segment_points.length) {\n                segments.push(segment_points);\n            }\n        }\n        return segments;\n    };\n\n    var getWaypoints = function(xml) {\n        var waypoint_elements = xml.getElementsByTagName('wpt');\n        var waypoints = [];\n        for (var i = 0; i < waypoint_elements.length; i++) {\n            var waypoint_element = waypoint_elements[i];\n            var waypoint = {};\n            waypoint.lat = parseFloat(waypoint_element.getAttribute('lat'));\n            waypoint.lng = parseFloat(waypoint_element.getAttribute('lon'));\n            if (isNaN(waypoint.lat) || isNaN(waypoint.lng)) {\n                error = 'CORRUPT';\n                continue;\n            }\n            try {\n                waypoint.name = utf8_decode(xmlGetNodeText(waypoint_element.getElementsByTagName('name')[0]));\n            }  catch (e) {\n                error = 'CORRUPT';\n                continue;\n            }\n            waypoint.symbol_name = xmlGetNodeText(waypoint_element.getElementsByTagName('sym')[0]);\n            waypoints.push(waypoint);\n        }\n        return waypoints;\n    };\n\n    txt = stripBom(txt);\n    // remove namespaces\n    txt = txt.replace(/<([^ >]+):([^ >]+)/g, '<$1_$2');\n    try {\n        var dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('gpx').length === 0) {\n        return null;\n    }\n    if (preferNameFromFile) {\n        for (let trk of [...dom.getElementsByTagName('trk')]) {\n            let trkName = trk.getElementsByTagName('name')[0];\n            if (trkName) {\n                trkName = utf8_decode(xmlGetNodeText(trkName));\n                if (trkName.length) {\n                    name = trkName;\n                    break;\n                }\n            }\n        }\n    }\n    return [{\n        name: name,\n        tracks: getTrackSegments(dom),\n        points: getWaypoints(dom),\n        error: error\n    }];\n}\n\n\nfunction parseOziPlt(txt, name) {\n    var error;\n    var segments = [];\n    var lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Track Point File') !== 0) {\n        return null;\n    }\n    var expected_points_num = parseInt(lines[5], 10);\n    var current_segment = [];\n    var total_points_num = 0;\n    for (var i = 6; i < lines.length; i++) {\n        var line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        var fields = line.split(',');\n        var lat = parseFloat(fields[0]);\n        var lon = parseFloat(fields[1]);\n        var is_start_of_segment = parseInt(fields[2], 10);\n        if (isNaN(lat) || isNaN(lon) || isNaN(is_start_of_segment)) {\n            error = 'CORRUPT';\n            break;\n        }\n        if (is_start_of_segment) {\n            current_segment = [];\n        }\n        if (!current_segment.length) {\n            segments.push(current_segment);\n        }\n        current_segment.push({lat: lat, lng: lon});\n        total_points_num += 1;\n    }\n    if (isNaN(expected_points_num) || expected_points_num !== total_points_num) {\n        error = 'CORRUPT';\n    }\n    return [{name: name, tracks: segments, error: error}];\n}\n\nfunction decodeCP1251(s) {\n    var c, i, s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 192 && c <= 255) {\n            c += (0x410 - 192);\n        } else if (c === 168) {\n            c = 0x0401;\n        } else if (c === 184) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nfunction parseOziWpt(txt, name) {\n    var points = [],\n        error,\n        lines, line,\n        i,\n        lat, lng, pointName, fields;\n    lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Waypoint File') !== 0) {\n        return null;\n    }\n    for (i = 4; i < lines.length; i++) {\n        line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        fields = line.split(',');\n        lat = parseFloat(fields[2]);\n        lng = parseFloat(fields[3]);\n        pointName = decodeCP1251(fields[1]).trim();\n        if (isNaN(lat) || isNaN(lng)) {\n            error = 'CORRUPT';\n            break;\n        }\n        points.push({\n                lat: lat,\n                lng: lng,\n                name: pointName\n            }\n        );\n    }\n    return [{name: name, points: points, error: error}];\n}\n\nfunction parseKml(txt, name) {\n    var error;\n    var getSegmentPoints = function(coordinates_element) {\n        // convert multiline text value of tag to single line\n        var coordinates_string = xmlGetNodeText(coordinates_element);\n        var points_strings = coordinates_string.split(/\\s+/);\n        var points = [];\n        for (var i = 0; i < points_strings.length; i++) {\n            if (points_strings[i].length) {\n                var point = points_strings[i].split(',');\n                var lat = parseFloat(point[1]);\n                var lng = parseFloat(point[0]);\n                if (isNaN(lat) || isNaN(lng)) {\n                    error = 'CORRUPT';\n                    break;\n                }\n                points.push({lat: lat, lng: lng});\n            }\n        }\n        return points;\n    };\n\n    var getTrackSegments = function(xml) {\n        var segments_elements = xml.getElementsByTagName('LineString');\n        var segments = [];\n        for (var i = 0; i < segments_elements.length; i++) {\n            var coordinates_element = segments_elements[i].getElementsByTagName('coordinates');\n            if (coordinates_element.length) {\n                var segment_points = getSegmentPoints(coordinates_element[0]);\n                if (segment_points.length) {\n                    segments.push(segment_points);\n                }\n            }\n        }\n        return segments;\n    };\n\n    function getPoints(dom) {\n        var points = [],\n            placemarks, i, coord, name, lat, lng, pointObjs;\n        placemarks = dom.getElementsByTagName('Placemark');\n        for (i = 0; i < placemarks.length; i++) {\n            pointObjs = placemarks[i].getElementsByTagName('Point');\n            if (pointObjs.length === 0) {\n                continue\n            } else if (pointObjs.length > 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = pointObjs[0].getElementsByTagName('coordinates');\n            if (coord.length !== 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = xmlGetNodeText(coord[0]);\n            coord = coord.split(',');\n            lat = parseFloat(coord[1]);\n            lng = parseFloat(coord[0]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            name = placemarks[i].getElementsByTagName('name');\n            if (name.length !== 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            try {\n                name = utf8_decode(xmlGetNodeText(name[0]).trim());\n            } catch (e) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({\n                    name: name,\n                    lat: lat,\n                    lng: lng\n                }\n            );\n        }\n        return points;\n    }\n\n    txt = stripBom(txt);\n    txt = txt.replace(/<([^ >]+):([^ >]+)/g, '<$1_$2');\n    try {\n        var dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('kml').length === 0) {\n        return null;\n    }\n\n    return [{name: name, tracks: getTrackSegments(dom), points: getPoints(dom), error: error}];\n}\n\nfunction parseKmz(txt, name) {\n    var uncompressed;\n    try {\n        var unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    var tracks = [],\n        points = [],\n        geodata,\n        error;\n    var hasDocKml = false;\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var i, entry;\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName === 'doc.kml') {\n            hasDocKml = true;\n            break;\n        }\n    }\n    if (!hasDocKml) {\n        return null;\n    }\n\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName.match(/\\.kml$/i)) {\n            if (entry.compressionMethod === 0) {\n                uncompressed = entry.data;\n            } else if (entry.compressionMethod === 8) {\n                uncompressed = RawDeflate.inflate(entry.data);\n            } else {\n                return null;\n            }\n            geodata = parseKml(uncompressed, 'dummmy');\n            if (geodata) {\n                error = error || geodata.error;\n                tracks.push.apply(tracks, geodata[0].tracks);\n                points.push.apply(points, geodata[0].points);\n            }\n        }\n    }\n\n    geodata = [{name: name, error: error, tracks: tracks, points: points}];\n    return geodata;\n}\n\nfunction parseYandexRulerString(s) {\n    var last_lat = 0;\n    var last_lng = 0;\n    var error;\n    var points = [];\n    s = s.replace(/%2C/ig, ',');\n    var points_str = s.split('~');\n    for (var i = 0; i < points_str.length; i++) {\n        var point = points_str[i].split(',');\n        var lng = parseFloat(point[0]);\n        var lat = parseFloat(point[1]);\n        if (isNaN(lat) || isNaN(lng)) {\n            error = 'CORRUPT';\n            break;\n        }\n        last_lng += lng;\n        last_lat += lat;\n        points.push({lat: last_lat, lng: last_lng});\n    }\n    return {error: error, points: points};\n}\n\n\nfunction parseYandexRulerUrl(s) {\n    var re = /yandex\\..+[?&]rl=([^&]+)/;\n    var m = re.exec(s);\n    if (!m) {\n        return null;\n    }\n    var res = parseYandexRulerString(m[1]);\n    return [{name: 'Yandex ruler', error: res.error, tracks: [res.points]}];\n}\n\n\nfunction parseZip(txt, name) {\n    try {\n        var unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var geodata_array = [];\n    for (var i = 0; i < unzipper.entries.length; i++) {\n        var entry = unzipper.entries[i];\n        var uncompressed;\n        if (entry.compressionMethod === 0) {\n            uncompressed = entry.data;\n        } else if (entry.compressionMethod === 8) {\n            uncompressed = RawDeflate.inflate(entry.data);\n        } else {\n            return null;\n        }\n        var file_name = name + '/' + entry.fileName;\n        var geodata = parseGeoFile(file_name, uncompressed);\n        geodata_array.push.apply(geodata_array, geodata);\n    }\n    return geodata_array;\n}\n\n// function parseYandexMap(txt) {\n//     var start_tag = '<script id=\"vpage\" type=\"application/json\">';\n//     var json_start = txt.indexOf(start_tag);\n//     if (json_start === -1) {\n//         return null;\n//     }\n//     json_start += start_tag.length;\n//     var json_end = txt.indexOf('</script>', json_start);\n//     if (json_end === -1) {\n//         return null;\n//     }\n//     var map_data = txt.substring(json_start, json_end);\n//     map_data = JSON.parse(map_data);\n//     console.log(map_data);\n//     if (!('request' in map_data)) {\n//         return null;\n//     }\n//     var name = 'YandexMap';\n//     var segments = [];\n//     var error;\n//     if (map_data.vpage && map_data.vpage.data && map_data.vpage.data.objects && map_data.vpage.data.objects.length) {\n//         var mapName = ('' + (map_data.vpage.data.name || '')).trim();\n//         if (mapName.length > 3) {\n//             name = '';\n//         } else if (mapName.length) {\n//             name += ': ';\n//         }\n//         name += fileutils.decodeUTF8(mapName);\n//         map_data.vpage.data.objects.forEach(function(obj){\n//             if (obj.pts && obj.pts.length) {\n//                 var segment = [];\n//                 for (var i=0; i< obj.pts.length; i++) {\n//                     var pt = obj.pts[i];\n//                     var lng = parseFloat(pt[0]);\n//                     var lat = parseFloat(pt[1]);\n//                     if (isNaN(lat) || isNaN(lng)) {\n//                         error = 'CORRUPT';\n//                         break;\n//                     }\n//                     segment.push({lat: lat, lng:lng});\n//                 }\n//                 if (segment.length) {\n//                     segments.push(segment);\n//                 }\n//             }\n//         });\n//     }\n//     if (map_data.request.args && map_data.request.args.rl) {\n//         var res = parseYandexRulerString(map_data.request.args.rl);\n//         error = error || res.error;\n//         if (res.points && res.points.length) {\n//             segments.push(res.points);\n//         }\n//     }\n//     return [{name: name, error: error, tracks: segments}];\n// }\n\nfunction decodeUrlSafeBase64(s) {\n    var decoded;\n    s = s\n        .replace(/[\\n\\r \\t]/g, '')\n        .replace(/-/g, '+')\n        .replace(/_/g, '/');\n    try {\n        decoded = atob(s);\n    } catch (e) {\n    }\n    if (decoded && decoded.length) {\n        return decoded;\n    }\n    return null;\n}\n\nfunction unpackNumber(s, position) {\n    var x,\n        n = 0;\n    x = s.charCodeAt(position);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n = x - 64;\n        return [n, 1];\n    }\n    n = x & 0x7f;\n    x = s.charCodeAt(position + 1);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 7;\n        n -= 8192;\n        return [n, 2];\n    }\n    n |= (x & 0x7f) << 7;\n    x = s.charCodeAt(position + 2);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 14;\n        n -= 1048576;\n        return [n, 3];\n    }\n    n |= (x & 0x7f) << 14;\n    x = s.charCodeAt(position + 3);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    n |= x << 21;\n    n -= 268435456;\n    return [n, 4];\n}\n\nfunction PackedStreamReader(s) {\n    this._string = s;\n    this.position = 0;\n}\n\nPackedStreamReader.prototype.readNumber = function() {\n    var n = unpackNumber(this._string, this.position);\n    this.position += n[1];\n    return n[0];\n};\n\nPackedStreamReader.prototype.readString = function(size) {\n    var s = this._string.slice(this.position, this.position + size);\n    this.position += size;\n    return s;\n};\n\nfunction parseStringified(s, oldVersion) {\n    var name,\n        n,\n        segments = [],\n        segment,\n        segmentsCount,\n        pointsCount,\n        arcUnit = ((1 << 24) - 1) / 360,\n        x, y,\n        error, version, midX, midY, /*symbol,*/ waypointName,\n        wayPoints = [], color, measureTicksShown, trackHidden = false;\n    s = decodeUrlSafeBase64(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    s = new PackedStreamReader(s);\n    try {\n        if (oldVersion) {\n            version = 0;\n        } else {\n            version = s.readNumber();\n        }\n        if (version !== 0 && version !== 1 && version !== 2 && version !== 3) {\n            return [{name: 'Text encoded track', error: ['CORRUPT']}];\n        }\n        n = s.readNumber();\n        name = s.readString(n);\n        name = utf8_decode(name);\n        segmentsCount = s.readNumber();\n        for (; segmentsCount--;) {\n            segment = [];\n            pointsCount = s.readNumber();\n            x = 0;\n            y = 0;\n            for (; pointsCount--;) {\n                x += s.readNumber();\n                y += s.readNumber();\n                segment.push({lng: x / arcUnit, lat: y / arcUnit});\n            }\n            segments.push(segment);\n            segment = null;\n        }\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            error = ['CORRUPT'];\n            if (segment) {\n                segments.push(segment);\n            }\n        } else {\n            throw e;\n        }\n    }\n    try {\n        color = s.readNumber();\n        measureTicksShown = s.readNumber();\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            color = 0;\n            measureTicksShown = 0;\n            if (version > 0) {\n                error = ['CORRUPT'];\n            }\n        } else {\n            throw e;\n        }\n    }\n    if (version >= 3) {\n        try {\n            trackHidden = !!(s.readNumber())\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    if (version >= 2) {\n        try {\n            pointsCount = s.readNumber();\n            if (pointsCount) {\n                midX = s.readNumber();\n                midY = s.readNumber();\n            }\n            for (; pointsCount--;) {\n                n = s.readNumber();\n                waypointName = s.readString(n);\n                waypointName = utf8_decode(waypointName);\n\n                // let symbol = s.readNumber();\n                s.readNumber();\n\n                x = s.readNumber() + midX;\n                y = s.readNumber() + midY;\n                wayPoints.push({\n                        name: waypointName,\n                        lat: y / arcUnit,\n                        lng: x / arcUnit,\n\n                    }\n                );\n            }\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    var geoData = {\n        name: name || \"Text encoded track\",\n        tracks: segments,\n        error: error,\n        points: wayPoints,\n        color: color,\n        measureTicksShown: measureTicksShown,\n        trackHidden: trackHidden\n    };\n    return [geoData];\n}\n\nfunction parseTrackUrl(s) {\n    var i = s.indexOf('track://');\n    if (i === -1) {\n        return null;\n    }\n    return parseStringified(s.substring(i + 8), true);\n}\n\nfunction parseNakarteUrl(s) {\n    var i = s.indexOf('#');\n    if (i === -1) {\n        return null;\n    }\n    i = s.indexOf('nktk=', i + 1);\n    if (i === -1) {\n        return null;\n    }\n    s = s.substring(i + 5).split('/');\n    var geodataArray = [];\n    for (i = 0; i < s.length; i++) {\n        if (s[i]) {\n            geodataArray.push.apply(geodataArray, parseStringified(s[i]));\n        }\n    }\n    return geodataArray;\n}\n\nfunction parseGeoFile(name, data, preferNameFromFile) {\n    var parsers = [\n        parseTrackUrl,\n        parseNakarteUrl,\n        parseKmz,\n        parseZip,\n        parseGpx,\n        parseOziPlt,\n        parseOziWpt,\n        parseKml,\n        parseYandexRulerUrl,\n//            parseYandexMap\n    ];\n    for (var i = 0; i < parsers.length; i++) {\n        var parsed = parsers[i](data, name, preferNameFromFile);\n        if (parsed !== null) {\n            return parsed;\n        }\n    }\n    return [{name: name, error: 'UNSUPPORTED'}];\n}\n\nexport {parseGeoFile};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.track-list/lib/geo_file_formats.js\n **/","import L from 'leaflet';\nimport ko from 'vendored/knockout';\nimport Contextmenu from 'lib/contextmenu';\nimport 'lib/knockout.component.progress/progress';\nimport './track-list.css';\nimport {selectFiles, readFiles} from 'lib/file-read';\nimport {parseGeoFile} from './lib/geo_file_formats';\nimport urlViaCorsProxy from 'lib/CORSProxy';\nimport {fetch} from 'lib/xhr-promise';\nimport geoExporters from './lib/geo_file_exporters';\nimport copyToClipboard from 'lib/clipboardCopy';\nimport {saveAs} from 'browser-filesaver';\nimport 'lib/leaflet.layer.canvasMarkers';\nimport 'lib/leaflet.lineutil.simplifyLatLngs';\nimport iconFromBackgroundImage from 'lib/iconFromBackgroundImage';\nimport 'lib/controls-styles/controls-styles.css';\nimport {ElevationProfile, calcSamplingInterval} from 'lib/leaflet.control.elevation-profile';\nimport 'lib/leaflet.control.commons';\nimport {blobFromString} from 'lib/binary-strings';\nimport 'lib/leaflet.polyline-edit';\nimport 'lib/leaflet.polyline-measure';\nimport logging from 'lib/logging';\nimport {notify} from 'lib/notifications';\nimport {isGpsiesUrl, gpsiesXhrOptions} from './lib/gpsies';\n\n\nconst TrackSegment = L.MeasuredLine.extend({\n    includes: L.Polyline.EditMixin,\n\n    options: {\n        weight: 6,\n        lineCap: 'butt',\n        opacity: 0.5,\n\n    }\n});\nTrackSegment.mergeOptions(L.Polyline.EditMixinOptions);\n\n\nL.Control.TrackList = L.Control.extend({\n        options: {position: 'bottomright'},\n        includes: L.Mixin.Events,\n\n        colors: ['#77f', '#f95', '#0ff', '#f77', '#f7f', '#ee5'],\n\n\n        initialize: function() {\n            L.Control.prototype.initialize.call(this);\n            this.tracks = ko.observableArray();\n            this.url = ko.observable('');\n            this.readingFiles = ko.observable(false);\n            this.readProgressRange = ko.observable();\n            this.readProgressDone = ko.observable();\n            this._lastTrackColor = 0;\n            this.trackListHeight = ko.observable(0);\n            this.isPlacingPoint = false;\n            this.trackAddingPoint = ko.observable(null);\n        },\n\n        onAdd: function(map) {\n            this.map = map;\n            this.tracks.removeAll();\n            var container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-tracklist');\n            this._stopContainerEvents();\n\n            container.innerHTML = `\n                <div class=\"leaflet-control-button-toggle\" data-bind=\"click: setExpanded\"\n                 title=\"Load, edit and save tracks\"></div>\n                <div class=\"leaflet-control-content\">\n                <div class=\"header\">\n                    <div class=\"hint\">\n                        GPX Ozi GoogleEarth ZIP YandexMaps GPSies\n                    </div>\n                    <div class=\"button-minimize\" data-bind=\"click: setMinimized\"></div>\n                </div>\n                <div class=\"inputs-row\" data-bind=\"visible: !readingFiles()\">\n                    <a class=\"button add-track\" title=\"New track\" data-bind=\"click: function(){this.addNewTrack()}\"></a\n                    ><a class=\"button open-file\" title=\"Open file\" data-bind=\"click: loadFilesFromDisk\"></a\n                    ><input type=\"text\" class=\"input-url\" placeholder=\"Track URL\"\n                        data-bind=\"textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: onFileInputRightClick}\"\n                    ><a class=\"button download-url\" title=\"Download URL\" data-bind=\"click: loadFilesFromUrl\"></a\n                    ><a class=\"button menu-icon\" data-bind=\"click: function(_,e){this.showMenu(e)}\" title=\"Menu\"></a>\n                </div>\n                <div style=\"text-align: center\">\n                    <div data-bind=\"\n                        component: {\n                        name: 'progress-indicator',\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\n                        },\n                        visible: readingFiles\"></div>\n                </div>\n                <div class=\"tracks-rows-wrapper\" data-bind=\"style: {maxHeight: trackListHeight}\">\n                <table class=\"tracks-rows\"><tbody data-bind=\"foreach: {data: tracks, as: 'track'}\">\n                    <tr data-bind=\"event: {contextmenu: $parent.showTrackMenu.bind($parent)}\">\n                        <td><input type=\"checkbox\" class=\"visibility-switch\" data-bind=\"checked: track.visible\"></td>\n                        <td><div class=\"color-sample\" data-bind=\"style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)\"></div></td>\n                        <td><div class=\"track-name-wrapper\"><div class=\"track-name\" data-bind=\"text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)\"></div></div></td>\n                        <td><div class=\"button-length\" data-bind=\"text: $parent.formatLength(track.length()), css: {'ticks-enabled': track.measureTicksShown}, click: $parent.switchMeasureTicksVisibility.bind($parent)\"></div></td>\n                        <td><div class=\"button-add-track\" title=\"Add track segment\" data-bind=\"click: $parent.addSegmentAndEdit.bind($parent, track)\"></div></td>\n                        <td><div class=\"button-add-point\" title=\"Add point\" data-bind=\"click: $parent.onAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}\"></div></td>\n                        <td><a class=\"track-text-button\" title=\"Actions\" data-bind=\"click: $parent.showTrackMenu.bind($parent)\">&hellip;</a></td>\n                    </tr>\n                </tbody></table>\n                </div>\n                </div>\n            `;\n\n            ko.applyBindings(this, container);\n            // FIXME: add onRemove method and unsubscribe\n            L.DomEvent.addListener(map.getContainer(), 'drop', this.onFileDragDrop, this);\n            L.DomEvent.addListener(map.getContainer(), 'dragover', this.onFileDraging, this);\n            this.menu = new Contextmenu([\n                    {text: 'Copy all tracks to clipboard', callback: this.copyAllTracks.bind(this)},\n                    {text: 'Copy visible tracks to clipboard', callback: this.copyVisibleTracks.bind(this)},\n                    '-',\n                    {text: 'Delete all tracks', callback: this.deleteAllTracks.bind(this)},\n                    {text: 'Delete hidden tracks', callback: this.deleteHiddenTracks.bind(this)}\n                ]\n            );\n            this._markerLayer = new L.Layer.CanvasMarkers(null, {\n                print: true,\n                scaleDependent: true,\n                zIndex: 1000,\n                printTransparent: true\n            }).addTo(map);\n            this._markerLayer.on('markerclick markercontextmenu', this.onMarkerClick, this);\n            map.on('resize', this._setAdaptiveHeight, this);\n            setTimeout(() => this._setAdaptiveHeight(), 0);\n            return container;\n        },\n\n        onFileInputRightClick: function(_, e) {\n            L.DomEvent.stopPropagation(e);\n            return true;\n        },\n\n        _setAdaptiveHeight: function() {\n            const mapHeight = this._map.getSize().y;\n            let maxHeight;\n            maxHeight = (mapHeight\n            - this._container.offsetTop // controls above\n            - (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) //controls below\n            - 105); // margin\n            this.trackListHeight(maxHeight + 'px');\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        onFileDraging: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            e.dataTransfer.dropEffect = 'copy';\n        },\n\n        onFileDragDrop: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            const files  = e.dataTransfer.files;\n            if (files && files.length) {\n                this.loadFilesFromFilesObject(files);\n            }\n        },\n\n        onEnterPressedInInput: function(this_, e) {\n            if (e.keyCode === 13) {\n                this_.loadFilesFromUrl();\n                L.DomEvent.stop(e);\n            } else {\n                return true;\n            }\n        },\n\n        getTrackPolylines: function(track) {\n            return track.feature.getLayers().filter(function(layer) {\n                    return layer instanceof L.Polyline;\n                }\n            )\n        },\n\n        getTrackPoints: function(track) {\n            return track.markers;\n        },\n\n        addNewTrack: function(name) {\n            if (!name) {\n                name = this.url().slice(0, 50);\n                if (!name.length) {\n                    name = 'New track';\n                } else {\n                    this.url('');\n                }\n            }\n            var track = this.addTrack({name: name}),\n                line = this.addTrackSegment(track);\n            this.startEditTrackSegement(track, line);\n            line.startDrawingLine();\n            return track;\n        },\n\n        loadFilesFromFilesObject: function(files) {\n            this.readProgressDone(undefined);\n            this.readProgressRange(1);\n            this.readingFiles(true);\n\n            readFiles(files).then(function(fileDataArray) {\n                    var geodataArray = fileDataArray.map(function(fileData) {\n                            return parseGeoFile(fileData.filename, fileData.data);\n                        }\n                    ).reduce(function(prev, next) {\n                            Array.prototype.push.apply(prev, next);\n                            return prev;\n                        }, []\n                    );\n                    this.addTracksFromGeodataArray(geodataArray);\n                }.bind(this)\n            );\n        },\n\n        loadFilesFromDisk: function() {\n            logging.captureBreadcrumb({message: 'load track from disk'});\n            selectFiles(true).then(this.loadFilesFromFilesObject.bind(this));\n        },\n\n        loadFilesFromUrl: function() {\n            var url = this.url().trim();\n            logging.captureBreadcrumb({message: 'load track from url', data: {url: url}});\n            try {\n                url = decodeURIComponent(url);\n            } catch (e) {\n            }\n            var geodata;\n            if (url.length > 0) {\n                this.readingFiles(true);\n                this.readProgressDone(undefined);\n                this.readProgressRange(1);\n                geodata = parseGeoFile('', url);\n                if (geodata.length === 0 || geodata.length > 1 || geodata[0].error !== 'UNSUPPORTED') {\n                    this.addTracksFromGeodataArray(geodata);\n                } else {\n                    var name = url\n                        .split('#')[0]\n                        .split('?')[0]\n                        .replace(/\\/*$/, '')\n                        .split('/')\n                        .pop();\n                    let url_for_request, xhrOptions, preferNameFromFile;\n                    if (isGpsiesUrl(url)) {\n                        [url_for_request, xhrOptions] = gpsiesXhrOptions(url);\n                        preferNameFromFile = true;\n                    } else {\n                        url_for_request = urlViaCorsProxy(url);\n                        xhrOptions = {responseType: 'binarystring'};\n                        preferNameFromFile = false;\n                    }\n                    fetch(url_for_request, xhrOptions)\n                        .then(function(xhr) {\n                                var geodata = parseGeoFile(name, xhr.responseBinaryText, preferNameFromFile);\n                                this.addTracksFromGeodataArray(geodata);\n                            }.bind(this),\n                            function() {\n                                var geodata = [{name: url, error: 'NETWORK'}];\n                                this.addTracksFromGeodataArray(geodata);\n                            }.bind(this)\n                        );\n                }\n            }\n            this.url('');\n        },\n\n        addTracksFromGeodataArray: function(geodata_array) {\n            let hasData = false;\n            var messages = [];\n            if (geodata_array.length === 0) {\n                messages.push('No tracks loaded');\n            }\n            geodata_array.forEach(function(geodata) {\n                    var data_empty = !((geodata.tracks && geodata.tracks.length) || (geodata.points && geodata.points.length));\n\n                    if (!data_empty) {\n                        if (geodata.tracks) {\n                            geodata.tracks = geodata.tracks.map(function(line) {\n                                    return L.LineUtil.simplifyLatlngs(line, 360 / (1 << 24));\n                                }\n                            );\n                        }\n                        hasData = true;\n                        this.addTrack(geodata);\n                    }\n                    var error_messages = {\n                        'CORRUPT': 'File \"{name}\" is corrupt',\n                        'UNSUPPORTED': 'File \"{name}\" has unsupported format or is badly corrupt',\n                        'NETWORK': 'Could not download file from url \"{name}\"'\n                    };\n                    var message;\n                    if (geodata.error) {\n                        message = error_messages[geodata.error] || geodata.error;\n                        if (data_empty) {\n                            message += ', no data could be loaded';\n                        } else {\n                            message += ', loaded data can be invalid or incomplete';\n                        }\n                    }\n                    if (message) {\n                        message = L.Util.template(message, {name: geodata.name});\n                        messages.push(message);\n                    }\n                }.bind(this)\n            );\n            this.readingFiles(false);\n            if (messages.length) {\n                logging.captureMessage('errors in loaded tracks', {extra: {message: messages.join('\\n')}});\n                notify(messages.join('\\n'));\n            }\n            return hasData;\n        },\n\n\n        onTrackColorChanged: function(track) {\n            var color = this.colors[track.color()];\n            this.getTrackPolylines(track).forEach(\n                function(polyline) {\n                    polyline.setStyle({color: color});\n                }\n            );\n            var markers = this.getTrackPoints(track);\n            markers.forEach(this.setMarkerIcon.bind(this));\n            this._markerLayer.updateMarkers(markers);\n        },\n\n        onTrackVisibilityChanged: function(track) {\n            if (track.visible()) {\n                this.map.addLayer(track.feature);\n                this._markerLayer.addMarkers(track.markers);\n            } else {\n                this.map.removeLayer(track.feature);\n                this.stopPlacingPoint();\n                this._markerLayer.removeMarkers(track.markers);\n            }\n        },\n\n        onTrackLengthChanged: function(track) {\n            const lines = this.getTrackPolylines(track);\n            let length = 0;\n            for (let line of lines) {\n                length += line.getLength();\n            }\n            track.length(length);\n        },\n\n        formatLength: function(x) {\n            var digits = 0;\n            if (x < 10000) {\n                digits = 2;\n            } else if (x < 100000) {\n                digits = 1;\n            }\n            return (x / 1000).toFixed(digits) + ' km';\n        },\n\n        setTrackMeasureTicksVisibility: function(track) {\n            var visible = track.measureTicksShown(),\n                lines = this.getTrackPolylines(track);\n            lines.forEach((line) => line.setMeasureTicksVisible(visible));\n        },\n\n        switchMeasureTicksVisibility: function(track) {\n            track.measureTicksShown(!(track.measureTicksShown()));\n        },\n\n        onColorSelectorClicked: function(track, e) {\n            track._contextmenu.show(e);\n        },\n\n        setViewToTrack: function(track) {\n            var lines = this.getTrackPolylines(track);\n            var points = this.getTrackPoints(track);\n            if (lines.length || points.length) {\n                var bounds = L.latLngBounds([]);\n                lines.forEach(function(l) {\n                        if (l.getLatLngs().length > 1) {\n                            bounds.extend(l.getBounds());\n                        }\n                    }\n                );\n                points.forEach(function(p) {\n                        bounds.extend([p.latlng.lat, p.latlng.lng]);\n                    }\n                );\n                if (bounds.isValid()) {\n                    if (L.Browser.mobile) {\n                        this.map.fitBounds(bounds);\n                    } else {\n                        this.map.flyToBounds(bounds);\n                    }\n                }\n\n            }\n        },\n\n        attachColorSelector: function(track) {\n            var items = this.colors.map(function(color, index) {\n                    return {\n                        text: '<div style=\"display: inline-block; vertical-align: middle; width: 50px; height: 0; border-top: 4px solid ' +\n                        color + '\"></div>',\n                        callback: track.color.bind(null, index)\n                    };\n                }\n            );\n            track._contextmenu = new Contextmenu(items);\n        },\n\n        attachActionsMenu: function(track) {\n            var items = [\n                function() {\n                    return {text: `${track.name()}`, header: true};\n                },\n                '-',\n                {text: 'Rename', callback: this.renameTrack.bind(this, track)},\n                {text: 'Duplicate', callback: this.duplicateTrack.bind(this, track)},\n                {text: 'Reverse', callback: this.reverseTrack.bind(this, track)},\n                {text: 'Show elevation profile', callback: this.showElevationProfileForTrack.bind(this, track)},\n                '-',\n                {text: 'Delete', callback: this.removeTrack.bind(this, track)},\n                '-',\n                {text: 'Save as GPX', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpx, '.gpx')},\n                {text: 'Save as KML', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveKml, '.kml')},\n                {text: 'Copy link to clipboard', callback: this.copyLinkToClipboard.bind(this, track)},\n            ];\n            track._actionsMenu = new Contextmenu(items);\n        },\n\n        addSegmentAndEdit: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            this.stopPlacingPoint();\n            var polyline = this.addTrackSegment(track, []);\n            this.startEditTrackSegement(track, polyline);\n            polyline.startDrawingLine(1);\n        },\n\n        duplicateTrack: function(track) {\n            var segments = [], segment,\n                line,\n                lines = this.getTrackPolylines(track);\n            for (var i = 0; i < lines.length; i++) {\n                segment = [];\n                line = lines[i].getLatLngs();\n                for (var j = 0; j < line.length; j++) {\n                    segment.push([line[j].lat, line[j].lng]);\n                }\n                segments.push(segment);\n            }\n            this.addTrack({name: track.name(), tracks: segments});\n        },\n\n        reverseTrackSegment: function(trackSegment) {\n            trackSegment.stopDrawingLine();\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            latlngs.reverse();\n            var isEdited = (this._editedLine === trackSegment);\n            this.deleteTrackSegment(trackSegment);\n            var newTrackSegment = this.addTrackSegment(trackSegment._parentTrack, latlngs);\n            if (isEdited) {\n                this.startEditTrackSegement(trackSegment._parentTrack, newTrackSegment);\n            }\n        },\n\n        reverseTrack: function(track) {\n            var self = this;\n            this.getTrackPolylines(track).forEach(function(trackSegment) {\n                    self.reverseTrackSegment(trackSegment);\n                }\n            );\n        },\n\n        copyLinkToClipboard: function(track, mouseEvent) {\n            this.stopActiveDraw();\n            var s = this.trackToString(track, true);\n            var url = window.location + '&nktk=' + s;\n            copyToClipboard(url, mouseEvent);\n        },\n\n        saveTrackAsFile: function(track, exporter, extension) {\n            this.stopActiveDraw();\n            var lines = this.getTrackPolylines(track)\n                .map(function(line) {\n                        return line.getLatLngs();\n                    }\n                );\n            var points = this.getTrackPoints(track);\n            var name = track.name(),\n                i = name.lastIndexOf('.');\n            if (i > -1 && i >= name.length - 5) {\n                name = name.slice(0, i);\n            }\n\n            if (lines.length === 0 && points.length === 0) {\n                notify('Track is empty, nothing to save');\n                return;\n            }\n\n            var fileText = exporter(lines, name, points);\n            var filename = name + extension;\n            saveAs(blobFromString(fileText), filename, true);\n        },\n\n        renameTrack: function(track) {\n            var newName = prompt('Enter new name', track.name());\n            if (newName && newName.length) {\n                track.name(newName);\n            }\n        },\n\n        showTrackMenu: function(track, e) {\n            track._actionsMenu.show(e);\n        },\n\n        showMenu: function(e) {\n            this.menu.show(e);\n        },\n\n        stopActiveDraw: function() {\n            if (this._editedLine) {\n                this._editedLine.stopDrawingLine();\n            }\n        },\n\n        stopEditLine: function() {\n            if (this._editedLine) {\n                this.stopLineJoinSelection();\n                this._editedLine.stopEdit();\n                this._editedLine = null;\n            }\n        },\n\n        onTrackSegmentClick: function(track, trackSegment, e) {\n            if (this.isPlacingPoint) {\n                return;\n            }\n            if (this._lineJoinCursor) {\n                L.DomEvent.stopPropagation(e);\n                this.joinTrackSegments(trackSegment);\n            } else {\n                this.startEditTrackSegement(track, trackSegment);\n                L.DomEvent.stopPropagation(e);\n            }\n        },\n\n        startEditTrackSegement: function(track, polyline) {\n            if (this._editedLine && this._editedLine !== polyline) {\n                this.stopEditLine();\n            }\n            polyline.startEdit();\n            this._editedLine = polyline;\n            polyline.once('editend', function(e) {\n                    setTimeout(this.onLineEditEnd.bind(this, e, track, polyline), 0);\n                }.bind(this)\n            );\n            this.fire('startedit');\n        },\n\n        onAddPointClicked: function(track) {\n            if (this.trackAddingPoint() === track) {\n                this.stopPlacingPoint();\n            } else {\n                this.beginPointCreate(track);\n            }\n        },\n\n        _beginPointEdit: function() {\n            this.stopPlacingPoint();\n            this.stopEditLine();\n            L.DomUtil.addClass(this._map._container, 'leaflet-point-placing');\n            this.isPlacingPoint = true;\n            L.DomEvent.on(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this.fire('startedit');\n        },\n\n        beginPointMove: function(marker) {\n            this._beginPointEdit();\n            this._movingMarker = marker;\n            this.map.on('click', this.movePoint, this);\n        },\n\n        beginPointCreate: function(track) {\n            this._beginPointEdit();\n            this.map.on('click', this.createNewPoint, this);\n            this.trackAddingPoint(track);\n        },\n\n        movePoint: function(e) {\n            const marker = this._movingMarker;\n            this._markerLayer.setMarkerPosition(marker, e.latlng);\n            this.stopPlacingPoint();\n        },\n\n        createNewPoint: function(e) {\n            if (!this.isPlacingPoint) {\n                return;\n            }\n            const parentTrack = this.trackAddingPoint();\n            parentTrack._pointAutoInc += 1;\n            let name = parentTrack._pointAutoInc.toString();\n            while (name.length < 3) {\n                name = '0' + name;\n            }\n            const marker = this.addPoint(parentTrack, {name: name, lat: e.latlng.lat, lng: e.latlng.lng});\n            this._markerLayer.addMarker(marker);\n            // we need to show prompt after marker is dispalyed;\n            // grid layer is updated in setTimout(..., 0)after adding marker\n            // it is better to do it on 'load' event but when it is fired marker is not yet displayed\n            setTimeout(() => {\n                this.renamePoint(marker);\n                this.beginPointCreate(parentTrack);\n            }, 10);\n        },\n\n        stopPlacingPointOnEscPressed: function(e) {\n            if (e.keyCode === 27) {\n                this.stopPlacingPoint();\n            }\n        },\n\n        stopPlacingPoint: function() {\n            this.isPlacingPoint = false;\n            this.trackAddingPoint(null);\n            L.DomUtil.removeClass(this._map._container, 'leaflet-point-placing');\n            L.DomEvent.off(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this.map.off('click', this.createNewPoint, this);\n            this.map.off('click', this.movePoint, this);\n        },\n\n        joinTrackSegments: function(newSegment) {\n            this.stopLineJoinSelection();\n            var originalSegment = this._editedLine;\n            var latlngs = originalSegment.getLatLngs(),\n                latngs2 = newSegment.getLatLngs();\n            if (this._lineJoinToStart === this._lineJoinFromStart) {\n                latngs2.reverse();\n            }\n            if (this._lineJoinFromStart) {\n                latlngs.unshift.apply(latlngs, latngs2);\n            } else {\n                latlngs.push.apply(latlngs, latngs2);\n            }\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            this.deleteTrackSegment(originalSegment);\n            if (originalSegment._parentTrack === newSegment._parentTrack) {\n                this.deleteTrackSegment(newSegment);\n            }\n            this.addTrackSegment(originalSegment._parentTrack, latlngs);\n\n        },\n\n        onLineEditEnd: function(e, track, polyline) {\n            if (polyline.getLatLngs().length < 2) {\n                track.feature.removeLayer(polyline);\n            }\n            this.onTrackLengthChanged(track);\n            if (this._editedLine === polyline) {\n                this._editedLine = null;\n            }\n            if (!this.getTrackPolylines(track).length && !this.getTrackPoints(track).length && e.userCancelled) {\n                this.removeTrack(track);\n            }\n        },\n\n        addTrackSegment: function(track, sourcePoints) {\n            var polyline = new TrackSegment(sourcePoints || [], {\n                    color: this.colors[track.color()],\n                    print: true\n                }\n            );\n            polyline._parentTrack = track;\n            polyline.setMeasureTicksVisible(track.measureTicksShown());\n            polyline.on('click', this.onTrackSegmentClick.bind(this, track, polyline));\n            polyline.on('nodeschanged', this.onTrackLengthChanged.bind(this, track));\n            polyline.on('noderightclick', this.onNodeRightClickShowMenu, this);\n            polyline.on('segmentrightclick', this.onSegmentRightClickShowMenu, this);\n            polyline.on('mousemove', this.onMouseMoveOnSegmentUpdateLineJoinCursor, this);\n\n            //polyline.on('editingstart', polyline.setMeasureTicksVisible.bind(polyline, false));\n            //polyline.on('editingend', this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.feature.addLayer(polyline);\n            return polyline;\n        },\n\n        onNodeRightClickShowMenu: function(e) {\n            var items = [];\n            if (e.nodeIndex > 0 && e.nodeIndex < e.line.getLatLngs().length - 1) {\n                items.push({\n                        text: 'Cut',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, null)\n                    }\n                );\n            }\n            if (e.nodeIndex === 0 || e.nodeIndex === e.line.getLatLngs().length - 1) {\n                items.push({text: 'Join', callback: this.startLineJoinSelection.bind(this, e)});\n            }\n            items.push({text: 'Reverse', callback: this.reverseTrackSegment.bind(this, e.line)});\n            items.push({text: 'Delete segment', callback: this.deleteTrackSegment.bind(this, e.line)});\n            items.push({text: 'New track from segment', callback: this.newTrackFromSegment.bind(this, e.line)});\n            items.push({\n                    text: 'Show elevation profile for segment',\n                    callback: this.showElevationProfileForSegment.bind(this, e.line)\n                }\n            );\n\n            var menu = new Contextmenu(items);\n            menu.show(e.mouseEvent);\n\n        },\n\n        onSegmentRightClickShowMenu: function(e) {\n            var menu = new Contextmenu([\n                    {\n                        text: 'Cut',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, e.mouseEvent.latlng)\n                    },\n                    {text: 'Reverse', callback: this.reverseTrackSegment.bind(this, e.line)},\n                    {text: 'Delete segment', callback: this.deleteTrackSegment.bind(this, e.line)},\n                    {text: 'New track from segment', callback: this.newTrackFromSegment.bind(this, e.line)},\n                    {\n                        text: 'Show elevation profile for segment',\n                        callback: this.showElevationProfileForSegment.bind(this, e.line)\n                    }\n                ]\n            );\n            menu.show(e.mouseEvent);\n        },\n\n        startLineJoinSelection: function(e) {\n            this.stopLineJoinSelection();\n            this._editedLine.stopDrawingLine();\n            this._lineJoinFromStart = (e.nodeIndex === 0);\n            var p = this._editedLine.getLatLngs()[e.nodeIndex];\n            p = [p.lat, p.lng];\n            this._lineJoinCursor = L.polyline([p, e.mouseEvent.latlng], {\n                    interactive: false,\n                    color: 'red',\n                    weight: 1.5,\n                    opacity: 1,\n                    dashArray: '7,7'\n                }\n            )\n                .addTo(this.map);\n            this.map.on('mousemove', this.onMouseMoveUpdateLineJoinCursor, this);\n            this.map.on('click', this.stopLineJoinSelection, this);\n            L.DomUtil.addClass(this.map.getContainer(), 'join-line-selecting');\n            L.DomEvent.on(document, 'keyup', this.onEscPressedStopLineJoinSelection, this);\n            var self = this;\n            setTimeout(function() {\n                    self._editedLine.preventStopEdit = true;\n                }, 0\n            );\n        },\n\n        onMouseMoveUpdateLineJoinCursor: function(e) {\n            if (this._lineJoinCursor) {\n                this._lineJoinCursor.getLatLngs().splice(1, 1, e.latlng);\n                this._lineJoinCursor.redraw();\n                this._lineJoinCursor.setStyle({color: 'red'});\n            }\n        },\n\n        onMouseMoveOnSegmentUpdateLineJoinCursor: function(e) {\n            if (!this._lineJoinCursor) {\n                return;\n            }\n            var trackSegment = e.target,\n                latlngs = trackSegment.getLatLngs(),\n                distToStart = e.latlng.distanceTo(latlngs[0]),\n                distToEnd = e.latlng.distanceTo(latlngs[latlngs.length - 1]);\n            this._lineJoinToStart = (distToStart < distToEnd);\n            var cursorEnd = this._lineJoinToStart ? latlngs[0] : latlngs[latlngs.length - 1];\n            this._lineJoinCursor.setStyle({color: 'green'});\n            this._lineJoinCursor.getLatLngs().splice(1, 1, cursorEnd);\n            this._lineJoinCursor.redraw();\n            L.DomEvent.stopPropagation(e);\n        },\n\n        onEscPressedStopLineJoinSelection: function(e) {\n            if ('input' === e.target.tagName.toLowerCase()) {\n                return;\n            }\n            switch (e.keyCode) {\n                case 27:\n                case 13:\n                    this.stopLineJoinSelection();\n                    L.DomEvent.stop(e);\n                    break;\n                default:\n            }\n        },\n\n        stopLineJoinSelection: function() {\n            if (this._lineJoinCursor) {\n                this.map.off('mousemove', this.onMouseMoveUpdateLineJoinCursor, this);\n                this.map.off('click', this.stopLineJoinSelection, this);\n                L.DomUtil.removeClass(this.map.getContainer(), 'join-line-selecting');\n                L.DomEvent.off(document, 'keyup', this.onEscPressedStopLineJoinSelection, this);\n                this.map.removeLayer(this._lineJoinCursor);\n                this._lineJoinCursor = null;\n                var self = this;\n                setTimeout(function() {\n                        self._editedLine.preventStopEdit = false;\n                    }, 0\n                );\n            }\n        },\n\n        splitTrackSegment: function(trackSegment, nodeIndex, latlng) {\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            var latlngs1 = latlngs.slice(0, nodeIndex + 1),\n                latlngs2 = latlngs.slice(nodeIndex + 1);\n            if (latlng) {\n                var p = this.map.project(latlng),\n                    p1 = this.map.project(latlngs[nodeIndex]),\n                    p2 = this.map.project(latlngs[nodeIndex + 1]),\n                    pnew = L.LineUtil.closestPointOnSegment(p, p1, p2);\n                latlng = this.map.unproject(pnew);\n                latlngs1.push(latlng);\n                latlng = [latlng.lat, latlng.lng];\n            } else {\n                latlng = latlngs[nodeIndex];\n            }\n            latlngs2.unshift(latlng);\n            this.deleteTrackSegment(trackSegment);\n            var segment1 = this.addTrackSegment(trackSegment._parentTrack, latlngs1);\n            this.addTrackSegment(trackSegment._parentTrack, latlngs2);\n            this.startEditTrackSegement(trackSegment._parentTrack, segment1);\n        },\n\n        deleteTrackSegment: function(trackSegment) {\n            trackSegment._parentTrack.feature.removeLayer(trackSegment);\n        },\n\n        newTrackFromSegment: function(trackSegment) {\n            var srcNodes = trackSegment.getLatLngs(),\n                newNodes = [],\n                i;\n            for (i = 0; i < srcNodes.length; i++) {\n                newNodes.push([srcNodes[i].lat, srcNodes[i].lng]);\n            }\n            this.addTrack({name: \"New track\", tracks: [newNodes]});\n        },\n\n        addTrack: function(geodata) {\n            var color;\n            color = geodata.color;\n            if (!(color >= 0 && color < this.colors.length)) {\n                color = this._lastTrackColor;\n                this._lastTrackColor = (this._lastTrackColor + 1) % this.colors.length;\n            }\n            var track = {\n                name: ko.observable(geodata.name),\n                color: ko.observable(color),\n                visible: ko.observable(!geodata.trackHidden),\n                length: ko.observable('empty'),\n                measureTicksShown: ko.observable(geodata.measureTicksShown || false),\n                feature: L.featureGroup([]),\n                _pointAutoInc: 0,\n                markers: []\n            };\n            (geodata.tracks || []).forEach(this.addTrackSegment.bind(this, track));\n            (geodata.points || []).forEach(this.addPoint.bind(this, track));\n\n            this.tracks.push(track);\n\n            track.visible.subscribe(this.onTrackVisibilityChanged.bind(this, track));\n            track.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.color.subscribe(this.onTrackColorChanged.bind(this, track));\n\n            //this.onTrackColorChanged(track);\n            this.onTrackVisibilityChanged(track);\n            this.attachColorSelector(track);\n            this.attachActionsMenu(track);\n            this.onTrackLengthChanged(track);\n            return track;\n        },\n\n\n        setMarkerIcon: function(marker) {\n            var symbol = 'marker',\n                colorInd = marker._parentTrack.color() + 1,\n                className = 'symbol-' + symbol + '-' + colorInd;\n            marker.icon = iconFromBackgroundImage('track-waypoint ' + className);\n        },\n\n        setMarkerLabel: function(marker, label) {\n            if (label.match(/\\d{3,}/)) {\n                var n = parseInt(label, 10);\n                marker._parentTrack._pointAutoInc =\n                    Math.max(n, marker._parentTrack._pointAutoInc | 0);\n            }\n            marker.label = label;\n        },\n\n        addPoint: function(track, srcPoint) {\n            var marker = {\n                latlng: L.latLng([srcPoint.lat, srcPoint.lng]),\n                _parentTrack: track,\n            };\n            this.setMarkerIcon(marker);\n            this.setMarkerLabel(marker, srcPoint.name);\n            track.markers.push(marker);\n            marker._parentTrack = track;\n            return marker;\n        },\n\n        onMarkerClick: function(e) {\n            new Contextmenu([\n                    {text: 'Rename', callback: this.renamePoint.bind(this, e.marker)},\n                    {text: 'Move', callback: this.beginPointMove.bind(this, e.marker)},\n                    {text: 'Delete', callback: this.removePoint.bind(this, e.marker)},\n                ]\n            ).show(e);\n        },\n\n        removePoint: function(marker) {\n            this.stopPlacingPoint();\n            this._markerLayer.removeMarker(marker);\n            const markers = marker._parentTrack.markers;\n            const i = markers.indexOf(marker);\n            markers.splice(i, 1);\n        },\n\n        renamePoint: function(marker) {\n            this.stopPlacingPoint();\n            var newLabel = prompt('New point name', marker.label);\n            if (newLabel !== null) {\n                this.setMarkerLabel(marker, newLabel);\n                this._markerLayer.updateMarker(marker);\n            }\n        },\n\n        removeTrack: function(track) {\n            track.visible(false);\n            this.tracks.remove(track);\n            this.stopPlacingPoint();\n        },\n\n        deleteAllTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i;\n            for (i = 0; i < tracks.length; i++) {\n                this.removeTrack(tracks[i]);\n            }\n        },\n\n        deleteHiddenTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i, track;\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if (!track.visible()) {\n                    this.removeTrack(tracks[i]);\n                }\n            }\n        },\n\n        trackToString: function(track, forceVisible) {\n            var lines = this.getTrackPolylines(track).map(function(line) {\n                    var points = line.getLatLngs();\n                    points = L.LineUtil.simplifyLatlngs(points, 360 / (1 << 24));\n                    return points;\n                }\n            );\n            return geoExporters.saveToString(lines, track.name(), track.color(), track.measureTicksShown(),\n                this.getTrackPoints(track), forceVisible ? false : !track.visible()\n            );\n        },\n\n        copyAllTracks: function(mouseEvent) {\n            this.stopActiveDraw();\n            var tracks = this.tracks(),\n                serialized = [],\n                i, track, s;\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                s = this.trackToString(track);\n                serialized.push(s);\n            }\n            var url = window.location + '&nktk=' + serialized.join('/');\n            copyToClipboard(url, mouseEvent);\n        },\n\n        copyVisibleTracks: function(mouseEvent) {\n            this.stopActiveDraw();\n            var tracks = this.tracks(),\n                serialized = [],\n                i, track, s;\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if (track.visible()) {\n                    s = this.trackToString(track);\n                    serialized.push(s);\n                }\n            }\n            var url = window.location + '&nktk=' + serialized.join('/');\n            copyToClipboard(url, mouseEvent);\n        },\n\n        exportTracks: function(minTicksIntervalMeters) {\n            var self = this;\n            return this.tracks()\n                .filter(function(track) {\n                        return self.getTrackPolylines(track).length;\n                    }\n                )\n                .map(function(track) {\n                        var capturedTrack = track.feature.getLayers().map(function(pl) {\n                                return pl.getLatLngs().map(function(ll) {\n                                        return [ll.lat, ll.lng];\n                                    }\n                                );\n                            }\n                        );\n                        var bounds = track.feature.getBounds();\n                        var capturedBounds = [[bounds.getSouth(), bounds.getWest()], [bounds.getNorth(), bounds.getEast()]];\n                        return {\n                            color: track.color(),\n                            visible: track.visible(),\n                            segments: capturedTrack,\n                            bounds: capturedBounds,\n                            measureTicksShown: track.measureTicksShown(),\n                            measureTicks: [].concat.apply([], track.feature.getLayers().map(function(pl) {\n                                    return pl.getTicksPositions(minTicksIntervalMeters);\n                                }\n                                )\n                            )\n                        };\n                    }\n                );\n        },\n\n        showElevationProfileForSegment: function(line) {\n            this.hideElevationProfile();\n            this.stopEditLine();\n            this._elevationControl = new ElevationProfile(this._map, line.getLatLngs(), {\n                    samplingInterval: calcSamplingInterval(line.getLength())\n                }\n            );\n            this.fire('elevation-shown');\n        },\n\n        showElevationProfileForTrack: function(track) {\n            var lines = this.getTrackPolylines(track),\n                path = [],\n                i;\n            for (i = 0; i < lines.length; i++) {\n                if (lines[i] === this._editedLine) {\n                    this.stopEditLine();\n                }\n                path = path.concat(lines[i].getLatLngs());\n            }\n            this.hideElevationProfile();\n            this._elevationControl = new ElevationProfile(this._map, path, {\n                    samplingInterval: calcSamplingInterval(new L.MeasuredLine(path).getLength())\n                }\n            );\n            this.fire('elevation-shown');\n        },\n\n        hideElevationProfile: function() {\n            if (this._elevationControl) {\n                this._elevationControl.removeFrom(this._map);\n            }\n            this._elevationControl = null;\n        },\n\n        hasTracks: function() {\n            return !!this.tracks().length;\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.track-list/track-list.js\n **/","import {Cache} from 'lib/cache';\nimport {XHRQueue} from 'lib/xhr-promise';\n\n\nclass TiledDataLoader {\n    constructor(cacheSize = 50) {\n        this._cache = new Cache(cacheSize);\n        this._pendingRequests = {};\n        this._xhrQueue = new XHRQueue();\n    }\n\n    makeTileKey(coords) {\n        return `${coords.x}:${coords.y}:${coords.z}`;\n    }\n\n    getFromCache(dataTileCoords) {\n        const key = this.makeTileKey(dataTileCoords);\n        const res = this._cache.get(key);\n        res['coords'] = dataTileCoords;\n        return res;\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        return Object.assign({}, layerTileCoords);\n    }\n\n    makeRequestData(dataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     url,\n        //     options\n        // }\n    }\n\n    processResponse(xhr, originalDataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     tileData,\n        //     coords\n        // }\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        if (layerTileCoords.x === dataTileCoords.x &&\n            layerTileCoords.y === dataTileCoords.y &&\n            layerTileCoords.z === dataTileCoords.z) {\n            return null;\n        }\n        if (dataTileCoords.z > layerTileCoords.z) {\n            const multiplier = 1 << (dataTileCoords.z - layerTileCoords.z);\n            return {multiplier: 1 / multiplier, offsetX: 0, offsetY: 0}\n        } else {\n            const multiplier = 1 << (layerTileCoords.z - dataTileCoords.z);\n            return {\n                multiplier,\n                offsetX: (layerTileCoords.x - dataTileCoords.x * multiplier),\n                offsetY: (layerTileCoords.y - dataTileCoords.y * multiplier)\n            }\n        }\n    }\n\n    requestTileData(layerTileCoords) {\n        const dataTileCoords = this.layerTileToDataTileCoords(layerTileCoords);\n        let res = this.getFromCache(dataTileCoords);\n        if (res.found) {\n            return {\n                dataPromise: Promise.resolve({\n                        coords: res.coords,\n                        tileData: res.value,\n                        adjustment: this.calcAdjustment(layerTileCoords, res.coords)\n                    }\n                ),\n                abortLoading: () => {\n                }\n            }\n        }\n\n        const dataTileKey = this.makeTileKey(dataTileCoords);\n        if (!(dataTileKey in this._pendingRequests)) {\n            const {url, options} = this.makeRequestData(dataTileCoords);\n            const fetchPromise = this._xhrQueue.put(url, options);\n            // TODO: handle errors\n            const dataPromise = fetchPromise\n                .then((xhr) => this.processResponse(xhr, dataTileCoords))\n                .then(({tileData, coords}) => {\n                        this._cache.put(this.makeTileKey(coords), tileData);\n                        delete this._pendingRequests[dataTileKey];\n                        return {\n                            tileData,\n                            coords\n                        };\n                    }\n                );\n            const pendingRequest = this._pendingRequests[dataTileKey] = {\n                dataPromise,\n                refCount: 0\n            };\n            pendingRequest.abortLoading = () => {\n                pendingRequest.refCount -= 1;\n                if (pendingRequest.refCount < 1) {\n                    fetchPromise.abort();\n                    delete this._pendingRequests[dataTileKey];\n                }\n            };\n        }\n\n        let pendingRequest = this._pendingRequests[dataTileKey];\n        pendingRequest.refCount += 1;\n\n\n        return {\n            dataPromise: pendingRequest.dataPromise.then((data) => {\n                    return {\n                        coords: data.coords,\n                        tileData: data.tileData,\n                        adjustment: this.calcAdjustment(layerTileCoords, data.coords)\n                    };\n                }\n            ),\n            abortLoading: () => pendingRequest.abortLoading()\n        }\n\n    }\n}\n\nexport {TiledDataLoader};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/tiled-data-loader/index.js\n **/","import loadScript from 'load-script';\nimport config from 'config';\n\nlet _google = null;\nlet _pending = null;\n\nfunction getGoogle() {\n    if (_google) {\n        return Promise.resolve(_google);\n    }\n    if (!_pending) {\n        _pending = new Promise((resolve, reject) => {\n                loadScript(config.googleApiUrl, (error) => {\n                        if (error) {\n                            reject(error)\n                        }\n                        _google = window.google;\n                        resolve(_google);\n                    }\n                );\n\n            }\n        );\n    }\n    return _pending;\n}\n\n\nexport default getGoogle;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/googleMapsApi/index.js\n **/","function cached(f) {\n    var cache = {};\n    return function(arg) {\n        if (!(arg in cache)) {\n            cache[arg] = f(arg);\n        }\n        return cache[arg];\n    }\n}\n\nfunction iconFromBackgroundImage(className) {\n    const container = document.createElement('div');\n    container.style.position = 'absolute';\n    document.body.appendChild(container);\n    const el = document.createElement('div');\n    el.className = className;\n    container.appendChild(el);\n    const st = window.getComputedStyle(el),\n        url = st.backgroundImage.replace(/^url\\(\"?/, '').replace(/\"?\\)$/, '');\n    let icon = {'url': url, 'center': [-el.offsetLeft, -el.offsetTop]};\n    document.body.removeChild(container);\n    container.removeChild(el);\n    return icon;\n}\n\nexport default cached(iconFromBackgroundImage);\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/iconFromBackgroundImage/index.js\n **/","import ko from 'vendored/knockout';\nimport './style.css';\nimport 'lib/controls-styles/controls-styles.css';\n\nko.components.register('progress-indicator', {\n    template:   `\n        <div class=\"ko-progress-unknown icon-spinner-nuclear\" data-bind=\"visible: progress() === undefined\"></div>\n        <div class=\"ko-progress\" data-bind=\"visible: progress() !== undefined\">\n            <div class=\"ko-progress-bkg\">\n                <div class=\"ko-progress-bar\"  data-bind=\"style: {width: progress() + '%'}\"></div>\n            </div>\n        </div>`,\n    viewModel: function(params) {\n        this.progress = ko.pureComputed(function() {\n            var range = params.progressRange(),\n                done = params.progressDone();\n            return done === undefined ? undefined : done * 100 / range;\n        });\n    }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/knockout.component.progress/progress.js\n **/","import L from 'leaflet';\nimport './elevation-profile.css';\nimport {fetch} from 'lib/xhr-promise';\nimport config from 'config';\nimport 'lib/leaflet.control.commons';\nimport {notify} from 'lib/notifications';\nimport logging from 'lib/logging';\n\nfunction calcSamplingInterval(length) {\n    var targetPointsN = 2000;\n    var maxPointsN = 9999;\n    var samplingIntgerval = length / targetPointsN;\n    if (samplingIntgerval < 10) {\n        samplingIntgerval = 10;\n    }\n    if (samplingIntgerval > 50) {\n        samplingIntgerval = 50;\n    }\n    if (length / samplingIntgerval > maxPointsN) {\n        samplingIntgerval = length / maxPointsN;\n    }\n    return samplingIntgerval;\n}\n\nfunction createSvg(tagName, attributes, parent) {\n    var element = document.createElementNS('http://www.w3.org/2000/svg', tagName);\n    if (attributes) {\n        var keys = Object.keys(attributes),\n            key, value;\n        for (var i = 0; i < keys.length; i++) {\n            key = keys[i];\n            value = attributes[key];\n            element.setAttribute(key, value);\n        }\n    }\n    if (parent) {\n        parent.appendChild(element);\n    }\n    return element;\n}\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    //FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\n\nfunction gradientToAngle(g) {\n    return Math.round(Math.atan(g) * 180 / Math.PI);\n}\n\nfunction pathRegularSamples(latlngs, step) {\n    if (!latlngs.length) {\n        return [];\n    }\n    var samples = [],\n        lastSampleDist = 0,\n        lastPointDistance = 0,\n        nextPointDistance = 0,\n        segmentLength, i;\n\n    samples.push(latlngs[0]);\n    for (i = 1; i < latlngs.length; i++) {\n        segmentLength = latlngs[i].distanceTo(latlngs[i - 1]);\n        nextPointDistance = lastPointDistance + segmentLength;\n        if (nextPointDistance >= lastSampleDist + step) {\n            while (lastSampleDist + step <= nextPointDistance) {\n                lastSampleDist += step;\n                samples.push(\n                    pointOnSegmentAtDistance(latlngs[i - 1], latlngs[i], lastSampleDist - lastPointDistance)\n                );\n            }\n        }\n        lastPointDistance = nextPointDistance;\n    }\n    if (samples.length < 2) {\n        samples.push(latlngs[latlngs.length - 1]);\n    }\n    return samples;\n}\n\nfunction offestFromEvent(e) {\n    if (e.offsetX === undefined) {\n        var rect = e.target.getBoundingClientRect();\n        return {\n            offsetX: e.clientX - rect.left,\n            offestY: e.clientY - rect.top\n        }\n    } else {\n        return {\n            offsetX: e.offsetX,\n            offestY: e.offsetY\n        }\n    }\n}\n\nfunction movementFromEvents(e1, e2) {\n    return {\n        movementX: e2.clientX - e1.clientX,\n        movementY: e2.clientY - e1.clientY\n    }\n}\n\nvar DragEvents = L.Class.extend({\n        options: {\n            dragTolerance: 2,\n            dragButtons: [0]\n        },\n\n        includes: L.Mixin.Events,\n\n        initialize: function(eventsSource, eventsTarget, options) {\n            options = L.setOptions(this, options);\n            if (eventsTarget) {\n                this.eventsTarget = eventsTarget;\n            } else {\n                this.eventsTarget = this;\n            }\n            this.dragStartPos = [];\n            this.prevEvent = [];\n            this.isDragging = [];\n\n            L.DomEvent.on(eventsSource, 'mousemove', this.onMouseMove, this);\n            L.DomEvent.on(eventsSource, 'mouseup', this.onMouseUp, this);\n            L.DomEvent.on(eventsSource, 'mousedown', this.onMouseDown, this);\n            L.DomEvent.on(eventsSource, 'mouseleave', this.onMouseLeave, this);\n        },\n\n        onMouseDown: function(e) {\n            if (this.options.dragButtons.includes(e.button)) {\n                e._offset = offestFromEvent(e);\n                this.dragStartPos[e.button] = e;\n                this.prevEvent[e.button] = e;\n                L.DomUtil.disableImageDrag();\n                L.DomUtil.disableTextSelection();\n            }\n        },\n\n        onMouseUp: function(e) {\n            L.DomUtil.enableImageDrag();\n            L.DomUtil.enableTextSelection();\n\n            if (this.options.dragButtons.includes(e.button)) {\n                this.dragStartPos[e.button] = null;\n                if (this.isDragging[e.button]) {\n                    this.isDragging[e.button] = false;\n                    this.fire('dragend', L.extend({dragButton: e.button, origEvent: e},\n                        offestFromEvent(e), movementFromEvents(this.prevEvent[e.button], e)\n                        )\n                    );\n                } else {\n                    this.fire('click', L.extend({dragButton: e.button, origEvent: e},\n                        offestFromEvent(e)\n                        )\n                    );\n                }\n            }\n        },\n\n        onMouseMove: function(e) {\n            var i, button, self = this;\n\n            function exceedsTolerance(button) {\n                var tolerance = self.options.dragTolerance;\n                return Math.abs(e.clientX - self.dragStartPos[button].clientX) > tolerance ||\n                    Math.abs(e.clientY - self.dragStartPos[button].clientY) > tolerance;\n            }\n\n            var dragButtons = this.options.dragButtons;\n            for (i = 0; i < dragButtons.length; i++) {\n                button = dragButtons[i];\n                if (this.isDragging[button]) {\n                    this.eventsTarget.fire('drag', L.extend({dragButton: button, origEvent: e},\n                        offestFromEvent(e), movementFromEvents(this.prevEvent[button], e)\n                        )\n                    );\n                } else if (this.dragStartPos[button] && exceedsTolerance(button)) {\n                    this.isDragging[button] = true;\n                    this.eventsTarget.fire('dragstart', L.extend(\n                        {dragButton: button, origEvent: this.dragStartPos[button]},\n                        this.dragStartPos[button]._offset\n                        )\n                    );\n                    this.eventsTarget.fire('drag', L.extend({\n                            dragButton: button,\n                            origEvent: e,\n                            startEvent: self.dragStartPos[button]\n                        }, offestFromEvent(e), movementFromEvents(this.prevEvent[button], e)\n                        )\n                    );\n                }\n                this.prevEvent[button] = e;\n            }\n        },\n\n        onMouseLeave: function(e) {\n            var i, button;\n            var dragButtons = this.options.dragButtons;\n            for (i = 0; i < dragButtons.length; i++) {\n                button = dragButtons[i];\n                if (this.isDragging[button]) {\n                    this.isDragging[button] = false;\n                    this.fire('dragend', L.extend({dragButton: button, origEvent: e},\n                        offestFromEvent(e), movementFromEvents(this.prevEvent[button], e)\n                        )\n                    );\n                }\n            }\n            this.dragStartPos = {};\n        }\n    }\n);\n\nconst ElevationProfile = L.Class.extend({\n        options: {\n            elevationsServer: config.elevationsServer,\n            samplingInterval: 50,\n            sightLine: false\n        },\n\n        includes: L.Mixin.Events,\n\n        initialize: function(map, latlngs, options) {\n            L.setOptions(this, options);\n            this.path = latlngs;\n            var samples = this.samples = pathRegularSamples(this.path, this.options.samplingInterval);\n            if (!samples.length) {\n                notify('Track is empty');\n                return;\n            }\n            var self = this;\n            this.horizZoom = 1;\n            this.dragStart = null;\n            this._getElevation(samples)\n                .then(function(values) {\n                        self.values = values;\n                        self._addTo(map);\n                    }\n                )\n                .catch((e) => {\n                    logging.captureException(e, {extra: {description: 'while getting elevation'}});\n                    notify(`Failed to get elevation data: ${e.message}`);\n                    self._addTo(map);\n                });\n            this.values = null;\n\n        },\n\n        _addTo: function(map) {\n            this._map = map;\n            var container = this._container = L.DomUtil.create('div', 'elevation-profile-container');\n            L.Control.prototype._stopContainerEvents.call(this);\n            this._map._controlContainer.appendChild(container);\n            this.setupContainerLayout();\n            this.updateGraph();\n            this.trackMarker = L.marker([1000, 0], {clickable: false, icon: L.divIcon()});\n            this.polyline = L.polyline(this.path, {weight: 30, opacity: 0}).addTo(map);\n            this.polyline.on('mousemove', this.onLineMouseMove, this);\n            this.polyline.on('mouseover', this.onLineMouseEnter, this);\n            this.polyline.on('mouseout', this.onLineMouseLeave, this);\n            this.polyLineSelection = L.polyline([], {weight: 20, opacity: .5, color: 'yellow', lineCap: 'butt'});\n            return this;\n        },\n\n        setupContainerLayout: function() {\n            var horizZoom = this.horizZoom = 1;\n            var container = this._container;\n            this.propsContainer = L.DomUtil.create('div', 'elevation-profile-properties', container);\n            this.leftAxisLables = L.DomUtil.create('div', 'elevation-profile-left-axis', container);\n            this.closeButton = L.DomUtil.create('div', 'elevation-profile-close', container);\n            L.DomEvent.on(this.closeButton, 'click', this.onCloseButtonClick, this);\n            this.drawingContainer = L.DomUtil.create('div', 'elevation-profile-drawingContainer', container);\n            this.graphCursor = L.DomUtil.create('div', 'elevation-profile-cursor elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            this.graphCursorLabel =\n                L.DomUtil.create('div', 'elevation-profile-cursor-label elevation-profile-cursor-hidden',\n                    this.drawingContainer\n                );\n            this.graphSelection = L.DomUtil.create('div', 'elevation-profile-selection elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            var svgWidth = this.svgWidth = this.drawingContainer.clientWidth * horizZoom,\n                svgHeight = this.svgHeight = this.drawingContainer.clientHeight;\n            var svg = this.svg = createSvg('svg', {width: svgWidth, height: svgHeight}, this.drawingContainer);\n            L.DomEvent.on(svg, 'mousemove', this.onSvgMouseMove, this);\n            L.DomEvent.on(svg, 'mouseenter', this.onSvgEnter, this);\n            L.DomEvent.on(svg, 'mouseleave', this.onSvgLeave, this);\n            L.DomEvent.on(svg, 'mousewheel', this.onSvgMouseWheel, this);\n            this.svgDragEvents = new DragEvents(this.drawingContainer, null, {dragButtons: [0, 2]});\n            this.svgDragEvents.on('dragstart', this.onSvgDragStart, this);\n            this.svgDragEvents.on('dragend', this.onSvgDragEnd, this);\n            this.svgDragEvents.on('drag', this.onSvgDrag, this);\n            this.svgDragEvents.on('click', this.onSvgClick, this);\n            L.DomEvent.on(svg, 'dblclick', this.onSvgDblClick, this);\n        },\n\n        removeFrom: function(map) {\n            if (this.abortLoading) {\n                this.abortLoading();\n            }\n            if (!this._map) {\n                return;\n            }\n            this._map._controlContainer.removeChild(this._container);\n            map.removeLayer(this.polyline);\n            map.removeLayer(this.trackMarker);\n            map.removeLayer(this.polyLineSelection);\n            this._map = null;\n            this.fire('remove');\n            return this;\n        },\n\n        onSvgDragStart: function(e) {\n            if (e.dragButton === 0) {\n                // FIXME: restore hiding when we make display of selection on map\n                // this.cursorHide();\n                this.polyLineSelection.addTo(this._map).bringToBack();\n                this.dragStart = e.offsetX;\n            }\n        },\n\n        xToIndex: function(x) {\n            return x / (this.svgWidth - 1) * (this.values.length - 1);\n        },\n\n        updateGraphSelection: function(e) {\n            if (this.dragStart === null) {\n                return;\n            }\n            var selStart, selEnd;\n            if (e) {\n                var x = e.offsetX;\n                selStart = Math.min(x, this.dragStart);\n                selEnd = Math.max(x, this.dragStart);\n                this.selStartInd = Math.round(this.xToIndex(selStart));\n                this.selEndInd = Math.round(this.xToIndex(selEnd));\n\n                if (this.selStartInd < 0) {\n                    this.selStartInd = 0;\n                }\n                if (this.selEndInd > this.values.length - 1) {\n                    this.selEndInd = this.values.length - 1;\n                }\n\n            } else {\n                selStart = this.selStartInd * (this.svgWidth - 1) / (this.values.length - 1);\n                selEnd = this.selEndInd * (this.svgWidth - 1) / (this.values.length - 1);\n            }\n            this.graphSelection.style.left = selStart + 'px';\n            this.graphSelection.style.width = (selEnd - selStart) + 'px';\n            L.DomUtil.removeClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n        },\n\n        onSvgDragEnd: function(e) {\n            if (e.dragButton === 0) {\n                this.cursorShow();\n                this.updateGraphSelection(e);\n                var stats = this.calcProfileStats(this.values.slice(this.selStartInd, this.selEndInd + 1), true);\n                this.updatePropsDisplay(stats);\n                L.DomUtil.addClass(this.propsContainer, 'elevation-profile-properties-selected');\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.movementX;\n            }\n        },\n\n        onSvgDrag: function(e) {\n            if (e.dragButton === 0) {\n                this.updateGraphSelection(e);\n                this.polyLineSelection.setLatLngs(this.samples.slice(this.selStartInd, this.selEndInd + 1));\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.movementX;\n            }\n        },\n\n        onSvgClick: function(e) {\n            if (e.dragButton === 0) {\n                this.dragStart = null;\n                L.DomUtil.addClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n                L.DomUtil.removeClass(this.propsContainer, 'elevation-profile-properties-selected');\n                this._map.removeLayer(this.polyLineSelection);\n                if (this.stats) {\n                    this.updatePropsDisplay(this.stats);\n                }\n            }\n            if (e.dragButton === 2) {\n                this.setMapPositionAtIndex(Math.round(this.xToIndex(e.offsetX)));\n            }\n        },\n\n        onSvgDblClick: function(e) {\n            this.setMapPositionAtIndex(Math.round(this.xToIndex(e.offsetX)));\n        },\n\n        setMapPositionAtIndex: function(ind) {\n            var latlng = this.samples[ind];\n            if (latlng) {\n                this._map.panTo(latlng);\n            }\n        },\n\n        onSvgMouseWheel: function(e) {\n            var oldHorizZoom = this.horizZoom;\n            this.horizZoom += L.DomEvent.getWheelDelta(e) > 0 ? 1 : -1;\n            if (this.horizZoom < 1) {\n                this.horizZoom = 1;\n            }\n            if (this.horizZoom > 10) {\n                this.horizZoom = 10;\n            }\n\n            var x = offestFromEvent(e).offsetX;\n            var ind = this.xToIndex(x);\n\n            var newScrollLeft = this.drawingContainer.scrollLeft +\n                offestFromEvent(e).offsetX * (this.horizZoom / oldHorizZoom - 1);\n            if (newScrollLeft < 0) {\n                newScrollLeft = 0;\n            }\n\n            this.svgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            this.svg.setAttribute('width', this.svgWidth + 'px');\n            this.setupGraph();\n            if (newScrollLeft > this.svgWidth - this.drawingContainer.clientWidth) {\n                newScrollLeft = this.svgWidth - this.drawingContainer.clientWidth;\n            }\n            this.drawingContainer.scrollLeft = newScrollLeft;\n\n            this.cursorHide();\n            this.setCursorPosition(ind);\n            this.cursorShow();\n            this.updateGraphSelection();\n        },\n\n\n        updateGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            this.stats = this.calcProfileStats(this.values);\n            this.updatePropsDisplay(this.stats);\n            this.setupGraph();\n        },\n\n        updatePropsDisplay: function(stats) {\n            if (!this._map) {\n                return;\n            }\n            this.propsContainer.innerHTML = '';\n            var ascentAngleStr = isNaN(stats.angleAvgAscent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                {avg: stats.angleAvgAscent, max: stats.angleMaxAscent}\n            );\n            var descentAngleStr = isNaN(stats.angleAvgDescent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                {avg: stats.angleAvgDescent, max: stats.angleMaxDescent}\n            );\n\n            this.propsContainer.innerHTML =\n                '<table>' +\n                '<tr><td>Max elevation:</td><td>' + Math.round(stats.max) + '</td></tr>' +\n                '<tr><td>Min elevation:</td><td>' + Math.round(stats.min) + '</td></tr>' +\n                '<tr class=\"start-group\"><td>Start elevation:</td><td>' + Math.round(stats.start) + '</td></tr>' +\n                '<tr><td>Finish elevation:</td><td>' + Math.round(stats.end) + '</td></tr>' +\n                '<tr><td>Start to finish elevation change:</td><td>' + Math.round(stats.finalAscent) + '</td></tr>' +\n                '<tr class=\"start-group\"><td>Avg / Max ascent inclination:</td><td>' + ascentAngleStr + '</td></tr>' +\n                '<tr><td>Avg / Max descent inclination:</td><td>' + descentAngleStr + '</td></tr>' +\n                '<tr class=\"start-group\"><td>Total ascent:</td><td>' + Math.round(stats.ascent) + '</td></tr>' +\n                '<tr><td>Total descent:</td><td>' + Math.round(stats.descent) + '</td></tr>' +\n                '<tr class=\"start-group\"><td>Distance:</td><td>' + (stats.distance / 1000).toFixed(1) + ' km</td></tr>' +\n                '</table>'\n        },\n\n        calcGridValues: function(minValue, maxValue) {\n            var ticksNs = [3, 4, 5],\n                tickSteps = [1, 2, 5, 10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000],\n                ticks = [],\n                i, j, k, ticksN, tickStep, tick1, tick2,\n                matchFound=false;\n\n            for (i = 0; i < tickSteps.length; i++) {\n                tickStep = tickSteps[i];\n                for (j = 0; j < ticksNs.length; j++) {\n                    ticksN = ticksNs[j];\n                    tick1 = Math.floor(minValue / tickStep);\n                    tick2 = Math.ceil(maxValue / tickStep);\n                    if ((tick2 - tick1) < ticksN) {\n                        matchFound = true;\n                        break\n                    }\n                }\n                if (matchFound) {\n                    break;\n                }\n            }\n            for (k = tick1; k < tick1 + ticksN; k++) {\n                ticks.push(k * tickStep);\n            }\n            return ticks;\n\n        },\n\n        filterElevations: function(values, tolerance) {\n            var filtered = values.slice(0);\n            if (filtered.length < 3) {\n                return filtered;\n            }\n            var scanStart, scanEnd, job, linearValue, linearDelta, maxError, maxErrorInd, i, error;\n            var queue = [[0, filtered.length - 1]];\n            while (queue.length) {\n                job = queue.pop();\n                scanStart = job[0];\n                scanEnd = job[1];\n                linearValue = filtered[scanStart];\n                linearDelta = (filtered[scanEnd] - filtered[scanStart]) / (scanEnd - scanStart);\n                maxError = null;\n                maxErrorInd = null;\n                for (i = scanStart + 1; i < scanEnd; i++) {\n                    linearValue += linearDelta;\n                    error = Math.abs(filtered[i] - linearValue);\n                    if (error === null || error > maxError) {\n                        maxError = error;\n                        maxErrorInd = i;\n                    }\n                }\n                if (maxError > tolerance) {\n                    if (scanEnd > scanStart + 2) {\n                        queue.push([scanStart, maxErrorInd]);\n                        queue.push([maxErrorInd, scanEnd]);\n                    }\n                } else {\n                    filtered.splice(scanStart + 1, scanEnd - scanStart - 1);\n                }\n            }\n            return filtered;\n        },\n\n        calcProfileStats: function(values, partial) {\n            var stats = {},\n                gradient, i;\n            stats.min = Math.min.apply(null, values);\n            stats.max = Math.max.apply(null, values);\n            stats.finalAscent = values[values.length - 1] - values[0];\n            var ascents = [],\n                descents = [];\n            for (i = 1; i < values.length; i++) {\n                gradient = (values[i] - values[i - 1]);\n                if (gradient > 0) {\n                    ascents.push(gradient);\n                } else if (gradient < 0) {\n                    descents.push(-gradient);\n                }\n            }\n            function sum(a, b) {\n                return a + b;\n            }\n\n            stats.gradientAvgAscent = ascents.reduce(sum, 0) / ascents.length / this.options.samplingInterval;\n            stats.gradientMinAscent = Math.min.apply(null, ascents) / this.options.samplingInterval;\n            stats.gradientMaxAscent = Math.max.apply(null, ascents) / this.options.samplingInterval;\n            stats.gradientAvgDescent = descents.reduce(sum, 0) / descents.length / this.options.samplingInterval;\n            stats.gradientMinDescent = Math.min.apply(null, descents) / this.options.samplingInterval;\n            stats.gradientMaxDescent = Math.max.apply(null, descents) / this.options.samplingInterval;\n\n            stats.angleAvgAscent = gradientToAngle(stats.gradientAvgAscent);\n            stats.angleMinAscent = gradientToAngle(stats.gradientMinAscent);\n            stats.angleMaxAscent = gradientToAngle(stats.gradientMaxAscent);\n            stats.angleAvgDescent = gradientToAngle(stats.gradientAvgDescent);\n            stats.angleMinDescent = gradientToAngle(stats.gradientMinDescent);\n            stats.angleMaxDescent = gradientToAngle(stats.gradientMaxDescent);\n\n            stats.start = values[0];\n            stats.end = values[values.length - 1];\n            stats.distance = (values.length - 1) * this.options.samplingInterval;\n\n            var filterTolerance = 5;\n            var filtered = this.filterElevations(values, filterTolerance);\n            var ascent = 0,\n                descent = 0,\n                delta;\n            for (i = 1; i < filtered.length; i++) {\n                delta = filtered[i] - filtered[i - 1];\n                if (delta < 0) {\n                    descent += -delta;\n                } else {\n                    ascent += delta;\n                }\n            }\n            stats.ascent = ascent;\n            stats.descent = descent;\n\n            return stats;\n\n        },\n\n        setCursorPosition: function(ind) {\n            if (!this._map || !this.values) {\n                return;\n            }\n            var distance = this.options.samplingInterval * ind;\n            distance = (distance / 1000).toFixed(2);\n            var gradient = (this.values[Math.ceil(ind)] - this.values[Math.floor(ind)]) / this.options.samplingInterval;\n            var angle = Math.round(Math.atan(gradient) * 180 / Math.PI);\n            gradient = Math.round(gradient * 100);\n\n            var x = Math.round(ind / (this.values.length - 1) * (this.svgWidth - 1));\n            var indInt = Math.round(ind);\n            var elevation = this.values[indInt];\n            this.graphCursorLabel.innerHTML = L.Util.template('{ele} m<br>{dist} km<br>{angle}&deg;',\n                {ele: Math.round(elevation), dist: distance, grad: gradient, angle: angle}\n            );\n\n            this.graphCursor.style.left = x + 'px';\n            this.graphCursorLabel.style.left = x + 'px';\n            if (this.drawingContainer.getBoundingClientRect().left - this.drawingContainer.scrollLeft + x +\n                this.graphCursorLabel.offsetWidth >= this._container.getBoundingClientRect().right) {\n                L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            } else {\n                L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            }\n\n            var markerPos;\n            if (ind <= 0) {\n                markerPos = this.samples[0];\n            } else if (ind >= this.samples.length - 1) {\n                markerPos = this.samples[this.samples.length - 1];\n            } else {\n                var p1 = this.samples[Math.floor(ind)],\n                    p2 = this.samples[Math.ceil(ind)],\n                    indFrac = ind - Math.floor(ind);\n                markerPos = [p1.lat + (p2.lat - p1.lat) * indFrac, p1.lng + (p2.lng - p1.lng) * indFrac];\n            }\n            this.trackMarker.setLatLng(markerPos);\n            var label = L.Util.template('{ele} m<br>{dist} km<br>{angle}&deg;',\n                {ele: Math.round(elevation), dist: distance, grad: gradient, angle: angle}\n            );\n            var icon = L.divIcon({\n                    className: 'elevation-profile-marker',\n                    html: '<div class=\"elevation-profile-marker-icon\"></div><div class=\"elevation-profile-marker-label\">' +\n                    label + '</div>'\n                }\n            );\n            this.trackMarker.setIcon(icon);\n        },\n\n        onSvgMouseMove: function(e) {\n            if (!this.values) {\n                return;\n            }\n            var x = offestFromEvent(e).offsetX;\n            var ind = (x / (this.svgWidth - 1) * (this.values.length - 1));\n            this.setCursorPosition(ind);\n        },\n\n        cursorShow: function() {\n            L.DomUtil.removeClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.addLayer(this.trackMarker);\n        },\n\n        cursorHide: function() {\n            L.DomUtil.addClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.removeLayer(this.trackMarker);\n        },\n\n        onSvgEnter: function() {\n            this.cursorShow();\n        },\n\n        onSvgLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseEnter: function() {\n            this.cursorShow();\n        },\n\n        onLineMouseLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseMove: function(e) {\n            function sqrDist(latlng1, latlng2) {\n                var dx = (latlng1.lng - latlng2.lng);\n                var dy = (latlng1.lat - latlng2.lat);\n                return dx * dx + dy * dy;\n            }\n\n            var nearestInd = null, ind,\n                minDist = null,\n                mouseLatlng = e.latlng,\n                i, sampleLatlng, dist, di;\n            for (i = 0; i < this.samples.length; i++) {\n                sampleLatlng = this.samples[i];\n                dist = sqrDist(sampleLatlng, mouseLatlng);\n                if (nearestInd === null || dist < minDist) {\n                    nearestInd = i;\n                    minDist = dist;\n                }\n            }\n\n            if (nearestInd !== null) {\n                ind = nearestInd;\n                if (nearestInd > 0) {\n                    var prevDist = sqrDist(mouseLatlng, this.samples[nearestInd - 1]),\n                        prevSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd - 1]);\n                }\n                if (nearestInd < this.samples.length - 1) {\n                    var nextDist = sqrDist(mouseLatlng, this.samples[nearestInd + 1]),\n                        nextSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd + 1]);\n                }\n\n                if (nearestInd === 0) {\n                    if (nextDist < minDist + nextSampleDist) {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    } else {\n                        di = .001;\n                    }\n                } else if (nearestInd === this.samples.length - 1) {\n                    if (prevDist < minDist + prevSampleDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = -0.001\n                    }\n                } else {\n                    if (prevDist < nextDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    }\n                }\n                if (di < -1) {\n                    di = -1;\n                }\n                if (di > 1) {\n                    di = 1;\n                }\n                this.setCursorPosition(ind + di);\n            }\n\n        },\n\n\n        setupGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n\n            while (this.svg.hasChildNodes()) {\n                this.svg.removeChild(this.svg.lastChild);\n            }\n            while (this.leftAxisLables.hasChildNodes()) {\n                this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);\n            }\n\n            var maxValue = Math.max.apply(null, this.values),\n                minValue = Math.min.apply(null, this.values),\n                svg = this.svg,\n                path, i, horizStep, verticalMultiplier, x, y, gridValues, label;\n\n\n            var paddingBottom = 8 + 16,\n                paddingTop = 8;\n\n            gridValues = this.calcGridValues(minValue, maxValue);\n            var gridStep = (this.svgHeight - paddingBottom - paddingTop) / (gridValues.length - 1);\n            for (i = 0; i < gridValues.length; i++) {\n                y = Math.round(i * gridStep - 0.5) + 0.5 + paddingTop;\n                path = L.Util.template('M{x1} {y} L{x2} {y}', {x1: 0, x2: this.svgWidth * this.horizZoom, y: y});\n                createSvg('path', {d: path, 'stroke-width': '1px', stroke: 'green', fill: 'none', 'stroke-opacity': '0.5'}, svg);\n\n                label = L.DomUtil.create('div', 'elevation-profile-grid-label', this.leftAxisLables);\n                label.innerHTML = gridValues[gridValues.length - i - 1];\n                label.style.top = (gridStep * i + paddingTop) + 'px';\n            }\n\n            horizStep = this.svgWidth / (this.values.length - 1);\n            verticalMultiplier =\n                (this.svgHeight - paddingTop - paddingBottom) / (gridValues[gridValues.length - 1] - gridValues[0]);\n\n            path = [];\n            const valueToSvgCoord = (el) => {\n                const y = (el - gridValues[0]) * verticalMultiplier;\n                return this.svgHeight - y - paddingBottom;\n            };\n\n            let startNewSegment = true;\n            for (i = 0; i < this.values.length; i++) {\n                let value = this.values[i];\n                if (value === null) {\n                    startNewSegment = true;\n                    continue;\n                }\n                path.push(startNewSegment ? 'M' : 'L');\n                x = i * horizStep;\n                y = valueToSvgCoord(value);\n                path.push(x + ' ' + y + ' ');\n                startNewSegment = false;\n            }\n            path = path.join('');\n            createSvg('path', {d: path, 'stroke-width': '1px', stroke: 'brown', fill: 'none'}, svg);\n            // sightline\n            if (this.options.sightLine) {\n                path = L.Util.template('M{x1} {y1} L{x2} {y2}', {\n                        x1: 0, x2: this.svgWidth * this.horizZoom,\n                        y1: valueToSvgCoord(this.values[0]),\n                        y2: valueToSvgCoord(this.values[this.values.length - 1])\n                    }\n                );\n                createSvg('path',\n                    {d: path, 'stroke-width': '3px', stroke: '#94b1ff', fill: 'none', 'stroke-opacity': '0.5'}, svg\n                );\n            }\n        },\n\n        _getElevation: function(latlngs) {\n            function parseResponse(s) {\n                var values = [], v;\n                s = s.split('\\n');\n                for (var i = 0; i < s.length; i++) {\n                    if (s[i]) {\n                        if (s[i] === 'NULL') {\n                            v = null;\n                        } else {\n                            v = parseFloat(s[i]);\n                        }\n                        values.push(v);\n                    }\n                }\n                return values;\n            }\n\n            var req = [];\n            for (var i = 0; i < latlngs.length; i++) {\n                req.push(latlngs[i].lat.toFixed(6) + ' ' + latlngs[i].lng.toFixed(5));\n            }\n            req = req.join('\\n');\n            const xhrPromise = fetch(this.options.elevationsServer, {method: 'POST', data: req});\n            this.abortLoading = xhrPromise.abort.bind(xhrPromise);\n            return xhrPromise.then(\n                    function(xhr) {\n                        return parseResponse(xhr.responseText);\n                    }\n                );\n        },\n        onCloseButtonClick: function() {\n            this.removeFrom(this._map);\n        }\n    }\n);\n\nexport {ElevationProfile, calcSamplingInterval};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.elevation-profile/index.js\n **/","import L from 'leaflet';\nimport './style.css';\n\nfunction extendLayerName(name, layer) {\n    if (layer.options) {\n        const code = layer.options.code;\n        if (code && code.length === 1) {\n            name += `<span class=\"layers-control-hotkey\">${code}</span>`;\n        }\n    }\n    return name;\n}\n\nfunction enableHotKeys(control) {\n    const originalOnAdd = control.onAdd;\n    const originalOnRemove = control.onRemove;\n    const originalAddItem = control._addItem;\n\n    if (control._hotKeysEnabled) {\n        return control;\n    }\n\n    L.Util.extend(control, {\n            _hotKeysEnabled: true,\n\n            _addItem: function(obj) {\n                obj = L.Util.extend({}, obj);\n                obj.name = extendLayerName(obj.name, obj.layer);\n                return originalAddItem.call(this, obj);\n            },\n\n            onAdd: function(map) {\n                var result = originalOnAdd.call(this, map);\n                this._addHotketEvents();\n                return result;\n            },\n\n            onRemove: function(map) {\n                L.DomEvent.off(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.off(document, 'keydown', this.onKeyDown, this);\n                originalOnRemove.call(this, map);\n\n            },\n\n            _addHotKetEvents: function() {\n                L.DomEvent.on(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.on(document, 'keydown', this.onKeyDown, this);\n            },\n\n            onKeyDown: function(e) {\n                if (e.altKey || e.ctrlKey || e.shiftKey) {\n                    return;\n                }\n                this._keyDown = e.keyCode;\n            },\n\n            _onHotkeyUp: function(e) {\n                const pressedKey = this._keyDown;\n                this._keyDown = null;\n                const targetTag = e.target.tagName.toLowerCase();\n                if (('input' === targetTag && e.target.type === 'text') || 'textarea' === targetTag ||\n                    pressedKey !== e.keyCode) {\n                    return;\n                }\n                const key = String.fromCharCode(e.keyCode);\n                for (let layer of this._layers) {\n                    let layerId = L.stamp(layer.layer);\n                    if (layer.layer.options && layer.layer.options.code && layer.layer.options.code.toUpperCase() === key) {\n                        const inputs = this._form.getElementsByTagName('input');\n                        for (let input of [...inputs]) {\n                            if (input.layerId === layerId) {\n                                input.click();\n                                break;\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n    );\n    for (let layer of control._layers) {\n        layer.name = extendLayerName(layer.name, layer.layer);\n    }\n    control._addHotKetEvents();\n    control._update();\n    return control;\n}\n\nexport default enableHotKeys;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.layers.hotkeys/index.js\n **/","import L from 'leaflet';\nimport './style.css';\n\nfunction enableTopRow(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._topRowEnabled) {\n        return;\n    }\n\n\n\n\n    L.Util.extend(control, {\n        _topRowEnabled: true,\n\n        onAdd: function(map) {\n            const container = originalOnAdd.call(this, map);\n            setTimeout(() => this.__injectTopRow(), 0);\n            return container;\n        },\n\n        __injectTopRow: function() {\n            this._topRow = L.DomUtil.create('div', 'leaflet-control-layers-top-row');\n            this._form.parentNode.insertBefore(this._topRow, this._form);\n        }\n\n    });\n    if (control._map) {\n        control.__injectTopRow()\n    }\n\n\n}\n\nexport default enableTopRow;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.layers.top-row/index.js\n **/","function arrayItemsEqual(l1, l2) {\n    if (l1.length !== l2.length)\n        return false;\n    for (var i = 0; i < l1.length; i++) {\n        if (l1[i] !== l2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nconst hashState = {\n    _listeners: [],\n    _state: {},\n\n    addEventListener: function(key, callback) {\n        for (let [k, c] of this._listeners) {\n            if (k === key && c === callback) {\n                return;\n            }\n        }\n        this._listeners.push([key, callback]);\n    },\n\n    removeEventListener: function(key, callback) {\n        this._listeners.forEach(([k, c], i) => {\n                if (k === key && c === callback) {\n                    this._listeners.splice(i, 1);\n                    return;\n                }\n            }\n        );\n    },\n\n    updateState: function(key, values) {\n        if (values) {\n            this._state[key] = values;\n        } else {\n            delete this._state[key];\n        }\n        this._saveStateToHash();\n    },\n\n    getState: function(key) {\n        return this._state[key];\n    },\n\n    _parseHash: function() {\n        let hash = location.hash;\n        const args = {},\n             i = hash.indexOf('#');\n        if (i >= 0) {\n            hash = hash.substr(i + 1).trim();\n            let m, key, value;\n            for (let pair of hash.split('&')) {\n                m = /^([^=]+?)(?:=(.*))?$/.exec(pair);\n                if (m) {\n                    [, key, value] = m;\n                    if (value) {\n                        value = value.split('/');\n                        value = value.map(decodeURIComponent);\n                    } else {\n                        value = [];\n                    }\n                    args[key] = value;\n                }\n            }\n        }\n        return args;\n    },\n\n    _saveStateToHash: function() {\n        var stateItems = [];\n        for (let key of Object.keys(this._state)) {\n            if (this._state[key]) {\n                if (this._state[key].length) {\n                    var values = this._state[key].join('/');\n                    stateItems.push(key + '=' + values);\n                } else {\n                    stateItems.push(key);\n                }\n            }\n        }\n        location.hash = stateItems.join('&');\n    },\n\n\n    onHashChanged: function() {\n        const newState = this._parseHash();\n        const changedKeys = {};\n        for (let key of Object.keys(newState)) {\n            if (!(key in this._state)  || !arrayItemsEqual(newState[key], this._state[key])) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let key of Object.keys(this._state)) {\n            if (! (key in newState)) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let [key, callback] of this._listeners) {\n            if (key in changedKeys) {\n                callback(newState[key]);\n            }\n        }\n        this._state = newState;\n    }\n};\n\nwindow.addEventListener('hashchange', hashState.onHashChanged.bind(hashState));\nhashState.onHashChanged();\n\nexport default hashState;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.hashState/hashState.js\n **/","import L from 'leaflet';\n\nL.BingLayer = L.TileLayer.extend({\n    options: {\n        subdomains: [0, 1, 2, 3],\n        type: 'Aerial',\n        attribution: 'Bing',\n        culture: ''\n    },\n\n    initialize: function (key, options) {\n        L.Util.setOptions(this, options);\n\n        this._key = key;\n        this._url = null;\n        this._providers = [];\n        this.metaRequested = false;\n    },\n\n    tile2quad: function (x, y, z) {\n        var quad = '';\n        for (var i = z; i > 0; i--) {\n            var digit = 0;\n            var mask = 1 << (i - 1);\n            if ((x & mask) !== 0) digit += 1;\n            if ((y & mask) !== 0) digit += 2;\n            quad += digit;\n        }\n        return quad;\n    },\n\n    getTileUrl: function (tilePoint) {\n        var zoom = this._getZoomForUrl();\n        var subdomains = this.options.subdomains,\n            s = this.options.subdomains[Math.abs((tilePoint.x + tilePoint.y) % subdomains.length)];\n        return this._url.replace('{subdomain}', s)\n            .replace('{quadkey}', this.tile2quad(tilePoint.x, tilePoint.y, zoom))\n            .replace('{culture}', this.options.culture);\n    },\n\n    loadMetadata: function () {\n        if (this.metaRequested) return;\n        this.metaRequested = true;\n        var _this = this;\n        var cbid = '_bing_metadata_' + L.Util.stamp(this);\n        window[cbid] = function (meta) {\n            window[cbid] = undefined;\n            var e = document.getElementById(cbid);\n            e.parentNode.removeChild(e);\n            if (meta.errorDetails) {\n                throw new Error(meta.errorDetails);\n            }\n            _this.initMetadata(meta);\n        };\n        var urlScheme = (document.location.protocol === 'file:') ? 'http' : document.location.protocol.slice(0, -1);\n        var url = urlScheme + '://dev.virtualearth.net/REST/v1/Imagery/Metadata/'\n            + this.options.type + '?include=ImageryProviders&jsonp=' + cbid +\n            '&key=' + this._key + '&UriScheme=' + urlScheme;\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n        script.id = cbid;\n        document.getElementsByTagName('head')[0].appendChild(script);\n    },\n\n    initMetadata: function (meta) {\n        var r = meta.resourceSets[0].resources[0];\n        this.options.subdomains = r.imageUrlSubdomains;\n        this._url = r.imageUrl;\n        if (r.imageryProviders) {\n            for (var i = 0; i < r.imageryProviders.length; i++) {\n                var p = r.imageryProviders[i];\n                for (var j = 0; j < p.coverageAreas.length; j++) {\n                    var c = p.coverageAreas[j];\n                    var coverage = {zoomMin: c.zoomMin, zoomMax: c.zoomMax, active: false};\n                    var bounds = new L.LatLngBounds(\n                        new L.LatLng(c.bbox[0]+0.01, c.bbox[1]+0.01),\n                        new L.LatLng(c.bbox[2]-0.01, c.bbox[3]-0.01)\n                    );\n                    coverage.bounds = bounds;\n                    coverage.attrib = p.attribution;\n                    this._providers.push(coverage);\n                }\n            }\n        }\n        this._update();\n    },\n\n    _update: function () {\n        if (this._url === null || !this._map) return;\n        this._update_attribution();\n        L.TileLayer.prototype._update.apply(this, []);\n    },\n\n    _update_attribution: function () {\n        var bounds = L.latLngBounds(this._map.getBounds().getSouthWest().wrap(),this._map.getBounds().getNorthEast().wrap());\n        var zoom = this._map.getZoom();\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if ((zoom <= p.zoomMax && zoom >= p.zoomMin) &&\n                bounds.intersects(p.bounds)) {\n                if (!p.active && this._map.attributionControl)\n                    this._map.attributionControl.addAttribution(p.attrib);\n                p.active = true;\n            } else {\n                if (p.active && this._map.attributionControl)\n                    this._map.attributionControl.removeAttribution(p.attrib);\n                p.active = false;\n            }\n        }\n    },\n\n    onAdd: function (map) {\n        this.loadMetadata();\n        L.TileLayer.prototype.onAdd.apply(this, [map]);\n    },\n\n    onRemove: function (map) {\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if (p.active && this._map.attributionControl) {\n                this._map.attributionControl.removeAttribution(p.attrib);\n                p.active = false;\n            }\n        }\n        L.TileLayer.prototype.onRemove.apply(this, [map]);\n    }\n});\n\nL.bingLayer = function (key, options) {\n    return new L.BingLayer(key, options);\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.bing/index.js\n **/","import L from 'leaflet';\nimport getGoogle from 'lib/googleMapsApi';\n\nL.Layer.Google = L.GridLayer.extend({\n        options: {},\n\n        // Possible types: SATELLITE, ROADMAP, HYBRID, TERRAIN\n        initialize: function(mapType, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.mapType = mapType;\n        },\n\n        onAdd: function(map) {\n            this._clearTiles();\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this._googleMapContainer = L.DomUtil.create('div', '', map.getContainer());\n            this._googleMapContainer.style.width = '100%';\n            this._googleMapContainer.style.height = '100%';\n            // this._googleMapContainer.style.opacity = 0;\n            this._googleMapContainer.style.visibility = 'hidden';\n            this._googleMapContainer.style.pointerEvents = 'none';\n            getGoogle().then((google) => {\n                    let zoom, center;\n                    if (map) {\n                        zoom = map.getZoom();\n                        center = map.getCenter;\n                        center = new google.maps.LatLng(center.lat, center.lng);\n                    } else {\n                        zoom = 0;\n                        center = new google.maps.LatLng(0, 0);\n                    }\n                    this.google = google;\n                    this._googleMap = new google.maps.Map(this._googleMapContainer, {\n                            center: center,\n                            zoom: zoom,\n                            tilt: 0,\n                            mapTypeId: google.maps.MapTypeId[this.mapType],\n                            disableDefaultUI: true,\n                            keyboardShortcuts: false,\n                            draggable: false,\n                            disableDoubleClickZoom: true,\n                            scrollwheel: false,\n                            streetViewControl: false,\n                            clickableIcons: false\n                        }\n                    );\n                    google.maps.event.addListener(this._googleMap, 'tilesloaded', this._onTilesLoaded.bind(this));\n                    setTimeout(this._syncPosition.bind(this), 0);\n                }\n            );\n            map.on({\n                    viewreset: this._syncPosition,\n                    resize: this._onResize,\n                    move: this._syncPosition,\n                    zoomanim: this._onZoom\n                }, this\n            );\n        },\n\n        onRemove: function(map) {\n            if (this.google) {\n                this.google.maps.event.clearInstanceListeners(this._googleMap);\n            }\n            this._googleMap = null;\n            this._clearTiles();\n            L.DomUtil.remove(this._googleMapContainer);\n            map.off({\n                    viewreset: this._clearTiles,\n                    resize: this._onResize,\n                    move: this._syncPosition,\n                    zoomanim: this._onZoom\n                }, this\n            );\n            L.GridLayer.prototype.onRemove.call(this, map);\n        },\n\n        _clearTiles: function() {\n            this._pendingTiles = {};\n            this._readyTiles = {};\n        },\n\n        _onResize: function() {\n            if (!this.google) {\n                return;\n            }\n            this.google.maps.event.trigger(this._googleMap, 'resize');\n        },\n\n        _syncPosition: function() {\n            if (!this.google || !this._map) {\n                return;\n            }\n            let center = this._map.getCenter();\n            let googleCenter = new this.google.maps.LatLng(center.lat, center.lng);\n            setTimeout(() => {\n                    if (!this._googleMap) {\n                        return;\n                    }\n                    this._googleMap.setCenter(googleCenter);\n                    this._googleMap.setZoom(this._map.getZoom());\n                }, 0\n            );\n        },\n\n        _onZoom: function(e) {\n            if (!this.google) {\n                return;\n            }\n            let center = e.center;\n            let googleCenter = new this.google.maps.LatLng(center.lat, center.lng);\n            setTimeout(() => {\n                    if (!this._googleMap) {\n                        return;\n                    }\n                    this._googleMap.setCenter(googleCenter);\n                    this._googleMap.setZoom(Math.round(e.zoom));\n                }, 0\n            );\n        },\n\n        _roadRegexp: /!1i(\\d+)!2i(\\d+)!3i(\\d+)!/,\n        _satRegexp: /x=(\\d+)&y=(\\d+)&z=(\\d+)/,\n\n        _onTilesLoaded: function() {\n            this._readyTiles = this._collectMapImageElements();\n            this._fullfillPendingTiles();\n        },\n\n        _collectMapImageElements: function() {\n            const images = this._googleMapContainer.getElementsByTagName('img');\n            const tiles = {};\n            for (let image of [...images]) {\n                let url = image.src;\n                let match, coords;\n                match = url.match(this._roadRegexp);\n\n                if (match) {\n                    coords = {z: match[1], x: match[2], y: match[3]}\n                } else {\n                    match = url.match(this._satRegexp);\n                    if (match) {\n                        coords = {x: match[1], y: match[2], z: match[3]}\n                    }\n                }\n                if (coords) {\n                    tiles[this._tileCoordsToKey(coords)] = url;\n                }\n            }\n            return tiles;\n        },\n\n        _fullfillPendingTiles: function() {\n            for (let key of Object.keys(this._readyTiles)) {\n                if (key in this._pendingTiles) {\n                    for (let [img, cb] of this._pendingTiles[key]) {\n                        L.DomEvent.on(img, 'load', L.bind(this._tileOnLoad, this, cb, img));\n                        L.DomEvent.on(img, 'error', L.bind(this._tileOnError, this, cb, img));\n                        img.alt = '';\n                        img.src = this._readyTiles[key];\n                    }\n                    delete this._pendingTiles[key];\n                }\n            }\n        },\n\n        _tileOnLoad: function(done, tile) {\n            // For https://github.com/Leaflet/Leaflet/issues/3332\n            if (L.Browser.ielt9) {\n                setTimeout(L.bind(done, this, null, tile), 0);\n            } else {\n                done(null, tile);\n            }\n        },\n\n        _tileOnError: function(done, tile, e) {\n            done(e, tile);\n        },\n\n        createTile: function(coords, done) {\n            const tile = L.DomUtil.create('img');\n            const key = this._tileCoordsToKey(coords);\n            if (!(key in this._pendingTiles)) {\n                this._pendingTiles[key] = [];\n            }\n            this._pendingTiles[key].push([tile, done]);\n            setTimeout(this._fullfillPendingTiles.bind(this), 0);\n            return tile;\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.google/index.js\n **/","import L from \"leaflet\";\nimport 'lib/leaflet.layer.canvasMarkers'\n\nL.Layer.CanvasMarkers.include({\n        _printProgressWeight: 0.1,\n\n        cloneMarkers: function() {\n            const markers = this.rtree.all();\n\n            function cloneMarker(marker) {\n                return {\n                    latlng: {lat: marker.latlng.lat, lng: marker.latlng.lng},\n                    label: marker.label,\n                    icon: marker.icon\n                };\n            }\n\n            const markersCopy = markers.map(cloneMarker);\n            return markersCopy;\n        },\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options);\n            if (options.printIconsOpacity !== undefined) {\n                options.iconsOpacity = options.printIconsOpacity;\n            }\n            return new L.Layer.CanvasMarkers(this.cloneMarkers(), options);\n\n        },\n\n        getTilesInfo: async function(printOptions) {\n            this.options.iconScale = printOptions.resolution / 90 * 0.75;\n            const scale = printOptions.pixelBounds.getSize().x / printOptions.destPixelSize.x;\n            const pixelExtents = {\n                tileN: printOptions.pixelBounds.getTopRight().y / scale,\n                tileS: printOptions.pixelBounds.getBottomLeft().y / scale,\n                tileE: printOptions.pixelBounds.getTopRight().x / scale,\n                tileW: printOptions.pixelBounds.getBottomLeft().x / scale\n            };\n            const crs = L.CRS.EPSG3857;\n            if (!this._map) {\n                const dummyMap = {\n                    project: crs.latLngToPoint.bind(crs),\n                    unproject: crs.pointToLatLng.bind(crs),\n                };\n                this._map = dummyMap;\n            }\n            const zoom = crs.zoom((1 / scale) * crs.scale(printOptions.zoom));\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom, true);\n            await this.preloadIcons(iconUrls);\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => {\n                                    this.resetLabels();\n                                    this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom,\n                                        true);\n                                },\n                                isOverlay: true,\n                                overlaySolid: !this.options.printTransparent\n                            }\n                        ),\n                        abortLoading: () => {\n                        }\n                    }\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/CanvasMarkers.js\n **/","import L from 'leaflet';\nimport urlViaCorsProxy from 'lib/CORSProxy';\nimport {imgFromDataString} from './imgFromDataString';\n\nconst GridLayerGrabMixin = {\n    tileImagePromiseFromCoords: function(coords) {\n        throw new Error('Method not implemented');\n    },\n\n    waitTilesReadyToGrab: function() {\n        return Promise.resolve(null);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitTilesReadyToGrab();\n        const {pixelBounds} = printOptions;\n        const tileRange = this._pxBoundsToTileRange(pixelBounds);\n        const topLeft = pixelBounds.min;\n        const tilePromiseIterator = (function*() {\n            for (let j = tileRange.min.y; j <= tileRange.max.y; j++) {\n                for (let i = tileRange.min.x; i <= tileRange.max.x; i++) {\n                    let coords = new L.Point(i, j);\n                    coords.z = this._tileZoom;\n                    if (!this._isValidTile(coords)) {\n                        continue;\n                    }\n                    let tilePos = this._getTilePos(coords);\n                    const coordsPlusOne = coords.add(L.point(1, 1));\n                    coordsPlusOne.z = coords.z;\n                    const tilePlusOne = this._getTilePos(coordsPlusOne);\n                    const tileSize = tilePlusOne.subtract(tilePos);\n                    const latLngBounds = L.latLngBounds(\n                        this._map.unproject(tilePos.add(this._level.origin)),\n                        this._map.unproject(tilePlusOne.add(this._level.origin)));\n                    tilePos = tilePos.add(this._level.origin).subtract(topLeft);\n                    let {tilePromise, abortLoading} = this.tileImagePromiseFromCoords(\n                        this._wrapCoords(coords), printOptions);\n                    yield {\n                        tilePromise: tilePromise.then((image) => {\n                                return {image, tilePos, tileSize, latLngBounds};\n                            }\n                        ),\n                        abortLoading\n                    };\n                }\n            }\n        }).bind(this);\n        return {\n            iterateTilePromises: tilePromiseIterator,\n            count: (tileRange.max.x - tileRange.min.x + 1) * (tileRange.max.y - tileRange.min.y + 1)\n        };\n    }\n};\n\nconst TileLayerGrabMixin = L.Util.extend({}, GridLayerGrabMixin, {\n        cloneForPrint: function(options) {\n            return L.tileLayer(this._url, L.Util.extend({}, this.options, options));\n        },\n\n        tileImagePromiseFromCoords: function(coords, printOptions) {\n            let {xhrOptions} = printOptions;\n            let url = this.getTileUrl(coords);\n            if (!url) {\n                return {tilePromise: Promise.resolve(null), abortLoading: noop};\n            }\n            if (this.options.noCors) {\n                url = urlViaCorsProxy(url);\n            }\n            let promise = this.options.xhrQueue.put(url, xhrOptions);\n\n            return {\n                tilePromise: printOptions.rawData ? promise : promise.then(imgFromDataString),\n                abortLoading: () => promise.abort()\n            }\n        }\n    }\n);\n\nfunction noop() {\n\n}\n\nconst CanvasLayerGrabMixin = L.Util.extend({}, GridLayerGrabMixin, {\n    getCanvasFromTile: function(tile) {\n        return tile;\n    },\n\n    tileImagePromiseFromCoords: function(coords) {\n        let tilePromise;\n        if (this.createTile.length < 2) {\n            let tile = this.createTile(coords);\n            tilePromise = Promise.resolve(tile);\n        } else {\n            tilePromise = new Promise((resolve) => {\n                this.createTile(coords, (_, canvas) => resolve(canvas));\n            });\n        }\n\n        return {\n            tilePromise: tilePromise.then(this.getCanvasFromTile),\n            abortLoading: noop\n        }\n    }\n});\n\nL.TileLayer.include(TileLayerGrabMixin);\n\nexport {TileLayerGrabMixin, GridLayerGrabMixin, CanvasLayerGrabMixin};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/TileLayer.js\n **/","import L from 'leaflet';\nimport './TileLayer'\nimport './Bing'\nimport './Yandex'\nimport './Google'\nimport './WestraPasses'\nimport './CanvasMarkers'\nimport './MeasuredLine'\n\nfunction getTempMap(zoom, fullSize, pixelBounds) {\n    const container = L.DomUtil.create('div', '', document.body);\n    let width, height, center;\n    if (fullSize) {\n        const size = pixelBounds.getSize();\n        width = size.x;\n        height = size.y;\n        center = pixelBounds.min.add(size.divideBy(2));\n        center = L.CRS.EPSG3857.pointToLatLng(center, zoom);\n    } else {\n        width = 100;\n        height = 100;\n        center = L.latLng(0, 0);\n    }\n\n    Object.assign(container.style, {\n            width: `${width}px`,\n            height: `${height}px`,\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            visibility: 'hidden',\n        }\n    );\n\n    const map = L.map(container, {fadeAnimation: false, zoomAnimation: false, inertia: false, maxZoom: 18});\n    map.setView(center, zoom);\n    return map;\n}\n\nfunction disposeMap(map) {\n    const container = map._container;\n    map.remove();\n    L.DomUtil.remove(container);\n}\n\n\nexport {getTempMap, disposeMap}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/index.js\n **/","import L from 'leaflet';\nimport './westraPasses.css';\nimport 'lib/leaflet.layer.geojson-ajax';\nimport {WestraPassesMarkers} from './westraPassesMarkers';\n\nL.Layer.WestraPasses = L.Layer.extend({\n        options: {\n            fileRegions1: 'westra_regions_geo1.json',\n            fileRegions2: 'westra_regions_geo2.json',\n            scaleDependent: true\n        },\n\n        initialize: function(baseUrl, options) {\n            L.setOptions(this, options);\n            this.markers = new WestraPassesMarkers(baseUrl);\n            this.regions1 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileRegions1, {\n                    className: 'westra-region-polygon',\n                    onEachFeature: this._setRegionLabel.bind(this, 'regions1')\n                }\n            );\n            this.regions2 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileRegions2, {\n                    className: 'westra-region-polygon',\n                    onEachFeature: this._setRegionLabel.bind(this, 'regions2')\n                }\n            );\n        },\n\n        _setRegionLabel: function(layerName, feature, layer) {\n            var latlon = layer.getBounds().getCenter();\n            var icon = L.divIcon({\n                    className: 'westra-region-label',\n                    html: '<span>' + feature.properties.name + '</span>'\n                }\n            );\n            var labelMarker = L.marker(latlon, {icon: icon});\n            this[layerName].addLayer(labelMarker);\n            function zoomToRegion() {\n                this._map.fitBounds(layer.getBounds());\n            }\n\n            layer.on('click', zoomToRegion, this);\n            labelMarker.on('click', zoomToRegion, this);\n        },\n\n        setLayersVisibility: function(e) {\n            if (!this._map) {\n                return;\n            }\n            var newZoom;\n            var zoomFinished = e ? (e.type !== 'zoomanim') : true;\n            if (e && e.zoom !== undefined) {\n                newZoom = e.zoom;\n            } else {\n                newZoom = this._map.getZoom();\n            }\n            if (newZoom < 2) {\n                this._map.removeLayer(this.markers);\n                this._map.removeLayer(this.regions1);\n                this._map.removeLayer(this.regions2);\n            } else if (newZoom < 7) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.regions1);\n                this._map.removeLayer(this.regions2);\n            }\n            else if (newZoom < 10) {\n                this._map.removeLayer(this.regions1);\n                this._map.addLayer(this.regions2);\n                this._map.removeLayer(this.markers);\n            } else {\n                if (zoomFinished) {\n                    this._map.addLayer(this.markers);\n                }\n                this._map.removeLayer(this.regions1);\n                this._map.removeLayer(this.regions2);\n            }\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            this.markers.loadData();\n            this.regions1.loadData();\n            this.regions2.loadData();\n            this.setLayersVisibility();\n            map.on('zoomend', this.setLayersVisibility, this);\n            map.on('zoomanim', this.setLayersVisibility, this);\n        },\n\n        onRemove: function() {\n            this._map.removeLayer(this.markers);\n            this._map.removeLayer(this.regions1);\n            this._map.removeLayer(this.regions2);\n            this._map.off('zoomend', this.setLayersVisibility, this);\n            this._map.off('zoomanim', this.setLayersVisibility, this);\n            this._map = null;\n        }\n    }\n);\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.westraPasses/index.js\n **/","import L from 'leaflet';\nimport 'lib/leaflet.layer.canvasMarkers'\nimport {openPopupWindow} from 'lib/popup-window';\nimport escapeHtml from 'escape-html';\nimport {saveAs} from 'browser-filesaver';\nimport iconFromBackgroundImage from 'lib/iconFromBackgroundImage';\nimport {fetch} from 'lib/xhr-promise';\nimport {notify} from 'lib/notifications';\nimport logging from 'lib/logging';\n\nconst WestraPassesMarkers = L.Layer.CanvasMarkers.extend({\n        options: {\n            filePasses: 'westra_passes.json',\n            scaleDependent: true\n        },\n\n        initialize: function(baseUrl, options) {\n            L.Layer.CanvasMarkers.prototype.initialize.call(this, null, options);\n            this.on('markerclick', this.showPassDescription, this);\n            this._baseUrl = baseUrl;\n            this.url = baseUrl + this.options.filePasses;\n        },\n\n        loadData: function() {\n            if (this._downloadStarted) {\n                return;\n            }\n            this._downloadStarted = true;\n            fetch(this.url)\n                .then(\n                    (xhr) => this._loadMarkers(xhr),\n                    (e) => {\n                        this._downloadStarted = false;\n                        logging.captureException(e, {\n                                extra: {\n                                    description: 'failed to get westra passes',\n                                    url: this.url,\n                                    status: e.xhr.status\n                                }\n                            }\n                        );\n                        notify('Failed to get Westra passes data');\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.Layer.CanvasMarkers.prototype.onAdd.call(this, map);\n            this.loadData();\n        },\n\n        _makeTooltip: function(marker) {\n            var properties = marker.properties,\n                toolTip = properties.grade || '';\n            if (toolTip && properties.elevation) {\n                toolTip += ', '\n            }\n            toolTip += properties.elevation || '';\n            if (toolTip) {\n                toolTip = ' (' + toolTip + ')';\n            }\n            toolTip = (properties.name || 'без названия') + toolTip;\n            toolTip = (properties.is_summit ? 'Вершина ' : 'Перевал ') + toolTip;\n            return toolTip;\n        },\n\n        _passToGpx: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const gpx = `\n                <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n                <gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.tk\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\">\n                    <wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">\n                        <name>${label}</name>\n                    </wpt>\n                </gpx>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([gpx], {type: 'application/gpx+xml'}), filename + '.gpx', true);\n        },\n\n        _passToKml: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const kml = `\n                <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n                <kml xmlns=\"http://www.opengis.net/kml/2.2\">\n                    <Placemark>\n                        <name>${label}</name>\n                        <Point>\n                            <coordinates>\n                                ${marker.latlng.lng.toFixed(6)},${marker.latlng.lat.toFixed(6)},0\n                            </coordinates>\n                        </Point>\n                    </Placemark>\n                </kml>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([kml], {type: 'application/vnd.google-earth.kml+xml'}), filename + '.kml', true);\n        },\n\n        _makeIcon: function(marker) {\n            var className;\n            className = 'westra-pass-marker ';\n            if (marker.properties.is_summit) {\n                className += 'westra-pass-marker-summit';\n            } else {\n                className += 'westra-pass-marker-' + marker.properties.grade_eng;\n            }\n            return iconFromBackgroundImage(className);\n        },\n\n        _loadMarkers: function(xhr) {\n            var markers = [],\n                features = JSON.parse(xhr.response),\n                feature, i, marker;\n            for (i = 0; i < features.length; i++) {\n                feature = features[i];\n                marker = {\n                    latlng: {\n                        lat: feature.latlon[0],\n                        lng: feature.latlon[1]\n                    },\n                    label: feature.name || \"\",\n                    icon: this._makeIcon,\n                    tooltip: this._makeTooltip.bind(this),\n                    properties: feature\n                };\n                markers.push(marker);\n            }\n            this.addMarkers(markers);\n            this._dataLoaded = true;\n            this.fire('data-loaded');\n        },\n\n\n        showPassDescription: function(e) {\n            if (!this._map) {\n                return;\n            }\n            const properties = e.marker.properties,\n                latLng = e.marker.latlng,\n                url = 'http://westra.ru/passes/Passes/' + properties.id;\n            let altnames = '', connects = '', comments = '';\n            if (properties.altnames) {\n                altnames = `\n                    <tr>\n                        <td>Другие названия</td>\n                        <td>${properties.altnames}</td>\n                    </tr>`;\n            }\n\n            if (!properties.is_summit) {\n                connects = `\n                    <tr>\n                        <td>Соединяет</td>\n                        <td>${properties.connects || \"неизвестнo\"}</td>\n                    </tr>`;\n            }\n\n            if (properties.comments) {\n\n                for (let comment of properties.comments) {\n                    let user = '';\n                    if (comment.user) {\n                        user = `<span class=\"westra-passes-description-comment-author\">${comment.user}:</span>`\n                    }\n                    comments += `<p class=\"westra-passes-description-comment\">${user}${comment.content}</p>`;\n                }\n                comments = `\n                    <tr>\n                        <td>Комментарии</td>\n                        <td>${comments}</td>\n                    </tr>`\n            }\n\n            let description = `\n                <table class=\"pass-details\">\n                    <tr>\n                        <td>${properties.is_summit ? 'Вершина ' : 'Перевал '}</td>\n                        <td>${properties.name || 'название неизвестно'}</td>\n                    </tr>\n                    ${altnames}\n                    <tr>\n                        <td>Категория</td>\n                        <td>${properties.grade || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Высота</td>\n                        <td>${properties.elevation ? (properties.elevation + ' м') : 'неизвестная'}</td>\n                    </tr>\n                    ${connects}\n                    <tr>\n                        <td>Характеристика склонов</td>\n                        <td>${properties.slopes || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Координаты</td>\n                        <td>\n                            <table class=\"westra-passes-description-coords\">\n                                <tr>\n                                    <td>Широта</td>\n                                    <td>Долгота</td>\n                                </tr>\n                                <tr>\n                                    <td>${latLng.lat.toFixed(5)}</td>\n                                    <td>${latLng.lng.toFixed(5)}</td>\n                                    <td><a id=\"westra-pass-gpx\" title=\"Сохранить\">gpx</a></td>\n                                    <td><a id=\"westra-pass-kml\" title=\"Сохранить\">kml</a></td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>На сайте Вестры</td>\n                        <td><a id=\"westra-pass-link\" href=\"${url}\">${url}</a></td></tr>\n                    <tr>\n                        <td>Добавил</td>\n                        <td>${properties.author || \"неизвестно\"}</td>\n                    </tr>\n                    ${comments}\n                </table>`;\n            this._map.openPopup(description, latLng, {maxWidth: 500});\n            document.getElementById('westra-pass-link').onclick = function() {\n                openPopupWindow(url, 780, 'westra-details');\n                return false;\n            };\n            document.getElementById('westra-pass-gpx').onclick = function() {\n                this._passToGpx(e.marker);\n                return false;\n            }.bind(this);\n            document.getElementById('westra-pass-kml').onclick = function() {\n                this._passToKml(e.marker);\n                return false;\n            }.bind(this);\n        }\n    }\n);\n\nexport {WestraPassesMarkers};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.westraPasses/westraPassesMarkers.js\n **/","import L from 'leaflet'\nimport './style.css';\n\nconst yandexCrs = L.CRS.EPSG3395;\n\nL.Layer.Yandex = L.TileLayer.extend({\n        options: {\n            subdomains: '1234',\n            className: L.Browser.retina ? '' : 'yandex-tile-layer',\n            yandexScale: L.Browser.retina ? 2 : 1\n        },\n\n        initialize: function(mapType, options) {\n            let url;\n            this._mapType = mapType;\n            if (mapType === 'sat') {\n                url = 'https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}';\n            } else {\n                url = 'https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}';\n            }\n\n            L.TileLayer.prototype.initialize.call(this, url, options);\n        },\n\n        _getTilePos: function(coords) {\n            const tilePosLatLng = yandexCrs.pointToLatLng(coords.scaleBy(this.getTileSize()), coords.z);\n            return this._map.project(tilePosLatLng, coords.z).subtract(this._level.origin).round();\n        },\n\n        _pxBoundsToTileRange: function(bounds) {\n            const zoom = this._tileZoom;\n            const bounds2 = new L.Bounds(\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.min, zoom), zoom),\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.max, zoom), zoom));\n            return L.TileLayer.prototype._pxBoundsToTileRange.call(this, bounds2);\n        },\n\n        createTile: function(coords, done) {\n            const tile = L.TileLayer.prototype.createTile.call(this, coords, done);\n            const coordsBelow = L.point(coords).add([0, 1]);\n            coordsBelow.z = coords.z;\n            tile._adjustHeight = this._getTilePos(coordsBelow).y - this._getTilePos(coords).y;\n            return tile\n        },\n\n        _initTile: function(tile) {\n            L.TileLayer.prototype._initTile.call(this, tile);\n            tile.style.height = `${tile._adjustHeight}px`;\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.yandex/index.js\n **/","import L from 'leaflet';\nimport './measured_line.css';\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    //FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n\n}\n\nfunction sinCosFromLatLonSegment(segment) {\n    const\n        p1 = L.CRS.EPSG3857.project(segment[0]),\n        p2 = L.CRS.EPSG3857.project(segment[1]),\n        dx = p2.x - p1.x,\n        dy = p1.y - p2.y,\n        len = Math.sqrt(dx * dx + dy * dy),\n        sin = dy / len,\n        cos = dx / len;\n    return [sin, cos];\n}\n\nL.MeasuredLine = L.Polyline.extend({\n        options: {\n            minTicksIntervalMm: 15,\n        },\n\n        onAdd: function(map) {\n            L.Polyline.prototype.onAdd.call(this, map);\n            this._ticks = {};\n            this.updateTicks();\n            this._map.on('zoomend', this.updateTicks, this);\n            this._map.on('dragend', this.updateTicks, this);\n            this.on('nodeschanged', this.updateTicksLater, this);\n        },\n\n        updateTicksLater: function() {\n            setTimeout(this.updateTicks.bind(this), 0);\n        },\n\n        onRemove: function(map) {\n            this._map.off('zoomend', this.updateTicks, this);\n            this._map.off('dragend', this.updateTicks, this);\n            this.off('nodeschanged', this.updateTicks, this);\n            this._clearTicks();\n            L.Polyline.prototype.onRemove.call(this, map);\n        },\n\n        _clearTicks: function() {\n            if (this._map) {\n                Object.values(this._ticks).forEach((tick) => this._map.removeLayer(tick));\n                this._ticks = {};\n            }\n        },\n\n        _addTick: function(tick, marker) {\n            var transformMatrixString = 'matrix(' + tick.transformMatrix.join(',') + ')';\n            if (marker) {\n                marker._icon.childNodes[0].style.transform = transformMatrixString;\n                marker.setLatLng(tick.position);\n            } else {\n                var labelText = Math.round((tick.distanceValue / 10)) / 100 + ' km',\n                    icon = L.divIcon(\n                        {\n                            html: '<div class=\"measure-tick-icon-text\" style=\"transform:' + transformMatrixString + '\">' +\n                            labelText + '</div>',\n                            className: 'measure-tick-icon'\n                        }\n                    );\n                marker = L.marker(tick.position, {icon: icon, interactive: false, keyboard: false});\n                marker.addTo(this._map);\n            }\n            this._ticks[tick.distanceValue.toString()] = marker;\n        },\n\n        setMeasureTicksVisible: function(visible) {\n            this.options.measureTicksShown = visible;\n            this.updateTicks();\n        },\n\n        getTicksPositions: function(minTicksIntervalMeters, bounds) {\n            var steps = [500, 1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000];\n            var ticks = [];\n\n            function addTick(position, segment, distanceValue) {\n                if (bounds && (!bounds.contains(position))) {\n                    return;\n                }\n                var sinCos = sinCosFromLatLonSegment(segment),\n                    sin = sinCos[0], cos = sinCos[1],\n                    transformMatrix;\n\n                if (sin > 0) {\n                    transformMatrix = [sin, -cos, cos, sin, 0, 0];\n                } else {\n                    transformMatrix = [-sin, cos, -cos, -sin, 0, 0];\n                }\n                ticks.push({position: position, distanceValue: distanceValue, transformMatrix: transformMatrix});\n            }\n\n            let step;\n            for (step of steps) {\n                if (step >= minTicksIntervalMeters) {\n                    break;\n                }\n            }\n\n            var lastTickMeasure = 0,\n                lastPointMeasure = 0,\n                points = this._latlngs,\n                points_n = points.length,\n                nextPointMeasure,\n                segmentLength;\n            if (points_n < 2) {\n                return ticks;\n            }\n\n            for (var i = 1; i < points_n; i++) {\n                segmentLength = points[i].distanceTo(points[i - 1]);\n                nextPointMeasure = lastPointMeasure + segmentLength;\n                if (nextPointMeasure >= lastTickMeasure + step) {\n                    while (lastTickMeasure + step <= nextPointMeasure) {\n                        lastTickMeasure += step;\n                        addTick(\n                            pointOnSegmentAtDistance(points[i - 1], points[i], lastTickMeasure - lastPointMeasure),\n                            [points[i - 1], points[i]],\n                            lastTickMeasure\n                        );\n                    }\n                }\n                lastPointMeasure = nextPointMeasure;\n            }\n            if (lastPointMeasure > minTicksIntervalMeters / 2) {\n                addTick(points[0], [points[0], points[1]], 0);\n                addTick(points[points_n - 1], [points[points_n - 2], points[points_n - 1]], lastPointMeasure);\n            }\n            return ticks;\n        },\n\n        updateTicks: function() {\n            if (!this._map) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                this._clearTicks();\n                return;\n            }\n            var bounds = this._map.getBounds().pad(1),\n                rad = Math.PI / 180,\n                dpi = 96,\n                mercatorMetersPerPixel = 20003931 / (this._map.project([180, 0]).x),\n                referencePoint = this.getLatLngs().length ? this.getBounds().getCenter() : this._map.getCenter(),\n                realMetersPerPixel = mercatorMetersPerPixel * Math.cos(referencePoint.lat * rad),\n                mapScale = 1 / dpi * 2.54 / 100 / realMetersPerPixel,\n                minTicksIntervalMeters = this.options.minTicksIntervalMm / mapScale / 1000,\n                ticks = this.getTicksPositions(minTicksIntervalMeters, bounds),\n                oldTicks = this._ticks;\n            this._ticks = {};\n            ticks.forEach(function(tick) {\n                    var oldMarker = oldTicks[tick.distanceValue.toString()];\n                    this._addTick(tick, oldMarker);\n                    if (oldMarker) {\n                        delete oldTicks[tick.distanceValue.toString()];\n                    }\n                }.bind(this)\n            );\n            Object.values(oldTicks).forEach((tick) => this._map.removeLayer(tick));\n        },\n\n        getLength: function() {\n            var points = this._latlngs,\n                points_n = points.length,\n                length = 0;\n\n            for (var i = 1; i < points_n; i++) {\n                length += points[i].distanceTo(points[i - 1]);\n            }\n            return length;\n        }\n    }\n);\n\n\nL.measuredLine = function(latlngs, options) {\n    return new L.MeasuredLine(latlngs, options);\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.polyline-measure/index.js\n **/","import declination from './declination.json';\nimport {stringToArrayBuffer} from 'lib/binary-strings';\n\nlet data;\n\nfunction mod(x, n) {\n    return ((x % n) + n) % n;\n}\n\nfunction loadData() {\n    const ar1 = new Uint8Array(stringToArrayBuffer(atob(declination.array)));\n    const ar2 = new Float32Array(ar1.length);\n    const scale = declination.valueScale;\n    const offset = declination.valueOffset;\n    for (let i = 0; i < ar1.length; i++) {\n        ar2[i] = ar1[i] / scale - offset;\n    }\n    return ar2;\n}\n\nfunction getArrayValue(row, col) {\n    if (row < 0 || col < 0 || col >= declination.colsCount || row >= declination.rowsCount ) {\n        throw new Error(`Invalid col/row value col=${col} row=${row}`);\n    }\n    const ind = row * declination.colsCount + col;\n    if (ind >= data.length) {\n        throw new Error('Index value out of range');\n    }\n    return data[ind];\n}\n\nfunction getDeclination(lat, lon) {\n    if (lat < declination.minLat || lat > declination.maxLat) {\n        return null;\n    }\n    lon = mod(lon + 180, 360) - 180;\n    const row1 = Math.floor((lat - declination.minLat) / declination.step);\n    const row2 = row1 + 1;\n    const dlat = (lat - (row1 * declination.step + declination.minLat)) / declination.step;\n    let col1 = Math.floor((lon + 180) / declination.step);\n    let col2 = col1 + 1;\n    const dlon = (lon - (col1 * declination.step - 180)) / declination.step;\n    col1 %= declination.colsCount;\n    col2 %=  declination.colsCount;\n    let a1 = getArrayValue(row1, col1);\n    let a2 = getArrayValue(row1, col2);\n    const v1 = a1 * (1 - dlon) + a2 * dlon;\n    if (row2 >= declination.rowsCount) {\n        return v1;\n    }\n    a1 = getArrayValue(row2, col1);\n    a2 = getArrayValue(row2, col2);\n    const v2 = a1 * (1 - dlon) + a2 * dlon;\n    const v = v1 * (1 - dlat) + v2 * dlat;\n    return v;\n}\n\ndata = loadData();\n\nexport {getDeclination}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/magnetic-declination/index.js\n **/","function openPopupWindow(url, width, uniqName = null) {\n    var left, top, height,\n        screenLeft = screen.availLeft || 0,\n        bordersWidth = 8;\n    // if browser window is in the right half of screen, place new window on left half\n    if (window.screenX - screenLeft - bordersWidth * 1.5 > width) {\n        left = window.screenX - width - bordersWidth * 1.5;\n        // if browser window is in the left half of screen, place new window on right half\n    } else if (window.screenX + window.outerWidth + width + bordersWidth * 1.5 < screenLeft + screen.availWidth) {\n        left = window.screenX + window.outerWidth + bordersWidth;\n        // if screen is small or browser window occupies whole screen, place new window on top of current window\n    } else {\n        left = window.screenX + window.outerWidth / 2 - width / 2;\n        if (left < 0) {\n            left = 0;\n        }\n    }\n    top = window.screenY;\n    height = window.innerHeight;\n    var features = 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top;\n    features += ',resizable,scrollbars';\n    window.open(url, uniqName, features)\n        .focus();\n}\n\nexport {openPopupWindow};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/popup-window/index.js\n **/","import './App.css';\nimport './leaflet-fixes.css';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport 'lib/leaflet.control.printPages/control'\nimport 'lib/leaflet.control.caption'\nimport config from './config'\nimport 'lib/leaflet.control.coordinates';\nimport enableLayersControlHotKeys from 'lib/leaflet.control.layers.hotkeys';\nimport 'lib/leaflet.hashState/Leaflet.Map';\nimport 'lib/leaflet.hashState/Leaflet.Control.Layers';\nimport {fixAll} from 'lib/leaflet.fixes'\nimport './adaptive.css';\nimport 'lib/leaflet.control.panoramas';\nimport 'lib/leaflet.control.track-list/track-list';\nimport 'lib/leaflet.control.track-list/control-ruler';\nimport 'lib/leaflet.control.track-list/track-list.hash-state';\nimport 'lib/leaflet.control.track-list/track-list.localstorage';\nimport enableLayersControlAdaptiveHeight from 'lib/leaflet.control.layers.adaptive-height';\nimport enableLayersMinimize from 'lib/leaflet.control.layers.minimize';\nimport enableLayersConfig from 'lib/leaflet.control.layers.configure';\nimport hashState from 'lib/leaflet.hashState/hashState';\nimport raiseControlsOnFocus from 'lib/leaflet.controls.raise-on-focus';\nimport getLayers from 'layers';\nimport 'lib/leaflet.control.layers.events';\nimport 'lib/leaflet.control.jnx';\nimport 'lib/leaflet.control.jnx/hash-state';\nimport 'lib/leaflet.control.azimuth';\n\n\nfunction setUp() {\n    fixAll();\n\n    const map = L.map('map', {\n            zoomControl: false,\n            fadeAnimation: false,\n            attributionControl: false,\n            inertiaMaxSpeed: 1500,\n            worldCopyJump: true,\n            maxZoom: 18\n        }\n    );\n    map.enableHashState('m', [10, 55.75185, 37.61856]);\n\n    const tracklist = new L.Control.TrackList();\n\n    /////////// controls top-left corner\n\n    new L.Control.Caption(`<a href=\"${config.newsUrl}\">News</a> | <a href=\"mailto:${config.email}\">nakarte@nakarte.tk</a>`, {\n            position: 'topleft'\n        }\n    ).addTo(map);\n\n    new L.Control.Scale({imperial: false, position: 'topleft'}).addTo(map);\n\n    L.control.zoom().addTo(map);\n\n    new L.Control.TrackList.Ruler(tracklist).addTo(map);\n\n    const panoramas = new L.Control.Panoramas(document.getElementById('street-view'))\n        .addTo(map)\n        .enableHashState('n2');\n    L.Control.Panoramas.hashStateUpgrader(panoramas).enableHashState('n');\n\n\n    new L.Control.Coordinates({position: 'topleft'}).addTo(map);\n\n    const azimuthControl = new L.Control.Azimuth({position: 'topleft'}).addTo(map);\n\n    /////////// controls top-right corner\n\n    const layersControl = L.control.layers(null, null, {collapsed: false})\n        .addTo(map);\n    enableLayersControlHotKeys (layersControl);\n    enableLayersControlAdaptiveHeight(layersControl);\n    enableLayersMinimize(layersControl);\n    enableLayersConfig(layersControl, getLayers());\n    layersControl.enableHashState('l');\n\n    /////////// controls bottom-left corner\n\n    const printControl = new L.Control.PrintPages({position: 'bottomleft'})\n        .addTo(map)\n        .enableHashState('p');\n    if (!printControl.hasPages()) {\n        printControl.setMinimized();\n    }\n\n    new L.Control.JNX(layersControl, {position: 'bottomleft'})\n        .addTo(map)\n        .enableHashState('j');\n\n    /////////// controls bottom-right corner\n\n    tracklist.addTo(map);\n    if (!hashState.getState('nktk')) {\n        tracklist.loadTracksFromStorage();\n    }\n    tracklist.enableHashState('nktk');\n\n\n    ////////// adaptive layout\n\n    if (L.Browser.mobile) {\n        layersControl.setMinimized();\n        if (!tracklist.hasTracks()) {\n            tracklist.setMinimized();\n        }\n    }\n\n    if (L.Browser.mobile) {\n        map.on('mousedown dragstart', () => layersControl.setMinimized())\n    }\n\n    raiseControlsOnFocus(map);\n\n    //////////// save state at unload\n\n    L.DomEvent.on(window, 'beforeunload', () => tracklist.saveTracksToStorage());\n\n    ////////// track list and azimuth measure interaction\n\n    tracklist.on('startedit', () => azimuthControl.setEnabled(false));\n    tracklist.on('elevation-shown', () => azimuthControl.hideProfile());\n    azimuthControl.on('enabled', () => {\n        tracklist.stopEditLine();\n    });\n    azimuthControl.on('elevation-shown', () => tracklist.hideElevationProfile());\n}\n\nexport default {setUp};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/App.js\n **/","import Raven from 'raven-js';\nimport './index.css';\nimport App from './App'\nimport config from './config';\n\n/* eslint-disable no-undef */\nif (NODE_ENV === 'production' && config.sentryDSN.length > 0) {\n    Raven.config(config.sentryDSN, {release: RELEASE_VER}).install();\n/* eslint-enable no-undef */\n}\n\nconst oldOnunhandledrejection = window.onunhandledrejection;\n\n// Not using addEventListener due to https://github.com/zloirock/core-js/issues/205\nwindow.onunhandledrejection = (e) => {\n    let result = true;\n    if (oldOnunhandledrejection) {\n         result = oldOnunhandledrejection(e);\n    }\n    console.error('Uncaught in promise:', e.reason);\n    const err = e.reason;\n    if (err && err.name) {\n        err.name = 'Uncaught in promise: ' + err.name;\n    }\n    Raven.captureException(err);\n    return result;\n};\n\n/* eslint-disable no-undef */\nconsole.log('Version:', RELEASE_VER);\n/* eslint-enable no-undef */\n\nApp.setUp();\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import L from \"leaflet\";\nimport 'lib/leaflet.layer.yandex';\nimport 'lib/leaflet.layer.google';\nimport 'lib/leaflet.layer.bing';\nimport config from './config';\nimport 'lib/leaflet.layer.soviet-topomaps-grid';\nimport 'lib/leaflet.layer.westraPasses';\nimport 'lib/leaflet.layer.nordeskart';\n// import 'lib/leaflet.layer.tracks-collection';\nimport 'lib/leaflet.layer.wikimapia';\n\nexport default function getLayers() {\n    const layers = [\n        {\n            group: 'Default layers',\n            layers: [\n                {\n                    title: 'OpenStreetMap',\n                    description: 'OSM default style',\n                    order: 10,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n                        {code: 'O', scaleDependent: true, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'ESRI Sat',\n                    order: 20,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: L.tileLayer(\n                        'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n                        {code: 'E', scaleDependent: false, maxNativeZoom: 17, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'Yandex map',\n                    order: 30,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: new L.Layer.Yandex('map', {scaleDependent: true, code: 'Y', print: true, jnx: true})\n                },\n                {\n                    title: 'Yandex Satellite',\n                    order: 40,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: new L.Layer.Yandex('sat', {scaleDependent: false, code: 'S', print: true, jnx: true})\n                },\n                {\n                    title: 'Google',\n                    order: 50,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: new L.Layer.Google('ROADMAP', {code: 'G', scaleDependent: true, print: true, jnx: true})\n                },\n                {\n                    title: 'Google Satellite',\n                    order: 60,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: new L.Layer.Google('SATELLITE', {code: 'L', scaleDependent: false, print: true, jnx: true})\n                },\n                {\n                    title: 'Google Terrain',\n                    order: 65,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: new L.Layer.Google('TERRAIN', {code: 'P', scaleDependent: false, print: true, jnx: true})\n                },\n                {\n                    title: 'Bing Sat',\n                    order: 70,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: L.bingLayer(config.bingKey, {code: 'I', scaleDependent: false, print: true, jnx: true})\n                },\n\n                {\n                    title: 'marshruty.ru',\n                    order: 80,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: L.tileLayer('http://maps.marshruty.ru/ml.ashx?x={x}&y={y}&z={z}&i=1&al=1',\n                        {code: 'M', maxNativeZoom: 18, noCors: true, scaleDependent: true, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'Topomapper 1km',\n                    order: 90,\n                    isOverlay: false,\n                    isDefault: true,\n                    layer: L.tileLayer(\n                        'http://144.76.234.108/cgi-bin/tapp/tilecache.py/1.0.0/topomapper_v2/{z}/{x}/{y}.jpg',\n                        {code: 'T', scaleDependent: false, maxNativeZoom: 13, noCors: true, print: true, jnx: true}\n                    )\n                },\n\n                {\n                    title: 'Topo 10km',\n                    order: 1010,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/topo001m/{z}/{x}/{y}\",\n                        {code: 'D', tms: true, scaleDependent: false, maxNativeZoom: 9, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'GGC 2 km',\n                    order: 1020,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc2000/{z}/{x}/{y}\",\n                        {code: 'N', tms: true, scaleDependent: false, maxNativeZoom: 12, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'ArbaletMO',\n                    order: 1030,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/ArbaletMO/{z}/{x}/{y}\",\n                        {code: 'A', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'Slazav mountains',\n                    order: 1040,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/map_hr/{z}/{x}/{y}\",\n                        {code: 'Q', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'GGC 1km',\n                    order: 1050,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc1000/{z}/{x}/{y}\",\n                        {code: 'J', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'Topo 1km',\n                    order: 1060,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/topo1000/{z}/{x}/{y}\",\n                        {code: 'C', tms: true, scaleDependent: false, maxNativeZoom: 13, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'GGC 500m',\n                    order: 1070,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc500/{z}/{x}/{y}\",\n                        {code: 'F', tms: true, scaleDependent: false, maxNativeZoom: 14, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'Topo 500m',\n                    order: 1080,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/topo500/{z}/{x}/{y}\",\n                        {code: 'B', tms: true, scaleDependent: false, maxNativeZoom: 14, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'GGC 250m',\n                    order: 1090,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/ggc250/{z}/{x}/{y}\",\n                        {code: 'K', tms: true, scaleDependent: false, maxNativeZoom: 15, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'Slazav map',\n                    order: 1100,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/map_podm/{z}/{x}/{y}\",\n                        {code: 'Z', tms: true, scaleDependent: false, maxNativeZoom: 14, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'O-sport',\n                    order: 1110,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/osport/{z}/{x}/{y}\",\n                        {code: 'R', tms: true, scaleDependent: false, maxNativeZoom: 17, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'Soviet topo maps grid',\n                    order: 1120,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: new L.Layer.SovietTopoGrid({code: 'Ng'})\n                },\n                {\n                    title: 'Wikimapia',\n                    order: 1130,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: new L.Wikimapia({code: 'W'}),\n                },\n                {\n                    title: 'Mountain passes (Westra)',\n                    order: 1140,\n                    isOverlay: true,\n                    isDefault: true,\n                    layer: new L.Layer.WestraPasses(config.westraDataBaseUrl, {\n                            code: 'Wp',\n                            print: true,\n                            scaleDependent: true\n                        }\n                    )\n                },\n                // {\n                //     title: 'Tracks',\n                //     order: 1150,\n                //     isOverlay: true,\n                //     isDefault: true,\n                //     layer: new L.TracksCollection({\n                //             tms: true,\n                //             maxNativeZoom: 12,\n                //             code: 'Tc',\n                //             print: false,\n                //         }\n                //     )\n                // },\n            ]\n        },\n        {\n            group: 'OpenStreetMap alternatives',\n            layers: [\n                {\n                    title: 'OpenTopoMap',\n                    order: 11,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n                        {code: 'Otm', maxNativeZoom: 17, scaleDependent: true, print: true, jnx: true, noCors: true}\n                    )\n                },\n                {\n                    title: 'OpenCycleMap',\n                    description: '<a href=\"https://www.opencyclemap.org/docs/\">(Info and key)</a>',\n                    order: 12,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer('http://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=' + config.thunderforestKey,\n                        {code: 'Ocm', scaleDependent: true, print: true, jnx: true}\n                    )\n                },\n                {\n                    title: 'OSM Outdoors',\n                    order: 13,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer('http://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey=' + config.thunderforestKey,\n                        {code: 'Oso', scaleDependent: true, print: true, jnx: true}\n                    )\n                },\n            ]\n        },\n        {\n            group: 'Topo maps',\n            layers: [\n                {\n                    title: 'Eurasia 25km',\n                    description: '1975-80',\n                    order: 1009,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/eurasia25km/{z}/{x}/{y}\",\n                        {code: 'E25m', tms: true, maxNativeZoom: 9, print: true, jnx: true, scaleDependent: false}\n                    )\n                },\n                {\n                    title: 'Caucasus 1km',\n                    order: 1061,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/new_gsh_100k/{z}/{x}/{y}\",\n                        {code: 'NT1', tms: true, maxNativeZoom: 14, print: true, jnx: true, scaleDependent: false}\n                    )\n                },\n                {\n                    title: 'Caucasus 500m',\n                    order: 1081,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/new_gsh_050k/{z}/{x}/{y}\",\n                        {code: 'NT5', tms: true, maxNativeZoom: 15, print: true, jnx: true, scaleDependent: false}\n                    )\n                },\n                {\n                    title: 'Topo 250m',\n                    order: 1095,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/topo250/{z}/{x}/{y}\",\n                        {code: 'T25', tms: true, maxNativeZoom: 15, print: true, jnx: true, scaleDependent: false}\n                    )\n                },\n                {\n                    title: 'Montenegro topo 250m',\n                    description: '1970-72',\n                    order: 1096,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"http://{s}.tiles.nakarte.tk/montenegro250m/{z}/{x}/{y}\",\n                        {code: 'MN25', tms: true, maxNativeZoom: 15, print: true, jnx: true, scaleDependent: false}\n                    )\n                }\n            ]\n        },\n        {\n            group: 'Mountains maps',\n            layers: [\n                {\n                    title: 'Mountains by Aleksey Tsvetkov',\n                    description: 'Tian Shan, Dzungaria, <a href=\"http://pereval.g-utka.ru/\">http://pereval.g-utka.ru/</a>',\n                    order: 1039,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"http://map.g-utka.ru/{z}/{x}/{y}.png\",\n                        // FIXME: сделать minZoom=5, когда перейдём на версию leaflet с поддержкой minNativeZoom\n                        {\n                            code: 'Mt',\n                            tms: false,\n                            minZoom: 7,\n                            minNativeZoom: 7,\n                            maxNativeZoom: 15,\n                            print: true,\n                            jnx: true,\n                            scaleDependent: false,\n                            noCors: true\n                        }\n                    )\n                }]\n        },\n        {\n            group: 'Norway <a href=\"https://www.ut.no/kart/\">https://www.ut.no/kart/</a>',\n            layers: [\n                {\n                    // Вместо 404 отдают 500 для отсутствующих тайлов\n                    title: 'Norway UT map',\n                    order: 500,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://tilesprod.ut.no/tilestache/ut_topo_light/{z}/{x}/{y}.jpg\",\n                        {code: 'Nu', tms: false, maxNativeZoom: 16, print: true, jnx: true, scaleDependent: true, noCors: true}\n                    )\n                },\n                {\n                    title: 'Norway paper map',\n                    order: 1031,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: new L.TileLayer.Nordeskart('http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=toporaster3&zoom={z}&x={x}&y={y}&gkt={baatToken}',\n                        {code: 'Np', maxNativeZoom: 16, tms: false, print: true, jnx: true, scaleDependent: true}\n                    )\n                },\n                {\n                    title: 'Norway map',\n                    order: 1032,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: new L.TileLayer.Nordeskart('http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=topo2&zoom={z}&x={x}&y={y}&gkt={baatToken}',\n                        {code: 'Nm', tms: false, print: true, jnx: true, scaleDependent: true}\n                    )\n                },\n                {\n                    title: 'Norway summer trails',\n                    order: 2000,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://tilesprod.ut.no/tilestache/dnt_sommer/{z}/{x}/{y}.png\",\n                        {code: 'Ns', tms: false, print: true, jnx: true, scaleDependent: true, noCors: true}\n                    )\n                },\n                {\n                    title: 'Norway winter trails',\n                    order: 2001,\n                    isOverlay: true,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://tilesprod.ut.no/tilestache/dnt_vinter/{z}/{x}/{y}.png\",\n                        {code: 'Nw', tms: false, print: true, jnx: true, scaleDependent: true, noCors: true}\n                    )\n                },\n                {\n                    // Вместо 404 отдают 500 для отсутствующих тайлов\n                    title: 'Norway roads',\n                    description: '<a href=\"http://kart.finn.no/\">http://kart.finn.no/</a>',\n                    order: 503,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer(\"http://maptiles1.finncdn.no/tileService/1.0.3/normap/{z}/{x}/{y}.png\",\n                        {code: 'Nr', tms: false, print: true, jnx: true, scaleDependent: true, noCors: true}\n                    )\n                }]\n        },\n        {\n            group: 'Czech <a href=\"http://mapy.cz\">http://mapy.cz</a>',\n            layers: [\n                {\n                    title: 'Czech basic',\n                    order: 504,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://m{s}.mapserver.mapy.cz/base-m/{z}-{x}-{y}\",\n                        {code: 'Czb', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true}\n                    )\n                },\n                {\n                    title: 'Czhch tourist',\n                    order: 505,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://m{s}.mapserver.mapy.cz/wturist-m/{z}-{x}-{y}\",\n                        {code: 'Czt', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true}\n                    )\n                },\n                {\n                    title: 'Czech summer',\n                    order: 506,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://m{s}.mapserver.mapy.cz/turist_aquatic-m/{z}-{x}-{y}\",\n                        {code: 'Czs', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true}\n                    )\n                },\n                {\n                    title: 'Czech winter',\n                    order: 507,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://m{s}.mapserver.mapy.cz/wturist_winter-m/{z}-{x}-{y}\",\n                        {code: 'Czw', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true}\n                    )\n                },\n                {\n                    title: 'Czech geographical',\n                    order: 508,\n                    isOverlay: false,\n                    isDefault: false,\n                    layer: L.tileLayer(\"https://m{s}.mapserver.mapy.cz/zemepis-m/{z}-{x}-{y}\",\n                        {code: 'Czg', tms: false, print: true, jnx: true, subdomains: '1234', scaleDependent: true}\n                    )\n                }]\n        }\n    ];\n    // TODO: move it to tests\n    const codes = {};\n    const orders = {};\n    for (let group of layers) {\n        for (let layer of group.layers) {\n            if (!layer.layer.options) {\n                throw new Error('Layer without options: ' + layer.title);\n            }\n            let code = layer.layer.options.code;\n            if (!code) {\n                throw new Error('Layer without code: ' + layer.title);\n            }\n            if (code in codes) {\n                throw new Error(`Duplicate layer code \"${code}\"`);\n            }\n            codes[code] = 1;\n            let order = layer.order;\n            if (!order) {\n                throw new Error('Layer without order: ' + layer.title);\n            }\n            if (order in orders) {\n                throw new Error(`Duplicate layer order \"${order}\"`);\n            }\n            orders[order] = 1;\n        }\n    }\n    return layers;\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/layers.js\n **/","class Cache {\n    constructor(maxSize) {\n        this._maxSize = maxSize;\n        this._store = {};\n        this._size = 0;\n    }\n\n    get(key) {\n        if (key in this._store) {\n            const value = this._store[key];\n            delete this._store[key];\n            this._store[key] = value;\n            return {value, found: true};\n        }\n        return {found: false}\n    }\n\n    put(key, value) {\n        if (key in this._store) {\n            delete this._store[key];\n        } else {\n            this._size += 1;\n        }\n        this._store[key] = value;\n        if (this._size > this._maxSize) {\n            delete this._store[Object.keys(this._store)[0]];\n            this._size -= 1;\n        }\n    }\n}\n\nexport {Cache}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/cache/index.js\n **/","import {arrayBufferToString} from 'lib/binary-strings';\n\nconst selectFiles = (() => {\n    let fileInput;\n    return function selectFiles(multiple = false) {\n        if (fileInput) {\n            document.body.removeChild(fileInput);\n        }\n        fileInput = document.createElement('input');\n        document.body.appendChild(fileInput);\n        fileInput.type = 'file';\n        fileInput.multiple = !!multiple;\n        fileInput.style.display = 'none';\n\n        const result = new Promise(function(resolve) {\n                fileInput.addEventListener('change', function() {\n                        resolve(fileInput.files);\n                    }\n                );\n            }\n        );\n        fileInput.click();\n        return result;\n    }\n})();\n\nfunction readFile(file) {\n    return new Promise(function(resolve) {\n            var reader = new FileReader();\n            reader.onload = function(e) {\n                resolve({\n                        data: arrayBufferToString(e.target.result),\n                        filename: file.name\n                    }\n                );\n            };\n            reader.readAsArrayBuffer(file);\n        }\n    );\n}\n\nfunction readFiles(files) {\n    files = Array.prototype.slice.apply(files);\n    return Promise.all(files.map(readFile));\n}\n\n\nexport {selectFiles, readFile, readFiles};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/file-read/index.js\n **/","import L from 'leaflet';\nimport ko from 'knockout';\nimport 'lib/leaflet.control.commons';\nimport layout from './control.html';\nimport 'lib/controls-styles/controls-styles.css';\nimport './style.css';\nimport {getDeclination} from 'lib/magnetic-declination';\nimport 'vendored/github.com/bbecquet/Leaflet.RotatedMarker/leaflet.rotatedMarker';\nimport iconPointer from './pointer.svg';\nimport iconPointerStart from './pointer-start.svg';\nimport iconPointerEnd from './pointer-end.svg';\nimport {ElevationProfile, calcSamplingInterval} from 'lib/leaflet.control.elevation-profile';\n\nfunction radians(x) {\n    return x / 180 * Math.PI;\n}\n\nfunction degrees(x) {\n    return x / Math.PI * 180;\n}\n\nfunction calcAzimuth(latlng1, latlng2) {\n    const lat1 = radians(latlng1.lat);\n    const lat2 = radians(latlng2.lat);\n    const lng1 = radians(latlng1.lng);\n    const lng2 = radians(latlng2.lng);\n\n    const y = Math.sin(lng2 - lng1) * Math.cos(lat2);\n    const x = Math.cos(lat1) * Math.sin(lat2) -\n        Math.sin(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1);\n    let brng = Math.atan2(y, x);\n    brng = degrees(brng);\n    return brng;\n}\n\n\nfunction calcAngle(latlng1, latlng2) {\n    const p1 = L.Projection.SphericalMercator.project(latlng1);\n    const p2 = L.Projection.SphericalMercator.project(latlng2);\n    const delta = p2.subtract(p1);\n    const angle = Math.atan2(delta.x, delta.y);\n    return degrees(angle);\n}\n\nfunction roundAzimuth(a) {\n    return (Math.round(a) + 360) % 360\n}\n\nL.Control.Azimuth = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        includes: L.Mixin.Events,\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._enabled = ko.observable(false);\n            this.trueAzimuth = ko.observable(null);\n            this.magneticAzimuth = ko.observable(null);\n            this.distance = ko.observable(null);\n            this.points = {\n                start: null,\n                end: null\n            };\n            const iconSingle = L.icon({iconUrl: iconPointer, iconSize: [30, 30]});\n            const iconStart = L.icon({iconUrl: iconPointerStart, iconSize: [40, 40]});\n            const iconEnd = L.icon({iconUrl: iconPointerEnd, iconSize: [40, 40]});\n            this.markers = {\n                single: L.marker([0, 0], {icon: iconSingle, draggable: true, which: 'start'})\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation),\n                start: L.marker([0, 0], {icon: iconStart, draggable: true, which: 'start', rotationOrigin: 'center center'})\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this),\n                end: L.marker([0, 0], {icon: iconEnd, draggable: true, which: 'end', rotationOrigin: 'center center'})\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this)\n            };\n            this.azimuthLine = L.polyline([], {interactive: false, weight: 1.5});\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container =\n                L.DomUtil.create('div', 'leaflet-control leaflet-control-button leaflet-control-azimuth');\n            this._stopContainerEvents();\n            container.innerHTML = layout;\n            container.title = \"Measure bearing, display line of sight\";\n            ko.applyBindings(this, container);\n            L.DomEvent.on(container, 'click', this.onClick, this);\n            return container;\n        },\n\n        onClick: function() {\n            this.setExpanded(true);\n        },\n\n        onMinimizeButtonClick: function(e) {\n            setTimeout(() => this.setExpanded(false), 0);\n        },\n\n        onMarkerDrag: function(e) {\n            const marker = e.target;\n            this.setPoints({[marker.options.which]: marker.getLatLng()});\n        },\n\n        onMarkerDragEnd: function() {\n            if (this.elevationControl) {\n                this.showProfile();\n            }\n        },\n\n        setExpanded: function(expanded) {\n            if (!!expanded === this.isExpanded()) {\n                return;\n            }\n            if (expanded) {\n                L.DomUtil.addClass(this._container, 'expanded');\n            } else {\n                L.DomUtil.removeClass(this._container, 'expanded');\n                this.hideProfile();\n                this.setPoints({start: null, end: null});\n            }\n            this.setEnabled(expanded);\n        },\n\n        setEnabled: function(enabled) {\n            if (!!enabled === this.isEnabled()) {\n                return;\n            }\n            if (enabled) {\n                L.DomUtil.addClass(this._map._container, 'azimuth-control-active');\n                this._map.on('click', this.onMapClick, this);\n                this.fire('enabled');\n            } else {\n                L.DomUtil.removeClass(this._map._container, 'azimuth-control-active');\n                this._map.off('click', this.onMapClick, this);\n            }\n            this._map.clickLocked = enabled;\n            this._enabled(!!enabled);\n        },\n\n        isEnabled: function() {\n            return !!this._enabled();\n        },\n\n        onEnableButtonClick: function() {\n            this.setEnabled(!this.isEnabled());\n        },\n\n        isExpanded: function() {\n            return L.DomUtil.hasClass(this._container, 'expanded');\n        },\n\n        setPoints: function(points) {\n            Object.assign(this.points, points);\n            points = this.points;\n            if (points.start && !points.end) {\n                this.markers.single\n                    .setLatLng(points.start)\n                    .addTo(this._map);\n            } else {\n                this.markers.single.removeFrom(this._map);\n            }\n            if (points.start && points.end) {\n                const angle = calcAngle(points.start, points.end);\n                this.markers.start\n                    .setLatLng(points.start)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.markers.end\n                    .setLatLng(points.end)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.azimuthLine\n                    .setLatLngs([[points.start, points.end]])\n                    .addTo(this._map);\n            } else {\n                this.markers.start.removeFrom(this._map);\n                this.markers.end.removeFrom(this._map);\n                this.azimuthLine.removeFrom(this._map);\n            }\n            this.updateValuesDisplay();\n        },\n\n        updateValuesDisplay: function() {\n            if (this.points.start && this.points.end) {\n                const points = this.points;\n                const azimuth = calcAzimuth(points.start, points.end);\n                this.trueAzimuth(roundAzimuth(azimuth));\n                const declination = getDeclination(points.start.lat, points.start.lng);\n                if (declination !== null) {\n                    this.magneticAzimuth(roundAzimuth(azimuth - declination));\n                } else {\n                    this.magneticAzimuth(null);\n                }\n                this.distance(points.start.distanceTo(points.end));\n\n            } else {\n                this.distance(null);\n                this.trueAzimuth(null);\n                this.magneticAzimuth(null);\n            }\n        },\n\n        onMapClick: function(e) {\n            if (!this.points.start && !this.points.end) {\n                this.setPoints({start: e.latlng})\n            } else if (this.points.start && !this.points.end) {\n                this.setPoints({end: e.latlng})\n            } else if (this.points.start && this.points.end) {\n                this.hideProfile();\n                this.setPoints({start: e.latlng, end: null})\n            }\n        },\n\n        showProfile: function() {\n            if (!this.points.end) {\n                return;\n            }\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n\n            const dist = this.points.start.distanceTo(this.points.end);\n            this.elevationControl = new ElevationProfile(this._map, [this.points.start, this.points.end], {\n                samplingInterval: calcSamplingInterval(dist),\n                sightLine: true\n            });\n            this.elevationControl.on('remove', () => this.elevationControl = null);\n            this.fire('elevation-shown');\n\n        },\n\n        hideProfile: function() {\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n            this.elevationControl = null;\n        },\n\n        onProfileButtonClick: function() {\n            this.showProfile();\n        },\n\n        onReverseButtonClick: function() {\n            if (this.points.end && this.points.start) {\n                this.setPoints({start: this.points.end, end: this.points.start});\n                if (this.elevationControl) {\n                    this.showProfile();\n                }\n\n            }\n        }\n\n    }\n);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.azimuth/index.js\n **/","import L from 'leaflet';\nimport './style.css';\nimport 'lib/leaflet.control.commons';\n\nL.Control.Caption = L.Control.extend({\n    options: {\n        position: 'bottomright',\n        className: 'leaflet-control-caption'\n    },\n\n    initialize: function (contents, options) {\n        L.setOptions(this, options);\n        this._contents = contents;\n    },\n\n    onAdd: function (map) {\n        this._map = map;\n        this._container = L.DomUtil.create('div', this.options.className);\n        this._stopContainerEvents();\n        this._container.innerHTML = this._contents;\n        L.DomEvent.on(this._container, 'contextmenu', (e) => {\n            L.DomEvent.stopPropagation(e);\n            e.returnValue = true;\n            return true;\n        });\n        return this._container;\n    },\n\n    setContents: function(contents) {\n        this._contents = contents;\n        if (this._map) {\n            this._container.innerHTML = this._contents;\n        }\n    }\n\n});\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.caption/index.js\n **/","import L from 'leaflet'\nimport './coordinates.css';\nimport copyToClipboard from 'lib/clipboardCopy';\nimport Contextmenu from 'lib/contextmenu';\nimport 'lib/leaflet.control.commons';\nimport safeLocalStorage from 'lib/safe-localstorage';\nimport 'lib/controls-styles/controls-styles.css';\n\nfunction pad(s, n) {\n    var j = s.indexOf('.');\n    if (j === -1) {\n        j = s.length;\n    }\n    var zeroes = (n - j);\n    if (zeroes > 0) {\n        s = Array(zeroes + 1).join('0') + s;\n    }\n    return s;\n}\n\nfunction mod(n, m) {\n    return ((n % m) + m) % m;\n}\n\nfunction normalizeLongitude(lng) {\n    return mod(lng + 180, 360) - 180;\n}\n\nL.Control.Coordinates = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        formatNames: {\n            'd': 'ddd.ddddd',\n            'D': 'ddd.ddddd&deg',\n            'DM': 'ddd&deg;mm.mmm\\'',\n            'DMS': 'ddd&deg;mm\\'ss.s\"'\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            var container = this._container =\n                L.DomUtil.create('div', 'leaflet-control leaflet-control-button leaflet-control-coordinates');\n            container.title = \"Show coordinates at cursor\";\n            this._stopContainerEvents();\n            this._field_lat = L.DomUtil.create('div', 'leaflet-control-coordinates-text', container);\n            this._field_lon = L.DomUtil.create('div', 'leaflet-control-coordinates-text', container);\n            L.DomEvent\n                .on(container, {\n                        'click': this.onClick\n                    }, this\n                );\n            this.menu = new Contextmenu([\n                    {text: 'Click map to copy coordinates to clipboard', callback: this.prepareForClickOnMap.bind(this)},\n                    '-',\n                    {text: '&plusmn;ddd.ddddd', callback: this.onMenuSelect.bind(this, 'd')},\n                    {text: 'ddd.ddddd&deg;', callback: this.onMenuSelect.bind(this, 'D')},\n                    {text: 'ddd&deg;mm.mmm\\'', callback: this.onMenuSelect.bind(this, 'DM')},\n                    {text: 'ddd&deg;mm\\'ss.s\"', callback: this.onMenuSelect.bind(this, 'DMS')}\n                ]\n            );\n            this.loadStateFromStorage();\n            this.onMouseMove();\n            L.DomEvent.on(container, 'contextmenu', this.onRightClick, this);\n            return container;\n        },\n\n        loadStateFromStorage: function() {\n            var active = false,\n                fmt = 'D';\n            active = safeLocalStorage.leafletCoordinatesActive === '1';\n            fmt = safeLocalStorage.leafletCoordinatesFmt || fmt;\n            this.setEnabled(active);\n            this.setFormat(fmt);\n        },\n\n        saveStateToStorage: function() {\n            safeLocalStorage.leafletCoordinatesActive = this.isEnabled() ? '1' : '0';\n            safeLocalStorage.leafletCoordinatesFmt = this.fmt;\n        },\n\n        formatCoodinate: function(value, isLat, fmt) {\n            if (value === undefined || isNaN(value)) {\n                return '-------';\n            }\n            fmt = fmt || this.fmt;\n            var h, d, m, s;\n            if (isLat) {\n                h = (value < 0) ? 'S' : 'N';\n            } else {\n                h = (value < 0) ? 'W' : 'E';\n            }\n            if (fmt === 'd') {\n                d = value.toFixed(5);\n                d = pad(d, isLat ? 2 : 3);\n                return d;\n            }\n\n            value = Math.abs(value);\n            if (fmt === 'D') {\n                d = value.toFixed(5);\n                d = pad(d, isLat ? 2 : 3);\n                return `${h} ${d}&deg;`;\n            }\n            if (fmt === 'DM') {\n                d = Math.floor(value).toString();\n                d = pad(d, isLat ? 2 : 3);\n                m = ((value - d) * 60).toFixed(3);\n                m = pad(m, 2);\n                return `${h} ${d}&deg;${m}'`\n            }\n            if (fmt === 'DMS') {\n                d = Math.floor(value).toString();\n                d = pad(d, isLat ? 2 : 3);\n                m = Math.floor((value - d) * 60).toString();\n                m = pad(m, 2);\n                s = ((value - d - m / 60) * 3600).toFixed(2);\n                s = pad(s, 2);\n                return `${h} ${d}&deg;${m}'${s}\"`;\n            }\n        },\n\n        onMenuSelect: function(fmt) {\n            this.setFormat(fmt);\n            this.saveStateToStorage();\n        },\n\n        setFormat: function(fmt) {\n            this.fmt = fmt;\n            this.onMouseMove();\n        },\n\n        onMouseMove: function(e) {\n            var lat, lng;\n            if (e) {\n                ({lat, lng} = e.latlng);\n            }\n            lng = normalizeLongitude(lng);\n            this._field_lat.innerHTML = this.formatCoodinate(lat, true);\n            this._field_lon.innerHTML = this.formatCoodinate(lng, false);\n        },\n\n        setEnabled: function(enabled) {\n            if (!!enabled === this.isEnabled()) {\n                return;\n            }\n            if (enabled) {\n                L.DomUtil.addClass(this._container, 'expanded');\n                L.DomUtil.addClass(this._map._container, 'coordinates-control-active');\n                this._map.on('mousemove', this.onMouseMove, this);\n                this._map.on('contextmenu', this.onMapRightClick, this);\n            } else {\n                L.DomUtil.removeClass(this._container, 'expanded');\n                L.DomUtil.removeClass(this._map._container, 'coordinates-control-active');\n                this._map.off('contextmenu', this.onMapRightClick, this);\n                this._map.off('mousemove', this.onMouseMove, this);\n            }\n        },\n\n        onMapRightClick: function(e) {\n            const items = [{text: '<b>Copy coordinates to clipboard</b>', header: true}, '-'];\n\n            const lat = e.latlng.lat,\n                lng = normalizeLongitude(e.latlng.lng);\n\n            for (let fmt of ['d', 'D', 'DM', 'DMS']) {\n                let strLat = this.formatCoodinate(lat, true, fmt);\n                let strLng = this.formatCoodinate(lng, false, fmt);\n                let s = `${strLat} ${strLng}`;\n                items.push({\n                        text: `${s} <span class=\"leaflet-coordinates-menu-fmt\">${this.formatNames[fmt]}</span>`,\n                        callback: () => {\n                            copyToClipboard(s.replace(/&deg;/g, '°'), e.originalEvent);\n                        }\n                    }\n                )\n            }\n            const menu = new Contextmenu(items);\n            menu.show(e);\n        },\n\n        isEnabled: function() {\n            return L.DomUtil.hasClass(this._container, 'expanded');\n        },\n\n        onClick: function(e) {\n            this.setEnabled(!this.isEnabled());\n            this.saveStateToStorage();\n            this.onMouseMove();\n        },\n\n        onRightClick: function(e) {\n            this.menu.show(e);\n        },\n\n        onMapClick: function(e) {\n            var s = this.formatCoodinate(e.latlng.lat, true) + ' ' + this.formatCoodinate(e.latlng.lng, false);\n            s = s.replace(/&deg;/g, '°');\n            copyToClipboard(s, e.originalEvent);\n        },\n\n        prepareForClickOnMap: function() {\n            this._map.once('click', this.onMapClick, this);\n        }\n\n\n\n        // TODO: onRemove\n\n    }\n);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.coordinates/index.js\n **/","import utf8 from 'utf8'\n\nclass BinStream {\n    constructor(size, littlEndian) {\n        this.maxSize = 1024;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        this._pos = 0;\n        this.size = 0;\n        this.littlEndian = littlEndian;\n    }\n\n    grow() {\n        this.maxSize *= 2;\n        const old_buffer = this.dv.buffer;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        const newAr = new Uint8Array(this.dv.buffer);\n        const oldAr = new Uint8Array(old_buffer);\n        for (let i = 0; i < oldAr.length; i++) {\n            newAr[i] = oldAr[i];\n        }\n    };\n\n    checkSize(size) {\n        if (this._pos + size >= this.maxSize) {\n            this.grow();\n        }\n        const newPos = this._pos + size;\n        this.size = (newPos > this.size) ? newPos : this.size;\n    };\n\n    writeUint8(value) {\n        this.checkSize(1);\n        this.dv.setUint8(this._pos, value);\n        this._pos += 1;\n    };\n\n    writeInt8(value) {\n        this.checkSize(1);\n        this.dv.setInt8(this._pos, value);\n        this._pos += 1;\n    };\n\n    writeInt16(value) {\n        this.checkSize(2);\n        this.dv.setInt16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    };\n\n    writeUint16(value) {\n        this.checkSize(2);\n        this.dv.setUint16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    };\n\n    writeInt32(value) {\n        this.checkSize(4);\n        this.dv.setInt32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    };\n\n    writeUint32(value) {\n        this.checkSize(4);\n        this.dv.setUint32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    };\n\n    writeString(s, zeroTerminated) {\n        s = utf8.encode(s);\n        for (let i = 0; i < s.length; i++) {\n            this.writeUint8(s.charCodeAt(i));\n        }\n        if (zeroTerminated) {\n            this.writeUint8(0);\n        }\n    };\n\n    tell() {\n        return this._pos;\n    };\n\n    seek(pos) {\n        this._pos = pos;\n    };\n\n    getBuffer() {\n        return this.dv.buffer.slice(0, this.size);\n    };\n}\n\nexport {BinStream}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.jnx/binary-stream.js\n **/","import L from 'leaflet';\nimport  '../leaflet.control.layers.hotkeys/index';\nimport 'lib/leaflet.hashState/leaflet.hashState';\n\nL.Control.JNX.include(L.Mixin.HashState);\nL.Control.JNX.include({\n        stateChangeEvents: ['selectionchange'],\n\n        serializeState: function() {\n            let state;\n            if (this._selector) {\n                const bounds = this._selector.getBounds();\n                state = [\n                    bounds.getSouth().toFixed(5),\n                    bounds.getWest().toFixed(5),\n                    bounds.getNorth().toFixed(5),\n                    bounds.getEast().toFixed(5)];\n            }\n            return state;\n        },\n\n        unserializeState: function(values) {\n            function validateFloat(value, min, max) {\n                value = parseFloat(value);\n                if (isNaN(value) || value < min || value > max) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            if (values && values.length === 4) {\n                try {\n                    var south = validateFloat(values[0], -86, 86),\n                        west = validateFloat(values[1], -180, 180),\n                        north = validateFloat(values[2], -86, 86),\n                        east = validateFloat(values[3], -180, 180);\n                } catch (e) {\n                    if (e.message === 'INVALID VALUE') {\n                        return false;\n                    }\n                    throw e;\n                }\n                this.removeSelector();\n                this.addSelector([[south, west], [north, east]]);\n                return true;\n            } else {\n                return false;\n            }\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.jnx/hash-state.js\n **/","import L from 'leaflet';\nimport ko from 'vendored/knockout';\nimport './style.css';\nimport 'lib/leaflet.control.commons';\nimport {RectangleSelect} from './selector';\nimport Contextmenu from 'lib/contextmenu';\nimport {makeJnxFromLayer, minZoom} from './jnx-maker';\nimport {saveAs} from 'browser-filesaver';\nimport {notify} from 'lib/notifications';\nimport logging from 'lib/logging';\n\nL.Control.JNX = L.Control.extend({\n        includes: L.Mixin.Events,\n\n        initialize: function(layersControl, options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._layersControl = layersControl;\n            this.makingJnx = ko.observable(false);\n            this.downloadProgressRange = ko.observable(1);\n            this.downloadProgressDone = ko.observable(0);\n            this.contextMenu = new Contextmenu(() => this.makeMenuItems());\n        },\n\n        getLayerForJnx: function() {\n            let selectedLayer = {};\n            for (let layerRec of this._layersControl._layers) {\n                let layer = layerRec.layer;\n                if (this._map.hasLayer(layer) && layer.options && layer.options.jnx) {\n                    selectedLayer = {\n                        layer,\n                        layerName: layerRec.name\n                    }\n                }\n            }\n            return selectedLayer;\n        },\n\n        estimateTilesCount: function(maxZoom) {\n            let tilesCount = 0;\n            const bounds = this._selector.getBounds();\n            for (let zoom=minZoom(maxZoom); zoom <= maxZoom; zoom++) {\n                const topLeftTile = this._map.project(bounds.getNorthWest(), zoom).divideBy(256).floor();\n                const bottomRightTile = this._map.project(bounds.getSouthEast(), zoom).divideBy(256).ceil();\n                tilesCount += Math.ceil((bottomRightTile.x - topLeftTile.x) * (bottomRightTile.y - topLeftTile.y));\n            }\n            return tilesCount;\n        },\n\n        makeMenuItems: function() {\n            const {layer, layerName} = this.getLayerForJnx();\n            if (!layer) {\n                return [{text: 'No supported layer'}];\n            }\n            const maxLevel = layer.options.maxNativeZoom || layer.options.maxZoom || 18;\n            const minLevel = Math.max(0, maxLevel - 6);\n\n            const equatorLength = 40075016;\n            const lat = this._selector.getBounds().getCenter().lat;\n            let metersPerPixel = equatorLength / Math.pow(2, maxLevel) / 256 * Math.cos(lat / 180 * Math.PI);\n\n            const items = [{text: layerName, header: true}];\n            for (let zoom = maxLevel; zoom >= minLevel; zoom -= 1) {\n                let tilesCount = this.estimateTilesCount(zoom);\n                let fileSizeMb = tilesCount * 0.02;\n                let itemClass = tilesCount > 50000 ? 'jnx-menu-warning' : '';\n                let resolutionString = metersPerPixel.toFixed(2);\n                let sizeString = fileSizeMb.toFixed(fileSizeMb > 1 ? 0 : 1);\n                let item = {\n                    text: `<span class=\"${itemClass}\">Zoom ${zoom} (${resolutionString} m/pixel) &mdash; ${tilesCount} tiles (~${sizeString} Mb)</span>`,\n                    callback: () => this.makeJnx(layer, layerName, zoom),\n                    disabled: this.makingJnx()\n                };\n                items.push(item);\n                metersPerPixel *= 2;\n            }\n            return items;\n        },\n\n        notifyProgress: function(value, maxValue) {\n            this.downloadProgressDone(this.downloadProgressDone() + value);\n            this.downloadProgressRange(maxValue);\n        },\n\n        makeJnx: function(layer, layerName, zoom) {\n            logging.captureBreadcrumbWithUrl({message: 'start making jnx'});\n            this.makingJnx(true);\n            this.downloadProgressDone(0);\n\n            const bounds = this._selector.getBounds();\n            const sanitizedLayerName = layerName.toLowerCase().replace(/[ ()]+/, '_');\n            const fileName = `nakarte.tk_${sanitizedLayerName}_z${zoom}.jnx`;\n            makeJnxFromLayer(layer, layerName, zoom, bounds, this.notifyProgress.bind(this))\n                .then((fileData) => saveAs(fileData, fileName, true))\n                .catch((e) => {\n                        logging.captureException(e);\n                        notify(`Failed to create JNX: ${e.message}`);\n                    }\n                )\n                .then(() => this.makingJnx(false));\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-jnx');\n            container.innerHTML = `\n                <a class=\"button\" data-bind=\"visible: !makingJnx(), click: onButtonClicked\"\n                 title=\"Make JNX for Garmin receivers\">JNX</a>\n                <div data-bind=\"\n                    component:{\n                        name: 'progress-indicator',\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                    },\n                    visible: makingJnx()\"></div>`;\n            ko.applyBindings(this, container);\n            this._stopContainerEvents();\n            return container;\n        },\n\n        removeSelector: function() {\n            if (this._selector) {\n                this._map.removeLayer(this._selector);\n                this._selector = null;\n                this.fire('selectionchange');\n            }\n        },\n\n        addSelector: function(bounds) {\n            if (!bounds) {\n                bounds = this._map.getBounds().pad(-0.25);\n            }\n            this._selector = new RectangleSelect(bounds)\n                .addTo(this._map)\n                .on('change', () => this.fire('selectionchange'))\n                .on('click contextmenu', (e) => this.contextMenu.show(e));\n            this.fire('selectionchange');\n        },\n\n\n        onButtonClicked: function() {\n            if (this._selector) {\n                if (this._selector.getBounds().intersects(this._map.getBounds().pad(-0.05))) {\n                    this.removeSelector();\n                } else {\n                    this.removeSelector();\n                    this.addSelector();\n                }\n\n            } else {\n                this.addSelector();\n            }\n        },\n    }\n);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.jnx/index.js\n **/","import L from 'leaflet';\nimport {BinStream} from './binary-stream';\n\nfunction jnxCoordinates(extents) {\n    function toJnx(x) {\n        return Math.round(x / 180.0 * 0x7fffffff);\n    }\n\n    return [toJnx(extents.north), toJnx(extents.east), toJnx(extents.south), toJnx(extents.west)];\n}\n\nconst JnxWriter = L.Class.extend({\n        initialize: function(productName, productId, zOrder) {\n            this.tiles = {};\n            this.productName = productName || 'Raster map';\n            this.productId = productId || 0;\n            this.zOrder = zOrder;\n        },\n\n        addTile: function(tileData, level, latLngBounds) {\n            this.tiles[level] = this.tiles[level] || [];\n            tileData = new Blob([tileData]).slice(2);\n            const extents = {\n                west: latLngBounds.getWest(),\n                north: latLngBounds.getNorth(),\n                south: latLngBounds.getSouth(),\n                east: latLngBounds.getEast(),\n\n            };\n            this.tiles[level].push({data: tileData, extents: extents});\n        },\n\n        getJnx: function() {\n            const  HEADER_SIZE = 52,\n                LEVEL_INFO_SIZE = 17,\n                TILE_INFO_SIZE = 28;\n\n            let totalTilesCount = 0;\n            for (let levelTiles of Object.values(this.tiles)) {\n                totalTilesCount += levelTiles.length;\n            }\n            if (totalTilesCount === 0) {\n                throw new Error('No tiles collected, JNX is empty');\n            }\n            if (totalTilesCount > 50000) {\n                throw new Error('Too many tiles found (more then 50000)');\n            }\n\n            let west = 1e10,\n                east = -1e10,\n                north = -1e10,\n                south = 1e10,\n                levels_n = Object.keys(this.tiles).length,\n                level, tiles, extents,\n                i, tile;\n            for (let levelTiles of Object.values(this.tiles)) {\n                for (let tile of levelTiles) {\n                    west = (west < tile.extents.west) ? west : tile.extents.west;\n                    east = (east > tile.extents.east) ? east : tile.extents.east;\n                    north = (north > tile.extents.north) ? north : tile.extents.north;\n                    south = (south < tile.extents.south) ? south : tile.extents.south;\n                }\n            }\n            const  stream = new BinStream(1024, true);\n            // header\n            stream.writeInt32(4); // version\n            stream.writeInt32(0); // device id\n            extents = jnxCoordinates({south: south, north: north, west: west, east: east});\n            stream.writeInt32(extents[0]); // north\n            stream.writeInt32(extents[1]); // west\n            stream.writeInt32(extents[2]); // south\n            stream.writeInt32(extents[3]); // east\n            stream.writeInt32(levels_n); // number of zoom levels\n            stream.writeInt32(0); //expiration date\n            stream.writeInt32(this.productId);\n            stream.writeInt32(0); // tiles CRC32\n            stream.writeInt32(0); // signature version\n            stream.writeUint32(0); // signature offset\n            stream.writeInt32(this.zOrder);\n            stream.seek(HEADER_SIZE + LEVEL_INFO_SIZE * levels_n);\n            // map description\n            stream.writeInt32(9); // section version\n            stream.writeString('12345678-1234-1234-1234-123456789ABC', true); // GUID\n            stream.writeString(this.productName, true);\n            stream.writeString('', true);\n            stream.writeInt16(this.productId);\n            stream.writeString(this.productName, true);\n            stream.writeInt32(levels_n);\n            // levels descriptions\n            for (level of Object.keys(this.tiles)) {\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeInt32(level);\n            }\n            let tileDescriptorOffset = stream.tell();\n            // level info\n            let  jnxScale;\n            stream.seek(HEADER_SIZE);\n            for (level of Object.keys(this.tiles)) {\n                level = parseInt(level, 10);\n                stream.writeInt32(this.tiles[level].length);\n                stream.writeUint32(tileDescriptorOffset);\n                //jnxScale = JnxScales[level + 3];\n                jnxScale = 34115555 / (Math.pow(2, level)) * Math.cos((north + south) / 2 / 180 * Math.PI) / 1.1;\n                stream.writeInt32(jnxScale);\n                stream.writeInt32(2);\n                stream.writeUint8(0);\n                tileDescriptorOffset += TILE_INFO_SIZE * this.tiles[level].length;\n            }\n            // tiles descriptors\n            stream.seek(stream.size);\n            let tileDataOffset = tileDescriptorOffset;\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    extents = jnxCoordinates(tile.extents);\n                    stream.writeInt32(extents[0]); // north\n                    stream.writeInt32(extents[1]); // west\n                    stream.writeInt32(extents[2]); // south\n                    stream.writeInt32(extents[3]); // east\n                    stream.writeInt16(256); // width\n                    stream.writeInt16(256); // height\n                    stream.writeInt32(tile.data.size);\n                    stream.writeUint32(tileDataOffset);\n                    tileDataOffset += tile.data.size;\n                }\n            }\n\n            const  blob = [];\n            blob.push(stream.getBuffer());\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    blob.push(tile.data);\n                }\n            }\n\n            blob.push('BirdsEye');\n            return new Blob(blob);\n        }\n    }\n);\n\nexport {JnxWriter};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.jnx/jnx-encoder.js\n **/","import L from 'leaflet';\nimport {JnxWriter} from './jnx-encoder';\nimport {getTempMap, disposeMap} from 'lib/leaflet.layer.rasterize';\nimport {XHRQueue} from 'lib/xhr-promise';\nimport {arrayBufferToString, stringToArrayBuffer} from 'lib/binary-strings';\n\nconst defaultXHROptions = {\n    responseType: 'arraybuffer',\n    timeout: 20000,\n    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n};\n\nfunction minZoom(maxZoom) {\n    return Math.max(maxZoom - 4, 0);\n}\n\nfunction imageFromarrayBuffer(arr) {\n    const dataUrl = 'data:image/png;base64,' + btoa(arrayBufferToString(arr));\n    const image = new Image();\n    return new Promise(function(resolve, reject) {\n            image.onload = () => resolve(image);\n            image.onerror = () => reject(new Error('Tile image corrupt'));\n            image.src = dataUrl;\n        }\n    )\n}\n\nasync function convertToJpeg(image) {\n    try {\n        image = await imageFromarrayBuffer(image);\n    } catch (e) {\n        return null;\n    }\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0);\n    const dataURL = canvas.toDataURL(\"image/jpeg\");\n    const s = atob(dataURL.replace(/^data:image\\/jpeg;base64,/, \"\"));\n    return stringToArrayBuffer(s);\n}\n\nfunction ensureImageJpg(image) {\n    if (!image) {\n        return null;\n    }\n    if (arrayBufferToString(image.slice(0, 4)) === '\\x89PNG' &&\n        arrayBufferToString(image.slice(-8)) === 'IEND\\xae\\x42\\x60\\x82') {\n        return convertToJpeg(image)\n    } else if (arrayBufferToString(image.slice(0, 2)) === '\\xff\\xd8' &&\n        arrayBufferToString(image.slice(-2)) === '\\xff\\xd9') {\n        return Promise.resolve(image);\n    } else {\n        return null;\n    }\n}\n\nasync function makeJnxFromLayer(srcLayer, layerName, maxZoomLevel, latLngBounds, progress) {\n    const jnxProductId = L.stamp(srcLayer);\n    const jnxZOrder = Math.min(jnxProductId, 100);\n    const writer = new JnxWriter(layerName, jnxProductId, jnxZOrder);\n    const xhrQueue = new XHRQueue();\n    let doStop = false;\n    let error;\n    const minZoomLevel = minZoom(maxZoomLevel);\n    let progressWeight = 1;\n    for (let zoom = maxZoomLevel; zoom >= minZoomLevel; zoom--) {\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n\n        let promises = [];\n        let layer = srcLayer.cloneForPrint({xhrQueue});\n        let tempMap = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n        tempMap.addLayer(layer);\n        let {iterateTilePromises, count: tilesCount} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                rawData: true\n            }\n        );\n        for (let tilePromiseRec of iterateTilePromises()) {\n            promises.push(tilePromiseRec);\n        }\n        for (let {tilePromise} of promises) {\n            let imageRec;\n            try {\n                imageRec = await tilePromise;\n            } catch (e) {\n                error = e;\n                doStop = true;\n                break;\n            }\n            let xhr = imageRec.image;\n\n            if (xhr === null || xhr.status !== 200 || !xhr.response || !xhr.response.byteLength) {\n                continue;\n            }\n            let image = await ensureImageJpg(xhr.response);\n            if (!image) {\n                error = new Error('Tile image invalid');\n                doStop = true;\n                break;\n            }\n            writer.addTile(image, zoom, imageRec.latLngBounds);\n            progress(progressWeight / tilesCount, 4 / 3);\n        }\n        disposeMap(tempMap);\n        if (doStop) {\n            promises.forEach((promiseRec) => promiseRec.abortLoading());\n            throw error;\n        }\n        progressWeight /= 4;\n    }\n\n    return writer.getJnx();\n}\n\n\nexport {makeJnxFromLayer, minZoom};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.jnx/jnx-maker.js\n **/","import L from 'leaflet';\n\nconst RectangleSelect = L.Rectangle.extend({\n        includes: L.Mixin.Events,\n\n        options: {\n            opacity: 1,\n            weight: 0.5,\n            fillOpacity: 0.2,\n            color: '#3388ff',\n            fillColor: '#3388ff',\n\n        },\n\n        onAdd: function(map) {\n            L.Rectangle.prototype.onAdd.call(this, map);\n            this.markers = [];\n            for (let position of ['top', 'right', 'bottom', 'left']) {\n                let marker = L.marker([0, 0], {\n                        icon: L.divIcon({className: `leaflet-rectangle-select-edge edge-${position}`}),\n                        draggable: true\n                    }\n                )\n                    .addTo(map);\n                marker.on({\n                        'drag': this.onMarkerDrag,\n                        'dragend': this.onMarkerDragEnd\n                    }, this\n                );\n                this.markers[position] = marker;\n            }\n            this.placeMarkers();\n            map.on('zoomend', this.placeMarkers, this);\n        },\n\n        placeMarkers: function() {\n            const bounds = this.getBounds();\n            const topLeftPixel = this._map.project(bounds.getNorthWest());\n            const bottomRightPixel = this._map.project(bounds.getSouthEast());\n            const size = bottomRightPixel.subtract(topLeftPixel);\n            let center = topLeftPixel.add(size.divideBy(2));\n            center = this._map.unproject(center);\n            this.markers['top'].setLatLng([bounds.getNorth(), center.lng]);\n            this.markers['top']._icon.style.width = `${size.x}px`;\n            this.markers['top']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['right'].setLatLng([center.lat, bounds.getEast()]);\n            this.markers['right']._icon.style.height = `${size.y}px`;\n            this.markers['right']._icon.style.marginTop = `-${size.y / 2}px`;\n            this.markers['bottom'].setLatLng([bounds.getSouth(), center.lng]);\n            this.markers['bottom']._icon.style.width = `${size.x}px`;\n            this.markers['bottom']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['left'].setLatLng([center.lat, bounds.getWest()]);\n            this.markers['left']._icon.style.height = `${size.y}px`;\n            this.markers['left']._icon.style.marginTop = `-${size.y / 2}px`;\n        },\n\n        onRemove: function(map) {\n            for (let marker of Object.values(this.markers)) {\n                this._map.removeLayer(marker);\n            }\n            this.markers = null;\n            map.off('zoomend', this.placeMarkers, this);\n            L.Rectangle.prototype.onRemove.call(this, map);\n        },\n\n        setBoundsFromMarkers: function() {\n            this.setBounds(\n                [\n                    [this.markers['top'].getLatLng().lat, this.markers['left'].getLatLng().lng],\n                    [this.markers['bottom'].getLatLng().lat, this.markers['right'].getLatLng().lng]\n                ]\n            );\n\n        },\n        onMarkerDrag: function() {\n            this.setBoundsFromMarkers();\n        },\n\n        onMarkerDragEnd: function() {\n            this.setBoundsFromMarkers();\n            this.placeMarkers();\n            this.fire('change');\n        }\n    }\n);\n\nexport {RectangleSelect};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.jnx/selector.js\n **/","import L from 'leaflet';\nimport './style.css';\n\nfunction enableAdaptiveHeight(control) {\n    if (control._adaptiveHeightEnabled) {\n        return;\n    }\n    const originalOnAdd = control.onAdd;\n\n    L.Util.extend(control, {\n            _adaptiveHeightEnabled: true,\n\n            onAdd: function(map) {\n                const result = originalOnAdd.call(this, map);\n                this.__setupResizeEventsHandler();\n                setTimeout(() => this.__setAdaptiveHeight(), 0);\n                return result;\n            },\n\n            __setupResizeEventsHandler: function() {\n                this._map.on('resize', this.__setAdaptiveHeight, this);\n            },\n\n            __setAdaptiveHeight: function() {\n                const mapHeight = this._map.getSize().y;\n                let maxHeight;\n                    maxHeight = (mapHeight\n                    - this._container.offsetTop // controls above\n                    - (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) //controls below\n                    - 70); // margin\n                this._form.style.maxHeight = maxHeight + 'px';\n            }\n        }\n    );\n\n    if (control._map) {\n        control.__setupResizeEventsHandler();\n        setTimeout(() => control.__setAdaptiveHeight(), 0);\n    }\n\n    return control;\n}\n\nexport default enableAdaptiveHeight;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.layers.adaptive-height/index.js\n **/","import L from 'leaflet';\nimport './style.css';\nimport enableTopRow from 'lib/leaflet.control.layers.top-row';\nimport ko from 'vendored/knockout';\nimport {notify} from 'lib/notifications';\nimport logging from 'lib/logging';\nimport safeLocalStorage from 'lib/safe-localstorage';\n\nfunction enableConfig(control, layers) {\n    const originalOnAdd = control.onAdd;\n    const originalUnserializeState = control.unserializeState;\n    const originalAddItem = control._addItem;\n    if (control._configEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _configEnabled: true,\n            _allLayersGroups: layers,\n            _allLayers: [].concat(...layers.map(group => group.layers)),\n            _customLayers: ko.observableArray(),\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                this.__injectConfigButton();\n                return container;\n            },\n\n            __injectConfigButton: function() {\n                const configButton = L.DomUtil.create('div', 'button icon-settings');\n                configButton.title = 'Configure layers';\n                this._topRow.appendChild(configButton);\n                L.DomEvent.on(configButton, 'click', this._onConfigButtonClick, this);\n\n                const newCustomLayerButton = L.DomUtil.create('div', 'button icon-edit');\n                newCustomLayerButton.title = 'Add custom layer';\n                this._topRow.appendChild(newCustomLayerButton);\n                L.DomEvent.on(newCustomLayerButton, 'click', this.onCustomLayerCreateClicked, this);\n            },\n\n            _initializeLayersState: function() {\n                let storedLayersEnabled = {};\n                const serialized = safeLocalStorage.getItem('layersEnabled');\n                if (serialized) {\n                    try {\n                        storedLayersEnabled = JSON.parse(serialized);\n                    } catch (e) {\n                        logging.captureMessage('Failed to load enabled layers from localstorage - invalid json',{\n                            extra: {\"localstorage.layersEnabled\": serialized.slice(0, 1000)}\n                        })\n                    }\n                }\n                // restore custom layers\n                Object.keys(storedLayersEnabled).forEach(code => this.loadCustomLayerFromString(code));\n\n                for (let layer of [...this._allLayers, ...this._customLayers()]) {\n                    let enabled = storedLayersEnabled[layer.layer.options.code];\n                    // if storage is empty enable only default layers\n                    // if new default layer appears it will be enabled\n                    if (typeof enabled === 'undefined') {\n                        enabled = layer.isDefault;\n                    }\n                    layer.enabled = enabled;\n                    layer.checked = ko.observable(enabled);\n                    layer.description = layer.description || '';\n                }\n                this.updateEnabledLayers();\n            },\n\n            _onConfigButtonClick: function() {\n                this.showLayersSelectWindow()\n            },\n\n            _initLayersSelectWindow: function() {\n                if (this._configWindow) {\n                    return;\n                }\n\n                const container = this._configWindow =\n                    L.DomUtil.create('div', 'leaflet-layers-dialog-wrapper');\n                L.DomEvent\n                    .disableClickPropagation(container)\n                    .disableScrollPropagation(container);\n                container.innerHTML = `\n<div class=\"leaflet-layers-select-window\">\n    <form>\n        <!-- ko foreach: _allLayersGroups -->\n            <div class=\"section-header\" data-bind=\"html: group\"></div>\n            <!-- ko foreach: layers -->\n                <label>\n                    <input type=\"checkbox\" data-bind=\"checked: checked\"/>\n                    <span data-bind=\"text: title\">\n                    </span><!--  ko if: description -->\n                    <span data-bind=\"html: description || ''\"></span>\n                    <!-- /ko -->\n                </label>\n            <!-- /ko -->\n        <!-- /ko -->\n        <div data-bind=\"if: _customLayers().length\" class=\"section-header\">Custom layers</div>\n        <!-- ko foreach: _customLayers -->\n                <label>\n                    <input type=\"checkbox\" data-bind=\"checked: checked\"/>\n                    <span data-bind=\"text: title\"></span>\n                </label>\n        <!-- /ko -->\n    </form>\n    <div class=\"buttons-row\">\n        <div href=\"#\" class=\"button\" data-bind=\"click: onSelectWindowOkClicked\">Ok</div>\n        <div href=\"#\" class=\"button\" data-bind=\"click: onSelectWindowCancelClicked\">Cancel</div>\n        <div href=\"#\" class=\"button\" data-bind=\"click: onSelectWindowResetClicked\">Reset</div>\n    </div>            \n</div>\n                `;\n                ko.applyBindings(this, container);\n            },\n\n            showLayersSelectWindow: function() {\n                if (this._configWindowVisible) {\n                    return;\n                }\n                [...this._allLayers, ...this._customLayers()].forEach(layer => layer.checked(layer.enabled));\n                this._initLayersSelectWindow();\n                this._map._controlContainer.appendChild(this._configWindow);\n                this._configWindowVisible = true;\n            },\n\n            hideSelectWindow: function() {\n                if (!this._configWindowVisible) {\n                    return;\n                }\n                this._map._controlContainer.removeChild(this._configWindow);\n                this._configWindowVisible = false;\n            },\n\n            onSelectWindowCancelClicked: function() {\n                this.hideSelectWindow();\n            },\n\n            onSelectWindowResetClicked: function() {\n                if (!this._configWindow) {\n                    return;\n                }\n                [...this._allLayers, ...this._customLayers()].forEach(layer => layer.checked(layer.isDefault));\n            },\n\n            onSelectWindowOkClicked: function() {\n                [...this._allLayers, ...this._customLayers()].forEach(layer => layer.enabled = layer.checked());\n                this.updateEnabledLayers();\n                this.hideSelectWindow();\n            },\n\n            onCustomLayerCreateClicked: function() {\n                this.showCustomLayerForm([\n                        {\n                            caption: 'Add layer',\n                            callback: (fieldValues) => this.onCustomLayerAddClicked(fieldValues)\n                        }, {\n                            caption: 'Cancel',\n                            callback: () => this.onCustomLayerCancelClicked()\n                        }], {\n                        name: 'Custom layer',\n                        url: '',\n                        tms: false,\n                        maxZoom: 18,\n                        isOverlay: false,\n                        scaleDependent: false\n                    }\n                );\n            },\n\n            updateEnabledLayers: function() {\n                const disabledLayers = [...this._allLayers, ...this._customLayers()].filter(l => !l.enabled);\n                disabledLayers.forEach((l) => this._map.removeLayer(l.layer));\n                [...this._layers].forEach((l) => this.removeLayer(l.layer));\n\n                let hasBaselayerOnMap = false;\n                const enabledLayers = [...this._allLayers, ...this._customLayers()].filter(l => l.enabled);\n                enabledLayers.sort((l1, l2) => l1.order - l2.order);\n                enabledLayers.forEach((l) => {\n                        l.isOverlay ? this.addOverlay(l.layer, l.title) : this.addBaseLayer(l.layer, l.title);\n                        if (!l.isOverlay && this._map.hasLayer(l.layer)) {\n                              hasBaselayerOnMap = true;\n                        }\n                    }\n                );\n                // если нет активного базового слоя, включить первый, если он есть\n                if (!hasBaselayerOnMap) {\n                    for (let layer of enabledLayers) {\n                        if (!layer.isOverlay) {\n                            this._map.addLayer(layer.layer);\n                            break;\n                        }\n                    }\n                }\n                this.storeEnabledLayers();\n            },\n\n            storeEnabledLayers: function() {\n                const layersState = {};\n                for (let layer of [...this._allLayers, ...this._customLayers()]) {\n                    if (layer.isDefault || layer.enabled || layer.isCustom) {\n                        layersState[layer.layer.options.code] = layer.enabled;\n                    }\n                }\n                const serialized = JSON.stringify(layersState);\n                safeLocalStorage.setItem('layersEnabled', serialized);\n            },\n\n            unserializeState: function(values) {\n                if (values) {\n                    values = values.map((code) => {\n                        let newCode = this.loadCustomLayerFromString(code);\n                        return newCode || code;\n                    });\n                    for (let layer of [...this._allLayers, ...this._customLayers()]) {\n                        if (layer.layer.options && values.includes(layer.layer.options.code)) {\n                            layer.enabled = true;\n                        }\n                    }\n                    this.updateEnabledLayers();\n                }\n                this.storeEnabledLayers();\n                return originalUnserializeState.call(this, values);\n            },\n\n            showCustomLayerForm: function(buttons, fieldValues) {\n                if (this._customLayerWindow) {\n                    return;\n                }\n                this._customLayerWindow =\n                    L.DomUtil.create('div', 'leaflet-layers-dialog-wrapper', this._map._controlContainer);\n\n                L.DomEvent\n                    .disableClickPropagation(this._customLayerWindow)\n                    .disableScrollPropagation(this._customLayerWindow);\n\n                let customLayerWindow = L.DomUtil.create('div', 'custom-layers-window', this._customLayerWindow);\n                let form = L.DomUtil.create('form', '', customLayerWindow);\n\n                let buttonsHtml = '';\n                for (let [i, button] of buttons.entries()) {\n                    buttonsHtml += `<a class=\"button\" name=\"btn-${i}\">${button.caption}</a>`;\n                }\n                L.DomEvent.on(form, 'submit', L.DomEvent.preventDefault);\n                form.innerHTML = `\n<p><a href=\"http://leafletjs.com/reference-1.0.2.html#tilelayer\" target=\"_blank\">See Leaflet TileLayer documentation for url format</a></p>\n<label>Layer name<br/>\n<input name=\"name\"/></label><br/>\n<label>Tile url template<br/>\n<textarea name=\"url\" style=\"width: 100%\"></textarea></label><br/>\n<label><input type=\"radio\" name=\"overlay\" value=\"no\">Base layer</label><br/>\n<label><input type=\"radio\" name=\"overlay\" value=\"yes\">Overlay</label><br/>\n<label><input type=\"checkbox\" name=\"scaleDependent\"/>Content depends on scale(like OSM or Google maps)</label><br/>\n<label><input type=\"checkbox\" name=\"tms\" />TMS rows order</label><br />\n\n<label>Max zoom<br>\n<select name=\"maxZoom\">\n<option value=\"9\">9</option>\n<option value=\"10\">10</option>\n<option value=\"11\">11</option>\n<option value=\"12\">12</option>\n<option value=\"13\">13</option>\n<option value=\"14\">14</option>\n<option value=\"15\">15</option>\n<option value=\"16\">16</option>\n<option value=\"17\">17</option>\n<option value=\"18\" selected>18</option>\n</select></label>\n<br />\n${buttonsHtml}`;\n\n                form.name.value = fieldValues.name;\n                form.url.value = fieldValues.url;\n                form.tms.checked = fieldValues.tms;\n                form.scaleDependent.checked = fieldValues.scaleDependent;\n                form.maxZoom.value = fieldValues.maxZoom;\n                form.overlay[fieldValues.isOverlay ? 1 : 0].checked = true;\n\n                function buttonClicked(callback) {\n                    var fieldValues = {\n                        name: form.name.value.trim(),\n                        url: form.url.value.trim(),\n                        tms: form.tms.checked,\n                        scaleDependent: form.scaleDependent.checked,\n                        maxZoom: form.maxZoom.value,\n                        isOverlay: form.querySelector('input[name=\"overlay\"]:checked').value === 'yes'\n                    };\n                    callback(fieldValues);\n                }\n\n                for (let [i, button] of buttons.entries()) {\n\n                    let buttonEl = form.querySelector(`[name=\"btn-${i}\"]`);\n                    L.DomEvent.on(buttonEl, 'click', buttonClicked.bind(this, button.callback));\n                }\n\n            },\n\n            _addItem: function(obj) {\n                var label = originalAddItem.call(this, obj);\n                if (obj.layer.__customLayer) {\n                    const editButton = L.DomUtil.create('div', 'custom-layer-edit-button icon-edit', label.children[0]);\n                    editButton.title = 'Edit layer';\n                    L.DomEvent.on(editButton, 'click', (e) => this.onCustomLayerEditClicked(obj.layer.__customLayer, e));\n                }\n                return label;\n            },\n\n            serializeCustomLayer: function(fieldValues) {\n                let s = JSON.stringify(fieldValues);\n                s = s.replace(/[\\u007f-\\uffff]/g,\n                    function(c) {\n                        return '\\\\u' + ('0000' + c.charCodeAt(0).toString(16)).slice(-4);\n                    }\n                );\n\n                function encodeUrlSafeBase64(s) {\n                    return btoa(s)\n                        .replace(/\\+/g, '-')\n                        .replace(/\\//g, '_');\n                }\n\n                return '-cs' + encodeUrlSafeBase64(s);\n            },\n\n            customLayerExists: function(fieldValues, ignoreLayer) {\n                const serialized = this.serializeCustomLayer(fieldValues);\n                for (let layer of this._customLayers()) {\n                    if (layer !== ignoreLayer && layer.serialized === serialized) {\n                        return layer;\n                    }\n                }\n                return false;\n            },\n\n            checkCustomLayerValues: function(fieldValues) {\n                if (!fieldValues.url) {\n                    return {'error': 'Url is empty'}\n                }\n                if (!fieldValues.name) {\n                    return {'error': 'Name is empty'}\n                }\n                return {};\n            },\n\n            onCustomLayerAddClicked: function(fieldValues) {\n                const error = this.checkCustomLayerValues(fieldValues).error;\n                if (error) {\n                    notify(error);\n                    return;\n                }\n\n                const duplicateLayer = this.customLayerExists(fieldValues);\n                if (duplicateLayer) {\n                    let msg = 'Same layer already exists';\n                    if (!duplicateLayer.enabled) {\n                        msg += ' but it is hidden. You can enable it in layers setting.';\n                    }\n                    notify(msg);\n                    return;\n                }\n\n                const layer = this.createCustomLayer(fieldValues);\n                layer.enabled = true;\n                layer.checked = ko.observable(true);\n                this._customLayers.push(layer);\n                this.hideCustomLayerForm();\n                this.updateEnabledLayers();\n            },\n\n\n            createCustomLayer: function(fieldValues, position, ignoreExists) {\n                const serialized = this.serializeCustomLayer(fieldValues);\n                const tileLayer = L.tileLayer(fieldValues.url, {\n                        tms: fieldValues.tms,\n                        maxNativeZoom: fieldValues.maxZoom,\n                        scaleDependent: fieldValues.scaleDependent,\n                        print: true,\n                        jnx: true,\n                        code: serialized,\n                        noCors: true\n                    }\n                );\n\n                const customLayer = {\n                    title: fieldValues.name,\n                    isOverlay: fieldValues.isOverlay,\n                    isDefault: false,\n                    isCustom: true,\n                    serialized: serialized,\n                    layer: tileLayer,\n                    order: 10000,\n                    fieldValues: fieldValues,\n                    enabled: true,\n                    checked: ko.observable(true)\n                };\n                tileLayer.__customLayer = customLayer;\n                return customLayer;\n            },\n\n            onCustomLayerCancelClicked: function() {\n                this.hideCustomLayerForm();\n            },\n\n            hideCustomLayerForm: function() {\n                if (!this._customLayerWindow) {\n                    return;\n                }\n                this._customLayerWindow.parentNode.removeChild(this._customLayerWindow);\n                this._customLayerWindow = null;\n            },\n\n            onCustomLayerEditClicked: function(layer, e) {\n                L.DomEvent.stop(e);\n                this.showCustomLayerForm([\n                        {caption: 'Save', callback: (fieldValues) => this.onCustomLayerChangeClicked(layer, fieldValues)},\n                        {caption: 'Delete', callback: (fieldValues) => this.onCustomLayerDeletelClicked(layer)},\n                        {caption: 'Cancel', callback: () => this.onCustomLayerCancelClicked()}\n                    ], layer.fieldValues\n                );\n            },\n\n            onCustomLayerChangeClicked: function(layer, newFieldValues) {\n                const error = this.checkCustomLayerValues(newFieldValues).error;\n                if (error) {\n                    notify(error);\n                    return;\n                }\n                const duplicateLayer = this.customLayerExists(newFieldValues, layer);\n                if (duplicateLayer) {\n                    let msg = 'Same layer already exists';\n                    if (!duplicateLayer.enabled) {\n                        msg += ' but it is hidden. You can enable it in layers setting.';\n                    }\n                    notify(msg);\n                    return;\n                }\n\n                const layerPos = this._customLayers.indexOf(layer);\n                this._customLayers.remove(layer);\n\n                const newLayer = this.createCustomLayer(newFieldValues);\n                this._customLayers.splice(layerPos, 0, newLayer);\n                if (this._map.hasLayer(layer.layer) && (!layer.isOverlay || newLayer.isOverlay)) {\n                    this._map.addLayer(newLayer.layer);\n                }\n                this._map.removeLayer(layer.layer);\n                this.updateEnabledLayers();\n                this.hideCustomLayerForm();\n            },\n\n            onCustomLayerDeletelClicked: function(layer) {\n                this._map.removeLayer(layer.layer);\n                this._customLayers.remove(layer);\n                this.updateEnabledLayers();\n                this.hideCustomLayerForm();\n            },\n\n            loadCustomLayerFromString: function(s) {\n                let fieldValues;\n                const m = s.match(/^-cs(.+)$/);\n                if (m) {\n                    s = m[1].replace(/-/g, '+').replace(/_/g, '/');\n                    try {\n                        s = atob(s);\n                        fieldValues = JSON.parse(s);\n                    } catch (e) {\n                    }\n\n                    if (fieldValues) {\n                        if (!this.customLayerExists(fieldValues)) {\n                            this._customLayers.push(this.createCustomLayer(fieldValues));\n                        }\n                        return this.serializeCustomLayer(fieldValues);\n                    }\n\n                }\n            }\n\n\n        }\n    );\n    if (control._map) {\n        control.__injectConfigButton()\n    }\n    control._initializeLayersState();\n}\n\n\nexport default enableConfig;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.layers.configure/index.js\n **/","import L from 'leaflet';\nimport 'lib/leaflet.control.commons';\n\nconst originalLayerOnAdd = L.Control.Layers.prototype.onAdd;\n\nL.Control.Layers.include({\n    onAdd: function(map) {\n        const container = originalLayerOnAdd.call(this, map);\n        this._stopContainerEvents();\n        return container;\n\n    }\n});\n\nconst originalZoomOnAdd = L.Control.Zoom.prototype.onAdd;\n\nL.Control.Zoom.include({\n    onAdd: function(map) {\n        const container = originalZoomOnAdd.call(this, map);\n        this._container = container;\n        this._stopContainerEvents();\n        return container;\n\n    }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.layers.events/index.js\n **/","import L from 'leaflet';\nimport './style.css';\nimport 'lib/controls-styles/controls-styles.css';\nimport enableTopRow from 'lib/leaflet.control.layers.top-row';\n\n\nfunction enableMinimize(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._minimizeEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _minimizeEnabled: true,\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                setTimeout(() => this.__injectMinimizeButtons(), 0);\n                return container;\n            },\n\n            __injectMinimizeButtons: function() {\n                const container = this._container;\n                const contentsWrapper = L.DomUtil.create('div', 'leaflet-control-content');\n                while (container.childNodes.length) {\n                    contentsWrapper.appendChild(container.childNodes[0]);\n                }\n                container.appendChild(contentsWrapper);\n                const minimizeButton = L.DomUtil.create('div', 'button-minimize');\n                this._topRow.appendChild(minimizeButton);\n                const expandButton = L.DomUtil.create('div', 'leaflet-control-button-toggle', container);\n                expandButton.title = 'Select layers';\n                L.DomEvent.on(expandButton, 'click', this.setExpanded, this);\n                L.DomEvent.on(minimizeButton, 'click', this.setMinimized, this);\n            },\n\n            setExpanded: function() {\n                L.DomUtil.removeClass(this._container, 'minimized');\n            },\n\n            setMinimized: function() {\n                L.DomUtil.addClass(this._container, 'minimized');\n            }\n        }\n    );\n    if (control._map) {\n        control.__injectMinimizeButtons()\n    }\n\n\n}\n\nexport default enableMinimize;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.layers.minimize/index.js\n **/","import L from 'leaflet';\nimport './style.css';\nimport 'lib/controls-styles/controls-styles.css';\nimport ko from 'vendored/knockout';\nimport googleProvider from './lib/google';\nimport mapillaryProvider from './lib/mapillary';\nimport wikimediaProvider from './lib/wikimedia';\n\nfunction fireRefreshEventOnWindow() {\n    const evt = document.createEvent(\"HTMLEvents\");\n    evt.initEvent('resize', true, false);\n    window.dispatchEvent(evt);\n}\n\n\nconst PanoMarker = L.Marker.extend({\n    options: {\n        zIndexOffset: 10000\n    },\n\n    initialize: function() {\n        const icon = L.divIcon({\n                className: 'leaflet-panorama-marker-wraper',\n                html: '<div class=\"leaflet-panorama-marker\"></div>'\n            }\n        );\n        L.Marker.prototype.initialize.call(this, [0, 0], {icon, interactive: false});\n    },\n\n    getIcon: function() {\n        let markerIcon = this.getElement();\n        markerIcon = markerIcon.children[0];\n        return markerIcon;\n    },\n\n    setHeading: function(angle) {\n        const markerIcon = this.getIcon();\n        markerIcon.style.transform = `rotate(${angle || 0}deg)`;\n    },\n\n    setType: function(markerType) {\n        const className = {\n            'slim': 'leaflet-panorama-marker-circle',\n            'normal': 'leaflet-panorama-marker-binocular'}[markerType]\n        this.getIcon().className = className;\n    }\n});\n\nL.Control.Panoramas = L.Control.extend({\n        includes: L.Mixin.Events,\n\n        options: {\n            position: 'topleft'\n        },\n\n        getProviders: function() {\n            return [\n                {name: 'google', title: 'Google street view', provider: googleProvider, layerOptions: {zIndex:10},\n                 code: 'g',\n                 selected: ko.observable(true),\n                 mapMarkerType: 'normal'},\n                {name: 'wikimedia', title: 'Wikimedia commons', provider: wikimediaProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 9},\n                    code: 'w',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'slim'\n                },\n                {name: 'mapillary', title: 'Mapillary', provider: mapillaryProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 8},\n                    code: 'm',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'normal'},\n            ]\n        },\n\n        initialize: function(panoramaContainer, options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._panoramaContainer = panoramaContainer;\n            this.providers = this.getProviders();\n            for (let provider of this.providers) {\n                provider.selected.subscribe(this.updateCoverageVisibility, this);\n                provider.container = L.DomUtil.create('div', 'panorama-container', panoramaContainer);\n            }\n            this.nearbyPoints = [];\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-contol-panoramas');\n            container.innerHTML = `\n                <a name=\"button\" class=\"panoramas-button leaflet-control-button icon-panoramas\" title=\"Show panoramas\"\n                    data-bind=\"click: onButtonClick\"></a>\n                <div class=\"panoramas-list control-form\" data-bind=\"foreach: providers\">\n                    <div><label><input type=\"checkbox\" data-bind=\"checked: selected\"><span data-bind=\"text: title\"></span></label></div>\n                </div>\n            `;\n            this._stopContainerEvents();\n            ko.applyBindings(this, container);\n            map.createPane('rasterOverlay').style.zIndex = 300;\n            return container;\n        },\n\n        onButtonClick: function() {\n            if (this.controlEnabled) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        enableControl: function() {\n            if (this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = true;\n            L.DomUtil.addClass(this._container, 'enabled');\n            this.updateCoverageVisibility();\n            this._map.on('click', this.onMapClick, this);\n            L.DomUtil.addClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        disableControl: function() {\n            if (!this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = false;\n            L.DomUtil.removeClass(this._container, 'enabled');\n            this.updateCoverageVisibility();\n            this._map.off('click', this.onMapClick, this);\n            this.hidePanoViewer();\n            L.DomUtil.removeClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        updateCoverageVisibility: function() {\n            if (!this._map) {\n                return;\n            }\n            for (let provider of this.providers) {\n                if (this.controlEnabled && provider.selected()) {\n                    if (!provider.coverageLayer) {\n                        const options = L.extend({pane: 'rasterOverlay'}, provider.layerOptions);\n                        provider.coverageLayer = provider.provider.getCoverageLayer(options);\n                    }\n                    provider.coverageLayer.addTo(this._map);\n                } else {\n                    if (provider.coverageLayer) {\n                        this._map.removeLayer(provider.coverageLayer);\n                    }\n                }\n            }\n            this.notifyChanged();\n        },\n\n        showPanoramaContainer: function() {\n            L.DomUtil.addClass(this._panoramaContainer, 'enabled');\n            fireRefreshEventOnWindow();\n        },\n\n        panoramaVisible: function() {\n            if (L.DomUtil.hasClass(this._panoramaContainer, 'enabled')) {\n                for (let provider of this.providers) {\n                    if (L.DomUtil.hasClass(provider.container, 'enabled')) {\n                        return provider\n                    }\n                }\n            }\n            return false;\n        },\n\n        setupNearbyPoints: function(points) {\n            for (let point of this.nearbyPoints) {\n                this._map.removeLayer(point)\n            }\n            this.nearbyPoints = [];\n            if (points) {\n                const icon = L.divIcon({className: 'leaflet-panorama-marker-point'});\n                for (let latlng of points) {\n                    this.nearbyPoints.push(L.marker(latlng, {icon}).addTo(this._map));\n                }\n            }\n        },\n\n        hidePano: function(provider) {\n            L.DomUtil.removeClass(provider.container, 'enabled');\n            if (provider.viewer) {\n                provider.viewer.deactivate();\n            }\n            this.setupNearbyPoints();\n        },\n\n        showPano: async function(provider, data) {\n            this.showPanoramaContainer();\n            for (let otherProvider of this.providers) {\n                if (otherProvider !== provider) {\n                    this.hidePano(otherProvider);\n                }\n            }\n            L.DomUtil.addClass(provider.container, 'enabled');\n            if (!provider.viewer) {\n                provider.viewer = await provider.provider.getViewer(provider.container);\n                this.setupViewerEvents(provider);\n            }\n            if (data) {\n                // wait for panorama container become of right size, needed for viewer setup\n                L.Util.requestAnimFrame(() => provider.viewer.showPano(data));\n            }\n            provider.viewer.activate();\n            this.notifyChanged();\n        },\n\n        setupViewerEvents: function(provider) {\n            provider.viewer.on({\n                'change': this.onPanoramaChangeView.bind(this, provider),\n                'closeclick': this.onPanoramaCloseClick\n            }, this);\n        },\n\n        hidePanoViewer: function() {\n            for (let provider of this.providers) {\n                this.hidePano(provider);\n            }\n            L.DomUtil.removeClass(this._panoramaContainer, 'enabled');\n            this.hideMarker();\n            fireRefreshEventOnWindow();\n            this.notifyChanged();\n        },\n\n\n        placeMarker: function(latlng, heading) {\n            if (!this.panoramaVisible()) {\n                return;\n            }\n            if (!this.marker) {\n                this.marker = new PanoMarker();\n            }\n            this._map.addLayer(this.marker);\n            this.marker.setLatLng(latlng);\n            this.marker.setHeading(heading);\n        },\n\n        hideMarker: function() {\n            if (this.marker) {\n                this._map.removeLayer(this.marker);\n            }\n        },\n        notifyChanged: function() {\n            this.fire('panoramachanged');\n        },\n\n        onPanoramaChangeView: function(provider, e) {\n            if (!this._map.getBounds().pad(-0.05).contains(e.latlng)) {\n                this._map.panTo(e.latlng);\n            }\n            this.placeMarker(e.latlng, e.heading);\n            this.marker.setType(provider.mapMarkerType);\n            this.setupNearbyPoints(e.latlngs);\n            this.notifyChanged();\n        },\n\n        onPanoramaCloseClick: function(e) {\n            this.hidePanoViewer();\n        },\n\n        onMapClick: async function(e) {\n            const\n                searchRadiusPx = 24,\n                p = this._map.project(e.latlng).add([searchRadiusPx, 0]),\n                searchRadiusMeters = e.latlng.distanceTo(this._map.unproject(p)),\n                promises = [];\n            for (let provider of this.providers) {\n                if (provider.selected()) {\n                    promises.push({\n                        promise: provider.provider.getPanoramaAtPos(e.latlng, searchRadiusMeters),\n                        provider: provider\n                    });\n                }\n            }\n\n            for (let {promise, provider} of promises) {\n                let searchResult = await promise;\n                if (searchResult.found) {\n                    this.showPano(provider, searchResult.data);\n                    return;\n                }\n            }\n        }\n    },\n);\n\nL.Control.Panoramas.include(L.Mixin.HashState);\nL.Control.Panoramas.include({\n        stateChangeEvents: ['panoramachanged'],\n\n        serializeState: function() {\n            let state = null;\n            if (this.controlEnabled) {\n                state = [];\n                let coverageCode='_';\n                for (let provider of this.providers) {\n                    if (provider.selected()){\n                        coverageCode += provider.code;\n                    }\n                }\n                state.push(coverageCode);\n                const provider = this.panoramaVisible();\n                if (provider && provider.viewer) {\n                    let viewerState = provider.viewer.getState();\n                    if (viewerState) {\n                        state.push(provider.code);\n                        state.push(...viewerState);\n                    }\n                }\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state) {\n                this.disableControl();\n                return true;\n            }\n\n            const coverageCode = state[0];\n            if (!coverageCode || coverageCode[0] !== '_') {\n                return false;\n            }\n            this.enableControl();\n            for (let provider of this.providers) {\n                provider.selected(coverageCode.includes(provider.code))\n            }\n            if (state.length > 2) {\n                const panoramaVisible = state[1];\n                for (let provider of this.providers) {\n                    if (panoramaVisible === provider.code) {\n                        this.showPano(provider).then(() => {\n                            const success = provider.viewer.setState(state.slice(2));\n                            if (!success) {\n                                this.hidePanoViewer();\n                            }\n                        });\n                        break;\n                    }\n                }\n            }\n            return true;\n        }\n    }\n);\n\n\nL.Control.Panoramas.hashStateUpgrader = function(panoramasControl) {\n    return L.Util.extend({}, L.Mixin.HashState, {\n        unserializeState: function(oldState) {\n            if (oldState) {\n                console.log('Upgrading');\n                const upgradedState = ['_g'];\n                if (oldState.length) {\n                    upgradedState.push('g', ...oldState);\n                }\n                setTimeout(()=> panoramasControl.unserializeState(upgradedState), 0);\n            }\n            return false;\n        },\n\n        serializeState: function() {\n            return null;\n        },\n    });\n\n\n\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/index.js\n **/","import L from 'leaflet';\nimport getGoogle from 'lib/googleMapsApi';\n\n\nfunction getCoverageLayer(options) {\n    return L.tileLayer(\n        'https://maps.googleapis.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m8!1e2!2ssvv!4m2!1scb_client!2sapiv3!4m2!1scc!2s*211m3*211e3*212b1*213e2*211m3*211e2*212b1*213e2!3m5!3sUS!12m1!1e40!12m1!1e18!4e0',\n        options\n    );\n}\n\n\nasync function getStreetViewService() {\n    const google = await getGoogle();\n    return new google.maps.StreetViewService();\n}\n\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const google = await getGoogle();\n    const service = await getStreetViewService();\n    const {data, status} = await new Promise((resolve) => {\n            service.getPanorama({\n                    location: latlng,\n                    radius: searchRadiusMeters,\n                    preference: google.maps.StreetViewPreference.NEAREST\n                }, (data, status) => resolve({data, status})\n            )\n        }\n    );\n    if (status === google.maps.StreetViewStatus.OK) {\n        return {found: true, data};\n    } else {\n        return {found: false};\n    }\n}\n\n\nconst Viewer = L.Evented.extend({\n    initialize: function(google, container) {\n        const panorama = this.panorama = new google.maps.StreetViewPanorama(container, {\n                enableCloseButton: true,\n                imageDateControl: true\n            }\n        );\n        panorama.addListener('position_changed', () => this.onPanoramaChangeView());\n        panorama.addListener('pov_changed', () => this.onPanoramaChangeView());\n        panorama.addListener('closeclick', () => this.onCloseClick());\n    },\n\n    showPano: function(data) {\n        this.panorama.setPosition(data.location.latLng);\n        this.panorama.setZoom(1);\n    },\n\n    onPanoramaChangeView: function() {\n        if (!this._active) {\n            return;\n        }\n        let pos = this.panorama.getPosition();\n        pos = L.latLng(pos.lat(), pos.lng());\n        const pov = this.panorama.getPov();\n        this.fire('change', {latlng: pos, heading: pov.heading, zoom: pov.zoom, pitch: pov.pitch});\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n        this.panorama.setVisible(true);\n    },\n\n    deactivate: function() {\n        this._active = false;\n        this.panorama.setVisible(false);\n    },\n\n    getState: function() {\n        const pos = this.panorama.getPosition();\n        const pov = this.panorama.getPov();\n        if (pos && pov) {\n            return [pos.lat().toFixed(6), pos.lng().toFixed(6),\n                (pov.heading || 0).toFixed(1), (pov.pitch || 0).toFixed(1), (pov.zoom || 1).toFixed(1)];\n        } else {\n            return null;\n        }\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const heading = parseFloat(state[2]);\n        const pitch = parseFloat(state[3]);\n        const zoom = parseFloat(state[4]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(heading) && !isNaN(pitch) && !isNaN(zoom)) {\n            this.panorama.setPosition({lat, lng});\n            this.panorama.setPov({heading, pitch, zoom});\n            return true;\n        }\n        return false;\n\n    }\n});\n\nasync function getViewer(container) {\n    const google = await getGoogle();\n    return new Viewer(google, container)\n}\n\n\nexport default {getCoverageLayer, getPanoramaAtPos, getViewer};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/google/index.js\n **/","import L from 'leaflet';\nimport {MapillaryCoverage} from './mapillary-coverage-layer'\nimport {fetch} from 'lib/xhr-promise';\nimport config from 'config';\nimport './style.css';\nimport '../common/style.css';\n\nfunction getCoverageLayer(options) {\n    return new MapillaryCoverage(options);\n}\n\nfunction getMapillary() {\n    return new Promise((resolve) => {\n        require.ensure(['mapillary-js/dist/mapillary.js', 'mapillary-js/dist/mapillary.min.css'], () => {\n            require('mapillary-js/dist/mapillary.min.css');\n            resolve(require('mapillary-js/dist/mapillary.js'));\n        }, 'mapillary');\n    });\n}\n\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const url = `https://a.mapillary.com/v3/images?client_id=${config.mapillary}&closeto=${latlng.lng},${latlng.lat}&radius=${searchRadiusMeters}`;\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200 && resp.responseJSON.features.length) {\n        return {found: true, data: resp.responseJSON.features[0].properties.key};\n    }\n    return {found: false};\n}\n\nfunction formatDateTime(ts) {\n    const d = new Date(ts);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\n}\n\n\nconst Viewer = L.Evented.extend({\n        initialize: function(mapillary, container) {\n            const id = `container-${L.stamp(container)}`;\n            container.id = id;\n            const viewer = this.viewer = new mapillary.Viewer(\n                id, config.mapillary, null, {component: {cover: false, bearing: false}});\n            window.addEventListener('resize', function() {\n                    viewer.resize();\n                }\n            );\n            viewer.on('nodechanged', this.onNodeChanged.bind(this));\n            viewer.on('bearingchanged', this.onBearingChanged.bind(this));\n            this.dateLabel = L.DomUtil.create('div', 'mapillary-viewer-date-overlay', container);\n            this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n            L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n            this._bearing = 0;\n            this._zoom = 0;\n            this._center = [0, 0];\n        },\n\n        showPano: function(data) {\n            this.deactivate();\n            this.activate();\n            this.viewer.moveToKey(data).then(() => {\n                this.viewer.setZoom(0);\n                this.updateZoomAndCenter();\n            });\n        },\n\n        onNodeChanged: function(node) {\n            if (this._node && (node.key === this._node.key)) {\n                return;\n            }\n            this._node = node;\n            this.fireChangeEvenet();\n            this.dateLabel.innerHTML = formatDateTime(node.capturedAt);\n        },\n\n        getBearingCorrection: function() {\n            if (this._node && 'computedCA' in this._node) {\n                return (this._node.computedCA - this._node.originalCA);\n            }\n            return 0;\n        },\n\n        onBearingChanged: function(bearing) {\n            bearing -= this.getBearingCorrection();\n            if (this._bearing === bearing) {\n                return;\n            }\n            this._bearing = bearing;\n            this.fireChangeEvenet();\n        },\n\n        onCloseClick: function() {\n            this.fire('closeclick');\n        },\n\n        fireChangeEvenet: function() {\n            if (this._node) {\n                const latlon = this._node.originalLatLon;\n                this.fire('change', {\n                        latlng: L.latLng(latlon.lat, latlon.lon),\n                        heading: this._bearing,\n                        pitch: this._pitch,\n                        zoom: this._zoom\n                    }\n                );\n            }\n        },\n\n        deactivate: function() {\n            this.viewer.activateCover();\n            if (this._updateHandler) {\n                clearInterval(this._updateHandler);\n                this._updateHandler = null;\n            }\n        },\n\n        updateZoomAndCenter: function() {\n            this.viewer.getZoom().then((zoom) => {\n                this._zoom=zoom\n            });\n            this.viewer.getCenter().then((center) => {\n                this._center = center;\n            });\n            this.viewer.getBearing().then((bearing) => {\n                this.onBearingChanged(bearing);\n            });\n        },\n\n        activate: function() {\n            this.viewer.resize();\n            this.viewer.deactivateCover();\n            if (!this._updateHandler) {\n                this._updateHandler = setInterval(() => this.updateZoomAndCenter(), 200);\n            }\n        },\n\n        getState: function() {\n            if (!this._node) {\n                return [];\n            }\n            const {lat, lon} = this._node.originalLatLon;\n            return [lat.toFixed(6), lon.toFixed(6),\n                this._center[0].toFixed(4), this._center[1].toFixed(4), this._zoom.toFixed(2)];\n        },\n    \n        setState: function(state) {\n            const lat = parseFloat(state[0]);\n            const lng = parseFloat(state[1]);\n            const center0 = parseFloat(state[2]);\n            const center1 = parseFloat(state[3]);\n            const zoom = parseFloat(state[4]);\n            if (!isNaN(lat) && !isNaN(lng) && !isNaN(center0) && !isNaN(center1) && !isNaN(zoom)) {\n                this.viewer.moveCloseTo(lat, lng).then(() => {\n                    this.viewer.setCenter([center0, center1]);\n                    this.viewer.setZoom(zoom);\n                });\n                return true;\n            }\n            return false;\n        }\n    }\n);\n\n\nasync function getViewer(container) {\n    const mapillary = await getMapillary();\n    return new Viewer(mapillary, container);\n}\n\nexport default {getCoverageLayer, getPanoramaAtPos, getViewer};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/mapillary/index.js\n **/","import L from 'leaflet';\nimport {MapillaryLoader} from './mapillary-loader';\n\nconst MapillaryCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true,\n            color: '#00cfb1'\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new MapillaryLoader(this.options.url, 12);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawOverview: function(canvas) {\n            const\n                tileData = canvas._tileData;\n            if (!tileData['mapillary-sequence-overview']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-sequence-overview']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid sequence overview geometry type \"${feature.geometry.type}\"`)\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n\n        },\n\n        drawSequences: function(canvas, lineWidth) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n\n            if (!tileData['mapillary-sequences']) {\n                return;\n            }\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = this.options.color;\n            canvasCtx.lineWidth = lineWidth;\n            // canvasCtx.lineWidth = thinLines ? 1 : 1;\n            canvasCtx.lineCap = \"round\";\n            canvasCtx.lineJoin = \"bevel\";\n            for (let feature of tileData['mapillary-sequences']) {\n                if (feature.geometry.type !== 'MultiLineString') {\n                    throw new Error(`Invalid sequence geometry type \"${feature.geometry.type}\"`)\n                }\n                let {multiplier, offsetX, offsetY} = adjustment;\n\n                let lines = feature.geometry.coordinates;\n                for (let lineI = 0; lineI < lines.length; lineI++) {\n                    let line = lines[lineI];\n                    if (!line.length) {\n                        continue;\n                    }\n                    let x = line[0][0] * multiplier - offsetX;\n                    let y = line[0][1] * multiplier - offsetY;\n                    canvasCtx.moveTo(x, y);\n                    if (line.length === 1) {\n                        canvasCtx.lineTo(x, y);\n                    }\n                    for (let pointI = 0; pointI < line.length; pointI++) {\n                        let x = line[pointI][0] * multiplier - offsetX;\n                        let y = line[pointI][1] * multiplier - offsetY;\n                        canvasCtx.lineTo(x, y);\n                    }\n                }\n            }\n            canvasCtx.stroke();\n        },\n\n        drawImages: function(canvas) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData['mapillary-images']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-images']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid image geometry type \"${feature.geometry.type}\"`)\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 4, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n\n        },\n\n        drawTile: function(canvas, coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            if (coords.z < 6 + 2 ) {\n                this.drawOverview(canvas);\n            } else if (coords.z < 14 + 2) {\n                let width = coords.z < 14 ? 10 : 5;\n                this.drawSequences(canvas, width);\n            } else {\n                this.drawSequences(canvas, 2);\n                this.drawImages(canvas)\n            }\n\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            );\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n    }\n);\n\nexport {MapillaryCoverage};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-coverage-layer.js\n **/","import L from 'leaflet';\nimport {TiledDataLoader} from 'lib/tiled-data-loader';\nimport {decodeMvt} from './mvt';\n\n\nclass MapillaryLoader extends TiledDataLoader {\n    url = 'https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt';\n    maxZoom = 14;\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        let z2 = null;\n        if (z > 6 && z <= 10) {\n            z2 = 6;\n        } else if (z >= 11 && z < 14) {\n            z2 = z - 4;\n        } else if (z < 0) {\n            z2 = 0;\n        } else if (z > this.maxZoom) {\n            z2 = this.maxZoom\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y}\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        }\n    }\n\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            }\n        }\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        let adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        return this._processResponse(xhr, originalDataTileCoords);\n    }\n\n    async _processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (xhr.status === 200 && xhr.response) {\n            const layers = decodeMvt(xhr.response, 1024);\n            tileData = {};\n            for (let layer of layers) {\n                tileData[layer.name] = layer.features;\n            }\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        }\n    }\n}\n\nexport {MapillaryLoader};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-loader.js\n **/","import Pbf from 'pbf';\nimport {Tile as TileProto} from './vector_tile_proto';\n\nfunction decodeCoordinate(x) {\n    return ((x >> 1) ^ (-(x & 1)));\n}\n\nfunction parseGeometry(geometryType, ints, coordinatesScale) {\n    if (geometryType !== TileProto.GeomType.POINT && geometryType !== TileProto.GeomType.LINESTRING &&\n        geometryType !== TileProto.GeomType.POLYGON) {\n        throw new Error(`Unknown feature geometry type ${geometryType}`);\n    }\n    const len = ints.length;\n    let pos = 0;\n    const lineStrings = [];\n    let line;\n    let x = 0, y = 0;\n    while (pos < len) {\n        let i = ints[pos];\n        let cmd = i & 0x7;\n        let cmdRepeat = i >> 3;\n        switch (cmd) {\n            case 1: // MoveTo\n                if (cmdRepeat !== 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command MoveTo`);\n                }\n                if (pos + 2 > len) {\n                    throw new Error('Not enough elements for MoveTo arguments');\n                }\n                if (line) {\n                    lineStrings.push(line);\n                }\n                x += decodeCoordinate(ints[pos + 1]);\n                y += decodeCoordinate(ints[pos + 2]);\n                line = [[x * coordinatesScale, y * coordinatesScale]];\n                pos += 3;\n                break;\n            case 2: // LineTo\n                if (cmdRepeat < 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command LineTo`);\n                }\n                if (!line) {\n                    throw new Error('LineTo with empty linestring')\n                }\n                pos +=1;\n                for (let cmdN = 0; cmdN < cmdRepeat; cmdN++){\n                    if (pos + 2 > len) {\n                        throw new Error('Not enough elements for LineTo arguments');\n                    }\n                    x += decodeCoordinate(ints[pos]);\n                    y += decodeCoordinate(ints[pos + 1]);\n                    line.push([x * coordinatesScale, y * coordinatesScale])\n                    pos += 2;\n                }\n                break;\n            case 7: // ClosePath\n                if (geometryType !== TileProto.GeomType.POLYGON) {\n                    throw new Error(`ClosePath command for non-polygon type ${geometryType}`);\n                }\n                if (!line) {\n                    throw new Error('ClosePath with empty linestring')\n                }\n                if (cmdRepeat !== 1) {\n                    throw new Error(`ClosePath repeats ${cmdRepeat} times`);\n                }\n                line.push(line[0]);\n                pos += 1;\n                break;\n            default:\n                throw new Error(`Unknown command ${i} & 0x7 = ${cmd}`);\n        }\n    }\n    if (line) {\n        lineStrings.push(line);\n    }\n    const geometry = {};\n    switch (geometryType) {\n        case TileProto.GeomType.POINT:\n            if (lineStrings.length !== 1 || lineStrings[0].length !== 1) {\n                throw new Error('Invalid coordinates number for point');\n            }\n            geometry.type = 'Point';\n            geometry.coordinates = lineStrings[0][0];\n            break;\n        case TileProto.GeomType.LINESTRING:\n            geometry.type = 'MultiLineString';\n            geometry.coordinates = lineStrings;\n            break;\n        case TileProto.GeomType.POLYGON:\n            geometry.type = 'Polygon';\n            geometry.coordinates = lineStrings;\n            break;\n        default:\n    }\n    return geometry;\n}\n\n\nfunction parseFeatures(layer, coordinatesScale) {\n    const features = [];\n    for (let feature of layer.features) {\n        const geometry = parseGeometry(feature.type, feature.geometry, coordinatesScale);\n        features.push({geometry});\n    }\n    return features;\n}\n\nfunction decodeMvt(ar, tileExtent=256) {\n    const\n        pbf = new Pbf(new Uint8Array(ar)),\n        tileData = TileProto.read(pbf);\n    const parsedLayers = [];\n    for (let layer of tileData.layers) {\n        let scale = tileExtent / layer.extent;\n        parsedLayers.push({\n            name: layer.name,\n            features: parseFeatures(layer, scale)\n        });\n    }\n    return parsedLayers;\n}\n\nexport {decodeMvt};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/mapillary/mvt.js\n **/","// code generated by pbf v3.0.5\n\n// Tile ========================================\n\nvar Tile = exports.Tile = {};\n\nTile.read = function (pbf, end) {\n    return pbf.readFields(Tile._readField, {layers: []}, end);\n};\nTile._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.layers.push(Tile.Layer.read(pbf, pbf.readVarint() + pbf.pos));\n};\n\nTile.GeomType = {\n    \"UNKNOWN\": 0,\n    \"POINT\": 1,\n    \"LINESTRING\": 2,\n    \"POLYGON\": 3\n};\n\n\n// Tile.Feature ========================================\n\nTile.Feature = {};\n\nTile.Feature.read = function (pbf, end) {\n    return pbf.readFields(Tile.Feature._readField, {id: 0, tags: [], type: 0, geometry: []}, end);\n};\nTile.Feature._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.type = pbf.readVarint();\n    else if (tag === 4) pbf.readPackedVarint(obj.geometry);\n};\n\n// Tile.Layer ========================================\n\nTile.Layer = {};\n\nTile.Layer.read = function (pbf, end) {\n    return pbf.readFields(Tile.Layer._readField, {version: 0, name: \"\", features: [], keys: [], values: [], extent: 0}, end);\n};\nTile.Layer._readField = function (tag, obj, pbf) {\n    if (tag === 15) obj.version = pbf.readVarint();\n    else if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.features.push(Tile.Feature.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 5) obj.extent = pbf.readVarint();\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/mapillary/vector_tile_proto.js\n **/","import L from 'leaflet';\nimport {TiledDataLoader} from 'lib/tiled-data-loader';\n\nconst MultiLayer = L.Layer.extend({\n    initialize: function(layers) {\n        this.layers = layers;\n    },\n\n    setLayersVisibility: function(e) {\n        if (!this._map) {\n            return;\n        }\n\n        let newZoom;\n        if (e && e.zoom !== undefined) {\n            newZoom = e.zoom;\n        } else {\n            newZoom = this._map.getZoom();\n        }\n\n        for (let layer of this.layers) {\n            if (layer.minZoom <= newZoom && newZoom <= layer.maxZoom) {\n                this._map.addLayer(layer.layer);\n            } else {\n                this._map.removeLayer(layer.layer);\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this.setLayersVisibility();\n        map.on('zoomend', this.setLayersVisibility, this);\n    },\n\n    onRemove: function() {\n        for (let layer of this.layers) {\n            this._map.removeLayer(layer.layer);\n        }\n        this._map.off('zoomend', this.setLayersVisibility, this);\n        this._map.off('zoomanim', this.setLayersVisibility, this);\n        this._map = null;\n    }\n\n});\n\nclass WikimediaLoader extends TiledDataLoader {\n    constructor(urlTemplate, zoom) {\n        super();\n        this.url = urlTemplate;\n        this.maxZoom = zoom;\n    }\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: 2 ** coords.z - 1 - coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z;\n        let z2 = null;\n        if (z > this.maxZoom) {\n            z2 = this.maxZoom\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y}\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        }\n    }\n\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 5000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n            }\n        }\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (originalDataTileCoords.z >= this.maxZoom && xhr.status === 200 && xhr.response) {\n            tileData = new Uint16Array(xhr.response);\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        }\n    }\n}\n\nconst WikimediaVectorCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 256,\n            // updateWhenIdle: true,\n            color: '#ff00ff',\n        },\n\n        initialize: function(url, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new WikimediaLoader(url, 11);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawTile: function(canvas, coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            const dataOffset = 5000;\n            const dataExtent = 65535 - 2 * dataOffset;\n            const tileData = canvas._tileData;\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            const pixelScale = multiplier * 256 / dataExtent;\n            canvasCtx.fillStyle = this.options.color;\n            for (let i = 0, l = tileData.length; i < l; i += 2) {\n                let x = (tileData[i] - dataOffset) * pixelScale - offsetX * 256;\n                let y = (tileData[i + 1] - dataOffset) * pixelScale - offsetY * 256;\n                canvasCtx.beginPath();\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            );\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n    }\n);\n\nexport {MultiLayer, WikimediaVectorCoverage};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/wikimedia/coverage-layer.js\n **/","import L from 'leaflet';\nimport {MultiLayer, WikimediaVectorCoverage} from './coverage-layer';\nimport {fetch} from 'lib/xhr-promise';\nimport './style.css';\nimport '../common/style.css';\nimport config from 'config';\n\n\nfunction getCoverageLayer(options) {\n    const url = config.wikimediaCommonsCoverageUrl;\n    return new MultiLayer([\n        {layer: L.tileLayer(url, L.extend({}, options, {tms: true})),\n         minZoom: 0, maxZoom: 10},\n        {layer: new WikimediaVectorCoverage(url, options),\n         minZoom: 11, maxZoom: 18}\n    ]);\n}\n\nfunction parseSearchResponse(resp) {\n    const images = [];\n    if (resp && resp.query && resp.query.pages && resp.query.pages) {\n        for (let page of Object.values(resp.query.pages)) {\n            const iinfo = page.imageinfo[0];\n            let imageDescription = iinfo.extmetadata.ImageDescription ? iinfo.extmetadata.ImageDescription.value : null;\n            let objectDescription = iinfo.extmetadata.ObjectName ? iinfo.extmetadata.ObjectName.value : null;\n            if (imageDescription && /^<table (.|\\n)+<\\/table>$/.test(imageDescription)) {\n                imageDescription = null;\n            }\n            if (imageDescription) {\n                imageDescription = imageDescription.replace(/<[^>]+>/g, '');\n                imageDescription = imageDescription.replace(/[\\n\\r]/g, '');\n            }\n            if (imageDescription && objectDescription && objectDescription.toLowerCase().includes(imageDescription.toLowerCase())) {\n                imageDescription = null;\n            }\n            if (objectDescription && imageDescription && imageDescription.toLowerCase().includes(objectDescription.toLowerCase())) {\n                objectDescription = null;\n            }\n            let description = 'Wikimedia commons';\n            if (objectDescription || imageDescription) {\n                description = '';\n                if (objectDescription) {\n                    description = objectDescription;\n                }\n                if (imageDescription) {\n                    if (objectDescription) {\n                        description += '</br>';\n                    }\n                    description += imageDescription;\n                }\n            }\n\n            let author = iinfo.extmetadata.Artist ? iinfo.extmetadata.Artist.value : null;\n            if (author && /^<table (.|\\n)+<\\/table>$/.test(author)) {\n                author = `See author info at <a href=\"${iinfo.descriptionurl}\">Wikimedia commons</a>`;\n            }\n\n            // original images can be rotated, 90 degrees\n            // thumbnails are always oriented right\n            // so we request thumbnail of original image size\n            let url = iinfo.thumburl.replace('134px', `${iinfo.width}px`);\n            images.push({\n                url,\n                width: iinfo.width,\n                height: iinfo.height,\n                lat: page.coordinates[0].lat,\n                lng: page.coordinates[0].lon,\n                author: author,\n                timeOriginal: iinfo.extmetadata.DateTimeOriginal ? iinfo.extmetadata.DateTimeOriginal.value : null,\n                time: iinfo.extmetadata.DateTime ? iinfo.extmetadata.DateTime.value : null,\n                description: description,\n                pageUrl: iinfo.descriptionurl,\n                pageId: page.pageid.toString()\n            })\n        }\n        if (images.length) {\n            return images;\n        }\n    }\n    return null;\n}\n\nfunction isCloser(target, a, b) {\n    const d1 = target.distanceTo(a);\n    const d2 = target.distanceTo(b);\n    if (d1 < d2) {\n        return -1;\n    } else if (d1 === d2) {\n        return 0;\n    } else {\n        return 1;\n    }\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const clusterSize = 10;\n    const urlTemplate = 'https://commons.wikimedia.org/w/api.php?' +\n                        'origin=*&format=json&action=query&generator=geosearch&' +\n                        'ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&' +\n                        'ggsradius={radius}&ggscoord={lat}|{lng}&' +\n                        'iiurlwidth=134&' +\n                        'prop=imageinfo|coordinates&' +\n                        'iiprop=url|mime|size|extmetadata|commonmetadata|metadata';\n    searchRadiusMeters += clusterSize;\n    if (searchRadiusMeters < 10) {\n        searchRadiusMeters = 10;\n    }\n    if (searchRadiusMeters > 10000) {\n        searchRadiusMeters = 10000;\n    }\n    const url = L.Util.template(urlTemplate, {lat: latlng.lat, lng: latlng.lng, radius: searchRadiusMeters});\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200) {\n        let photos = parseSearchResponse(resp.responseJSON);\n        if (photos) {\n            latlng = L.latLng(latlng.lat, latlng.lng);\n            photos.sort(isCloser.bind(null, latlng));\n            latlng = L.latLng(photos[0].lat, photos[0].lng);\n            photos = photos.filter((photo) => latlng.distanceTo(L.latLng(photo.lat, photo.lng)) <= clusterSize, latlng);\n            return {\n                found: true,\n                data: photos\n            };\n        } else {\n            return {found: false};\n        }\n        \n    }\n    return {found: false};\n}\n\nfunction formatDateTime(dateStr) {\n    const m = /^(\\d+)-(\\d+)-(\\d+)/.exec(dateStr);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    if (m) {\n        let [year, month, day] = m.slice(1);\n        return `${day} ${months[month - 1]} ${year}`;\n    } else {\n        return dateStr;\n    }\n}\n\nconst Viewer = L.Evented.extend({\n    initialize: function(container) {\n        container = L.DomUtil.create('div', 'wikimedia-viewer-container', container);\n        const mapContainer = this.mapContainer = L.DomUtil.create('div', 'wikimedia-viewer-map-container', container);\n        this.pageButtonContainer = L.DomUtil.create('div', 'wikimedia-viewer-page-buttons-container', container);\n\n        this.map = L.map(mapContainer, {\n            maxBoundsViscosity: 1,\n            crs: L.CRS.Simple,\n            zoomControl: false,\n            attributionControl: false,\n            zoomSnap: 0,\n        });\n\n        this.map.on('zoomend', this.notifyChange, this);\n        this.map.on('moveend', this.notifyChange, this);\n\n        this.infoLabel = L.DomUtil.create('div', 'wikimedia-viewer-info-overlay', mapContainer);\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        this.prevPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-prev', mapContainer);\n        this.nextPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-next', mapContainer);\n        L.DomEvent.on(this.prevPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx - 1);\n        });\n        L.DomEvent.on(this.nextPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx + 1);\n        });\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    setupPageButtons: function(count) {\n        if (this._buttons) {\n            for (let button of this._buttons) {\n                this.pageButtonContainer.removeChild(button);\n            }\n        }\n        this._buttons = [];\n        if (count > 1) {\n            L.DomUtil.addClass(this.pageButtonContainer, 'enabled');\n\n            for (let i = 0; i < count; i++) {\n                let button = L.DomUtil.create('div', 'wikimedia-viewer-page-button', this.pageButtonContainer);\n                button.innerHTML = '' + (i + 1);\n                this._buttons.push(button);\n                L.DomEvent.on(button, 'click', () => this.switchPhoto(i));\n            }\n        } else {\n            L.DomUtil.removeClass(this.pageButtonContainer, 'enabled');\n        }\n    },\n\n    switchPhoto: function(imageIdx, imagePos=null) {\n        this._imageIdx = imageIdx;\n        if (this.imageLayer) {\n            this.map.removeLayer(this.imageLayer);\n        }\n        let image = this.images[imageIdx];\n        let mapSize = this.map.getSize();\n        if (!mapSize.x || !mapSize.y) {\n            mapSize = {x: 500, y: 500}\n        }\n        let maxZoom = Math.log2(Math.max(image.width / mapSize.x, image.height / mapSize.y)) + 2;\n        if (maxZoom < 1) {\n            maxZoom = 1;\n        }\n        let\n            southWest = this.map.unproject([0, image.height], maxZoom - 2),\n            northEast = this.map.unproject([image.width, 0], maxZoom - 2);\n        const bounds = new L.LatLngBounds(southWest, northEast);\n        this.map.setMaxZoom(maxZoom);\n        this.map.setMaxBounds(bounds);\n        if (imagePos) {\n            this.map.setView(imagePos.center, imagePos.zoom, {animate: false});\n        } else {\n            this.map.fitBounds(bounds, {animate: false});\n        }\n\n        this.imageLayer = L.imageOverlay(null, bounds);\n        L.DomUtil.addClass(this.mapContainer, 'loading');\n        this.imageLayer.on('load', () => {\n            L.DomUtil.removeClass(this.mapContainer, 'loading');\n        });\n        this.imageLayer.setUrl(image.url);\n        this.imageLayer.addTo(this.map);\n        let caption = [];\n\n        if (image.timeOriginal) {\n            caption.push(formatDateTime(image.timeOriginal));\n        }\n        if (image.author) {\n            caption.push(image.author);\n        }\n        caption.push(`<a href=\"${image.pageUrl}\">${image.description}</a>`);\n        caption = caption.join('</br>');\n        this.infoLabel.innerHTML = caption;\n\n        if (imageIdx > 0) {\n            L.DomUtil.addClass(this.prevPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.prevPhotoButton, 'enabled');\n        }\n        if (imageIdx < this.images.length - 1) {\n            L.DomUtil.addClass(this.nextPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.nextPhotoButton, 'enabled');\n        }\n        for (let [i, button] of this._buttons.entries()) {\n            ((i === imageIdx) ? L.DomUtil.addClass : L.DomUtil.removeClass)(button, 'active');\n        }\n        this.notifyChange();\n    },\n\n    notifyChange: function() {\n        if (this.images && this._active) {\n            const image = this.images[this._imageIdx];\n            this.fire('change', {\n                    latlng: L.latLng(image.lat, image.lng),\n                    latlngs: this.images.map((image) => {\n                        return L.latLng(image.lat, image.lng);\n                    })\n\n                }\n            )\n        }\n    },\n\n    _showPano: function(images, imageIdx=0, imagePos=null) {\n        this.images = images;\n        this.setupPageButtons(images.length);\n        this.switchPhoto(imageIdx, imagePos);\n    },\n\n    showPano: function(images) {\n        this._showPano(images);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n    },\n\n    deactivate: function() {\n        this._active = false;\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const pageId = state[2];\n        const y = parseFloat(state[3]);\n        const x = parseFloat(state[4]);\n        const zoom = parseFloat(state[5]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(x) && !isNaN(y) && !isNaN(zoom)) {\n            let imageIdx = -1;\n            getPanoramaAtPos({lat, lng}, 0).then((resp) => {\n                if (!resp.found) {\n                    return false;\n                }\n                for (let [i, image] of resp.data.entries()) {\n                    if (image.pageId === pageId) {\n                        imageIdx = i;\n                        break;\n                    }\n                }\n                if (imageIdx > -1) {\n                    this._showPano(resp.data, imageIdx, {center: L.latLng(y, x), zoom});\n                }\n            });\n            return true;\n        }\n        return false;\n    },\n\n    getState: function() {\n        if (!this.images) {\n            return [];\n        }\n        const center = this.map.getCenter();\n        return [\n            this.images[0].lat.toFixed(6),\n            this.images[0].lng.toFixed(6),\n            this.images[this._imageIdx].pageId,\n            center.lat.toFixed(2),\n            center.lng.toFixed(2),\n            this.map.getZoom().toFixed(1)\n        ];\n    }\n});\n\nfunction getViewer(container) {\n    return new Viewer(container);\n}\n\nexport default {\n    getCoverageLayer, \n    getPanoramaAtPos,\n    getViewer\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.panoramas/lib/wikimedia/index.js\n **/","import L from 'leaflet'\nimport ko from 'vendored/knockout';\nimport 'lib/knockout.component.progress/progress';\nimport 'lib/controls-styles/controls-styles.css';\nimport './control.css';\nimport PageFeature from './pageFeature';\nimport Contextmenu from 'lib/contextmenu';\nimport {renderPages} from './map-render'\nimport formHtml from './form.html';\nimport {notify} from 'lib/notifications';\nimport {makePdf} from './pdf';\nimport {saveAs} from 'browser-filesaver';\nimport {blobFromString} from 'lib/binary-strings';\nimport 'lib/leaflet.hashState/leaflet.hashState';\nimport 'lib/leaflet.control.commons';\nimport logging from 'lib/logging';\nimport  {MagneticMeridians} from './decoration.magnetic-meridians';\nimport {OverlayScale} from './decoration.scale';\nimport {Grid} from './decoration.grid';\n\nko.extenders.checkNumberRange = function(target, range) {\n    return ko.pureComputed({\n            read: target,  //always return the original observables value\n            write: function(newValue) {\n                newValue = parseFloat(newValue);\n                if (newValue >= range[0] && newValue <= range[1]) {\n                    target(newValue);\n                } else {\n                    target.notifySubscribers(target());\n                }\n            }\n        }\n    ).extend({notify: 'always'});\n};\n\nfunction savePagesPdf(imagesInfo, resolution) {\n    let pdf = makePdf(imagesInfo, resolution);\n    pdf = blobFromString(pdf);\n    saveAs(pdf, 'map.pdf', true);\n}\n\nfunction savePageJpg(page) {\n    saveAs(blobFromString(page.data), 'map.jpg', true);\n}\n\nL.Control.PrintPages = L.Control.extend({\n        options: {position: 'bottomleft'},\n\n        includes: [L.Mixin.Events, L.Mixin.HashState],\n\n        stateChangeEvents: ['change'],\n\n        pageSizes: [\n            {'name': 'A1', width: 594, height: 841},\n            {'name': 'A2', width: 420, height: 594},\n            {'name': 'A3', width: 297, height: 420},\n            {'name': 'A4', width: 210, height: 297},\n            {'name': 'A5', width: 148, height: 210}\n        ],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.pages = [];\n            this.scale = ko.observable(500).extend({checkNumberRange: [1, 1000000]});\n            this.resolution = ko.observable(300).extend({checkNumberRange: [10, 9999]});\n            this.zoomLevel = ko.observable('auto');\n            this.pageWidth = ko.observable(210).extend({checkNumberRange: [10, 9999]});\n            this.pageHeight = ko.observable(297).extend({checkNumberRange: [10, 9999]});\n            this.settingsExpanded = ko.observable(false);\n            this.makingPdf = ko.observable(false);\n            this.downloadProgressRange = ko.observable();\n            this.downloadProgressDone = ko.observable();\n            this.marginLeft = ko.observable(3).extend({checkNumberRange: [0, 99]});\n            this.marginRight = ko.observable(3).extend({checkNumberRange: [0, 99]});\n            this.marginTop = ko.observable(3).extend({checkNumberRange: [0, 99]});\n            this.marginBottom = ko.observable(3).extend({checkNumberRange: [0, 99]});\n            this.autoZoomLevels = ko.observable({});\n            this.printSize = ko.pureComputed(this._printSize, this);\n            this.printSize.subscribe(this.onPageSizeChanged, this);\n            this.scale.subscribe(this.onPageSizeChanged, this);\n            this.resolution.subscribe(this.onPageSizeChanged, this);\n            this.pageSizeDescription = ko.pureComputed(this._displayPageSize, this);\n            this.pagesNum = ko.observable(0);\n            this.pagesNumLabel = ko.pureComputed(this._pagesNumLabel, this);\n            this.gridOn = ko.observable(false);\n            this.magneticMerisiansdOn = ko.observable(false);\n\n            //hash state notifications\n            this.scale.subscribe(this.notifyChange, this);\n            this.printSize.subscribe(this.notifyChange, this);\n            this.resolution.subscribe(this.notifyChange, this);\n            this.zoomLevel.subscribe(this.notifyChange, this);\n            this.gridOn.subscribe(this.notifyChange, this);\n            this.magneticMerisiansdOn.subscribe(this.notifyChange, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container =\n                L.DomUtil.create('div', 'leaflet-control control-form control-print-pages');\n            this._stopContainerEvents();\n\n            map.on('move', this.updateFormZooms, this);\n            container.innerHTML = formHtml;\n            ko.applyBindings(this, container);\n            this.updateFormZooms();\n            return container;\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        addPage: function(isLandsacape, center) {\n            let [pageWidth, pageHeight] = this.printSize();\n            if (isLandsacape) {\n                [pageWidth, pageHeight] = [pageHeight, pageWidth];\n            }\n            if (!center) {\n                center = this._map.getCenter();\n            }\n            const page = new PageFeature(center, [pageWidth, pageHeight],\n                this.scale(), (this.pages.length + 1).toString()\n            );\n            page._rotated = isLandsacape;\n            page.addTo(this._map);\n            this.pages.push(page);\n            this.pagesNum(this.pages.length);\n            let cm = new Contextmenu(this.makePageContexmenuItems.bind(this, page));\n            page.on('contextmenu', cm.show, cm);\n            page.on('click', this.rotatePage.bind(this, page));\n            page.on('move', this.updateFormZooms, this);\n            page.on('moveend', this.notifyChange, this);\n            this.updateFormZooms();\n            this.notifyChange();\n            return page\n        },\n\n        addLandscapePage: function() {\n            this.addPage(true);\n        },\n\n        addPortraitPage: function() {\n            this.addPage(false);\n        },\n\n        removePage: function(page) {\n            let i = this.pages.indexOf(page);\n            this.pages.splice(i, 1);\n            this.pagesNum(this.pages.length);\n            this._map.removeLayer(page);\n            for (; i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n            this.updateFormZooms()\n        },\n\n        removePages: function() {\n            this.pages.forEach((page) => page.removeFrom(this._map));\n            this.pages = [];\n            this.pagesNum(this.pages.length);\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        onSavePdfClicked: function() {\n            if (!this.pages.length) {\n                notify('Add some pages to print');\n                return;\n            }\n            this.savePdf();\n        },\n\n        zoomForPrint: function() {\n            let zoom = this.zoomLevel();\n            if (zoom === 'auto') {\n                zoom = this.suggestZooms()\n            } else {\n                zoom = {mapZoom: zoom, satZoom: zoom}\n            }\n            return zoom;\n        },\n\n        incrementProgress: function(inc, range) {\n            this.downloadProgressRange(range);\n            this.downloadProgressDone((this.downloadProgressDone() || 0) + inc);\n        },\n\n        savePdf: function() {\n            logging.captureBreadcrumbWithUrl({message: 'start save pdf'});\n            if (!this._map) {\n                return;\n            }\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const pages = this.pages.map((page) => {\n                    return {\n                        latLngBounds: page.getLatLngBounds(),\n                        printSize: page.getPrintSize(),\n                        label: page.getLabel()\n                    }\n                }\n            );\n            const resolution = this.resolution();\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMerisiansdOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms: this.zoomForPrint(),\n                    resolution,\n                    scale: this.scale(),\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            ).then((images) => {\n                    if (images) {\n                        savePagesPdf(images, resolution)\n                    }\n                }\n            ).catch((e) => {\n                    logging.captureException(e);\n                    notify(`Failed to create PDF: ${e.message}`);\n                }\n            ).then(() => this.makingPdf(false));\n        },\n\n        savePageJpg: function(page) {\n            logging.captureBreadcrumbWithUrl({message: 'start save page jpg', data: {pageNumber: page.getLabel()}});\n            const pages = [{\n                latLngBounds: page.getLatLngBounds(),\n                printSize: page.getPrintSize(),\n                label: page.getLabel()\n            }];\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMerisiansdOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms: this.zoomForPrint(),\n                    resolution: this.resolution(),\n                    scale: this.scale(),\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            )\n                .then((images) => savePageJpg(images[0]))\n                .catch((e) => {\n                        logging.captureException(e);\n                        notify(`Failed to create JPEG from page: ${e.message}`);\n                    }\n                ).then(() => this.makingPdf(false));\n        },\n\n        onPageSizeChanged: function() {\n            let [pageWidth, pageHeight] = this.printSize();\n            this.pages.forEach((page) => {\n                    let [w, h] = [pageWidth, pageHeight];\n                    if (page._rotated) {\n                        [w, h] = [h, w];\n                    }\n                    page.setSize([w, h], this.scale());\n                }\n            );\n            this.updateFormZooms();\n        },\n\n        makePageContexmenuItems: function(page) {\n            const items = [\n                {text: 'Rotate', callback: this.rotatePage.bind(this, page)},\n                '-',\n                {text: 'Delete', callback: this.removePage.bind(this, page)},\n                '-',\n                {text: 'Save image', callback: this.savePageJpg.bind(this, page), disabled: this.makingPdf()}\n            ];\n            if (this.pages.length > 1) {\n                items.push({text: 'Change order', separator: true});\n                this.pages.forEach((p, i) => {\n                        if (p !== page) {\n                            items.push({\n                                    text: (i + 1).toString(),\n                                    callback: this.renumberPage.bind(this, page, i)\n                                }\n                            );\n                        }\n                    }\n                );\n            }\n            return items;\n        },\n\n        rotatePage: function(page) {\n            page._rotated = !page._rotated;\n            page.rotate();\n            this.notifyChange();\n        },\n\n        renumberPage: function(page, newIndex) {\n            const oldIndex = this.pages.indexOf(page);\n            this.pages.splice(oldIndex, 1);\n            this.pages.splice(newIndex, 0, page);\n            for (let i = Math.min(oldIndex, newIndex); i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n        },\n\n        _printSize: function() {\n            return [this.pageWidth() - this.marginLeft() - this.marginRight(),\n                this.pageHeight() - this.marginTop() - this.marginBottom()];\n        },\n\n        suggestZooms: function() {\n            const scale = this.scale(),\n                resolution = this.resolution();\n            let referenceLat;\n            if (this.pages.length > 0) {\n                let absLats = this.pages.map((page) => {\n                        return Math.abs(page.getLatLngBounds().getCenter().lat);\n                    }\n                );\n                referenceLat = Math.min(...absLats);\n            } else {\n                if (!this._map) {\n                    return [null, null];\n                }\n                referenceLat = this._map.getCenter().lat;\n            }\n            let targetMetersPerPixel = scale / (resolution / 2.54);\n            let mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let satZoom = Math.ceil(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n\n            targetMetersPerPixel = scale / (90 / 2.54) / 1.5;\n            mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let mapZoom = Math.round(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n            mapZoom = Math.min(mapZoom, 18);\n            satZoom = Math.min(satZoom, 18);\n            mapZoom = Math.max(mapZoom, 0);\n            satZoom = Math.max(satZoom, 0);\n            return {mapZoom, satZoom};\n        },\n\n        updateFormZooms: function() {\n            this.autoZoomLevels(this.suggestZooms());\n        },\n\n        _displayPageSize: function() {\n            const width = this.pageWidth(),\n                height = this.pageHeight();\n            for (let size of this.pageSizes) {\n                if (size.width === width && size.height === height) {\n                    return size.name;\n                }\n            }\n            return `${width} x ${height} mm`;\n        },\n\n        notifyChange: function() {\n            this.fire('change');\n        },\n\n        hasPages: function() {\n            return !!this.pages.length\n        },\n\n        _pagesNumLabel: function() {\n            const n = this.pagesNum();\n            let label = '';\n            if (n) {\n                label += n;\n            } else {\n                label = 'No';\n            }\n            label += ' page';\n            if (n === 0 || n > 1) {\n                label += 's';\n            }\n            return label;\n        },\n\n        serializeState: function() {\n            const pages = this.pages;\n            let state = null;\n            if (pages.length) {\n                state = [];\n                state.push(this.scale().toString());\n                state.push(this.resolution().toString());\n                state.push(this.zoomLevel().toString());\n                state.push(this.pageWidth().toString());\n                state.push(this.pageHeight().toString());\n                state.push(this.marginLeft().toString());\n                state.push(this.marginRight().toString());\n                state.push(this.marginTop().toString());\n                state.push(this.marginBottom().toString());\n                for (let page of pages) {\n                    let latLng = page.getLatLng();\n                    state.push(latLng.lat.toFixed(5));\n                    state.push(latLng.lng.toFixed(5));\n                    state.push(page._rotated ? '1' : '0');\n                }\n                let flags =\n                    (this.magneticMerisiansdOn() ? 1 : 0) |\n                    (this.gridOn() ? 2 : 0);\n                state.push(flags);\n\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state || !state.length) {\n                return false;\n            }\n            this.removePages();\n            state = [...state];\n            this.scale(state.shift());\n            this.resolution(state.shift());\n            this.zoomLevel(state.shift());\n            this.pageWidth(state.shift());\n            this.pageHeight(state.shift());\n            this.marginLeft(state.shift());\n            this.marginRight(state.shift());\n            this.marginTop(state.shift());\n            this.marginBottom(state.shift());\n            let lat, lng, rotated;\n            while (state.length >= 3) {\n                lat = parseFloat(state.shift());\n                lng = parseFloat(state.shift());\n                rotated = parseInt(state.shift(), 10);\n                if (isNaN(lat) || isNaN(lng) || lat < -85 || lat > 85 || lng < -180 || lng > 180) {\n                    break;\n                }\n                this.addPage(!!rotated, L.latLng(lat, lng));\n            }\n            if (state.length) {\n                const flags = parseInt(state.shift(), 10);\n                if (flags >= 0  && flags <= 3) {\n                    this.magneticMerisiansdOn(!!(flags & 1));\n                    this.gridOn(!!(flags & 2));\n                }\n            }\n            return true;\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/control.js\n **/","import {PrintStaticLayer} from './decorations';\nimport L from 'leaflet';\n\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nclass Grid extends PrintStaticLayer {\n    minGridIntervalMm = 15;\n\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n\n    intervals = [1, 1.5, 2, 3.3, 5, 7.5,\n        10, 15, 20, 33, 50, 75,\n        100, 150, 200, 333, 500, 750,\n        1000, 1500, 2000, 4000, 5000, 7500,\n        10000, 15000, 20000, 40000, 50000, 75000,\n        100000, 150000, 200000, 400000, 500000, 750000,\n        1000000, 1500000, 2000000, 4000000, 5000000, 7500000];\n\n    getGridInterval(printOptions) {\n        const minGridIntervalM = this.minGridIntervalMm / 10 * printOptions.scale;\n        let intervalM;\n        for (intervalM of this.intervals) {\n            if (intervalM > minGridIntervalM) {\n                break\n            }\n        }\n        return intervalM;\n    }\n\n    formatDistance(x) {\n        let unit;\n        if (x < 1000) {\n            unit = 'm';\n        } else {\n            x /= 1000;\n            unit = 'km';\n        }\n        if (x % 1) {\n            x = x.toFixed(1);\n        }\n        return `${x} ${unit}`;\n    }\n\n    _drawGrid(canvas, printOptions) {\n        const metersPerDegree = L.Projection.SphericalMercator.R * Math.PI / 180;\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        const pixelsPerMm = 1 / 25.4 * printOptions.resolution;\n        const intervalM = this.getGridInterval(printOptions);\n        const width = printOptions.destPixelSize.x;\n        const height = printOptions.destPixelSize.y;\n        const mercatorBounds = L.bounds(\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getNorthWest()),\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getSouthEast())\n        );\n        const canvasToMercatorScale = mercatorBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const rows = [];\n        let y = height;\n        while (true) {\n            let yMerc = mercatorBounds.max.y - y * canvasToMercatorScale.y;\n            let lat = L.Projection.SphericalMercator.unproject(L.point(0, yMerc)).lat;\n            rows.push({lat, y});\n            if (y < 0) {\n                break\n            }\n            let lat2 = lat + intervalM / metersPerDegree;\n            let yMerc2 = L.Projection.SphericalMercator.project(L.latLng(lat2, 0)).y;\n            y = (mercatorBounds.max.y - yMerc2) / canvasToMercatorScale.y;\n        }\n        const lineWidthMm = 0.15;\n        let lineWidthPx = lineWidthMm * pixelsPerMm;\n        for (let {color, offset} of [{color: '#D9D9D9', offset: lineWidthPx / 2}, {color: '#8C8C8C', offset: -lineWidthPx / 2}]) {\n            ctx.beginPath();\n\n            ctx.lineWidth = lineWidthPx;\n            ctx.strokeStyle = color;\n\n            for ({y} of rows) {\n                ctx.moveTo(0, y + offset);\n                ctx.lineTo(width, y + offset);\n            }\n            const pageCanvasCenterX = printOptions.destPixelSize.x / 2;\n            for (let direction of [-1, 1]) {\n                let colN = 0;\n                while (true) {\n                    let firstRow = true;\n                    let hasPointInPage = false;\n                    for (let {lat, y} of rows) {\n                        let dx = colN * intervalM / Math.cos(radians(lat)) / canvasToMercatorScale.x;\n                        if (dx < pageCanvasCenterX) {\n                            hasPointInPage = true;\n                        }\n                        if (firstRow) {\n                            ctx.moveTo(pageCanvasCenterX + dx * direction + offset, y);\n                        } else {\n                            ctx.lineTo(pageCanvasCenterX + dx * direction + offset, y);\n                        }\n                        firstRow = false;\n                    }\n                    if (!hasPointInPage) {\n                        break\n                    }\n                    colN += 1;\n                }\n            }\n            ctx.stroke();\n        }\n\n    }\n    _drawLabel(canvas, printOptions) {\n        const intervalM = this.getGridInterval(printOptions);\n        const height = printOptions.destPixelSize.y;\n        const ctx = canvas.getContext('2d');\n        const caption = 'Grid ' + this.formatDistance(intervalM);\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, height - fontSize - 2 * padding, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, height - padding);\n    }\n\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawGrid(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: false\n                        }\n                    ),\n                    abortLoading: () => {\n                    }\n                };\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawLabel(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: true\n                        }\n                    ),\n                    abortLoading: () => {\n                    }\n                }\n            }).bind(this),\n            count: 2\n        };\n    }\n\n}\n\nexport {Grid};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/decoration.grid.js\n **/","import L from 'leaflet';\nimport {getDeclination} from 'lib/magnetic-declination';\nimport {PrintStaticLayer} from './decorations';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nfunction movePoint(p, angle, dist) {\n    angle = radians(angle);\n    return new L.point(p.x + Math.sin(angle) * dist, p.y - Math.cos(angle) * dist);\n}\n\nclass MagneticMeridians extends PrintStaticLayer {\n    lineThicknessMm = 0.2;\n    lineIntervalMm = 50;\n    samplingIntervalMm = 15;\n    color = '#66c2ff';\n    overlaySolid = false;\n\n    _makeCanvasToLatLngTransformer(printOptions) {\n        const projectedBounds = printOptions.pixelBounds;\n        const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const origin = projectedBounds.min;\n        return function(pixel) {\n            return L.CRS.EPSG3857.pointToLatLng(pixel.scaleBy(scale).add(origin), printOptions.zoom);\n        }\n    };\n\n    _drawRaster(canvas, printOptions) {\n        const toLatLng = this._makeCanvasToLatLngTransformer(printOptions);\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        ctx.strokeStyle = this.color;\n        ctx.lineWidth = this.lineThicknessMm / 25.4 * printOptions.resolution;\n        const intervalPx = this.lineIntervalMm / 25.4 * printOptions.resolution;\n        const samplingPx = this.samplingIntervalMm / 25.4 * printOptions.resolution;\n        const pageDiagonal = Math.sqrt(printOptions.destPixelSize.x * printOptions.destPixelSize.x + printOptions.destPixelSize.y * printOptions.destPixelSize.y);\n        const maxSegments = pageDiagonal / 2 / samplingPx;\n\n        function drawLine(p, directionDown) {\n            ctx.moveTo(p.x, p.y);\n\n            for (let i = 0; i <= maxSegments; i++) {\n                let latLng = toLatLng(p);\n                let declination = getDeclination(latLng.lat, latLng.lng);\n                if (declination === null) {\n                    break;\n                }\n                if (directionDown) {\n                    declination += 180;\n                }\n                p = movePoint(p, declination, samplingPx);\n                ctx.lineTo(p.x, p.y);\n            }\n        }\n\n        const center = printOptions.destPixelSize.divideBy(2);\n        const maxLines = pageDiagonal / 2 / intervalPx;\n\n        drawLine(center);\n        drawLine(center, true);\n\n        let p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination + 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n        p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination - 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n\n        ctx.stroke();\n    }\n}\n\nexport {MagneticMeridians};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/decoration.magnetic-meridians.js\n **/","import {PrintStaticLayer} from './decorations';\n\n\nfunction pageScaleRange(printOptions) {\n    const pageSize = printOptions.destPixelSize.divideBy(printOptions.resolution / 25.4);\n    const bounds = printOptions.latLngBounds;\n    const southLen = bounds.getSouthEast().distanceTo(bounds.getSouthWest());\n    const northLen = bounds.getNorthEast().distanceTo(bounds.getNorthWest());\n    const nScale = Math.round(northLen / pageSize.x * 10);\n    const sScale = Math.round(southLen / pageSize.x * 10);\n    return {\n        min: Math.min(nScale, sScale, printOptions.scale),\n        max: Math.max(nScale, sScale, printOptions.scale)\n    }\n}\n\nfunction formatScale(nominalScale, scaleRange) {\n    const threshold = 0.05;\n    if (Math.abs(nominalScale - scaleRange.min) / nominalScale > threshold || Math.abs(nominalScale - scaleRange.max) / nominalScale > threshold) {\n        let unit;\n        scaleRange = Object.assign({}, scaleRange);\n        if (scaleRange.min >= 1000) {\n            scaleRange.min /= 1000;\n            scaleRange.max /= 1000;\n            unit = 'km'\n        } else {\n            unit = 'm'\n        }\n        return `${scaleRange.min} – ${scaleRange.max} ${unit} in 1 cm`;\n    } else {\n        let unit;\n        if (nominalScale >= 1000) {\n            nominalScale /= 1000;\n            unit = 'km';\n        } else {\n            unit = 'm';\n        }\n        return `${nominalScale} ${unit} in 1 cm`;\n    }\n}\n\n\nclass OverlayScale extends PrintStaticLayer {\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n    overlaySolid = true;\n\n    _drawRaster(canvas, printOptions) {\n        const ctx = canvas.getContext('2d');\n        let caption = formatScale(printOptions.scale, pageScaleRange(printOptions));\n        if (printOptions.pagesCount > 1) {\n            caption += ` | Page ${printOptions.pageLabel} / ${printOptions.pagesCount}`;\n        }\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, 0, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, fontSize + padding);\n    }\n}\n\nexport {OverlayScale};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/decoration.scale.js\n **/","import L from 'leaflet';\nimport {getTempMap, disposeMap} from 'lib/leaflet.layer.rasterize';\nimport {XHRQueue} from 'lib/xhr-promise';\n\n\nfunction getLayersForPrint(map, xhrQueue) {\n    function getZIndex(el) {\n        return parseInt(window.getComputedStyle(el).zIndex, 10) || 0;\n    }\n\n    function compare(i1, i2) {\n        if (i1 < i2) {\n            return -1;\n        } else if (i1 > i2) {\n            return 1;\n        }\n        return 0;\n    }\n\n    function compareLayersOrder(layer1, layer2) {\n        return compareArrays(getLayerZOrder(layer1), getLayerZOrder(layer2));\n    }\n\n    function getLayerZOrder(layer) {\n        let el = layer._container || layer._path;\n        if (!el) {\n            throw TypeError('Unsupported layer type');\n        }\n        const order = [];\n        while (el !== layer._map._container) {\n            order.push(getZIndex(el));\n            el = el.parentNode;\n        }\n        return order.reverse()\n    }\n\n\n    function compareArrays(ar1, ar2) {\n        const len = Math.min(ar1.length, ar2.length);\n        for (let i = 0; i < len; i++) {\n            let c = compare(ar1[i], ar2[i]);\n            if (c) {\n                return c;\n            }\n        }\n        return compare(ar1.length, ar2.length);\n    }\n\n    let layers = [];\n    map.eachLayer((layer) => {\n            if (layer.options.print) {\n                layers.push(layer);\n            }\n        }\n    );\n    layers.sort(compareLayersOrder);\n    layers = layers.map((l) => l.cloneForPrint({xhrQueue}));\n    return layers;\n}\n\nfunction blendMultiplyCanvas(src, dest) {\n    if (src.width !== dest.width || src.height !== dest.height) {\n        throw new Error('Canvas size mismatch');\n    }\n    var s_data = src.getContext('2d').getImageData(0, 0, src.width, src.height).data;\n    src.width = 0;\n    src.height = 0;\n    var d_image_data = dest.getContext('2d').getImageData(0, 0, dest.width, dest.height);\n    var d_data = d_image_data.data;\n    var data_length = s_data.length,\n        sr, sg, sb, sa, sa1,\n        dr, dg, db,\n        l;\n    for (var i = 0; i < data_length; i += 4) {\n        sa = s_data[i + 3] / 255;\n        if (sa) {\n            sr = s_data[i];\n            sg = s_data[i + 1];\n            sb = s_data[i + 2];\n            dr = d_data[i];\n            dg = d_data[i + 1];\n            db = d_data[i + 2];\n\n            l = (dr + dg + db) / 3;\n            l = l / 255 * 0.5 + 0.5;\n            sa1 = 1 - sa;\n            dr = sr * l * sa + sa1 * dr;\n            dg = sg * l * sa + sa1 * dg;\n            db = sb * l * sa + sa1 * db;\n\n            d_data[i] = dr;\n            d_data[i + 1] = dg;\n            d_data[i + 2] = db;\n        }\n    }\n    s_data = null;\n    dest.getContext('2d').putImageData(d_image_data, 0, 0);\n}\n\nclass PageComposer {\n    constructor(destSize, pixelBoundsAtZoom24) {\n        this.destSize = destSize;\n        this.projectedBounds = pixelBoundsAtZoom24;\n        this.currentCanvas = null;\n        this.currentZoom = null;\n        this.targetCanvas = this.createCanvas(destSize);\n    }\n\n    createCanvas(size) {\n        const canvas = L.DomUtil.create('canvas');\n        canvas.width = size.x;\n        canvas.height = size.y;\n        return canvas;\n    }\n\n    putTile(tileInfo) {\n        if (!tileInfo.isOverlay && !tileInfo.image) {\n            return;\n        }\n        let zoom;\n        if (tileInfo.isOverlay) {\n            zoom = tileInfo.overlaySolid ? 'solidOverlay' : 'overlay';\n        } else {\n            zoom = tileInfo.zoom;\n        }\n        if (zoom !== this.currentZoom) {\n            this.mergeCurrentCanvas();\n            this.setupCurrentCanvas(zoom);\n        }\n        if (tileInfo.isOverlay) {\n            tileInfo.draw(this.currentCanvas);\n        } else {\n            const ctx = this.currentCanvas.getContext('2d');\n            const {tilePos, tileSize} = tileInfo;\n            ctx.drawImage(tileInfo.image, tilePos.x, tilePos.y, tileSize.x, tileSize.y);\n        }\n    }\n\n    setupCurrentCanvas(zoom) {\n        let size;\n        if (zoom === 'overlay' || zoom === 'solidOverlay') {\n            size = this.destSize;\n        } else {\n            const q = 1 << (24 - zoom);\n            const\n                topLeft = this.projectedBounds.min.divideBy(q).round(),\n                bottomRight = this.projectedBounds.max.divideBy(q).round();\n            size = bottomRight.subtract(topLeft);\n        }\n        this.currentCanvas = this.createCanvas(size);\n        this.currentZoom = zoom;\n    }\n\n    mergeCurrentCanvas() {\n        if (!this.currentCanvas) {\n            return;\n        }\n        if (this.currentZoom === 'overlay') {\n            blendMultiplyCanvas(this.currentCanvas, this.targetCanvas);\n        } else {\n            this.targetCanvas.getContext('2d').drawImage(this.currentCanvas, 0, 0,\n                this.destSize.x, this.destSize.y\n            );\n        }\n        this.currentCanvas.width = 0;\n        this.currentCanvas.height = 0;\n        this.currentCanvas = null;\n    }\n\n    getDataUrl() {\n        this.mergeCurrentCanvas();\n        const dataUrl = this.targetCanvas.toDataURL(\"image/jpeg\");\n        this.targetCanvas.width = 0;\n        this.targetCanvas.height = 0;\n        this.targetCanvas = null;\n        return dataUrl;\n    }\n}\n\nasync function* iterateLayersTiles(layers, latLngBounds, destPixelSize, resolution, scale, zooms, pageLabel, pagesCount) {\n    const defaultXHROptions = {\n        responseType: 'blob',\n        timeout: 20000,\n        isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n    };\n    let doStop;\n    for (let layer of layers) {\n        let zoom;\n        if (layer.options && layer.options.scaleDependent) {\n            zoom = zooms.mapZoom;\n        } else {\n            zoom = zooms.satZoom;\n        }\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n        let map;\n        if (!layer._layerDummy) {\n            map = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n            map.addLayer(layer);\n        }\n        let {iterateTilePromises, count} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                latLngBounds,\n                destPixelSize,\n                resolution,\n                scale,\n                zoom,\n                pageLabel,\n                pagesCount\n            }\n        );\n        let layerPromises = [];\n        for (let tilePromise of iterateTilePromises()) {\n            layerPromises.push(tilePromise.tilePromise);\n            let progressInc = (layer._printProgressWeight || 1) / count;\n            tilePromise.tilePromise =\n                tilePromise.tilePromise.then((tileInfo) => Object.assign({zoom, progressInc}, tileInfo));\n            doStop = yield tilePromise;\n            if (doStop) {\n                tilePromise.abortLoading();\n                break;\n            }\n        }\n        if (!layer._layerDummy) {\n            if (doStop) {\n                disposeMap(map);\n                break;\n            } else {\n                Promise.all(layerPromises).then(() => disposeMap(map));\n            }\n        }\n    }\n}\n\nasync function* promiseQueueBuffer(source, maxActive) {\n    const queue = [];\n    while (queue.length < maxActive) {\n        let {value, done} = await source.next();\n        if (done) {\n            break;\n        }\n        queue.push(value);\n    }\n\n    while (queue.length) {\n        let doStop = yield queue.shift();\n        if (doStop) {\n            let {value, done} = await source.next(true);\n            if (!done) {\n                queue.push(value);\n            }\n            for (let {abortLoading} of queue) {\n                abortLoading();\n            }\n\n            return;\n        }\n        let {value, done} = await source.next();\n        if (!done) {\n            queue.push(value);\n        }\n    }\n}\n\n\nasync function renderPages({map, pages, zooms, resolution, scale, progressCallback, decorationLayers}) {\n    const xhrQueue = new XHRQueue();\n    const layers = getLayersForPrint(map, xhrQueue);\n    layers.push(...decorationLayers);\n    let progressRange = 0;\n    for (let layer of layers) {\n        progressRange += layer._printProgressWeight || 1;\n    }\n    progressRange *= pages.length;\n    const pageImagesInfo = [];\n    for (let page of pages) {\n        let destPixelSize = page.printSize.multiplyBy(resolution / 25.4).round();\n        let pixelBounds = L.bounds(\n            map.project(page.latLngBounds.getNorthWest(), 24).round(),\n            map.project(page.latLngBounds.getSouthEast(), 24).round()\n        );\n\n        const composer = new PageComposer(destPixelSize, pixelBounds);\n        let tilesIterator = await iterateLayersTiles(layers, page.latLngBounds, destPixelSize, resolution, scale, zooms,\n            page.label, pages.length);\n        let queuedTilesIterator = promiseQueueBuffer(tilesIterator, 20);\n        while (true) {\n            let {value: tilePromise, done} = await queuedTilesIterator.next();\n            if (done) {\n                break;\n            }\n            let tileInfo;\n            try {\n                tileInfo = await tilePromise.tilePromise;\n            } catch (e) {\n                queuedTilesIterator.next(true);\n                throw e;\n            }\n            progressCallback(tileInfo.progressInc, progressRange);\n            composer.putTile(tileInfo);\n        }\n        const dataUrl = composer.getDataUrl();\n        let data = dataUrl.substring(dataUrl.indexOf(',') + 1);\n        data = atob(data);\n        pageImagesInfo.push({\n                data,\n                width: destPixelSize.x,\n                height: destPixelSize.y\n            }\n        );\n    }\n    return pageImagesInfo;\n}\n\n\nexport {renderPages};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/map-render.js\n **/","import L from 'leaflet'\nimport './page-feature.css';\n\nconst PageFeature = L.Marker.extend({\n        initialize: function(centerLatLng, paperSize, scale, label) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            var icon = L.divIcon({className: \"print-page-marker\", html: label});\n            L.Marker.prototype.initialize.call(this, centerLatLng, {\n                    icon: icon,\n                    draggable: true,\n                    title: 'Left click to rotate, right click for menu'\n                }\n            );\n            this.on('drag', this.updateView.bind(this, undefined));\n        },\n\n        onAdd: function(map) {\n            L.Marker.prototype.onAdd.call(this, map);\n            map.on('viewreset', () => this.updateView());\n            this.rectangle = L.rectangle([[0, 0], [0, 0]],\n                {color: '#ff7800', weight: 2, opacity: 0.7, fillOpacity: 0.2}\n            ).addTo(map);\n            this.updateView();\n        },\n\n        onRemove: function(map) {\n            map.off('viewreset', this.updateView, this);\n            L.Marker.prototype.onRemove.call(this, map);\n            this.rectangle.removeFrom(map);\n        },\n\n        getLatLngBounds: function() {\n            return this.latLngBounds;\n        },\n\n        _getLatLngBounds: function() {\n\n            const centerLatLng = this.getLatLng();\n            const centerMerc = L.Projection.SphericalMercator.project(centerLatLng);\n            const mercatorScale = Math.cos(centerLatLng.lat * Math.PI / 180) * L.CRS.Earth.R / L.Projection.SphericalMercator.R;\n            const mercatorPageSize = L.point(...this.paperSize).multiplyBy(this.scale / 10 / mercatorScale);\n            let sw = centerMerc.subtract(mercatorPageSize.divideBy(2));\n            let ne = centerMerc.add(mercatorPageSize.divideBy(2));\n            sw = L.Projection.SphericalMercator.unproject(sw);\n            ne = L.Projection.SphericalMercator.unproject(ne);\n            return L.latLngBounds([sw, ne]);\n        },\n\n        _animateZoom: function(e) {\n            L.Marker.prototype._animateZoom.call(this, e);\n            this.updateView(e.zoom);\n        },\n\n        updateView: function(newZoom) {\n            if (!this._map) {\n                return;\n            }\n            if (newZoom === undefined) {\n                newZoom = this._map.getZoom();\n            }\n            var bounds = this.latLngBounds = this._getLatLngBounds();\n            var pixel_sw = this._map.project(bounds.getSouthWest(), newZoom);\n            var pixel_ne = this._map.project(bounds.getNorthEast(), newZoom);\n            var pixel_center = this._map.project(this.getLatLng(), newZoom);\n            var st = this._icon.style;\n            var pixel_width = pixel_ne.x - pixel_sw.x;\n            var pixel_height = pixel_sw.y - pixel_ne.y;\n            st.width = `${pixel_width}px`;\n            st.height = `${pixel_height}px`;\n            st.marginLeft = `${pixel_sw.x - pixel_center.x}px`;\n            st.marginTop = `${pixel_ne.y - pixel_center.y}px`;\n            st.fontSize = `${Math.min(pixel_width, pixel_height, 500) / 2}px`;\n            st.lineHeight = `${pixel_height}px`;\n            this.rectangle.setBounds(bounds);\n        },\n\n        setLabel: function(s) {\n            this._icon.innerHTML = s;\n        },\n\n        getLabel: function() {\n            return this._icon.innerHTML;\n        },\n\n        setSize: function(paperSize, scale) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            this.updateView();\n        },\n\n        getPrintSize: function() {\n            return L.point(...this.paperSize);\n        },\n\n        rotate: function(e) {\n            this.paperSize = [this.paperSize[1], this.paperSize[0]];\n            this.updateView();\n        }\n\n    }\n);\n\nexport default PageFeature;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/pageFeature.js\n **/","function header() {\n    return '%PDF-1.3';\n}\n\n\nfunction eof() {\n    return '%%EOF\\n';\n}\n\n\nfunction recCatalog() {\n    return (\n`1 0 obj\n<< /Type /Catalog\n/Pages 2 0 R\n>>\nendobj`);\n}\n\n\nfunction recPages(count) {\n    let kidsIds = [];\n    for (let i = 0; i < count; i++) {\n        kidsIds.push(`${i * 3 + 3} 0 R`);\n    }\n    kidsIds = kidsIds.join(' ');\n    return (\n`2 0 obj\n<< /Type /Pages        \n/Kids [ ${kidsIds} ]\n/Count ${count}\n>>\nendobj`);\n}\n\n\nfunction recPage(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const imageRecId = pageRecId + 2;\n    return (\n`${pageRecId} 0 obj\n<< /Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 ${width} ${height}]\n/Contents ${contentRecId} 0 R\n/Resources <<\n    /XObject << /Im${serialNum} ${imageRecId} 0 R >>\n    /ProcSet [ /PDF /Text /ImageC ] \n    >>\n>>\nendobj`);\n}\n\n\nfunction recContent(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const contents = (\n`q\n${width} 0 0 ${height} 0 0 cm\n/Im${serialNum} Do\nQ   `);\n    return (\n`${contentRecId} 0 obj\n<<\n/Length ${contents.length + 1}\n>>\nstream\n${contents}   \nendstream\nendobj`);\n}\n\n\nfunction recImage(serialNum, widthPixels, heightPixels, data) {\n    const pageRecId = serialNum * 3 + 3;\n    const imageRecId = pageRecId + 2;\n\n    return (\n`${imageRecId} 0 obj\n<< /Type /XObject\n/Subtype /Image\n/Name /Im${serialNum}\n/Filter [ /DCTDecode ]\n/Width ${widthPixels}\n/Height ${heightPixels}\n/ColorSpace /DeviceRGB\n/BitsPerComponent 8\n/Length ${data.length}\n>>\nstream\n${data}\nendstream\nendobj`);\n}\n\n\nfunction recTrailer(recOffsets, currentOffset) {\n    const trailer = [];\n    trailer.push(\n`xref\n0 ${recOffsets.length + 1}\n0000000000 65535 f `);\n    const zeroes = '0000000000';\n    for (let offset of recOffsets) {\n        offset = offset.toString();\n        let padding = zeroes.substr(offset.length);\n        trailer.push(`${padding}${offset} 00000 n `);\n    }\n\n    trailer.push(\n`trailer\n<< /Root 1 0 R\n/Size ${recOffsets.length + 1}\n>>\nstartxref\n${currentOffset}`);\n    return trailer.join('\\n');\n}\n\n\nfunction makePdf(imagesInfo, resolution) {\n    let offset = 0;\n    const offsets = [];\n    let pdf = [];\n\n    function addRec(s, skipOffset) {\n        pdf.push(s);\n        if (!skipOffset) {\n            offsets.push(offset);\n        }\n        offset += s.length;\n    }\n\n    addRec(header(), true);\n    addRec(recCatalog());\n    addRec(recPages(imagesInfo.length));\n    for (let [i, {data, width, height}] of imagesInfo.entries()) {\n        let widthPoints = width / resolution * 72,\n            heightPoints = height / resolution * 72;\n        addRec(recPage(i, widthPoints, heightPoints));\n        addRec(recContent(i, widthPoints, heightPoints));\n        addRec(recImage(i, width, height, data));\n    }\n    addRec(recTrailer(offsets, offset), true);\n    addRec(eof(), true);\n\n    pdf = pdf.join('\\n');\n    return pdf;\n}\n\n\nexport {makePdf};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.printPages/pdf.js\n **/","import L from 'leaflet';\nimport './track-list';\nimport './ruler.css';\nimport 'lib/controls-styles/controls-styles.css';\nimport './track-list';\nimport 'lib/leaflet.control.commons';\n\nL.Control.TrackList.Ruler = L.Control.extend({\n    options: {\n        position: 'topleft'\n    },\n\n    initialize: function(trackList, options) {\n        L.Control.prototype.initialize.call(this, options);\n        this._trackList = trackList;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        const container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-button leaflet-control-ruler');\n        container.title = \"Measure distance\";\n        this._stopContainerEvents();\n        L.DomEvent.on(container, 'click', this.onClick, this);\n        return container;\n    },\n\n    onClick: function() {\n        this._trackList.setExpanded();\n        this._trackList.addNewTrack('Ruler').measureTicksShown(true);\n    }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.track-list/control-ruler.js\n **/","import utf8 from 'utf8';\nimport escapeHtml from 'escape-html';\n\nfunction saveGpx(segments, name, points) {\n    var gpx = [],\n        x, y;\n\n    gpx.push('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>');\n    gpx.push(\n        '<gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.tk\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\">'\n    );\n    if (segments.length) {\n        name = name || 'Track';\n        name = escapeHtml(name);\n        name = utf8.encode(name);\n        gpx.push('\\t<trk>');\n        gpx.push('\\t\\t<name>' + name + '</name>');\n\n        segments.forEach(function(points) {\n                if (points.length > 1) {\n                    gpx.push('\\t\\t<trkseg>');\n                    points.forEach(function(p) {\n                            x = p.lng.toFixed(6);\n                            y = p.lat.toFixed(6);\n                            gpx.push('\\t\\t\\t<trkpt lat=\"' + y + '\" lon=\"' + x + '\"></trkpt>');\n                        }\n                    );\n                    gpx.push('\\t\\t</trkseg>');\n                }\n            }\n        );\n        gpx.push('\\t</trk>');\n    }\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            gpx.push('\\t<wpt lat=\"' + marker.latlng.lat.toFixed(6) + '\" lon=\"' + marker.latlng.lng.toFixed(6) + '\">');\n            gpx.push('\\t\\t<name>' + label + '</name>');\n            gpx.push('\\t</wpt>');\n        }\n    );\n    gpx.push('</gpx>');\n    gpx = gpx.join('\\n');\n    return gpx;\n}\n\n\nfunction saveKml(segments, name, points) {\n    var kml = [],\n        x, y;\n\n    name = name || 'Track';\n    name = escapeHtml(name);\n    name = utf8.encode(name);\n\n    kml.push('<?xml version=\"1.0\" encoding=\"UTF-8\"?>');\n    kml.push('<kml xmlns=\"http://earth.google.com/kml/2.2\">');\n    kml.push('\\t<Document>');\n    kml.push('\\t\\t<name>' + name + '</name>');\n\n    segments.forEach(function(points, i) {\n            if (points.length > 1) {\n                kml.push('\\t\\t<Placemark>',\n                    '\\t\\t\\t<name>Line ' + (i + 1) + '</name>',\n                    '\\t\\t\\t<LineString>',\n                    '\\t\\t\\t\\t<tessellate>1</tessellate>',\n                    '\\t\\t\\t\\t<coordinates>'\n                );\n                points.forEach(function(p) {\n                        x = p.lng.toFixed(6);\n                        y = p.lat.toFixed(6);\n                        kml.push('\\t\\t\\t\\t\\t' + x + ',' + y);\n                    }\n                );\n                kml.push('\\t\\t\\t\\t</coordinates>',\n                    '\\t\\t\\t</LineString>',\n                    '\\t\\t</Placemark>'\n                );\n            }\n        }\n    );\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            var coordinates = marker.latlng.lng.toFixed(6) + ',' + marker.latlng.lat.toFixed(6) + ',0'\n\n            kml.push('\\t\\t<Placemark>');\n            kml.push('\\t\\t\\t<name>' + label + '</name>');\n            kml.push('\\t\\t\\t<Point>');\n            kml.push('\\t\\t\\t\\t<coordinates>' + coordinates + '</coordinates>');\n            kml.push('\\t\\t\\t</Point>');\n            kml.push('\\t\\t</Placemark>');\n        }\n    );\n\n    kml.push('\\t</Document>');\n    kml.push('\\t</kml>');\n\n    kml = kml.join('\\n');\n    return kml;\n}\n\nfunction packNumber(n) {\n    var bytes = [];\n    if (n >= -64 && n <= 63) {\n        n += 64;\n        bytes.push(n);\n    } else if (n >= -8192 && n <= 8191) {\n        n += 8192;\n        bytes.push((n & 0x7f) | 0x80);\n        bytes.push(n >> 7);\n        /*        } else if (n >= -2097152 && n <= 2097151) {\n         n += 2097152;\n         bytes.push((n & 0x7f) | 0x80);\n         bytes.push(((n >> 7) & 0x7f) | 0x80);\n         bytes.push(n >> 14);\n         */\n    } else if (n >= -1048576 && n <= 1048575) {\n        n += 1048576;\n        bytes.push((n & 0x7f) | 0x80);\n        bytes.push(((n >> 7) & 0x7f) | 0x80);\n        bytes.push(n >> 14);\n    } else if (n >= -268435456 && n <= 268435455) {\n        n += 268435456;\n        bytes.push((n & 0x7f) | 0x80);\n        bytes.push(((n >> 7) & 0x7f) | 0x80);\n        bytes.push(((n >> 14) & 0x7f) | 0x80);\n        bytes.push(n >> 21);\n    } else {\n        throw new Error('Number ' + n + ' too big to pack in 29 bits');\n    }\n    return String.fromCharCode.apply(null, bytes);\n}\n\n\nfunction encodeUrlSafeBase64(s) {\n    return (btoa(s)\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/=+$/, '')\n    );\n}\n\nfunction saveToString(segments, name, color, measureTicksShown, wayPoints, trackHidden) {\n    var stringified = [];\n    stringified.push(packNumber(3)); // version\n    name = utf8.encode(name);\n    stringified.push(packNumber(name.length));\n    stringified.push(name);\n\n    var arcUnit = ((1 << 24) - 1) / 360;\n    segments = segments.filter(function(segment) {\n            return segment.length > 1;\n        }\n    );\n\n    stringified.push(packNumber(segments.length));\n    segments.forEach(function(points) {\n            var lastX = 0,\n                lastY = 0,\n                x, y,\n                deltaX, deltaY,\n                p;\n            stringified.push(packNumber(points.length));\n            for (var i = 0, len = points.length; i < len; i++) {\n                p = points[i];\n                x = Math.round(p.lng * arcUnit);\n                y = Math.round(p.lat * arcUnit);\n                deltaX = x - lastX;\n                deltaY = y - lastY;\n                stringified.push(packNumber(deltaX));\n                stringified.push(packNumber(deltaY));\n                lastX = x;\n                lastY = y;\n            }\n        }\n    );\n    stringified.push(packNumber(+color || 0));\n    stringified.push(packNumber(measureTicksShown ? 1 : 0));\n    stringified.push(packNumber(trackHidden ? 1 : 0));\n\n    stringified.push(packNumber(wayPoints.length));\n    if (wayPoints.length) {\n        var midX = 0, midY = 0;\n        wayPoints.forEach(function(p) {\n                midX += p.latlng.lng;\n                midY += p.latlng.lat;\n            }\n        );\n        midX = Math.round(midX * arcUnit / wayPoints.length);\n        midY = Math.round(midY * arcUnit / wayPoints.length);\n        stringified.push(packNumber(midX));\n        stringified.push(packNumber(midY));\n        wayPoints.forEach(function(p) {\n                var deltaX = Math.round(p.latlng.lng * arcUnit) - midX,\n                    deltaY = Math.round(p.latlng.lat * arcUnit) - midY,\n                    symbol = 1,\n                    name = utf8.encode(p.label);\n                stringified.push(packNumber(name.length));\n                stringified.push(name);\n                stringified.push(packNumber(symbol));\n                stringified.push(packNumber(deltaX));\n                stringified.push(packNumber(deltaY));\n            }\n        );\n    }\n\n    return encodeUrlSafeBase64(stringified.join(''));\n}\n\n\nexport default {saveGpx, saveKml,saveToString};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.track-list/lib/geo_file_exporters.js\n **/","import urlViaCorsProxy from 'lib/CORSProxy';\n\nfunction urlEncode(d) {\n    return Object.entries(d).map(([k, v]) => `${k}=${encodeURIComponent(v)}`).join('&');\n}\n\nconst re = /^https?:\\/\\/www\\.gpsies\\.com\\/map\\.do\\?fileId=([a-z]+)/;\n\nfunction isGpsiesUrl(url) {\n    return re.test(url);\n}\n\nfunction gpsiesXhrOptions(url, options) {\n    const m = re.exec(url);\n    if (!m) {\n        throw new Error('Invalid gpsies url');\n    }\n    const trackId = m[1];\n    const newUrl = urlViaCorsProxy('http://www.gpsies.com/download.do');\n    return [newUrl, {\n        method: 'POST',\n        data: urlEncode({\n                fileId: trackId,\n                speed: '10',\n                dataType: '3',\n                filetype: 'gpxTrk',\n                submitButton: '',\n                inappropriate: ''\n            }\n        ),\n        headers: [[\"Content-type\", \"application/x-www-form-urlencoded\"]],\n        responseType: 'binarystring'\n    }]\n}\n\nexport {gpsiesXhrOptions, isGpsiesUrl}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.track-list/lib/gpsies.js\n **/","import L from 'leaflet';\nimport {parseGeoFile} from './lib/geo_file_formats';\n\nL.Control.TrackList.include(L.Mixin.HashState);\nL.Control.TrackList.include({\n        stateChangeEvents: [],\n\n        serializeState: function(e) {\n            return null;\n        },\n\n        unserializeState: function(values) {\n            if (values && values.length) {\n                var geodata = parseGeoFile('', window.location.href);\n                const notEmpty = this.addTracksFromGeodataArray(geodata);\n                if (notEmpty) {\n                    this.setExpanded();\n                }\n            }\n            return false;\n        }\n    }\n);\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.track-list/track-list.hash-state.js\n **/","import './track-list'\nimport L from 'leaflet';\nimport {parseGeoFile} from './lib/geo_file_formats';\nimport safeLocalStorage from 'lib/safe-localstorage';\n\nL.Control.TrackList.include({\n        maxLocalStorageSessions: 5,\n\n        saveTracksToStorage: function() {\n            var tracks = this.tracks(),\n                serialized = [],\n                maxKey = -1,\n                i, track, s, key, m, keys = [];\n\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/);\n                if (m && m[1] !== undefined) {\n                    if (+m[1] > maxKey) {\n                        maxKey = +m[1];\n                    }\n                }\n            }\n            key = 'trackList_' + (maxKey + 1);\n\n            if (tracks.length === 0) {\n                safeLocalStorage.setItem(key, '');\n                return;\n            }\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                s = this.trackToString(track);\n                serialized.push(s);\n            }\n            if (serialized.length === 0) {\n                return;\n            }\n            s = '#nktk=' + serialized.join('/');\n\n            safeLocalStorage.setItem(key, s);\n\n            //cleanup stale records\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/);\n                if (m && m[1] !== undefined) {\n                    keys.push(+m[1]);\n                }\n            }\n            if (keys.length > this.maxLocalStorageSessions) {\n                keys.sort(function(a, b) {\n                        return a - b\n                    }\n                );\n                for (i = 0; i < keys.length - this.maxLocalStorageSessions; i++) {\n                    key = 'trackList_' + keys[i];\n                    safeLocalStorage.removeItem(key);\n                }\n            }\n        },\n\n        loadTracksFromStorage: function() {\n            var i, key, m, s,\n                geodata,\n                maxKey = -1;\n\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/);\n                if (m && m[1] !== undefined) {\n                    if (+m[1] > maxKey) {\n                        maxKey = +m[1];\n                    }\n                }\n            }\n            if (maxKey > -1) {\n                key = 'trackList_' + maxKey;\n                s = safeLocalStorage.getItem(key);\n                safeLocalStorage.removeItem(key);\n                if (s) {\n                    geodata = parseGeoFile('', s);\n                    this.addTracksFromGeodataArray(geodata);\n                }\n            }\n        }\n    }\n);\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.control.track-list/track-list.localstorage.js\n **/","import './style.css';\nimport L from 'leaflet';\n\nfunction raiseControlsOnFocus(map) {\n    const selectors = ['.leaflet-top.leaflet-right', '.leaflet-bottom.leaflet-right', '.leaflet-top.leaflet-left',\n        '.leaflet-bottom.leaflet-left'];\n    let elements = map._container.querySelectorAll(selectors.join(','));\n\n    function raise(target) {\n        for (let cornerDiv of elements) {\n            if (cornerDiv === target) {\n                L.DomUtil.addClass(cornerDiv, 'leaflet-controls-corner-raised');\n            } else {\n                L.DomUtil.removeClass(cornerDiv, 'leaflet-controls-corner-raised');\n            }\n        }\n    }\n\n    [...elements].forEach((el) => L.DomEvent.on(el, 'mouseenter', raise.bind(null, el)));\n}\n\nexport default raiseControlsOnFocus;\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.controls.raise-on-focus/index.js\n **/","import L from 'leaflet';\nimport './style.css';\n\nfunction fixAll() {\n    fixPanAnimationBug();\n    fixTouchDetection();\n    fixMapKeypressEvent();\n}\n\n// https://github.com/Leaflet/Leaflet/issues/3575\nfunction fixPanAnimationBug() {\n    if (!L.Browser.chrome) {\n        return;\n    }\n    if (L.PosAnimation.prototype.__panAnimationFixed) {\n        return;\n    }\n\n    const originalStep = L.PosAnimation.prototype._step;\n    L.PosAnimation.prototype._step = function() {\n        return originalStep.call(this, true);\n    };\n    L.PosAnimation.prototype.__panAnimationFixed = true;\n}\n\nfunction fixTouchDetection() {\n    L.Browser.touch &= ((navigator.pointerEnabled && !L.Browser.ie)|| navigator.maxTouchPoints)\n}\n\nfunction fixMapKeypressEvent() {\n    const originalHandleDOMEvent = L.Map.prototype._handleDOMEvent;\n    L.Map.prototype._handleDOMEvent = function(e) {\n        if (e.type === 'keypress' && e.keyCode === 13) {\n            this._fireDOMEvent(e, e.type);\n        } else {\n            originalHandleDOMEvent.call(this, e);\n        }\n    }\n}\n\nexport {fixAll}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.fixes/index.js\n **/","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Control.Layers.include(L.Mixin.HashState);\n\nL.Control.Layers.include({\n        stateChangeEvents: ['baselayerchange', 'overlayadd', 'overlayremove'],\n        stateChangeEventsSource: '_map',\n\n        serializeState: function(e) {\n\n            const keys = [];\n            this._map.eachLayer((layer) => {\n                    let key = layer.options.code;\n                    if (key) {\n                        keys.push([key, layer.options.zIndex]);\n                    }\n                }\n            );\n            keys.sort((k1, k2) => k1[1] - k2[1]);\n            const state = keys.map((k) => k[0]);\n            return state;\n        },\n\n        unserializeState: function(values) {\n            if (!values || values.length === 0) {\n                return false;\n            }\n\n            let hasBaselayer;\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code) && !layer.overlay) {\n                    hasBaselayer = true;\n                    break;\n                }\n            }\n\n            if (!hasBaselayer) {\n                return false;\n            }\n\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code)) {\n                    this._map.addLayer(layer.layer);\n                } else {\n                    this._map.removeLayer(layer.layer);\n                }\n            }\n            return true;\n        }\n    }\n);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.hashState/Leaflet.Control.Layers.js\n **/","import L from 'leaflet';\nimport './leaflet.hashState'\n\nL.Map.include(L.Mixin.HashState);\n\nL.Map.include({\n        stateChangeEvents: ['moveend'],\n\n        serializeState: function() {\n            var center = this.getCenter();\n            var zoom = this.getZoom();\n            var precision = 5;\n            var state = [\n                zoom.toString(),\n                center.lat.toFixed(precision),\n                center.lng.toFixed(precision)\n            ];\n            return state;\n        },\n\n        unserializeState: function(values) {\n            if (!values || values.length !== 3) {\n                return false;\n            }\n            var zoom = parseInt(values[0], 10),\n                lat = parseFloat(values[1]),\n                lng = parseFloat(values[2]);\n            if (isNaN(zoom) || isNaN(lat) || isNaN(lng) || zoom < 0 || zoom > 32 || lat < -90 || lat > 90 ) {\n                return false;\n            }\n            this.setView([lat, lng], zoom);\n            return true;\n        }\n    }\n);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.hashState/Leaflet.Map.js\n **/","import L from 'leaflet';\nimport {fetch} from 'lib/xhr-promise';\nimport {notify} from 'lib/notifications';\nimport logging from 'lib/logging';\n\nL.Layer.GeoJSONAjax = L.GeoJSON.extend({\n        options: {\n            requestTimeout: 30000\n        },\n\n        initialize: function(url, options) {\n            L.GeoJSON.prototype.initialize.call(this, null, options);\n            this.url = url;\n        },\n\n\n        // Promise can be rejected if json invalid or addData fails\n        loadData: function() {\n            if (this._loadStarted) {\n                return;\n            }\n            this._loadStarted = true;\n            fetch(this.url, {timeout: this.options.requestTimeout})\n                .then(\n                    (xhr) => {\n                        this.addData(JSON.parse(xhr.response));\n                    },\n                    (e) => {\n                        logging.captureException(e, {extra: {\n                            description: 'failed to get geojson',\n                            url: this.url,\n                            status: e.xhr.status\n                        }});\n                        notify(`Failed to get GeoJSON data from ${this.url}: ${e.message}`);\n                    }\n                )\n        },\n\n        onAdd: function(map) {\n            L.GeoJSON.prototype.onAdd.call(this, map);\n            this.loadData();\n        }\n    }\n);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.geojson-ajax/index.js\n **/","import L from 'leaflet';\nimport {fetch} from 'lib/xhr-promise';\nimport {notify} from 'lib/notifications';\nimport logging from 'lib/logging';\nimport safeLocalStorage from 'lib/safe-localstorage';\n\nfunction parseResponse(s) {\n    let data;\n    data = JSON.parse(s);\n    if (!data.token) {\n        throw new Error('no token in response');\n    }\n    return data.token;\n}\n\nfunction getToken() {\n    return fetch('https://www.ut.no/kart/HentBaatToken/', {timeout: 10000})\n        .then(function(xhr) {\n                try {\n                    return {token: parseResponse(xhr.responseText)}\n                } catch (e) {\n                    logging.captureException(e, {extra: {\n                        description: 'Invalid baat token',\n                        response: xhr.responseText.toString().slice(0, 100)}});\n                    return {error: 'Server returned invalid token for Norway map'}\n                }\n            },\n            function(e) {\n                logging.captureException(e, {extra: {description: 'failed to download baat token'}});\n                return {error: `Failed to token for Norway map: ${e.message}`};\n            }\n        );\n}\n\nL.TileLayer.Nordeskart = L.TileLayer.extend({\n        options: {\n            tokenUpdateInterval: 5 * 60 * 1000\n        },\n\n        initialize: function(url, options) {\n            this.__url = url;\n            L.TileLayer.prototype.initialize.call(this, '', options);\n        },\n\n        baatTokenUpToDate: function() {\n            let nextUpdate = 0;\n            nextUpdate = parseInt(safeLocalStorage.getItem('baatTokenNextUpdate'), 10) || 0;\n            return Date.now() < nextUpdate && safeLocalStorage.getItem('baatToken');\n        },\n\n        storeBaatToken: function(token) {\n            safeLocalStorage.setItem('baatToken', token);\n            safeLocalStorage.setItem('baatTokenNextUpdate', Date.now().toString() + this.options.tokenUpdateInterval);\n        },\n\n        periodicTokenUpdate: function() {\n            if (!this._map) {\n                return;\n            }\n            getToken().then((data) => {\n                if (data.error) {\n                    notify(data.error);\n                } else {\n                    if (data.token !== this.options.baatToken) {\n                        this.options.baatToken = data.token;\n                        if (!this._url) {\n                            this.setUrl(this.__url);\n                        }\n                    }\n                    this.storeBaatToken(data.token);\n                }\n                setTimeout(() => this.periodicTokenUpdate(), this.options.tokenUpdateInterval);\n            });\n        },\n\n        onAdd: function(map) {\n            const token = this.baatTokenUpToDate();\n            if (token) {\n                this.options.baatToken = token;\n                this.setUrl(this.__url);\n            }\n            this.periodicTokenUpdate();\n            return L.TileLayer.prototype.onAdd.call(this, map);\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.nordeskart/index.js\n **/","import L from 'leaflet';\nimport 'lib/leaflet.layer.bing';\n\nL.BingLayer.include({\n        waitTilesReadyToGrab: function() {\n            if (this._url) {\n                return Promise.resolve();\n            } else {\n                return new Promise((resolve) => {\n                        let i = setInterval(() => {\n                                if (this._url) {\n                                    clearInterval(i);\n                                    resolve();\n                                }\n                            }, 50\n                        )\n                    }\n                );\n            }\n        },\n\n        cloneForPrint: function(options) {\n            return new L.BingLayer(this._key, L.Util.extend({}, this.options, options));\n        },\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/Bing.js\n **/","import L from 'leaflet';\nimport 'lib/leaflet.layer.google';\nimport {TileLayerGrabMixin} from './TileLayer';\n\n\n\nconst GooglePrint = L.Layer.Google.extend({\n    includes: TileLayerGrabMixin,\n\n    _rasterizeNeedsFullSizeMap: true,\n\n    _dummyTile: L.DomUtil.create('div'),\n\n    onAdd: function(map) {\n        this._waitTilesReadyToGrab = new Promise((resolve) => {\n           this._tilesReadyToGrab = resolve;\n        });\n        L.Layer.Google.prototype.onAdd.call(this, map);\n    },\n\n    waitTilesReadyToGrab: function() {\n        return this._waitTilesReadyToGrab;\n    },\n\n    createTile: function() {\n        return this._dummyTile;\n    },\n\n    _fullfillPendingTiles: function() {\n        if (!Object.keys(this._readyTiles).length) {\n            return;\n        }\n        this._tilesReadyToGrab();\n    },\n\n    getTileUrl: function(coords) {\n        return this._readyTiles[this._tileCoordsToKey(coords)] || null;\n    }\n});\n\n\nL.Layer.Google.include({\n    cloneForPrint: function(options) {\n        return new GooglePrint(this.mapType, L.Util.extend({}, this.options, options));\n    },\n});\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/Google.js\n **/","import L from 'leaflet';\nimport 'lib/leaflet.polyline-measure';\n\nL.Polyline.include({\n        _printProgressWeight: 0.1,\n        printWidthMm: 1,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.Polyline(latlngs, options);\n        },\n\n        _makelatLngToCanvasPixelTransformer: function(printOptions) {\n            const projectedBounds = printOptions.pixelBounds;\n            const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n            const origin = projectedBounds.min;\n            return function(latlng) {\n                return L.CRS.EPSG3857.latLngToPoint(latlng, printOptions.zoom).subtract(origin).unscaleBy(scale);\n            }\n        },\n\n\n        _drawRaster: function(canvas, printOptions) {\n            const latlngs = this.getLatLngs();\n            if (!latlngs.length || !this.getBounds().intersects(printOptions.latLngBounds)) {\n                return;\n            }\n\n            const ctx = canvas.getContext('2d');\n            ctx.lineWidth = this.printWidthMm / 25.4 * printOptions.resolution;\n            ctx.lineJoin = 'round';\n            ctx.strokeStyle = this.options.color;\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions);\n            let point;\n            ctx.beginPath();\n\n            point = transform(latlngs[0]);\n            ctx.moveTo(point.x, point.y);\n            for (let i = 1; i < latlngs.length; i++) {\n                point = transform(latlngs[i]);\n                ctx.lineTo(point.x, point.y);\n            }\n            ctx.stroke();\n            return true;\n        },\n\n\n        getTilesInfo: async function(printOptions) {\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => this._drawRaster(canvas, printOptions),\n                                isOverlay: true\n                            }\n                        ),\n                        abortLoading: () => {\n                        }\n                    }\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n\nL.MeasuredLine.include({\n        tickFontSizeMm: 2.5,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.MeasuredLine(latlngs, options);\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            if (!L.Polyline.prototype._drawRaster.call(this, canvas, printOptions)) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                return;\n            }\n            const minTicksIntervalMeters = printOptions.scale * 1.5;\n            const ctx = canvas.getContext('2d');\n            const ticks = this.getTicksPositions(minTicksIntervalMeters);\n            const ticksPixelSize = this.tickFontSizeMm / 25.4 * printOptions.resolution;\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions);\n            ctx.font = `bold ${ticksPixelSize}px verdana`;\n            ctx.fillStyle = this.options.color;\n            for (let tick of ticks) {\n                let m = tick.transformMatrix;\n                let label = '\\u2501\\u2501 ' + Math.round((tick.distanceValue / 10)) / 100 + ' km';\n                let position = transform(tick.position);\n                ctx.setTransform(m[0], m[1], m[2], m[3], position.x, position.y);\n                ctx.fillText(label, 0, ticksPixelSize * 0.3);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n        }\n    }\n);\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/MeasuredLine.js\n **/","import L from \"leaflet\";\nimport 'lib/leaflet.layer.westraPasses';\nimport {WestraPassesMarkers} from 'lib/leaflet.layer.westraPasses/westraPassesMarkers';\nimport 'lib/leaflet.layer.canvasMarkers'\nimport './CanvasMarkers';\n\nL.Layer.WestraPasses.addInitHook(function() {\n    this.markers.options.print = this.options.print;\n    this.options.print = false;\n});\n\nWestraPassesMarkers.include({\n    waitDataReady: function() {\n        if (this._dataLoaded) {\n            return Promise.resolve()\n        }\n        return new Promise((resolve) => {\n           this.on('data-loaded', resolve);\n        });\n    },\n\n    cloneForPrint: function (options) {\n        options = L.Util.extend({}, options);\n        return new WestraPassesMarkers(this._baseUrl, options);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitDataReady();\n        return await L.Layer.CanvasMarkers.prototype.getTilesInfo.call(this, printOptions);\n    }\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/WestraPasses.js\n **/","import L from 'leaflet';\nimport 'lib/leaflet.layer.yandex';\n\nL.Layer.Yandex.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex(this._mapType, L.Util.extend({}, this.options, options));\n    },\n});\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/Yandex.js\n **/","function imgFromDataString(xhr) {\n    if (xhr.status === 200 && xhr.response.size) {\n        const image = new Image();\n        let blobUrl = window.URL.createObjectURL(xhr.response);\n        const promise = new Promise((resolve, reject) => {\n                image.onload = () => {\n                    resolve(image);\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n                image.onerror = () => {\n                    reject(new Error('Image corrupt'));\n                }\n            }\n        );\n        image.src = blobUrl;\n        return promise;\n    } else {\n        return null;\n    }\n}\n\nexport {imgFromDataString}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.rasterize/imgFromDataString.js\n **/","import L from 'leaflet';\nimport './style.css';\nimport Contextmenu from 'lib/contextmenu';\nimport copyToClipboard from 'lib/clipboardCopy';\n\nfunction zeroPad(num, size) {\n    var s = num + \"\";\n    while (s.length < size) {\n        s = \"0\" + s;\n    }\n    return s;\n}\n\nconst bigLetterReplacers = [\n    {\n        '1': 'А',\n        '2': 'Б',\n        '3': 'В',\n        '4': 'Г'\n    },\n    {\n        '1': 'A',\n        '2': 'B',\n        '3': 'C',\n        '4': 'D'\n    }\n];\n\nvar Nomenclature = {\n    getQuadName1m: function(column, row, join) {\n        var name = '';\n        if (row < 0) {\n            row = -row - 1;\n            name += 'x';\n        }\n        column += 31;\n        name += 'ABCDEFGHIJKLMNOPQRSTUV'[row] + '-' + zeroPad(column, 2);\n        for (var n = 1; n <= join - 1; n++) {\n            name += ',' + zeroPad(column + n, 2);\n        }\n        return [name];\n    },\n\n    getQuadName500k: function(column, row, join) {\n        var name1 = this.getQuadName1m(Math.floor(column / 2), Math.floor(row / 2), 1)[0];\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 +=\n                ',' + this.getQuadName1m(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' + subquad +\n                ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/g, (s) => {\n                    return replacer[s]\n                }\n            );\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    getQuadName100k: function(column, row, join) {\n        var name = this.getQuadName1m(Math.floor(column / 12), Math.floor(row / 12), 1);\n        const subRow = row - Math.floor(row / 12) * 12;\n        const subColumn = column - Math.floor(column / 12) * 12;\n        var subquad = 132 - subRow * 12 + subColumn + 1;\n        name = name + '-' + zeroPad(subquad, 3);\n        if (join > 1) {\n            name += ',' + zeroPad(subquad + 1, 3);\n        }\n        if (join === 4) {\n            name += ',' + zeroPad(subquad + 2, 3) + ',' + zeroPad(subquad + 3, 3);\n        }\n\n        return [name];\n    },\n\n    getQuadName050k: function(column, row, join) {\n        var name1 = this.getQuadName100k(Math.floor(column / 2), Math.floor(row / 2), 1);\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 += ',' + this.getQuadName100k(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' +\n                subquad + ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/g, (s) => {\n                    return replacer[s]\n                }\n            );\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    _getQuads: function(bounds, row_height, column_width, name_factory) {\n        bounds = L.latLngBounds(bounds);\n        var quads = [];\n        var min_lat = Math.max(bounds.getSouth(), -84);\n        var max_lat = Math.min(bounds.getNorth(), 84);\n        var min_row = Math.floor(min_lat / row_height);\n        for (var row = min_row; row * row_height < max_lat; row++) {\n            var row_south = row * row_height;\n            var row_north = row_south + row_height;\n            var joined_quads;\n            if (row_south >= 76 || row_north <= -76) {\n                joined_quads = 4;\n            } else if (row_south >= 60 || row_north <= -60) {\n                joined_quads = 2;\n            } else {\n                joined_quads = 1;\n            }\n            var min_lon = Math.max(bounds.getWest(), -180);\n            var max_lon = Math.min(bounds.getEast(), 180);\n            var min_column = Math.floor((min_lon + 180) / column_width / joined_quads) * joined_quads -\n                Math.round(180 / column_width);\n            for (var column = min_column; column * column_width < max_lon; column += joined_quads) {\n                var column_west = column * column_width;\n                var column_east = column_west + column_width * joined_quads;\n                var quad_bounds = L.latLngBounds([[row_south, column_west], [row_north, column_east]]);\n                var names = name_factory(column, row, joined_quads);\n                quads.push({'names': names, 'bounds': quad_bounds});\n            }\n        }\n        return quads;\n    },\n\n    getQuads1m: function(bounds) {\n        return this._getQuads(bounds, 4, 6, this.getQuadName1m);\n    },\n\n    getQuads500k: function(bounds) {\n        return this._getQuads(bounds, 2, 3, this.getQuadName500k.bind(this));\n    },\n\n    getQuads100k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12, 6 / 12, this.getQuadName100k.bind(this));\n    },\n\n    getQuads050k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12 / 2, 6 / 12 / 2, this.getQuadName050k.bind(this));\n    }\n\n\n};\n\nL.Layer.SovietTopoGrid = L.LayerGroup.extend({\n        options: {},\n\n        initialize: function(options) {\n            L.LayerGroup.prototype.initialize.call(this);\n            L.Util.setOptions(this, options);\n            this.renderer = L.svg({padding: 0.5});\n            this._quads = {};\n            this._updateRenderer = L.Util.throttle(this._updateRenderer, 100, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            map.on('zoomend', this._reset, this);\n            map.on('move', this._update, this);\n            map.on('move', this._updateRenderer, this);\n            this._update();\n        },\n\n        onRemove: function(map) {\n            map.off('zoomend', this._reset, this);\n            map.off('move', this._update, this);\n            this._cleanupQuads(true);\n        },\n\n        _addQuad: function(bounds, id, titles, color, layer, scale) {\n            if (id in this._quads) {\n                return;\n            }\n            var rect_options = {\n                smoothFactor: 0,\n                noClip: true,\n                clickable: false,\n                fill: false,\n                opacity: {1: 0.7, 2: 0.4}[layer],\n                color: color,\n                weight: {1: 1, 2: 3}[layer],\n                renderer: this.renderer\n            };\n\n            var rect = L.rectangle(bounds, rect_options);\n            this.addLayer(rect);\n            if (layer === 1) {\n                rect.bringToBack();\n            }\n            var objects = [rect];\n            const title = titles[0].replace(/-/g, ' &ndash; ');\n            var html = L.Util.template(`<span style=\"color:{color}\">{title}</span>`, {color: color, title: title});\n            var icon = L.divIcon({html: html, className: 'leaflet-sovietgrid-quadtitle-' + layer, iconSize: null});\n            var marker = L.marker(L.latLngBounds(bounds).getCenter(), {icon: icon});\n            this.addLayer(marker);\n            objects.push(marker);\n            this._quads[id] = objects;\n            marker.on('click contextmenu', this._showContextMenu.bind(this, scale, titles));\n        },\n\n        _showContextMenu: function(scale, titles, e) {\n            const scaleString = {\n                '1m': '1:1 000 000',\n                '500k': '1:500 000',\n                '100k': '1:100 000',\n                '050k': '1:50 000'\n            }[scale];\n            const items = [\n                {'text': scaleString, disabled: true},\n                {'text': 'Click name to copy to clibpoard', disabled: true},\n                {\n                    'text': titles[0], callback: () => {\n                    copyToClipboard(titles[0], e.originalEvent)\n                }\n                }\n            ];\n            if (titles.length > 1) {\n                items.push({\n                        'text': titles[1] + ' <span class=\"leaflet-sovietgrid-lang\">RUS</span>', callback: () => {\n                            copyToClipboard(titles[1], e.originalEvent)\n                        }\n                    }\n                );\n                items.push({\n                        'text': titles[2] + ' <span class=\"leaflet-sovietgrid-lang\">LAT</span>', callback: () => {\n                            copyToClipboard(titles[2], e.originalEvent)\n                        }\n                    }\n                );\n            }\n            const menu = new Contextmenu(items);\n            menu.show(e);\n        },\n\n        _removeQuad: function(id) {\n            this._quads[id].forEach(this.removeLayer.bind(this));\n            delete this._quads[id];\n        },\n\n\n        _addQuads: function(quads, scale, color, layer) {\n            quads.forEach(function(quad) {\n                    var id = scale + quad.names[0];\n                    this._addQuad(quad.bounds, id, quad.names, color, layer, scale);\n                }.bind(this)\n            );\n        },\n\n        _addGrid: function() {\n            var quads;\n            var layer;\n            var map_bbox = this._map.getBounds();\n            var zoom = this._map.getZoom();\n\n            if (zoom >= 10) {\n                quads = Nomenclature.getQuads050k(map_bbox);\n                layer = (zoom >= 12) ? 2 : 1;\n                this._addQuads(quads, '050k', '#50d', layer);\n            }\n\n            if (zoom >= 8 && zoom < 12) {\n                quads = Nomenclature.getQuads100k(map_bbox);\n                layer = (zoom >= 10) ? 2 : 1;\n                this._addQuads(quads, '100k', '#d50', layer);\n            }\n\n\n            if (zoom >= 6 && zoom < 10) {\n                quads = Nomenclature.getQuads500k(map_bbox);\n                layer = (zoom >= 8) ? 2 : 1;\n                this._addQuads(quads, '500k', '#099', layer);\n            }\n\n            if (zoom >= 4 && zoom < 8) {\n                layer = (zoom >= 6) ? 2 : 1;\n                quads = Nomenclature.getQuads1m(map_bbox);\n                this._addQuads(quads, '1m', 'blue', layer);\n            }\n        },\n\n        _reset: function() {\n            this._update(true);\n        },\n\n        _cleanupQuads: function(reset) {\n            if (reset === true) {\n                this.clearLayers();\n                this._quads = {};\n            } else {\n                var map_bbox = this._map.getBounds();\n                for (var quad_id of Object.keys(this._quads)) {\n                    var rect = this._quads[quad_id][0];\n                    if (!map_bbox.intersects(rect.getBounds())) {\n                        this._removeQuad(quad_id);\n                    }\n                }\n            }\n        },\n\n        _updateRenderer: function() {\n            if (this.renderer._map) {\n                this.renderer._update();\n            }\n        },\n\n        _update: function(reset) {\n            this._cleanupQuads(reset);\n            this._addGrid();\n        }\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.soviet-topomaps-grid/index.js\n **/","import L from 'leaflet';\nimport {WikimapiaLoader} from './wikimapia-loader';\nimport './style.css';\nimport {openPopupWindow} from 'lib/popup-window';\n\n\nfunction isPointInPolygon(polygon, p) {\n    var inside = false;\n    var prevNode = polygon[polygon.length - 1],\n        node, i;\n    for (i = 0; i < polygon.length; i++) {\n        node = polygon[i];\n        if (\n            ((node[0] <= p[0] && p[0] < prevNode[0]) || (prevNode[0] <= p[0] && p[0] < node[0])) &&\n            p[1] < (prevNode[1] - node[1]) * (p[0] - node[0]) / (prevNode[0] - node[0]) + node[1]\n        ) {\n            inside = !inside;\n        }\n        prevNode = node;\n    }\n    return inside;\n}\n\nL.Wikimapia = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = null;\n        },\n\n        onAdd: function(map) {\n            if (!this.loader) {\n                this.loader = new WikimapiaLoader(map);\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('click', this.onClick, this);\n        },\n\n        onRemove: function(map) {\n            map.off('mousemove', this.onMouseMove, this);\n            map.off('click', this.onClick, this);\n            if (this.highlightedPlace) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n            L.TileLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n\n        },\n\n        drawTile: function(canvas) {\n            if (!this._map) {\n                return;\n            }\n            const\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData) {\n                return;\n            }\n\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = '#CFA600';\n            canvasCtx.lineWidth = 1;\n            for (let place of tileData.places) {\n                let polygon = place.localPolygon;\n                if (!polygon) {\n                    continue;\n                }\n                if (adjustment) {\n                    let {multiplier, offsetX, offsetY} = adjustment,\n                        polygon2 = [];\n                    for (let i = 0; i < polygon.length; i++) {\n                        let p = polygon[i];\n                        polygon2.push({\n                                x: p.x * multiplier - offsetX,\n                                y: p.y * multiplier - offsetY\n                            }\n                        );\n                    }\n                    polygon = polygon2;\n                }\n                canvasCtx.moveTo(polygon[0].x, polygon[0].y);\n                let p;\n                for (let i = 1; i < polygon.length; i++) {\n                    p = polygon[i];\n                    canvasCtx.lineTo(p.x, p.y);\n                }\n                canvasCtx.lineTo(polygon[0].x, polygon[0].y);\n            }\n            canvasCtx.stroke();\n\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment;\n                    this.drawTile(canvas);\n                    this._tileOnLoad(done, canvas)\n                }\n            );\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n        _tileOnLoad: function(done, tile) {\n            // For https://github.com/Leaflet/Leaflet/issues/3332\n            if (L.Browser.ielt9) {\n                setTimeout(L.bind(done, this, null, tile), 0);\n            } else {\n                done(null, tile);\n            }\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        _tileCoordsFromEvent: function(e) {\n            const layerPoint = this._map.getPixelOrigin().add(e.layerPoint);\n            const tileSize = this.options.tileSize;\n            let coords = {\n                x: Math.floor(layerPoint.x / tileSize),\n                y: Math.floor(layerPoint.y / tileSize),\n                z: this._map.getZoom()\n            };\n\n            return coords;\n        },\n\n        getPlaceAtMousePos: function(e) {\n            const tileCoords = this._tileCoordsFromEvent(e);\n            let tile = this._tiles[this._tileCoordsToKey(tileCoords)];\n            if (!tile) {\n                return null;\n            }\n            const tileData = tile.el._tileData;\n            if (!tileData) {\n                return null;\n            }\n            return this.getPlaceAtLatlng(e.latlng, tileData.places);\n        },\n\n        onMouseMove: function(e) {\n            const place = this.getPlaceAtMousePos(e);\n            if (this.highlightedPlace && (!place || this.highlightedPlace.id !== place.id)) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n\n            if (place && !this.highlightedPlace) {\n                this.highlightedPlace = {\n                    id: place.id,\n                    polygon: L.polygon(place.polygon, {\n                            weight: 0,\n                            color: '#E6B800'\n                        }\n                    ),\n                    label: L.tooltip({className: 'wikimapia-tooltip-wrapper'}, null)\n                };\n                this.highlightedPlace.label.setLatLng(e.latlng);\n                this.highlightedPlace.polygon.addTo(this._map).bringToBack();\n                this.highlightedPlace.label.setContent(`<div class=\"wikimapia-tooltip\">${place.title}</div>`);\n                this._map.addLayer(this.highlightedPlace.label);\n            }\n            if (this.highlightedPlace) {\n                this.highlightedPlace.label.setLatLng(e.latlng);\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const place = this.getPlaceAtMousePos(e);\n            if (place) {\n                const url = `http://wikimapia.org/${place.id}/ru/`;\n                openPopupWindow(url, 564, 'wikimapia-details');\n            }\n        },\n\n        getPlaceAtLatlng: function(latlng, places) {\n            let {lat, lng} = latlng,\n                bounds, place;\n            for (let i = places.length - 1; i >= 0; i--) {\n                place = places[i];\n                bounds = place.boundsWESN;\n                if (lng >= bounds[0] && lng <= bounds[1] && lat >= bounds[2] && lat <= bounds[3] &&\n                    isPointInPolygon(place.polygon, [lat, lng])) {\n                    return place;\n                }\n            }\n        }\n\n    }\n);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.wikimapia/index.js\n **/","import {TiledDataLoader} from 'lib/tiled-data-loader';\nimport wmUtils from './wm-utils'\nimport urlViaCorsProxy from 'lib/CORSProxy';\n\nclass WikimapiaLoader extends TiledDataLoader {\n    maxZoom = 15;\n    tileSize = 1024;\n\n    constructor(projectObj) {\n        super();\n        this._projectObj = projectObj;\n\n    }\n\n    getFromCache(dataTileCoords) {\n        dataTileCoords = Object.assign({}, dataTileCoords);\n        let exactMatch = true;\n        while (dataTileCoords.z >= 0) {\n            let key = this.makeTileKey(dataTileCoords);\n            let res = this._cache.get(key);\n            if (res.found) {\n                if (exactMatch || !res.value.hasChildren) {\n                    res['coords'] = dataTileCoords;\n                    return res;\n                }\n                break;\n            }\n            dataTileCoords.z -= 1;\n            dataTileCoords.x = Math.floor(dataTileCoords.x / 2);\n            dataTileCoords.y = Math.floor(dataTileCoords.y / 2);\n            exactMatch = false;\n        }\n        return {found: false};\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        if (z > this.maxZoom) {\n            let z2 = this.maxZoom,\n                multiplier = 1 << (z - z2);\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            }\n        }\n        else {\n            if (z < 0) {\n                return {z: 0, x: 0, y: 0};\n            }\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y}\n        }\n    }\n\n    makeRequestData(dataTileCoords) {\n        let url = wmUtils.makeTileUrl(dataTileCoords);\n        url = urlViaCorsProxy(url);\n        return {\n            url,\n            options: {timeout: 20000}\n        }\n    }\n\n    processResponse(xhr) {\n        return wmUtils.parseTile(xhr.response, this._projectObj)\n            .then((tileData) => {\n                    return {\n                        tileData,\n                        coords: tileData.coords\n                    }\n                }\n            );\n\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        const adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n}\n\nexport {WikimapiaLoader};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.wikimapia/wikimapia-loader.js\n **/","import L from 'leaflet';\n\n// (1233,130,5) -> \"032203\"\nfunction getTileId({x, y, z}) {\n    let id = [];\n    y = (1 << z) - y - 1;\n    z += 1;\n    while (z) {\n        id.push((x & 1) + (y & 1) * 2);\n        x >>= 1;\n        y >>= 1;\n        z--;\n    }\n    return id.reverse().join('');\n}\n\nfunction makeTileUrl(coords) {\n    const\n        tileId = getTileId(coords),\n        urlPath = tileId.replace(/(\\d{3})(?!$)/g, '$1/'); // \"033331022\" -> \"033/331/022\"\n    return `http://wikimapia.org/z1/itiles/${urlPath}.xy?342342`;\n}\n\nfunction tileIdToCoords(tileId) {\n    const z = tileId.length - 1;\n    let x = 0,\n        y = 0;\n    for (let i = 0; i < tileId.length; i++) {\n        let c = parseInt(tileId[i], 10);\n        x <<= 1;\n        y <<= 1;\n        x += c & 1;\n        y += c >> 1;\n    }\n    y = (1 << z) - y - 1;\n    return {x, y, z};\n}\n\nfunction getWikimapiaTileCoords(coords, viewTileSize) {\n    let z = coords.z - 2;\n    if (z < 0) {\n        z = 0;\n    }\n    if (z > 15) {\n        z = 15;\n    }\n    const q = 2 ** (z - coords.z + Math.log2(viewTileSize / 256));\n    let x = Math.floor(coords.x * q),\n        y = Math.floor(coords.y * q);\n    return {x, y, z};\n}\n\n\nfunction decodeTitles(s) {\n    const titles = {};\n    for (let title of s.split('\\x1f')) {\n        if (title.length > 2) {\n            let langCode = title.charCodeAt(0) - 32;\n            titles[langCode.toString()] = title.substring(1);\n        }\n    }\n    return titles;\n}\n\nfunction chooseTitle(titles) {\n    var popularLanguages = ['1', '0', '3', '2', '5', '4', '9', '28', '17', '27'];\n    for (let langCode of popularLanguages) {\n        if (langCode in titles) {\n            return titles[langCode];\n        }\n    }\n    for (let langCode of Object.keys(titles)) {\n        return titles[langCode];\n    }\n}\n\nfunction decodePolygon(s) {\n    var i = 0,\n        coords = [],\n        lat = 0,\n        lng = 0;\n    while (i < s.length) {\n        var p, l = 0,\n            c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63;\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lng += c & 1 ? ~(c >> 1) : c >> 1;\n        l = 0;\n        c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63;\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lat += c & 1 ? ~(c >> 1) : c >> 1;\n        coords.push([lat / 1e6, lng / 1e6]);\n    }\n    return coords;\n}\n\nfunction makeCoordsLocal(line, tileCoords, projectObj) {\n    const {x: tileX, y: tileY, z: tileZ} = tileCoords,\n        x0 = tileX * 1024,\n        y0 = tileY * 1024,\n        localCoords = [];\n    let latlon, p;\n    for (let i = 0; i < line.length; i++) {\n        latlon = line[i];\n        p = projectObj.project(latlon, tileZ + 2);\n        p.x -= x0;\n        p.y -= y0;\n        localCoords.push(p);\n    }\n    return localCoords;\n}\n\nfunction asap() {\n    return new Promise((resolve) => setTimeout(resolve, 0));\n}\n\nfunction simplifyPolygon(latlngs, tileCoords, tileHasChildren, projectObj) {\n    const\n        x = tileCoords.x * 1024,\n        y = tileCoords.y * 1024,\n        p0 = projectObj.unproject([x, y]),\n        p1 = projectObj.unproject([x + 1, y + 1]);\n    let pixelDegSize = p0.lat - p1.lat;\n    if (!tileHasChildren && tileCoords.z < 15) {\n        pixelDegSize /= (1 << (15 - tileCoords.z));\n    }\n    let points = [];\n    for (let i = 0; i < latlngs.length; i++) {\n        let ll = latlngs[i];\n        points.push({x: ll[0], y: ll[1]});\n    }\n    points = L.LineUtil.simplify(points, pixelDegSize * 2);\n    latlngs = [];\n    for (let i = 0; i < points.length; i++) {\n        let p = points[i];\n        latlngs.push([p.x, p.y]);\n    }\n    return latlngs\n}\n\nasync function parseTile(s, projectObj) {\n    const tile = {};\n    const places = tile.places = [];\n    const lines = s.split('\\n');\n    if (lines.length < 1) {\n        throw new Error('No data in tile');\n    }\n    const fields = lines[0].split('|');\n    const tileId = fields[0];\n    if (!tileId || !tileId.match(/^[0-3]+$/)) {\n        throw new Error('Invalid tile header');\n    }\n    tile.tileId = tileId;\n    tile.coords = tileIdToCoords(tileId);\n    tile.hasChildren = fields[1] === '1';\n\n    //FIXME: ignore some errors\n    let prevTime = Date.now();\n    for (let line of lines.slice(2)) {\n        let curTime = Date.now();\n        if (curTime - prevTime > 20) {\n            await asap();\n            prevTime = Date.now();\n        }\n        const place = {};\n        const fields = line.split('|');\n        if (fields.length < 6) {\n            continue;\n        }\n        let placeId = fields[0];\n        if (!placeId.match(/^\\d+$/)) {\n            // throw new Error('Invalid place id');\n            continue;\n        }\n        place.id = parseInt(placeId, 10);\n        place.title = chooseTitle(decodeTitles(fields[5]));\n        if (fields[6] !== '1') {\n            throw new Error(`Unknown wikimapia polygon encoding type: \"${fields[6]}\"`);\n        }\n\n        let bounds = fields[2].match(/^([-\\d]+),([-\\d]+),([-\\d]+),([-\\d]+)$/);\n        if (!bounds) {\n            throw new Error('Invalid place bounds');\n        }\n        place.boundsWESN = bounds.slice(1).map((x) => {\n                return parseInt(x, 10) / 1e7\n            }\n        );\n\n        let coords = fields.slice(7).join('|');\n\n        coords = decodePolygon(coords);\n        if (coords.length < 3) {\n            throw new Error(`Polygon has ${coords.length} points`);\n        }\n        let polygon = simplifyPolygon(coords, tile.coords, tile.hasChildren, projectObj);\n        place.polygon = polygon;\n        place.localPolygon = makeCoordsLocal(polygon, tile.coords, projectObj);\n        places.push(place);\n    }\n    return tile;\n}\n\n// быстрое проектирование полигонов\n// TODO: каждые 50-100 мс отдавать управление\n// projectPlacesForZoom: function(tile, viewZoom) {\n//     if (viewZoom < tile.coords.z) {\n//         throw new Error('viewZoom < tile.zoom');\n//     }\n//     if (tile.places && tile.places[0] && tile.places[0].projectedPolygons &&\n//         tile.places[0].projectedPolygons[viewZoom]) {\n//         return;\n//     }\n//     const virtualTileSize = 256 * (2 ** (viewZoom - tile.coords.z));\n//     const p1 = L.point([tile.coords.x * virtualTileSize, tile.coords.y * virtualTileSize]),\n//         p2 = L.point([(tile.coords.x + 1) * virtualTileSize, (tile.coords.y + 1) * virtualTileSize]),\n//         latlng1 = this._map.unproject(p1, viewZoom),\n//         latlng2 = this._map.unproject(p2, viewZoom),\n//         lat0 = latlng1.lat,\n//         lng0 = latlng1.lng;\n//     const qx = (p2.x - p1.x) / (latlng2.lng - latlng1.lng),\n//         qy = (p2.y - p1.y) / (latlng2.lat - latlng1.lat);\n//\n//     const offsets = [],\n//         offsetsStep = virtualTileSize / 64;\n//     const y0 = p1.y;\n//     for (let y = -virtualTileSize; y <= 2 * virtualTileSize; y += offsetsStep) {\n//         let lat = y / qy + lat0;\n//         let offset = this._map.project([lat, lng0], viewZoom).y - y0 - y;\n//         offsets.push(offset);\n//     }\n//\n//     let ll, offset, offsetPos, offsetIndex, offsetIndexDelta, x, y;\n//     const x0 = p1.x;\n//     for (let place of tile.places) {\n//         let polygon = place.polygon;\n//         if (polygon.length < 3) {\n//             continue;\n//         }\n//         let projectedPolygon = [];\n//         for (let i = 0; i < polygon.length; i++) {\n//             ll = polygon[i];\n//             x = (ll[1] - lng0) * qx;\n//             y = (ll[0] - lat0) * qy;\n//             offsetPos = (y + virtualTileSize) / offsetsStep;\n//             offsetIndex = Math.floor(offsetPos);\n//             offsetIndexDelta = offsetPos - offsetIndex;\n//             offset = offsets[offsetIndex] * (1 - offsetIndexDelta) + offsets[offsetIndex + 1] * offsetIndexDelta;\n//             projectedPolygon.push([x + x0, y + offset + y0]);\n//         }\n//         projectedPolygon = projectedPolygon.map(L.point);\n//         projectedPolygon = L.LineUtil.simplify(projectedPolygon, 1.5);\n//         if (!place.projectedPolygons) {\n//             place.projectedPolygons = [];\n//         }\n//         place.projectedPolygons[viewZoom] = projectedPolygon;\n//     }\n// },\n\nexport default {getTileId, getWikimapiaTileCoords, parseTile, makeTileUrl}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.layer.wikimapia/wm-utils.js\n **/","import L from 'leaflet';\n\nL.LineUtil.simplifyLatlngs = function simplifyLatlngs(points, tolerance) {\n    function latlngToXy(p) {\n        return {\n            x: p.lng,\n            y: p.lat\n        };\n    }\n\n    function xyToLatlng(p) {\n        return {\n            lat: p.y,\n            lng: p.x\n        };\n    }\n\n    points = points.map(latlngToXy);\n    points = L.LineUtil.simplify(points, tolerance);\n    points = points.map(xyToLatlng);\n    return points;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.lineutil.simplifyLatLngs/index.js\n **/","import L from 'leaflet';\nimport './edit_line.css';\n\nL.Polyline.EditMixinOptions = {\n    className: 'leaflet-editable-line'\n};\n\nL.Polyline.EditMixin = {\n    _nodeMarkersZOffset: 10000,\n\n    startEdit: function() {\n        if (this._map && !this._editing) {\n            this._editing = true;\n            this._drawingDirection = 0;\n            this.setupMarkers();\n            this.on('remove', this.stopEdit.bind(this));\n            this._map\n                .on('click', this.onMapClick, this)\n                .on('dragend', this.onMapEndDrag, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyPress, this);\n            this._storedStyle = {weight: this.options.weight, opacity: this.options.opacity};\n            this.setStyle({weight: 1.5, opacity: 1});\n            L.DomUtil.addClass(this._map._container, 'leaflet-line-editing');\n        }\n    },\n\n    stopEdit: function(userCancelled) {\n        if (this._editing) {\n            this.stopDrawingLine();\n            this._editing = false;\n            this.removeMarkers();\n            L.DomEvent.off(document, 'keyup', this.onKeyPress, this);\n            this.off('remove', this.stopEdit.bind(this));\n            this._map\n                .off('click', this.onMapClick, this)\n                .off('dragend', this.onMapEndDrag, this);\n            this.setStyle(this._storedStyle);\n            L.DomUtil.removeClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editend', {target: this, userCancelled});\n        }\n    },\n\n    removeMarkers: function() {\n        this.getLatLngs().forEach(function(node) {\n                if (node._nodeMarker) {\n                    this._map.removeLayer(node._nodeMarker);\n                    delete node._nodeMarker._lineNode;\n                    delete node._nodeMarker;\n                }\n                if (node._segmentOverlay) {\n                    this._map.removeLayer(node._segmentOverlay);\n                    delete node._segmentOverlay._lineNode;\n                    delete node._segmentOverlay;\n                }\n            }.bind(this)\n        );\n    },\n\n    onNodeMarkerDragEnd: function(e) {\n        var marker = e.target,\n            nodeIndex = this.getLatLngs().indexOf(marker._lineNode);\n        this.replaceNode(nodeIndex, marker.getLatLng());\n    },\n\n    onNodeMarkerMovedChangeNode: function(e) {\n        var marker = e.target,\n            latlng = marker.getLatLng(),\n        //nodeIndex = this.getLatLngs().indexOf(marker._lineNode);\n            node = marker._lineNode;\n        node.lat = latlng.lat;\n        node.lng = latlng.lng;\n        this.redraw();\n        this.fire('nodeschanged');\n    },\n\n    onNodeMarkerDblClickedRemoveNode: function(e) {\n        if (this.getLatLngs().length < 2 || (this._drawingDirection && this.getLatLngs().length === 2)) {\n            return;\n        }\n        var marker = e.target,\n            nodeIndex = this.getLatLngs().indexOf(marker._lineNode);\n        this.removeNode(nodeIndex);\n        this.fire('nodeschanged');\n    },\n\n    onMapClick: function(e) {\n        if (this._drawingDirection) {\n            var newNodeIndex = this._drawingDirection === -1 ? 1 : this.getLatLngs().length - 1;\n            this.addNode(newNodeIndex, e.latlng);\n        } else {\n            if (!this.preventStopEdit) {\n                this.stopEdit(true);\n            }\n        }\n    },\n\n    onMapEndDrag: function(e) {\n        if (e.distance < 15) {\n            // get mouse position from map drag handler\n            var handler = e.target.dragging._draggable;\n            var mousePos = handler._startPoint.add(handler._newPos).subtract(handler._startPos);\n            var latlng = e.target.mouseEventToLatLng({clientX: mousePos.x, clientY: mousePos.y});\n            this.onMapClick({latlng: latlng});\n        }\n    },\n\n    startDrawingLine: function(direction, e) {\n        if (!this._editing) {\n            return;\n        }\n        if (direction === undefined) {\n            direction = 1;\n        }\n        if (this._drawingDirection === direction) {\n            return;\n        }\n        this.stopDrawingLine();\n        this._drawingDirection = direction;\n\n        if (e) {\n            var newNodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length;\n            this.spliceLatLngs(newNodeIndex, 0, e.latlng);\n            this.fire('nodeschanged');\n        }\n\n        this._map.on('mousemove', this.onMouseMoveFollowEndNode, this);\n        L.DomUtil.addClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = true;\n    },\n\n\n    stopDrawingLine: function() {\n        if (!this._drawingDirection) {\n            return;\n        }\n        this._map.off('mousemove', this.onMouseMoveFollowEndNode, this);\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        this.spliceLatLngs(nodeIndex, 1);\n        this.fire('nodeschanged');\n        this._drawingDirection = 0;\n        L.DomUtil.removeClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = false;\n        this.fire('drawend');\n\n    },\n\n    onKeyPress: function(e) {\n        if ('input' === e.target.tagName.toLowerCase()) {\n            return;\n        }\n        var code = e.keyCode;\n        switch (code) {\n            case 27:\n            case 13:\n                if (this._drawingDirection) {\n                    this.stopDrawingLine();\n                } else {\n                    if (!this.preventStopEdit) {\n                        this.stopEdit(true);\n                    }\n                }\n                L.DomEvent.stop(e);\n                break;\n            case 8:\n            case 46:\n                if (this._drawingDirection && this.getLatLngs().length > 2) {\n                    const nodeIndex = this._drawingDirection === 1 ? this.getLatLngs().length - 2 : 1;\n                    this.removeNode(nodeIndex);\n                    this.fire('nodeschanged');\n                    L.DomEvent.preventDefault(e);\n                }\n                break;\n\n            default:\n        }\n    },\n\n    onMouseMoveFollowEndNode: function(e) {\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        this.spliceLatLngs(nodeIndex, 1, e.latlng);\n        this.fire('nodeschanged');\n    },\n\n    makeNodeMarker: function(nodeIndex) {\n        var node = this.getLatLngs()[nodeIndex],\n            marker = L.marker(node.clone(), {\n                    icon: L.divIcon(\n                        {className: 'line-editor-node-marker-halo', 'html': '<div class=\"line-editor-node-marker\"></div>'}\n                    ),\n                    draggable: true,\n                    zIndexOffset: this._nodeMarkersZOffset\n                }\n            );\n        marker\n            .on('drag', this.onNodeMarkerMovedChangeNode, this)\n            //.on('dragstart', this.fire.bind(this, 'editingstart'))\n            .on('dragend', this.onNodeMarkerDragEnd, this)\n            .on('dblclick', this.onNodeMarkerDblClickedRemoveNode, this)\n            .on('click', this.onNodeMarkerClickStartStopDrawing, this)\n            .on('contextmenu', function(e) {\n                    this.stopDrawingLine();\n                    this.fire('noderightclick', {\n                            nodeIndex: this.getLatLngs().indexOf(marker._lineNode),\n                            line: this,\n                            mouseEvent: e\n                        }\n                    );\n                }, this\n            );\n        marker._lineNode = node;\n        node._nodeMarker = marker;\n        marker.addTo(this._map);\n\n    },\n\n    onNodeMarkerClickStartStopDrawing: function(e) {\n        var marker = e.target,\n            latlngs = this.getLatLngs(),\n            latlngs_n = latlngs.length,\n            nodeIndex = latlngs.indexOf(marker._lineNode);\n        if ((this._drawingDirection === -1 && nodeIndex === 1) ||\n            ((this._drawingDirection === 1 && nodeIndex === latlngs_n - 2))) {\n            this.stopDrawingLine();\n        } else if (nodeIndex === 0) {\n            this.startDrawingLine(-1, e);\n        } else if (nodeIndex === this.getLatLngs().length - 1) {\n            this.startDrawingLine(1, e);\n        }\n    },\n\n    makeSegmentOverlay: function(nodeIndex) {\n        const latlngs = this.getLatLngs(),\n            p1 = latlngs[nodeIndex],\n            p2 = latlngs[nodeIndex + 1];\n        if (!p2) {\n            return;\n        }\n        const segmentOverlay = L.polyline([p1, p2], {weight: 10, opacity: 0.0});\n        segmentOverlay.on('mousedown', this.onSegmentMouseDownAddNode, this);\n        segmentOverlay.on('contextmenu', function(e) {\n                this.stopDrawingLine();\n                this.fire('segmentrightclick', {\n                        nodeIndex: this.getLatLngs().indexOf(segmentOverlay._lineNode),\n                        mouseEvent: e,\n                        line: this\n                    }\n                );\n            }, this\n        );\n        segmentOverlay._lineNode = p1;\n        p1._segmentOverlay = segmentOverlay;\n        segmentOverlay.addTo(this._map);\n    },\n\n    onSegmentMouseDownAddNode: function(e) {\n        if (e.originalEvent.button !== 0) {\n            return;\n        }\n        var segmentOverlay = e.target,\n            latlngs = this.getLatLngs(),\n            nodeIndex = latlngs.indexOf(segmentOverlay._lineNode) + 1;\n        this.addNode(nodeIndex, e.latlng);\n        if (L.Draggable._dragging) {\n            L.Draggable._dragging.finishDrag()\n        }\n        latlngs[nodeIndex]._nodeMarker.dragging._draggable._onDown(e.originalEvent)\n        this.fire('nodeschanged');\n    },\n\n    addNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            isAddingLeft = (index === 1 && this._drawingDirection === -1),\n            isAddingRight = (index === nodes.length - 1 && this._drawingDirection === 1);\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 0, latlng);\n        this.makeNodeMarker(index);\n        if (!isAddingLeft && (index >= 1)) {\n            if (!isAddingRight) {\n                var prevNode = nodes[index - 1];\n                this._map.removeLayer(prevNode._segmentOverlay);\n                delete prevNode._segmentOverlay._lineNode;\n                delete prevNode._segmentOverlay;\n            }\n            this.makeSegmentOverlay(index - 1);\n        }\n        if (!isAddingRight) {\n            this.makeSegmentOverlay(index);\n        }\n    },\n\n    removeNode: function(index) {\n        var nodes = this.getLatLngs(),\n            node = nodes[index],\n            marker = node._nodeMarker;\n        delete node._nodeMarker;\n        delete marker._lineNode;\n        this.spliceLatLngs(index, 1);\n        this._map.removeLayer(marker);\n        if (node._segmentOverlay) {\n            this._map.removeLayer(node._segmentOverlay);\n            delete node._segmentOverlay._lineNode;\n            delete node._segmentOverlay;\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this._map.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            if ((index < nodes.length - 1) || (index < nodes.length && this._drawingDirection !== 1)) {\n                this.makeSegmentOverlay(index - 1);\n            }\n        }\n    },\n\n    replaceNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            oldNode = nodes[index],\n            oldMarker = oldNode._nodeMarker;\n        this._map.removeLayer(oldNode._nodeMarker);\n        delete oldNode._nodeMarker;\n        delete oldMarker._lineNode;\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 1, latlng);\n        this.makeNodeMarker(index);\n        if (oldNode._segmentOverlay) {\n            this._map.removeLayer(oldNode._segmentOverlay);\n            delete oldNode._segmentOverlay._lineNode;\n            delete oldNode._segmentOverlay;\n            this.makeSegmentOverlay(index);\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this._map.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            this.makeSegmentOverlay(index - 1);\n        }\n    },\n\n    setupMarkers: function() {\n        this.removeMarkers();\n        var latlngs = this.getLatLngs(),\n            startNode = 0,\n            endNode = latlngs.length - 1;\n        if (this._drawingDirection === -1) {\n            startNode += 1;\n        }\n        if (this._drawingDirection === 1) {\n            endNode -= 1;\n        }\n        for (var i = startNode; i <= endNode; i++) {\n            this.makeNodeMarker(i);\n            if (i < endNode) {\n                this.makeSegmentOverlay(i);\n            }\n        }\n\n    },\n\n    spliceLatLngs: function(...args) {\n        const latlngs = this.getLatLngs();\n        const res = latlngs.splice(...args);\n        this.setLatLngs(latlngs);\n        return res;\n        // this._latlngs.splice(...args);\n        // this.redraw();\n    }\n\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/leaflet.polyline-edit/index.js\n **/","export default function stripBom(s) {\n    if (s.substr(0, 3) === '\\xef\\xbb\\xbf') {\n        s = s.substr(3);\n    }\n    return s;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/stripBom/index.js\n **/","export default {\n    bingKey: 'ArTkP-DmMk_eLjH_bqre-RDkN7_9JZ2QikvOTgD7NcePeL4ARw3CLRnzalMJQn32',\n    thunderforestKey: '00000000000000000000000000000000',\n    sentryDSN: '',\n    mapillary: 'azJWOG1CVHUtUjdlSkVTMUF2WG91dzoyZmNhZmFjMzMyMmU2YzNi'\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/secrets.js\n **/","module.exports = {\n\t\"minLat\": -58,\n\t\"step\": 2,\n\t\"rowsCount\": 69,\n\t\"maxLat\": 78,\n\t\"valueOffset\": 76,\n\t\"array\": \"7u7t7e3s7Ozr6+rq6unp6Ojn5+fm5ubl5eTk5OPj4uHh4N/e3dzb2djW1dPRz83LycbEwb+8ube0sa+sqaekop+dm5mXlZORj42MiomHhoSCgX9+fHp4dnRyb21raGVjYF1aV1RRTktIRUI/PDk2MzEuKyknJCIgHhwaGBYVExIRDw4ODQwMDAwMDA0OEBEUFxsfJSw0PklWZHSDkqGtuMLK0Nbb3uLk5+jq6+zt7e7u7u7u5ubm5ubm5eXl5OTk5OPj4+Li4uHh4eHg4ODg39/f3t7d3dzb2tnY19bU09HPzcvJx8TCv726t7Wyr6ypp6Shn5yamJaTkpCOjIuJiIaFg4KBf358e3l3dXNxb21qaGVjYF1aV1RRTktIRUI/PDo3NDIvLSooJiQiIB4dGxoZFxYWFRQUFBQUFBUWFxkbHiElKS40O0NMVWBrd4OOmaOttbzDyM3R1djb3d/g4uPk5eXm5ubm4ODg4ODg4N/f39/e3t7e3t3d3d3c3Nzc3Nzc29vb29ra2dnY19fW1dPS0c/Ny8nHxcPAvbu4tbKvraqnpKGenJmXlZKQjoyLiYeGhYOCgYB+fXx6eXh2dHNxb2xqaGVjYF1aV1RRT0xJRkNAPTo4NTMwLiwqKCYkIyEgHx4dHBsbGhoaGxscHR8gIyUoLDA0OT9GTVVeZ3B5g4yVnaWss7i+wsfKztHT1dfZ2tzd3d7f39/g2tvb29vb29ra2tra2tnZ2dnZ2NjY2NjY2NjY2NfX19fX1tbV1dTT0tHQz83LycfFw8G+u7m2s7CtqqekoZ6bmZaUkY+Ni4mHhoSDgoB/fn18e3p5d3Z1c3JwbmxqaGVjYF1bWFVST0xJRkNBPjs5NjQyMC4sKignJSQjIiEhICAgICEhIiMlJigrLjE1OT1DSE5VXGNrc3uDipKZn6arsba6vsLFyMvNz9HT1NXX19jZ2dra1tbW1tbW1tbW1tbW1dXV1dXV1NTU1NTU1NTU1NTU1NTU09PT0tLR0M/OzMvJyMbEwb+8ure0sa6rqKShnpuYlpOQjoyJh4aEgoGAfn18e3p6eXh3dnVzcnFvbWxqZ2VjYF5bWFVSUE1KR0RCPz06ODYzMTAuLCsqKCgnJiYlJSUmJicoKistLzI1ODxARUpPVVthaG91fIOJj5aboaarr7O3u77BxMbIyszOz9DR0tPU1NXV0dLS0tLS0tLS0tLS0tHR0dHR0dHR0dHR0dHR0dHR0dHQ0NDQz8/Ozs3MysnHxsTCv726uLWyr6uopaKfm5iVkpCNioiGhIKAf358e3p5eHh3dnV1dHNycXBubWtpZ2VjYF5bWVZTUE5LSEVDQD48OTc1NDIwLy4tLCsrKioqKissLS4vMTM2ODw/Q0dLUFVaYGZrcXd9g4iOk5idoqaqrrG1uLu+wMLExsjJy8zNzs/Q0NHRzs7Ozs7Pz8/Pzs7Ozs7Ozs7Ozs3Nzc3Nzc3Nzc3Nzs7Nzc3NzczMy8rJyMfFxMLAvbu4trOwrKmmop+cmJWSj4yKh4WCgX99fHp5eHd2dnV0dHNycnFwb25tbGtpZ2VjYV5cWVdUUU9MSUdEQkA9Ozk4NjQzMjEwLy8vLy8vMDEyMzU3OTs+QUVITFFVWl9kaW50eX6DiI2RlpqeoqaprbCztri7vb/Bw8TGx8jJysvMzM3NysvLy8vLy8vLy8vLy8vLy8vLy8rKysrKysrKysrKy8vLy8rKysrJycjHxsXDwsC+vLm2tLGtqqejoJyZlZKPjImGhIF/fXt6eHd2dXRzc3JycXFwcG9vbm1sa2ppZ2VjYV9dWlhVU1BNS0hGREJAPjw6OTc2NTQ0MzMzNDQ1Njc4Ojw+QUNGSk1RVVpeY2hscXZ6f4SIjJCUmJyfoqaprK6xs7a4ury+wMHCxMXGx8jIycnKx8jIyMjIyMjIyMjIyMjIyMjIyMjIx8fHx8fHx8jIyMjIyMjIx8fHxsbFxMPBwL68ube0sa6rqKShnZqWk4+MiYaDgX58enh3dXRzcnFxcG9vb25ubm1tbGxra2ppZ2ZkYmBeXFlXVFJPTUtIRkRCQD89PDs6OTg4ODg4OTk6PD0/QUNFSEtOUlZaXmJma29zeHyAhIiMj5OWmZ2goqWoq62vsrS2uLq7vb7AwcLDxMXFxsbHxMXFxcXGxsbGxsbGxsbGxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXExMPCwsC/vby6t7Wyr6yppaKem5eTkIyJhoOAfnt5d3V0cnFwb29ubW1sbGxsbGtra2tqamlpaGZlY2JgXVtZVlRST01LSUdFREJBQD8+PT09PT09Pj9AQkNFSEpNUFNWWl1hZWltcXV5fYGFiIyPkpWYm52goqWnqqyusLK0tre5ury9vr/AwcLDw8TEwsLCw8PDw8PDw8PDw8PDw8PDw8PDwsLCwsLCwsLCwsLCwsLCwsLCwcHAv769u7q4tbOwraqno5+cmJSRjYqGg4B9e3h2dHNxcG9ubWxsa2tqampqampqampqamlpaGdmZWNiYF5bWVdVU1BOTEtJR0ZFRENCQkJCQkJDREVGSEpMTlFUV1pdYWRobHB0d3t/goWJjI6RlJeZm56goqSnqautrrCytLW3uLm7vL2+v7/AwcHCwMDAwMDBwcHBwcHBwcHBwcHBwcDAwMDAwMDAwMDAwMDAwMDAwMC/v76+vby7ube1s7Guq6ikoZ2ZlpKOi4eEgX57eHZ0cnBvbm1sa2pqaWloaGhoaGhpaWlpaWlpaWhoZ2VkYmFfXVpYVlRSUE9NTEpJSEhHR0dHR0hJSktNTlBTVVhaXWFkZ2tucnZ5fYCDhomMjpGTlpianJ6goqSmqKqrra+wsrO1tre5uru8vL2+vr+/vb6+vr6+v7+/v7+/v7+/v7+/v76+vr6+vr6+vr6+vr6+vr69vb29vby8u7q4t7Wzsa6sqaWinpuXk4+MiIWBfnt5dnRycG5tbGtqaWhoZ2dnZ2dnZ2doaGlpampqampqaWhnZmRiYV9dW1lXVVNSUE9OTU1MTExNTU5PUFFTVVdZW15hZGdqbXF0d3t+gYSHioyPkZOVl5mbnZ6goqSlp6mqrK2vsLKztLa3uLm6uru8vL29u7y8vLy8vb29vb29vb29vb29vby8vLy8vLy8vLu7u7u7u7u7u7u7urq5uLe2tbOxr6yqpqOgnJmVkY2KhoJ/fHl3dHJwbm1ramloaGdmZmZmZmZmZmdnaGlpamtsbGxsbGtramhnZWNiYF5cWllXVlVUU1JSUlJSU1RVVldZW11fYmRnam1wc3Z5fH+ChYiKjY+Rk5WWmJqbnZ6goqOlpqipq6yur7Cys7S1tre4uLm6uru7urq6urq6u7u7u7u7u7u7u7u7u7u7urq6urq6urm5ubm5ubm5ubm5uLi3trW0s7GvraqnpKGempaTj4uHhIB9end1cnBubWtqaWhnZ2ZmZWVlZWVlZmZnaGlqa2xtbm9vb29vbm1samlnZWNiYF5dXFtaWVhYWFhYWVpbXF1fYWNlZ2psb3J1eHt+gIOGiIuNj5GTlJaYmZqcnZ6goaOkpqeoqqusrq+wsbKztLW2t7e4uLm5uLi4uLm5ubm5ubm5ubm5ubm5ubm5ubm4uLi4uLi4t7e3t7e3t7e3tra1tLOysa+tq6ilop+cmJSRjYmFgn97eHZzcW9tbGppaGdmZmVlZWVkZWVlZmdoaWprbW5vcXJzc3Nzc3JxcG5ta2poZmVjYmFgX15eXl5eX2BhYmNlZ2hqbW9xdHd5fH+BhIeJi42PkZOUlpeYmpucnZ6goaKkpaanqaqrra6vsLGys7S0tba2t7e4tra3t7e3t7e3t7e4uLi4uLi4uLe3t7e3t7a2tra2tra1tbW1tbW1tLSzsrGwr62rqaajoJ2alpKPi4eEgH16d3RycG5sa2loZ2dmZWVlZWVlZWVmZ2hpamttb3BydHV2d3h4eHd3dnRzcXBubWtpaGdmZWRkZGRkZWVmZ2lqbG5vcXR2eHt9gIKFh4qMjpCRk5SWl5iZmpucnZ6foaKjpKWnqKmqq62ur7CxsbKztLS1tba2tbW1tbW1tra2tra2tra2tra2tra2trW1tbW1tbS0tLS0tLSzs7OzsrKxsbCuraupp6Sin5uYlJGNiYaCf3x5dnNxb21ramloZ2ZmZWVlZWVlZmZnaGlqbG1vcXN1d3h6e3x8fXx8e3p5eHZ0c3Fwbm1sa2pqampqamtsbW5vcXJ0dnh6fH6Bg4WIioyOkJKTlZaXmJmam5ucnZ6foKGipKWmp6ipqqytrq+vsLGysrOztLS1s7S0tLS0tLS0tLS0tbW1tbW1tbW0tLS0tLSzs7Ozs7KysrKysrKxsbCwr66tq6mnpaOgnZqWk4+LiISBfXp3dXJwbmxraWhnZ2ZmZmVlZWZmZ2doaWtsbnBydHZ4enx9f4CBgYGBgIB/fXx6eXd2dHNycXBwb29vcHBxcnN0dXd4enx+gIKEhoiKjI6QkpOVlpeYmZmam5ycnZ6foKGio6Slpqeoqqusra2ur7CxsbKys7OzsrKzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsrKysrKxsbGxsbGwsLCwr6+urayrqqimo6Gem5iVkY6KhoOAfHl2dHJvbWxqaWhnZ2ZmZmZmZmdnaGlqbG1vcHJ0d3l7fX+BgoSFhYaGhYWEg4GAfn17enl3dnV1dHR0dHV1dnd4eXp8fX+Bg4WHiYuNjpCSk5WWl5iZmZqam5ycnZ6fn6ChoqOlpqeoqaqrrKytrq+wsLGxsbKysbGxsbGysrKysrKysrKysrKysrKysrKxsbGxsbCwsLCwr6+vr6+urq2trKuqqKakop+dmpaTkIyJhYJ/e3h2c3FvbWxqaWhoZ2dnZ2dnaGhpamtsbnBxc3V3enx+gIKEhoeIiYqKiomIh4aFg4KBf358e3p6eXl5eXl6ent8fX5/gYKEhYeJi42OkJKTlZaXmJiZmpqbm5ycnZ2en6ChoqOkpaanqKmqq6ysra6vr7CwsLGxsLCwsLCwsLCwsbGxsbGxsbGxsbGxsbCwsLCwr6+vr6+urq6urq6traysq6qop6WjoJ6bmJWSjouIhIF+e3h1c3FvbWxqaWloaGhoaGhpaWprbG5vcXJ0dnh6fH+Bg4WHiYqLjI2NjY2MjIuJiIeFhIKBgH9+fn19fX19fn9/gIGCg4WGiImLjY6QkpOUlpeYmJmZmpqbm5ucnJ2en5+goaKjpKWmp6ipqqusrK2urq+vsLCwr6+vr6+vr6+vr6+wsLCwsLCwsLCwr6+vr6+vrq6urq6tra2traysrKuqqainpaShn52al5SRjYqHg4B9end1cnBubWxramlpaWlpaWpqa2xtb3Byc3V3eXt9f4GEhoiJi42Oj5CQkJCQj46NjIuJiIaFhIOCgYGBgYGBgYKCg4SFhoeIiouNjpCRk5SVlpeYmZmampqbm5ucnJ2dnp+goaKjpKWmp6eoqaqrrKytra6ur6+vrq+vr6+urq6urq6ur6+vr6+vr6+vrq6urq6ura2tra2srKysrKurq6qpqKempKKgnpuZlpOPjImGgn98eXd0cnBvbWxramppaWpqa2tsbW5wcXN0dnh6fH6AgoSGiIqMjY+QkZKSk5OTkpGQj46Ni4qJiIeGhYSEhISEhIWFhoaHiImKi42OkJGSlJWWl5iZmZqampqbm5ubnJydnp6foKGio6Slpqeoqamqq6ysra2urq6urq6urq6urq6urq6urq6urq6urq6urq2tra2traysrKysq6urq6uqqqmop6alo6GfnZqYlZKOi4iFgn98eXd0cnBvbWxra2pqamtrbG1ub3FydHV3eXt9foCChIaIioyOj5GSk5SUlZWVlJSTkpGQjo2Mi4qJiIeHh4eHh4eHiIiJiouMjY6PkZKTlJaXmJiZmZqampqam5ubm5ycnZ6foKGhoqOkpaanqKmqqqusrK2tra6ura2tra2tra2tra2tra2tra2tra2tra2srKysrKyrq6urq6uqqqqpqainpqWkoqCenJmWlJGOioeEgX57eXZ0cnBvbm1sbGtrbGxtbm9wcXN0dnh6e31/gYOFh4mKjI6PkZKTlZWWl5eXlpaVlJOSkZCOjYyLi4qKiYmJiYmKioqLjIyNjo+QkpOUlZaXmJmZmZqampqampqbm5ucnZ2en6ChoqOkpaamp6ipqqqrrKysra2tra2traysrKysrKysrKysrKysrKysrKysrKurq6urq6qqqqqqqampqKenpqSjoZ+dm5iWk5CNioeEgX57eXZ0cnFvbm1tbGxtbW5ub3Fyc3V3eHp8foCCg4WHiYqMjo+RkpSVlpeXmJiYmJiXlpWUk5KRkI+OjYyMjIuLi4uLjIyNjY6Pj5CRkpSVlpeXmJmZmZqampqampqam5ubnJ2enp+goaKjpKWmp6ioqaqqq6usrKytrKysrKysrKyrq6urq6urrKysrKysq6urq6urq6qqqqqqqqmpqaiop6empaOioJ6cmpeVko+MiYaDgH17eHZ0cnFwb25ubW1ubm9wcXJ0dnd5e31+gIKEhoeJi4yOj5GSk5WWl5iYmZmZmZmYmJeWlZSTkpGQj46Ojo2NjY2NjY6Oj4+QkJGSk5SVlpeYmJmZmZmampmZmZqampqbnJydnp+goaKio6SlpqeoqamqqqurrKysrKysrKurq6urq6urq6urq6urq6urq6urq6qqqqqqqqmpqampqKinp6alpKOhn52bmZaUkY6LiIWDgH17eHZ0c3Fwb29ubm9vcHFyc3R2eHl7fX+BgoSGiImLjI6PkZKTlZaXmJmZmpqampqamZiXlpWUk5KSkZCQj4+Pj4+Pj4+PkJCRkZKTlJWVlpeYmJmZmZmZmZmZmZmZmZqam5ycnZ6foKGio6SlpaanqKmpqqurq6ysq6urq6urq6urqqqqqqqqq6urq6urq6uqqqqqqqqpqampqamoqKenpqWko6Kgn52amJaTkI2LiIWCgH17eHZ1c3JxcHBvb3BwcXJzdXZ4eXt9f4GDhIaIiYuMjo+RkpOUlZeYmZmam5ubm5ubmpmZmJeWlZSTkpKRkZCQkJCQkJCQkZGSkpOTlJWWlpeYmJmZmZmZmZmZmZmZmZmampucnZ2en6ChoqOkpaanp6ipqqqrq6urq6urq6urqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqampqKioqKempqWko6Ggnpyal5WSkI2Kh4WCf317eHd1c3JxcXBwcHFycnN1dnh5e31/gYOEhoiJi4yOj5CSk5SVlpeYmZqbm5ycnJycm5qamZiXlpWUlJOTkpKSkZGRkZGRkpKSk5OUlZWWl5eYmJiZmZmZmJiYmJiYmJmZmpqbnJ2en5+goaKjpKWmp6ioqaqqqqurq6urq6uqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqampqKiop6empaSjoqGfnZuZlpSRj4yJh4SCf317eXd1dHNycnFxcnJzdHV2eHl7fX+BgoSGiImLjI6PkJKTlJWWl5iZmpubnJydnZ2cnJubmpmYl5aWlZSUk5OTkpKSkpKSk5OTk5SUlZaWl5eYmJiYmJiYmJiYl5eXmJiYmZmam5ydnp+goaKjpKSlpqeoqamqqqqrqqurqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqamoqKinp6ampaSjoaCenJqYlpORjoyJhoSBf317eXd2dHNzcnJyc3N0dXZ4eXt9foCChIaHiYuMjo+QkZOUlZaXmJmZmpucnJ2dnZ2dnJybm5qZmJeXlpWVlJSUk5OTk5OTk5OUlJSVlZaWl5eXmJiYmJiYl5eXl5eXl5eYmJmZmpucnZ6foKGio6SlpqenqKmpqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqamoqKinp6alpaOioZ+enJqXlZOQjouIhoOBf3x7eXd2dXRzc3NzdHR1dnh5e3x+gIKDhYeJioyNj5CRkpOUlZaXmJmam5ucnZ2dnp6dnZ2cm5qamZiXl5aWlZWVlJSUlJSUlJSUlZWVlpaWl5eXmJiYmJeXl5eWlpaWlpaXl5iZmZqbnJ2en6ChoqOkpaanqKipqaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpqampqKinp6alpKOioJ+dm5mXlJKPjYqIhYOBfnx7eXd2dXV0dHR0dXZ3eHl6fH5/gYOFhoiKjI2OkJGSk5SVlpeYmZqam5ycnZ2enp6enZ2cnJuampmYl5eWlpaVlZWVlZWVlZWVlZWWlpaWl5eXl5eXl5eXlpaWlZWVlZaWlpeYmJmam5ydnp+goaKjpKWmp6ioqamqqqqqqqqqqqqqqqqqqqqqqqqqq6urq6urq6qqqqqqqampqKinp6alpKOhoJ6cmpiWlJGPjIqHhYOAfnx7eXh3dnV1dXV1dnd4eXp8fX+BgoSGiImLjY6PkZKTlJWWl5iYmZqbm5ydnZ6enp6enp2dnJybmpmZmJiXl5aWlpaWlZWVlZWVlpaWlpaXl5eXl5eXl5aWlpWVlZWUlZWVlZaXl5iZmpucnZ6foKGio6SlpqeoqKmpqaqqqqqqqqqqqqqqqqqqqqurq6urq6urq6urq6qqqqmpqainp6alpKOhn56cmpiVk5GOjImHhIKAfnx7eXh3dnZ2dnZ2d3h5ent9foCCg4WHiYqMjY+QkpOUlZaXl5iZmpqbnJydnp6en5+enp6dnZybm5qZmZiYl5eXl5aWlpaWlpaWlpaWlpaXl5eXl5eWlpaVlZWUlJSUlJSUlJWWlpeYmZqbnJ2en6Cho6SlpqanqKmpqamqqqqqqqqqqqqqqqqrq6urq6usrKysrKurq6urqqqpqaiop6alpKKhn52bmZeVkpCNi4mGhIKAfnx7eXh3d3Z2dnd3eHl6e3x+f4GDhIaIiYuNjpCRkpOUlZaXmJmZmpubnJ2dnp6fn5+fn56enZ2cm5uamZmZmJiXl5eXl5eXlpaWlpaWl5eXl5eXl5aWlpWVlJSUk5OTk5OTk5SUlZaXmJmam5ydnp+goqOkpaanp6ipqampqqqqqqqqqqqqq6urq6usrKysrKysrKysrKurq6qqqamop6alpKKhn52bmZaUko+NioiGg4F/fnx7eXh4d3d3d3d4eXp7fH1/gIKEhYeJioyNj5CSk5SVlpeYmJmampucnJ2enp6fn5+fn5+enp2cnJubmpqZmZiYmJiYl5eXl5eXl5eXl5eXl5eWlpaWlZWUlJOTkpKSkpKSkpOTlJWWlpeYmpucnZ6foaKjpKWmp6eoqKmpqaqqqqqqqqurq6urrKysrK2tra2tra2trKysq6uqqqmop6alpKKgnp2amJaTkY+MioeFg4F/fXx7eXl4eHd4eHh5ent8fX6AgYOEhoiJi4yOj5GSk5SWlpeYmZqam5ucnZ2enp+fn5+fn5+fnp6dnJybm5qamZmZmZiYmJiYmJeXl5eXl5eXl5eWlpaVlZSUk5OSkpGRkZGRkZKSk5OUlZaXmJmbnJ2eoKGio6SlpqeoqKipqamqqqqqq6urq6ysrKytra2trq6urq6tra2srKyrqqmpqKalpKKgnpyamJWTkI6MiYeFgoB/fXx7enl4eHh4eHl6ent9fn+AgoOFh4iKi42PkJGTlJWWl5iZmZqbm5ycnZ6en5+foKCgoJ+fn56dnZycm5uampqZmZmZmZiYmJiYmJiXl5eXl5aWlpWVlJSTkpKRkZCQkJCQkJCRkZKTlJWWl5iZm5ydnqChoqOkpaanp6ioqamqqqqrq6urrKysra2trq6urq6urq6urq6traysq6qpqKelpKKgnpyal5WSkI2LiIaEgoB+fXt6enl4eHh5eXp6e3x9foCBg4SGh4mKjI2PkJKTlJWWl5iZmpqbnJydnZ6en5+goKCgoKCfn56enZ2cnJybm5qampqamZmZmZmYmJiYmJeXl5aWlpWUlJOSkpGQkI+Pj4+Pj4+QkJGSk5SVlpeYmZucnZ+goaKjpKWmpqeoqKmqqqqrq6ysrK2tra6urq+vr6+vr6+vr66ura2sq6qpqKelpKKgnpyZl5SSj42KiIaDgYB+fHt6eXl5eXl5eXp7fH1+f4CCg4WGiImLjI6PkZKTlZaXmJiZmpubnJydnp6fn5+goKCgoKCgn5+fnp6dnZycnJubm5qampqamZmZmZiYmJiXl5aWlZWUk5OSkZCQj46Ojo6Ojo6Oj5CQkZKTlJWXmJmbnJ2foKGipKWmpqenqKmpqqqrq6ysra2urq6vr7CwsLCwsLCwsK+vrq6trKuqqaempKKgnpuZl5SRj4yKh4WDgX99fHt6eXl5eXl5enp7fH1+gIGChIWHiIqLjY6QkZKUlZaXmJmampucnJ2dnp6fn6CgoKGhoaCgoKCfn56enZ2dnJycnJubm5uampqamZmZmJiXl5aWlZSUk5KRkJCPjo6NjY2MjY2Njo6PkJGSk5SVl5iZm5yen6Cho6SlpaanqKmpqqqrrKytra6ur6+wsLCxsbGxsbGxsLCwr66urayqqaimpKKgnpuZlpSRjoyJh4SCgH99fHt6eXl5eXl5ent8fH5/gIGDhIWHiIqLjY6QkZOUlZaXmJmam5ucnZ2enp+foKCgoaGhoaGhoKCgn5+fnp6enZ2dnJycnJubm5uampmZmZiYl5aWlZSTkpGRkI+OjY2MjIuLi4uMjI2Ojo+QkpOUlZeYmpucnp+goqOkpKWmp6ipqqurrK2trq6vr7CwsbGxsrKysrKysbGwsK+urayrqqimpKKgnpuZlpOQjouIhoSCgH58e3p5eXl5eXl5ent8fX5/gIGDhIaHiYqMjY+QkZOUlZaXmJmam5ycnZ2enp+goKChoaGhoaGhoaGhoKCgn5+fnp6enZ2dnZycnJubm5qamZiYl5aWlZSTkpGQj46NjIyLi4qKioqLi4yMjY6PkJGTlJWXmJqbnZ6foaKjpKWmp6ipqqurrK2urq+wsLGxsrKys7Ozs7OysrKxsbCvrq2rqqinpaKgnpuYlZOQjYqIhYOBf318e3p5eXh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkpOUlZaYmZmam5ycnZ6en5+goKGhoaKioqKioqKhoaGgoKCgn5+fnp6enp2dnZycm5uamZmYl5aVlZOSkZCPjo2Mi4uKiYmJiYmJioqLjI2Oj5CRk5SWl5mam52eoKGio6SlpqipqqurrK2ur6+wsbGysrOzs7S0tLSzs7OysbGwr62sqqmnpaKgnZuYlZKPjYqHhYKAfn17enl4eHh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkZOUlZeYmZqam5ydnZ6fn6CgoaGhoqKioqOjo6KioqKioaGhoKCgoJ+fn56enp2dnJubmpmYl5aVlJOSkZCOjYyLiomJiIiIiIiIiImKiouMjo+QkZOUlpeZmpydn6CioqOlpqeoqausra2ur7CxsbKzs7S0tLW1tbW0tLSzsrGwr66tq6mnpaOgnZuYlZKPjImGhIJ/fnx6eXh4eHd3eHh5eXp7fH5/gIGDhIaHiYqMjY+QkZOUlZeYmZqbm5ydnp6fn6CgoaGioqOjo6Ojo6Ojo6Ojo6KioqKhoaGgoKCfn56dnZybmpqZmJaVlJOSkI+OjYuKiYiIh4eGhoaHh4iIiYqLjI6PkJKTlZaYmZucnp+hoaOkpqeoqausra6vsLGxsrOztLW1tbW2trW1tbS0s7KxsK+tq6qnpaOgnZqXlJGOi4iGg4F/fXt6eXh3d3d3d3h4eXp7fH1+gIGChIWHiIqLjY6QkZOUlZaYmZqbm5ydnp6foKChoaKio6OkpKSkpKSkpKSkpKSjo6OjoqKioaGgoJ+enp2cm5qZmJeVlJORkI6NjIqJiIeHhoaFhYWFhoaHiImKi4yOj5CSlJWXmJqbnZ6goaKkpaeoqaqsra6vsLGys7S0tbW2tra2t7a2trW1tLOysa+urKqopaOgnZqXlJGOioiFgoB+fHp5eHd2dnZ2dnd4eHl6e31+f4GCg4WGiImLjI6PkZKUlZaXmZqbm5ydnp+foKGhoqKjo6SkpaWlpaWmpqalpaWlpaWkpKSjo6KioaCgn56dnJuZmJeVlJKRj46Mi4qIh4aFhYSEhISEhYWGh4iJiouMjo+RkpSWl5mbnJ6foKKjpaaoqaqsra6vsLKzs7S1tra3t7e3t7e3t7a2tbSzsbCurKqopaOgnZqXk5CNioeEgX98e3l4d3Z1dXV1dXZ3eHh6e3x9f4CBg4SGh4mKjI6PkZKTlZaXmJmbm5ydnp+goKGioqOkpKWlpqamp6enp6enp6enp6ampqWlpKSjoqKhoJ+enJuamJeVlJKQj42MiomHhoWEhIODg4ODg4SFhYaHiYqLjY6QkZOVlpiam52foKGjpaaoqaqsra6wsbKztLW2tre4uLi4uLi4uLe3trW0srGvrauopqOgnZmWk4+MiYaDgH17eXh2dXV0dHR0dHV2d3h5ent8fn+BgoSFh4iKi42PkJKTlJaXmJmam5ydnp+goaKio6Skpaamp6enqKioqampqampqaioqKenpqalpKOioaCfnZyamZeVk5KQjoyLiYiGhYSDgoKCgYKCgoODhIWGiImKjI2PkJKUlpeZm5yen6GjpKanqaqsra+wsbK0tba2t7i4ubm5ubm5ubi4t7a0s7GvrauppqOgnJmVko6LiISBf3x6eHZ1dHNzc3Nzc3R1dXZ3eXp7fX6AgYOEhoeJi4yOj5GSlJWXmJmam5ydnp+goaKjpKSlpqenqKipqaqqqqqrq6urq6qqqqmpqKenpqWkoqGgnpybmZeVk5GPjoyKiIeFhIOCgYGAgICBgYKCg4SFh4iJi4yOkJGTlZaYmpydn6GipKanqausrq+wsrO0tba3uLm5urq6urq6urm4uLe1tLKwrquppqOfnJiVkY2KhoOAfXt4dnVzcnJxcXFxcnJzdHV2d3l6e31+gIKDhYeIiouNj5CSk5WWmJmam5ydn6ChoqKjpKWmp6ioqaqqq6usrKytra2tra2srKyrqqqpqKelpKKhn52bmZeVk5GPjYuJh4aEg4KBgIB/f39/gICBgoOEhoeIiouNj5GSlJaYmZudnqCipKanqausrq+xsrO1tre4ubm6u7u7u7u7u7q5ube2tbOxrqyppqOfm5iUkIyIhYF+e3l3dXNycXBwb29wcHFycnR1dnd5enx9f4CChIWHiYuMjpCRk5SWl5iam5yen6ChoqOkpaanqKmqqqusra2urq+vr6+vr6+vrq6trayrqqinpqSioJ6cmpiWk5GPjIqIhoWDgoGAf35+fn5+f3+AgYKDhYaIiYuMjpCSk5WXmZudnqCipKWnqausrrCxsrS1tre4ubq7u7y8vLy8vLu7uri3tbOxr6yppqKfm5eTj4uHg4B8eXd0c3Fwb25ubW1ubm9wcXJzdHZ3eXp8fX+Bg4SGiIqLjY+QkpSVl5iam5yen6Cho6SlpqeoqaqrrK2urq+wsLGxsrKysrKxsbGwr66trKupp6akop+dm5iWk5GOjIqIhoSCgYB/fn19fX19fn5/gIGChIWHiIqMjY+Rk5WXmZqcnqCipKWnqautrrCxs7S2t7i5uru8vL29vb29vby8u7m4trSyr6yppqKempaRjYmFgX16d3RycG9tbGxra2tsbG1ub3BxcnR1d3h6fH5/gYOFh4iKjI6PkZOVlpiZm5yen6Cio6Smp6ipqqytrq+wsLGys7O0tLS1tbW0tLSzsrGwr62rqqilo6GenJmWk5GOjImHhYOBgH59fXx8fHx8fX1+f4CCg4SGiImLjY+RkpSWmJqcnqCipKWnqautrrCys7W2t7m6u7y9vb6+vr6+vr29vLq5t7WysK2ppaGdmZSQi4eDf3t3dHJvbWxramlpaWlpamtrbG5vcHJzdXd4enx+gIGDhYeJi42PkJKUlpeZm5yen6GipKWnqKmrrK2ur7Gys7S0tba2t7e4uLi3t7e2tbSzsbCurKqnpaKgnZqXlJGOi4mGhIKAf318fHt7e3t7fHx9fn+BgoSFh4mKjI6QkpSWmJqcnqCipKWnqautr7CytLW3uLm7vL29vr+/v8C/v7++vbu6uLWzsK2ppaGcl5OOiYSAfHh0cW9samloZ2ZmZmZnZ2hpamttbnBxc3V2eHp8foCChIaIioyOj5GTlZeZmpyeoKGjpKanqausra+wsbO0tba3uLm5urq7u7u7u7q5uLe2tbOxr6yqp6ShnpuXlJGOi4iGg4F/fnx7enp6enp6e3x8fX+AgYOFhoiKjI6QkpSWmJqcnZ+ho6Wnqautr7GytLa3ubq7vL2+v8DAwMHBwMC/vry7uLazsKyopKCblpCLhoF9eHRxbmtpZ2VkY2NjY2NkZGVmZ2lqbG1vcXN0dnh6fH6AgoSGiIuNj5GTlZaYmpyeoKKjpaepqqytr7Gys7W2t7m6u7y8vb6+vr6+vr69vLu6uLa0sq+tqqajoJyZlZGOi4iFg4B+fXt6eXl5eXl5ent8fX5/gYKEhoeJi42PkZOVl5mbnZ+ho6aoqqutr7Gztba4ubu8vb6/wMHBwsLCwcHAv727ubazsKyoo56Zk46Ig315dHBsaWdkY2FgYF9fX2BgYWJjZWZnaWttbnBydHZ4en1/gYOFh4mMjpCSlJaYmpyeoKKkpqiqq62vsbK0tre5uru9vr/AwMHCwsLCwsLBwL++vLq4trOwrammop6alpKPi4iFgoB+fHt5eXh4eHh4eXp7fH1/gIKDhYeJi42PkZOVl5mbnZ+ho6aoqqyur7Gztbe4uru9vr/AwcLCwsPDwsLBv768ubezr6umoZyWkIqEfnl0b2tnZGJgXl1cW1tbW1xdXl9gYmNlZmhqbG5wcnR2eXt9f4KEhoiLjY+RlJaYmpyeoaOlp6mrra+xs7S2uLq7vb7AwcLDxMXFxsbGxsbGxcTCwb+9ure0sK2ppaCcmJSQjIiFgn99e3p5eHd3d3d4eHl6e3x+f4GDhYaIioyOkJKVl5mbnZ+ho6aoqqyusLKztbe5ury9vsDBwsLDw8PDw8LBwL68ubazrqqkn5iSjIV/eXNuaWViX1xaWVhXV1dXV1hZWltdXmBiZGVnaWxucHJ0d3l7foCChYeKjI6Rk5WYmpyfoaOmqKqsrrCytLa4ury+v8HDxMXHyMnJysvLy8vKysnHxsTCv7y5tbGtqKOfmpaRjYmGgoB9e3l4d3d2dnZ3d3h5enx9f4CChIaIioyOkJKUlpmbnZ+ho6WoqqyusLK0tre5u7y+v8DBwsPExMTEw8PCwL68ubWxrKehm5SNhn94cmxnYl5bWFZUU1JSUlJSU1RVVlhZW11fYWNlZ2lrbnBzdXd6fH+BhIaJi46Qk5WYmp2foqSmqautsLK0tri7vb/AwsTGx8nKy83Ozs/Q0NDQz87NzMrHxcK+urayraijnpiUj4uHg4B9e3l4d3Z2dnZ2d3h5ent9foCCg4WHiYuOkJKUlpibnZ+ho6WoqqyusLK0tri5u72+v8HCw8PExMTEw8PBwL26t7OuqaOclY2FfnZwaWNeWldUUU9OTU1MTU1OT1BRU1RWWFpcXmBiZWdpbG5xc3Z4e36Ag4WIi42Qk5WYmp2goqWnqqyvsbS2uLu9v8HDxcfJy8zOz9HS09TU1dXV1dTT0tDOzMnFwb24s66oop2Xko2JhYJ/fHp4d3Z2dnZ2d3d4eXt8fn+Bg4WHiYuNj5GUlpianJ6ho6WnqqyusLK0tri5u72+v8HCw8PExMTDw8LAvru4tK+po5yUjIR7c2xlX1lVUU5LSUhHR0ZHR0hJSkxNT1FSVFdZW11gYmVnamxvcnR3enx/goWHio2QkpWYm52go6aoq66ws7W4ur2/wcTGyMrMztDS1NXW2Nna2tvb29va2djW1NHOysbBu7awqqOdl5KNiISBfnt6eHd2dnZ2d3d4eXp8fX+Bg4SGiIuNj5GTlZianJ6go6WnqauusLK0tbe5u7y+v8DBwsLDw8LCwb+9ureyraehmZGIf3ZtZV5YUk1JRkRCQUBAQEBBQkNERkdJS01PUVRWWFtdYGNlaGttcHN2eXx+gYSHio2Qk5WYm56hpKaprK+ytLe6vL/BxMbJy83Q0tTW2Nrb3d7f4OHi4uLi4eDf3dvY1NDMxsG6tK2moJmUjomFgn98enl4d3d3d3h4eXt8fX+BgoSGiIqMjpGTlZeam56goqSnqautr7Gztbe4uru9vr+/wMDAwL++vLq3s66popqSiX91bGNbU01IQ0A9Ozo5ODg4OTo7PD4/QUNFR0pMTlFTVllbXmFkZmlsb3J1eHt+gYSHio2Qk5aZnJ+ipaeqrbCztrm8vsHExsnMztHT1dja3N7g4uPl5ujp6erq6urp6Obk4d7a1dDKw7y1raafmJKNiYWBf317enl5eXl6ent9fn+Bg4SGiIqMjpCTlZeZ\",\n\t\"colsCount\": 180,\n\t\"valueScale\": 2\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/lib/magnetic-declination/declination.json\n ** module id = 473\n ** module chunks = 2\n **/","module.exports = \"<div class=\\\"contents\\\">\\n    <div class=\\\"left-buttons\\\">\\n        <div class=\\\"button-minimize\\\" data-bind=\\\"click: onMinimizeButtonClick\\\"\\n             title=\\\"Minimize\\\"></div>\\n        <div class=\\\"button-minimize icon-on-off\\\"\\n             data-bind=\\\"click: onEnableButtonClick, css: {'state-on': _enabled()}\\\"\\n             title=\\\"Switch draw by click on/off\\\"></div>\\n    </div>\\n    <table>\\n        <tr>\\n            <td>True azimuth</td>\\n            <td data-bind=\\\"text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Magnetic azimuth</td>\\n            <td data-bind=\\\"text: magneticAzimuth() !== null ? magneticAzimuth() + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Distance</td>\\n            <td data-bind=\\\"text: distance() === null ? '--' :\\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + ' km' : Math.round(distance()) + ' m'\\\"></td>\\n        </tr>\\n    </table>\\n\\n    <div class=\\\"buttons\\\">\\n        <div class=\\\"button\\\" data-bind=\\\"click: onReverseButtonClick\\\">Reverse</div>\\n        <div class=\\\"button\\\" data-bind=\\\"click: onProfileButtonClick\\\">Elevation / Sightline</div>\\n    </div>\\n</div>\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/lib/leaflet.control.azimuth/control.html\n ** module id = 486\n ** module chunks = 2\n **/","module.exports = \"<div class=\\\"leaflet-control-button-toggle\\\" title=\\\"Print map\\\"\\n     data-bind=\\\"click: setExpanded, css: {'icon-spinner-nuclear': makingPdf, 'icon-printer': !makingPdf()}\\\">\\n    </div>\\n<div class=\\\"leaflet-control-content\\\">\\n<table class=\\\"layout\\\">\\n    <tbody>\\n    <tr><td colspan=\\\"2\\\">\\n        <a title=\\\"Add page in portrait orientation\\\" class=\\\"button-add-page-vert image-button\\\"\\n           data-bind=\\\"click: addPortraitPage\\\"></a>\\n        <a title=\\\"Add page in landscape orientation\\\" class=\\\"button-add-page-horiz image-button\\\"\\n           data-bind=\\\"click: addLandscapePage\\\"></a>\\n        <span class=\\\"pages-num\\\" data-bind=\\\"text: pagesNumLabel\\\"></span>\\n        <a title=\\\"Remove all pages\\\" class=\\\"button-remove-pages image-button\\\"\\n           data-bind=\\\"click: removePages\\\"></a>\\n    </td></tr>\\n    <tr>\\n        <td class=\\\"label\\\">Print scale</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" >\\n                <a data-bind=\\\"click: function() {scale(100)}, css: {selected: scale() === 100}\\\">100 m</a>\\n                <a data-bind=\\\"click: function() {scale(500)}, css: {selected: scale() === 500}\\\">500 m</a>\\n                <a data-bind=\\\"click: function() {scale(1000)}, css: {selected: scale() === 1000}\\\">1 km</a>\\n            </div>\\n            <input type=\\\"text\\\" class=\\\"scale\\\" maxlength=\\\"6\\\" data-bind=\\\"value: scale\\\">&nbsp;m in 1 cm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Page size</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" data-bind=\\\"foreach: {data: pageSizes, as: 'size'}\\\">\\n                <a data-bind=\\\"click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\\n                              text: size.name,\\n                              css: {selected: size.name === $root.pageSizeDescription() }\\\"></a>\\n            </div>\\n            <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"width\\\" placeholder=\\\"width\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageWidth\\\">\\n            x <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"height\\\" placeholder=\\\"height\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageHeight\\\"> mm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label-high\\\">Margins</td>\\n        <td>\\n            <table class=\\\"margins\\\">\\n                <tr>\\n                    <td></td>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginTop\\\"></td>\\n                    <td></td>\\n                </tr>\\n                <tr>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginLeft\\\"></td>\\n                    <td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginRight\\\"> mm</td>\\n                </tr>\\n                <tr><td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginBottom\\\"></td><td></td></tr>\\n            </table>\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Resolution</td>\\n        <td><input type=\\\"text\\\" maxlength=\\\"4\\\" class=\\\"resolution\\\" data-bind=\\\"value: resolution\\\"> dpi</td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Source zoom<br />level</td>\\n        <td>\\n            <select name=\\\"srczoom\\\"\\n                    data-bind=\\\"options: ['auto', 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], value: zoomLevel\\\">\\n            </select>\\n        </td>\\n    </tr>\\n    <tr>\\n        <td colspan=\\\"2\\\">\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: magneticMerisiansdOn\\\"> Magnetic meridians</label>\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: gridOn\\\"> Kilometers grid</label>\\n        </td>\\n    </tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <a class=\\\"button-settings image-button\\\" data-bind=\\\"click: function() {settingsExpanded(!settingsExpanded())}\\\"\\n            title=\\\"More settings\\\"></a>\\n        <div class=\\\"settings-summary\\\">\\n            <span data-bind=\\\"text: pageSizeDescription\\\"></span><br/>\\n            <span data-bind=\\\"text: resolution\\\"></span>&nbsp;dpi,\\n            zoom&nbsp;<span data-bind=\\\"text: zoomLevel\\\"></span>\\n            <!-- ko if: zoomLevel()=== \\\"auto\\\" -->\\n            (<span title=\\\"Zoom for satellite and scanned imagery\\\" data-bind=\\\"text: autoZoomLevels().satZoom\\\"></span>&nbsp;\\n            /&nbsp;<span title=\\\"Zoom for maps like OSM and Google\\\" data-bind=\\\"text: autoZoomLevels().mapZoom\\\"></span>)\\n            <!-- /ko -->\\n        </div>\\n    </td></tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <div class=\\\"download-button-row\\\">\\n            <div class=\\\"button-minimize\\\" data-bind=\\\"click: setMinimized\\\"></div>\\n            <a class=\\\"text-button button-save\\\" data-bind=\\\"\\n                                click: onSavePdfClicked,\\n                                visible: !makingPdf()\\\">Save PDF</a>\\n            <div data-bind=\\\"\\n                                component: { \\n                                    name: 'progress-indicator',\\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\\n                                },\\n                                visible: makingPdf()\\\"></div>\\n        </div>\\n    </td></tr>\\n    </tbody>\\n</table>\\n</div>\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/lib/leaflet.control.printPages/form.html\n ** module id = 487\n ** module chunks = 2\n **/","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDQwIDQwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiICBjeT0iMjQuNSIgY3g9IjIwIiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxsaW5lIHgxPSIyMCIgeTE9IjIwIiB4Mj0iMjUiIHkyPSIzMCIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjE1IiB5Mj0iMzAiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMjAiIHgyPSIyMCIgeTI9IjM4IiBzdHJva2U9IiMzMzg4ZmYiIHN0cm9rZS13aWR0aD0iMS4yIi8+CiAgICA8L2c+Cjwvc3ZnPg==\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/lib/leaflet.control.azimuth/pointer-end.svg\n ** module id = 503\n ** module chunks = 2\n **/","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDQwIDQwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiIGN5PSIyMiIgY3g9IjIwIiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgoKICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjIzIiB5Mj0iMjQiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjE3IiB5Mj0iMjQiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KCiAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMjAiIHgyPSIyMCIgeTI9IjciIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KICAgIDwvZz4KPC9zdmc+\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/lib/leaflet.control.azimuth/pointer-start.svg\n ** module id = 504\n ** module chunks = 2\n **/","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDMwIDMwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxsaW5lIHgxPSIxMiIgeTE9IjEyIiB4Mj0iMTgiIHkyPSIxOCIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjEuNSIvPgogICAgICAgIDxsaW5lIHgxPSIxMiIgeTE9IjE4IiB4Mj0iMTgiIHkyPSIxMiIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjEuNSIvPgogICAgPC9nPgo8L3N2Zz4=\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/lib/leaflet.control.azimuth/pointer.svg\n ** module id = 505\n ** module chunks = 2\n **/"],"sourceRoot":""}