webpackJsonp([2],[function(e,t,n){n(233),e.exports=n(174)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){c.default.captureException(e,t)}function a(e,t){c.default.captureMessage(e,t)}function o(e){a(e,{extra:{url:window.location.toString()}})}function s(e){c.default.setExtraContext(e)}function l(e){c.default.captureBreadcrumb(e)}function u(e){var t=Object.assign(e.data||{},{url:window.location.toString()});e=Object.assign({},e,{data:t}),l(e)}Object.defineProperty(t,"__esModule",{value:!0});var d=n(169),c=i(d);t.default={captureMessage:a,captureException:r,setExtraContext:s,captureBreadcrumbWithUrl:u,captureBreadcrumb:l,captureMessageWithUrl:o}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){return e.status>=200&&e.status<=299}function s(e){return 0===e.status||e.status>=500}function l(e,t){var n=new f(e,t);return n.send(),n}Object.defineProperty(t,"__esModule",{value:!0}),t.XHRQueue=t.fetch=void 0;var u=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(50),h=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.xhr=e,n.name="XMLHttpRequestPromiseError",n.message=0===e.status?"network error":"server response is "+e.status,n}return a(t,e),t}(Error),f=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.method,l=void 0===a?"GET":a,d=r.data,c=void 0===d?null:d,h=r.responseType,f=void 0===h?"":h,p=r.timeout,m=void 0===p?3e4:p,v=r.maxTries,g=void 0===v?3:v,y=r.retryTimeWait,b=void 0===y?500:y,k=r.isResponseSuccess,_=void 0===k?o:k,w=r.responseNeedsRetry,x=void 0===w?s:w,L=r.headers,S=void 0===L?null:L;i(this,e);var C=new Promise(function(e,t){n._resolve=e,n._reject=t});this.then=C.then.bind(C),this.catch=C.catch.bind(C),this.method=l,this.url=t,this.responseType=f,this.postData=c,this._isResponseSuccess=_,this._responseNeedsRetry=x,this._retryTimeWait=b,this.triesLeft=g;var M=this.xhr=new XMLHttpRequest;if(M.onreadystatechange=function(){return n._onreadystatechange()},this._open(),M.timeout=m,"binarystring"===f?M.responseType="arraybuffer":M.responseType=f,S){var q=!0,T=!1,P=void 0;try{for(var I,D=S[Symbol.iterator]();!(q=(I=D.next()).done);q=!0){var O=u(I.value,2),E=O[0],z=O[1];M.setRequestHeader(E,z)}}catch(j){T=!0,P=j}finally{try{!q&&D.return&&D.return()}finally{if(T)throw P}}}}return d(e,[{key:"_open",value:function(){this.xhr.open(this.method,this.url)}},{key:"_onreadystatechange",value:function(){var e=this,t=this.xhr;if(4===t.readyState&&!this._aborted){if(t.responseBinaryText="","binarystring"===this.responseType&&t.response&&t.response.byteLength&&(t.responseBinaryText=(0,c.arrayBufferToString)(t.response)),"json"===this.responseType&&"string"==typeof t.response)try{t.responseJSON=JSON.parse(t.response)}catch(n){}else t.responseJSON=t.response;this._isResponseSuccess(t)?this._resolve(t):this.triesLeft>0&&this._responseNeedsRetry(t)?(this._open(),this._timerId=setTimeout(function(){return e.send()},this._retryTimeWait)):this._reject(new h(t))}}},{key:"abort",value:function(){this._aborted=!0,clearTimeout(this._timerId),this.xhr.abort()}},{key:"send",value:function(){this.triesLeft-=1,this.xhr.send(this.postData)}}]),e}(),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;i(this,e),this._maxConnections=t,this._queue=[],this._activeCount=0}return d(e,[{key:"put",value:function(e,t){var n=this,i=new f(e,t);return i._originalAbort=i.abort,i.abort=function(){return n._abortPromise(i)},this._queue.push(i),this._processQueue(),i}},{key:"_abortPromise",value:function(e){var t=this,n=this._queue.indexOf(e);n>-1?this._queue.splice(n,1):4===e.xhr.readyState||(e._originalAbort(),this._activeCount-=1,setTimeout(function(){return t._processQueue()},0))}},{key:"_processQueue",value:function(){var e=this;if(!(this._activeCount>=this._maxConnections||0===this._queue.length)){var t=this._queue.shift();t.catch(function(){}).then(function(){return e._onRequestReady(t)}),this._activeCount+=1,t.send()}}},{key:"_onRequestReady",value:function(e){var t=this;e._aborted||(this._activeCount-=1),setTimeout(function(){return t._processQueue()},0)}}]),e}();t.fetch=l,t.XHRQueue=p},,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);a.default.Control.include({_stopContainerEvents:function(){var e=this._container;a.default.DomEvent.disableClickPropagation(e),a.default.DomEvent.disableScrollPropagation(e),a.default.DomEvent.on(e,"mousemove contextmenu",a.default.DomEvent.stop)}})},,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(231),a=i(r);t.default=Object.assign({email:"nakarte@nakarte.tk",googleApiUrl:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDleuw7YtJifzC1OI2nSah74KJfGiziHXY#v=3",westraDataBaseUrl:"http://nakarte.tk/westraPasses/",CORSProxyUrl:"http://proxy.nakarte.tk/",elevationsServer:"http://elevation.nakarte.tk/",newsUrl:"http://about.nakarte.tk",wikimediaCommonsCoverageUrl:"http://tiles.nakarte.tk/wikimedia_commons_images/{z}/{x}/{y}"},a.default)},function(e,t){"use strict";function n(e,t){setTimeout(function(){return window.alert(e)},0)}function i(e,t){return window.prompt(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.notify=n,t.prompt=i},,,437,,,,,,,,,,,,function(e,t){"use strict";function n(e){for(var t=new Uint8Array(e),n=[],i=0;i<t.length;i+=4096){var r=t.subarray(i,i+4096);r=String.fromCharCode.apply(null,r),n.push(r)}return n.join("")}function i(e){for(var t=e.length,n=new ArrayBuffer(t),i=new Uint8Array(n),r=0;r<t;r++)i[r]=e.charCodeAt(r);return n}function r(e){var t=i(e);return new Blob([t])}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayBufferToString=n,t.blobFromString=r,t.stringToArrayBuffer=i},,,,,,function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)return!1;for(;t;){if(t===e)return!0;t=t.parentNode}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n(443);var o=function(){function e(t){var n=this;i(this,e),this.onKeyDown=function(e){27===e.keyCode&&n.hide()},this.onMouseDown=function(e){r(n._container,e.target)||n.hide()},this.items=t}return a(e,[{key:"show",value:function(e){if(!this._container){e.originalEvent&&(e=e.originalEvent),e.preventDefault?e.preventDefault():e.returnValue=!1;var t=e,n=t.clientX,i=t.clientY,r=this._container=document.createElement("div");document.body.appendChild(r),r.className="contextmenu",r.style.zIndex=1e4,window.addEventListener("keydown",this.onKeyDown,!0),window.addEventListener("mousedown",this.onMouseDown,!0),window.addEventListener("touchstart",this.onMouseDown,!0);var a=!0,o=!1,s=void 0;try{for(var l,u=this.createItems()[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value;r.appendChild(d)}}catch(c){o=!0,s=c}finally{try{!a&&u.return&&u.return()}finally{if(o)throw s}}this.setPosition(n,i)}}},{key:"hide",value:function(){this._container&&(document.body.removeChild(this._container),this._container=null,window.removeEventListener("keydown",this.onKeyDown,!0),window.removeEventListener("mousedown",this.onMouseDown,!0),window.removeEventListener("touchstart",this.onMouseDown,!0))}},{key:"setPosition",value:function(e,t){var n=window.innerWidth,i=window.innerHeight,r=this._container.offsetWidth,a=this._container.offsetHeight;e+r>=n&&(e-=r),t+a>=i&&(t-=a),this._container.style.left=e+"px",this._container.style.top=t+"px"}},{key:"createItems",value:regeneratorRuntime.mark(function e(){var t,n,i,r,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.items,"function"==typeof t&&(t=t()),n=!0,i=!1,r=void 0,e.prev=5,a=t[Symbol.iterator]();case 7:if(n=(o=a.next()).done){e.next=20;break}if(s=o.value,"function"==typeof s&&(s=s()),"-"!==s&&!s.separator){e.next=15;break}return e.next=13,this.createSeparator(s);case 13:e.next=17;break;case 15:return e.next=17,this.createItem(s);case 17:n=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),i=!0,r=e.t0;case 26:e.prev=26,e.prev=27,!n&&a.return&&a.return();case 29:if(e.prev=29,!i){e.next=32;break}throw r;case 32:return e.finish(29);case 33:return e.finish(26);case 34:case"end":return e.stop()}},e,this,[[5,22,26,34],[27,,29,33]])})},{key:"createItem",value:function(e){var t=document.createElement("a"),n="item";e.disabled&&(n+=" disabled"),e.header&&(n+=" header"),t.className=n,t.innerHTML=e.text;var i=e.callback;return i&&!e.disabled&&t.addEventListener("click",this.onItemClick.bind(this,i)),t}},{key:"onItemClick",value:function(e,t){t.stopPropagation(),t.preventDefault(),this.hide(),e(t)}},{key:"createSeparator",value:function(e){var t=document.createElement("div");return t.className="separator",e.text&&(t.innerHTML="<span>"+e.text+"</span>"),t}}]),e}();t.default=o},,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return o.default.CORSProxyUrl+e.replace(/^(https?):\/\//,"$1/")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=n(34),o=i(a)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r),o=n(117),s=i(o),l=n(23),u=i(l);a.default.Mixin.HashState={enableHashState:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._hashStateKey=e;var i=this.stateChangeEventsSource?this[this.stateChangeEventsSource]:this;this.stateChangeEvents&&this.stateChangeEvents.forEach(function(e){i.on(e,t._onControlStateChanged,t)}),s.default.addEventListener(e,function(e){return t._onExternalStateChanged(e)});var r=s.default.getState(e)||n;return this._ignoreStateChange=!0,this.unserializeState(r)||this.unserializeState(n)||s.default.updateState(e,this.serializeState()),s.default.updateState(this._hashStateKey,this.serializeState()),this._ignoreStateChange=!1,this},_onControlStateChanged:function(){if(!this._ignoreStateChange){var e=this.serializeState();s.default.updateState(this._hashStateKey,e)}},_onExternalStateChanged:function(e){this._ignoreStateChange=!0,this.unserializeState(e)||(u.default.captureMessageWithUrl('Invalid state in hash string (key "'+this._hashStateKey+'")'),s.default.updateState(this._hashStateKey,this.serializeState())),this._ignoreStateChange=!1}}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e,t){var n=0,i=void 0,r=void 0,a=void 0,o=void 0,s=void 0,l=!0,u=!1,d=void 0;try{for(var c,h=t[Symbol.iterator]();!(l=(c=h.next()).done);l=!0)s=c.value,i=Math.max(e.minX,s.minX),r=Math.min(e.maxX,s.maxX),a=Math.max(e.minY,s.minY),o=Math.min(e.maxY,s.maxY),a<o&&i<r&&(n+=(r-i)*(o-a))}catch(f){u=!0,d=f}finally{try{!l&&h.return&&h.return()}finally{if(u)throw d}}return n}var o=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=n(2),l=i(s);n(464);var u=n(488),d=i(u),c=n(471),h=i(c);l.default.Layer.CanvasMarkers=l.default.GridLayer.extend({options:{async:!0,labelFontName:"Verdana, Arial, sans-serif",labelFontSize:10,iconScale:1,pane:"rasterMarker",updateWhenZooming:!l.default.Browser.mobile,iconsOpacity:1},initialize:function(e,t){l.default.GridLayer.prototype.initialize.call(this,t),this.rtree=(0,d.default)(9,[".latlng.lng",".latlng.lat",".latlng.lng",".latlng.lat"]),this._regions=(0,d.default)(),this._iconPositions={},this._labelPositions={},this._labelPositionsZoom=null,this.addMarkers(e),this._images={},this._tileQueue=[],this._hoverMarker=null,this.on("markerenter",this.onMarkerEnter,this),this.on("markerleave",this.onMarkerLeave,this)},addMarkers:function(e){var t=this;e&&(this.rtree.load(e),this.resetLabels(),setTimeout(function(){return t.redraw()},0))},addMarker:function(e){var t=this;this.rtree.insert(e),this.resetLabels(),setTimeout(function(){return t.redraw()},0)},removeMarker:function(e){this.removeMarkers([e])},removeMarkers:function(e){var t=this;e.forEach(function(e){return t.rtree.remove(e)}),this.resetLabels(),setTimeout(function(){return t.redraw()},0)},updateMarkers:function(e){this.removeMarkers(e),this.addMarkers(e)},updateMarker:function(e){this.updateMarkers([e])},setMarkerPosition:function(e,t){this.removeMarker(e),e.latlng=t,this.addMarker(e)},getMarkers:function(){return this.rtree.all()},findLabelPosition:function(e,t,n,i,r){var o=0,s=[e[0]+t[0]/2+2,e[0]-t[0]/2-n-2],l=[e[1]-i/2+o,e[1]-.75*i-t[1]/4+o,e[1]-i/4+t[1]/4+o,e[1]-i-t[1]/2+o,e[1]+t[1]/2+o],u=+(1/0),d=s[0],c=l[0],h=!0,f=!1,p=void 0;try{for(var m,v=s[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value,y=!0,b=!1,k=void 0;try{for(var _,w=l[Symbol.iterator]();!(y=(_=w.next()).done);y=!0){var x=_.value,L={minX:g,minY:x,maxX:g+n,maxY:x+i};if(!r||!(L.minX<r.tileW||L.maxX>r.tileE||L.minY<r.tileN||L.maxY>r.tileS)){var S=a(L,this._regions.search(L));if(S<u&&(u=S,d=g,c=x,0===u))break}}}catch(C){b=!0,k=C}finally{try{!y&&w.return&&w.return()}finally{if(b)throw k}}if(0===u)break}}catch(C){f=!0,p=C}finally{try{!h&&v.return&&v.return()}finally{if(f)throw p}}return[d,c]},preloadIcons:function(e){var t=this,n=e.filter(function(e){return!(e in t._images)});return n.length?(0,h.default)(n).then(function(e){var n=!0,i=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t._images[s.src]=s}}catch(l){i=!0,r=l}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}}):Promise.resolve()},createTile:function(e,t){var n=this,i=l.default.DomUtil.create("canvas","leaflet-tile");return i.width=this.options.tileSize,i.height=this.options.tileSize,l.default.Util.requestAnimFrame(function(){n.drawTile(i,e).then(function(){return t(null,i)})}),i},selectMarkersForDraw:function(e,t,n){var i=e.tileN,r=e.tileS,a=e.tileE,o=e.tileW;if(!this._map)return{};var s=n?0:520,u=n?0:50,d=n?0:256,c=n?0:20,h=l.default.latLngBounds(this._map.unproject(l.default.point(o-s,r+s),t),this._map.unproject(l.default.point(a+s,i-u),t)),f=l.default.latLngBounds(this._map.unproject(l.default.point(o-d,r+d),t),this._map.unproject(l.default.point(a+d,i-c),t)),p=[],m={},v=this.rtree.search({minX:h.getWest(),minY:h.getSouth(),maxX:h.getEast(),maxY:h.getNorth()}),g=this.rtree.search({minX:f.getWest(),minY:f.getSouth(),maxX:f.getEast(),maxY:f.getNorth()}),y=!0,b=!1,k=void 0;try{for(var _,w=v[Symbol.iterator]();!(y=(_=w.next()).done);y=!0){var x=_.value,L=this._map.project(x.latlng,t),S=x.icon;"function"==typeof S&&(S=S(x)),p.push(S.url);var C=l.default.stamp(x);m[C]={marker:x,icon:S,projectedXY:L}}}catch(M){b=!0,k=M}finally{try{!y&&w.return&&w.return()}finally{if(b)throw k}}return{iconUrls:p,markerJobs:m,pointsForLabels:g}},drawSelectedMarkers:function(e,t,n,i,r,a){var s=t.tileN,u=t.tileW,d=t.tileS,c=t.tileE,h=this.options.labelFontSize*this.options.iconScale;this._labelPositionsZoom!==r&&(this._labelPositionsZoom=r,this.resetLabels());var f=e.getContext("2d");f.font=l.default.Util.template("bold {size}px {name}",{name:this.options.labelFontName,size:this.options.labelFontSize*this.options.iconScale});var p=!0,m=!1,v=void 0;try{for(var g,y=Object.entries(n)[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=o(g.value,2),k=b[0],_=b[1],w=this._images[_.icon.url];_.img=w;var x=Math.round(w.width*this.options.iconScale),L=Math.round(w.height*this.options.iconScale);if(!(k in this._iconPositions)){var S=_.projectedXY.x-_.icon.center[0]*this.options.iconScale,C=_.projectedXY.y-_.icon.center[1]*this.options.iconScale;S=Math.round(S),C=Math.round(C),this._iconPositions[k]=[S,C],this._regions.insert({minX:S,minY:C,maxX:S+x,maxY:C+L,marker:_.marker,isLabel:!1})}var M=o(this._iconPositions[k],2),q=M[0],T=M[1];_.iconCenter=[q+x/2,T+L/2],_.iconSize=[x,L]}}catch(P){m=!0,v=P}finally{try{!p&&y.return&&y.return()}finally{if(m)throw v}}var I=!0,D=!1,O=void 0;try{for(var E,z=i[Symbol.iterator]();!(I=(E=z.next()).done);I=!0){var j=E.value,k=l.default.stamp(j),_=n[k],Z=_.marker.label;if(Z){if("function"==typeof Z&&(Z=Z(_.marker)),_.label=Z,!(k in this._labelPositions)){var N=f.measureText(Z).width,W=this.findLabelPosition(_.iconCenter,_.iconSize,N,h,a?t:null);this._labelPositions[k]=W;var R=o(W,2),q=R[0],T=R[1];this._regions.insert({minX:q,minY:T,maxX:q+N,maxY:T+h,marker:_.marker,isLabel:!0})}}else this._labelPositions[k]=null}}catch(P){D=!0,O=P}finally{try{!I&&z.return&&z.return()}finally{if(D)throw O}}var K=this._regions.search({minX:u,minY:s,maxX:c,maxY:d}),U=!0,A=!1,G=void 0;try{for(var B,F=K[Symbol.iterator]();!(U=(B=F.next()).done);U=!0){var J=B.value;if(J.isLabel){var H=l.default.stamp(J.marker),X=n[H],Y=this._labelPositions[H],V=Y[0]-u,Q=Y[1]-s;f.textBaseline="bottom",f.shadowColor="#fff",f.strokeStyle="#fff",f.fillStyle="#000",f.lineWidth=1.2*this.options.iconScale,f.shadowBlur=1*this.options.iconScale,f.strokeText(X.label,V,Q+h),f.shadowBlur=0,f.fillText(X.label,V,Q+h)}}}catch(P){A=!0,G=P}finally{try{!U&&F.return&&F.return()}finally{if(A)throw G}}f.globalAlpha=this.options.iconsOpacity;var $=!0,ee=!1,te=void 0;try{for(var ne,ie=K[Symbol.iterator]();!($=(ne=ie.next()).done);$=!0){var re=ne.value;if(!re.isLabel){var ae=l.default.stamp(re.marker),oe=n[ae],se=this._iconPositions[ae],le=se[0]-u,ue=se[1]-s;f.drawImage(oe.img,le,ue,oe.iconSize[0],oe.iconSize[1])}}}catch(P){ee=!0,te=P}finally{try{!$&&ie.return&&ie.return()}finally{if(ee)throw te}}f.globalAlpha=1},drawTile:function(){function e(e,n){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t,n){var i,r,a,o,s,l,u,d,c,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.z,r=this.options.tileSize,a=n.y*r,o=n.x*r,s=a+r,l=o+r,u={tileN:a,tileS:s,tileE:l,tileW:o},d=this.selectMarkersForDraw(u,i),c=d.iconUrls,h=d.markerJobs,f=d.pointsForLabels,h){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.preloadIcons(c);case 7:this.drawSelectedMarkers(t,u,h,f,i);case 8:case"end":return e.stop()}},e,this)}));return e}(),resetLabels:function(){this._iconPositions={},this._labelPositions={},this._regions.clear()},findMarkerFromMouseEvent:function(e){var t=this._map.project(e.latlng),n=this._regions.search({minX:t.x,minY:t.y,maxX:t.x,maxY:t.y})[0],i=void 0;return i=n?n.marker:null},onMouseMove:function(e){var t=this.findMarkerFromMouseEvent(e);this._hoverMarker!==t&&(this._hoverMarker&&this.fire("markerleave",{marker:this._hoverMarker}),t&&this.fire("markerenter",{marker:t}),this._hoverMarker=t)},showTooltip:function(e){if(e.marker.tooltip){var t=e.marker.tooltip;if("function"!=typeof t||(t=t(e.marker),e.marker.tooltip)){this.toolTip.innerHTML=t;var n=this._map.latLngToLayerPoint(e.marker.latlng);l.default.DomUtil.setPosition(this.toolTip,n),l.default.DomUtil.addClass(this.toolTip,"canvas-marker-tooltip-on")}}},onMarkerEnter:function(e){this._map._container.style.cursor="pointer",this.showTooltip(e)},onMarkerLeave:function(){this._map._container.style.cursor="",l.default.DomUtil.removeClass(this.toolTip,"canvas-marker-tooltip-on")},onMouseOut:function(){this._hoverMarker&&(this._hoverMarker=null,this.fire("markerleave",{marker:this._hoverMarker}))},onClick:function(e){if(!this._map.clickLocked){var t=this.findMarkerFromMouseEvent(e);t&&(l.default.extend(e,{marker:t}),this.fire("markerclick",e))}},onRightClick:function(e){var t=this.findMarkerFromMouseEvent(e);t&&(l.default.extend(e,{marker:t}),this.fire("markercontextmenu",e))},onAdd:function(e){"rasterMarker"!==this.options.pane||e.getPane("rasterMarker")||(e.createPane("rasterMarker").style.zIndex=550),l.default.GridLayer.prototype.onAdd.call(this,e),e.on("mousemove",this.onMouseMove,this),e.on("mouseout",this.onMouseOut,this),e.on("click",this.onClick,this),e.on("contextmenu",this.onRightClick,this),this.toolTip=l.default.DomUtil.create("div","canvas-marker-tooltip",this._map.getPanes().markerPane)},onRemove:function(e){this._map.off("mousemove",this.onMouseMove,this),this._map.off("mouseout",this.onMouseOut,this),this._map.off("click",this.onClick,this),this._map.off("contextmenu",this.onRightClick,this),this._hoverMarker&&(this._hoverMarker=null,this.fire("markerleave",{marker:this._hoverMarker})),this._map.getPanes().markerPane.removeChild(this.toolTip),l.default.GridLayer.prototype.onRemove.call(this,e)}})},function(e,t){"use strict";function n(){try{return window.localStorage.setItem("_testDummy","TEST"),"TEST"===window.localStorage.getItem("_testDummy")}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0});var i=void 0;if(n())i=window.localStorage;else{var r={};i={length:0,key:function(e){return Object.keys(r)[e]},removeItem:function(e){delete r[e]},getItem:function(e){return i[e]},setItem:function(e,t){i[e]=t},clear:function(){r={}}}}t.default=i},,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=document.createElement("div");n.innerHTML=e,n.className="copy-clipboard-notification",document.body.appendChild(n);var i=n.offsetWidth,r=n.offsetHeight,a=t.clientX-i-8,o=t.clientY-r/2;a<0&&(a=0),o<0&&(o=0),n.style.top=o+"px",n.style.left=a+"px",setTimeout(function(){document.body.removeChild(n)},1e3)}function a(e,t){try{var n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),r("Copied",t)}catch(i){s.default.captureException(i,{extra:{description:"clipborad to copy failed"}}),prompt("Copy to clipboard: Ctrl+C, Enter",e)}finally{document.body.removeChild(n)}}Object.defineProperty(t,"__esModule",{value:!0}),n(442);var o=n(23),s=i(o);t.default=a},function(e,t){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(){i(this,e),this._layerDummy=!0,this._printProgressWeight=.01}return r(e,[{key:"cloneForPrint",value:function(){return this}},{key:"getTilesInfo",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{tilePromise:Promise.resolve({draw:function(e){return n._drawRaster(e,t)},isOverlay:!0,overlaySolid:this.overlaySolid}),abortLoading:function(){}};case 2:case"end":return e.stop()}},e,this)}).bind(this),count:1});case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"_drawRaster",value:function(e,t){}}]),e}();t.PrintStaticLayer=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){if(e)return Array.prototype.slice.call(e.childNodes).map(function(e){return e.nodeValue}).join("")}function o(e,t,n){function i(e){for(var t=e.getElementsByTagName("trkpt"),n=[],i=0;i<t.length;i++){var r=t[i],a=parseFloat(r.getAttribute("lat")),s=parseFloat(r.getAttribute("lon"));if(isNaN(a)||isNaN(s)){o="CORRUPT";break}n.push({lat:a,lng:s})}return n}var o,s=function(e){for(var t=[],n=e.getElementsByTagName("trkseg"),r=0;r<n.length;r++){var a=i(n[r]);a.length&&t.push(a)}return t},l=function(e){for(var t=e.getElementsByTagName("wpt"),n=[],i=0;i<t.length;i++){var r=t[i],s={};if(s.lat=parseFloat(r.getAttribute("lat")),s.lng=parseFloat(r.getAttribute("lon")),isNaN(s.lat)||isNaN(s.lng))o="CORRUPT";else{try{s.name=(0,q.decode)(a(r.getElementsByTagName("name")[0]))}catch(l){o="CORRUPT";continue}s.symbol_name=a(r.getElementsByTagName("sym")[0]),n.push(s)}}return n};e=(0,M.default)(e),e=e.replace(/<([^ >]+):([^ >]+)/g,"<$1_$2");try{var u=(new DOMParser).parseFromString(e,"text/xml")}catch(d){return null}if("parsererror"===u.documentElement.nodeName)return null;if(0===u.getElementsByTagName("gpx").length)return null;if(n)for(var c=[].concat(r(u.getElementsByTagName("trk"))),h=0;h<c.length;h++){var f=c[h],p=f.getElementsByTagName("name")[0];if(p&&(p=(0,q.decode)(a(p)),p.length)){t=p;break}}return[{name:t,tracks:s(u),points:l(u),error:o}]}function s(e,t){var n,i=[],r=e.split("\n");if(0!==r[0].indexOf("OziExplorer Track Point File"))return null;for(var a=parseInt(r[5],10),o=[],s=0,l=6;l<r.length;l++){var u=r[l].trim();if(u){var d=u.split(","),c=parseFloat(d[0]),h=parseFloat(d[1]),f=parseInt(d[2],10);if(isNaN(c)||isNaN(h)||isNaN(f)){n="CORRUPT";break}f&&(o=[]),o.length||i.push(o),o.push({lat:c,lng:h}),s+=1}}return(isNaN(a)||a!==s)&&(n="CORRUPT"),[{name:t,tracks:i,error:n}]}function l(e){var t,n,i=[];for(n=0;n<e.length;n++)t=e.charCodeAt(n),t>=192&&t<=255?t+=848:168===t?t=1025:184===t&&(t=1105),i.push(String.fromCharCode(t));return i.join("")}function u(e,t){var n,i,r,a,o,s,u,d,c=[];if(i=e.split("\n"),0!==i[0].indexOf("OziExplorer Waypoint File"))return null;for(a=4;a<i.length;a++)if(r=i[a].trim()){if(d=r.split(","),o=parseFloat(d[2]),s=parseFloat(d[3]),u=l(d[1]).trim(),isNaN(o)||isNaN(s)){n="CORRUPT";break}c.push({lat:o,lng:s,name:u})}return[{name:t,points:c,error:n}]}function d(e,t){function n(e){var t,n,r,o,s,l,u,d=[];for(t=e.getElementsByTagName("Placemark"),n=0;n<t.length;n++)if(u=t[n].getElementsByTagName("Point"),0!==u.length){if(u.length>1){i="CORRUPT";break}if(r=u[0].getElementsByTagName("coordinates"),1!==r.length){i="CORRUPT";break}if(r=a(r[0]),r=r.split(","),s=parseFloat(r[1]),l=parseFloat(r[0]),isNaN(s)||isNaN(l)){i="CORRUPT";break}if(o=t[n].getElementsByTagName("name"),1!==o.length){i="CORRUPT";break}try{o=(0,q.decode)(a(o[0]).trim())}catch(c){i="CORRUPT";break}d.push({name:o,lat:s,lng:l})}return d}var i,r=function(e){for(var t=a(e),n=t.split(/\s+/),r=[],o=0;o<n.length;o++)if(n[o].length){var s=n[o].split(","),l=parseFloat(s[1]),u=parseFloat(s[0]);if(isNaN(l)||isNaN(u)){i="CORRUPT";break}r.push({lat:l,lng:u})}return r},o=function(e){for(var t=e.getElementsByTagName("LineString"),n=[],i=0;i<t.length;i++){var a=t[i].getElementsByTagName("coordinates");if(a.length){var o=r(a[0]);o.length&&n.push(o)}}return n};e=(0,M.default)(e),e=e.replace(/<([^ >]+):([^ >]+)/g,"<$1_$2");try{var s=(new DOMParser).parseFromString(e,"text/xml")}catch(l){return null}return"parsererror"===s.documentElement.nodeName?null:0===s.getElementsByTagName("kml").length?null:[{name:t,tracks:o(s),points:n(s),error:i}]}function c(e,t){var n;try{var i=new x.default(e)}catch(r){return null}var a,o,s=[],l=[],u=!1;if(!i.isZipFile())return null;try{i.readEntries()}catch(r){return null}var c,h;for(c=0;c<i.entries.length;c++)if(h=i.entries[c],"doc.kml"===h.fileName){u=!0;break}if(!u)return null;for(c=0;c<i.entries.length;c++)if(h=i.entries[c],h.fileName.match(/\.kml$/i)){if(0===h.compressionMethod)n=h.data;else{if(8!==h.compressionMethod)return null;n=S.default.inflate(h.data)}a=d(n,"dummmy"),a&&(o=o||a.error,s.push.apply(s,a[0].tracks),l.push.apply(l,a[0].points))}return a=[{name:t,error:o,tracks:s,points:l}]}function h(e){var t,n=0,i=0,r=[];e=e.replace(/%2C/gi,",");for(var a=e.split("~"),o=0;o<a.length;o++){var s=a[o].split(","),l=parseFloat(s[0]),u=parseFloat(s[1]);if(isNaN(u)||isNaN(l)){t="CORRUPT";break}i+=l,n+=u,r.push({lat:n,lng:i})}return{error:t,points:r}}function f(e){var t=/yandex\..+[?&]rl=([^&]+)/,n=t.exec(e);if(!n)return null;var i=h(n[1]);return[{name:"Yandex ruler",error:i.error,tracks:[i.points]}]}function p(e,t){try{var n=new x.default(e)}catch(i){return null}if(!n.isZipFile())return null;try{n.readEntries()}catch(i){return null}for(var r=[],a=0;a<n.entries.length;a++){var o,s=n.entries[a];if(0===s.compressionMethod)o=s.data;else{if(8!==s.compressionMethod)return null;o=S.default.inflate(s.data)}var l=t+"/"+s.fileName,u=_(l,o);r.push.apply(r,u)}return r}function m(e){var t;e=e.replace(/[\n\r \t]/g,"").replace(/-/g,"+").replace(/_/g,"/");try{t=atob(e)}catch(n){}return t&&t.length?t:null}function v(e,t){var n,i=0;if(n=e.charCodeAt(t),isNaN(n))throw new Error("Unexpected end of line while unpacking number");if(n<128)return i=n-64,[i,1];if(i=127&n,n=e.charCodeAt(t+1),isNaN(n))throw new Error("Unexpected end of line while unpacking number");if(n<128)return i|=n<<7,i-=8192,[i,2];if(i|=(127&n)<<7,n=e.charCodeAt(t+2),isNaN(n))throw new Error("Unexpected end of line while unpacking number");if(n<128)return i|=n<<14,i-=1048576,[i,3];if(i|=(127&n)<<14,n=e.charCodeAt(t+3),isNaN(n))throw new Error("Unexpected end of line while unpacking number");return i|=n<<21,i-=268435456,[i,4]}function g(e){this._string=e,this.position=0}function y(e,t){var n,i,r,a,o,s,l,u,d,c,h,f,p,v,y=[],b=46603.375,k=[],_=!1;if(e=m(e),!e)return[{name:"Text encoded track",error:["CORRUPT"]}];e=new g(e);try{if(d=t?0:e.readNumber(),0!==d&&1!==d&&2!==d&&3!==d)return[{name:"Text encoded track",error:["CORRUPT"]}];for(i=e.readNumber(),n=e.readString(i),n=(0,q.decode)(n),a=e.readNumber();a--;){for(r=[],o=e.readNumber(),s=0,l=0;o--;)s+=e.readNumber(),l+=e.readNumber(),r.push({lng:s/b,lat:l/b});y.push(r),r=null}}catch(w){if(!w.message.match("Unexpected end of line while unpacking number"))throw w;u=["CORRUPT"],r&&y.push(r)}try{p=e.readNumber(),v=e.readNumber()}catch(w){if(!w.message.match("Unexpected end of line while unpacking number"))throw w;p=0,v=0,d>0&&(u=["CORRUPT"])}if(d>=3)try{_=!!e.readNumber()}catch(w){if(!w.message.match("Unexpected end of line while unpacking number"))throw w;u=["CORRUPT"]}if(d>=2)try{for(o=e.readNumber(),o&&(c=e.readNumber(),h=e.readNumber());o--;)i=e.readNumber(),
f=e.readString(i),f=(0,q.decode)(f),e.readNumber(),s=e.readNumber()+c,l=e.readNumber()+h,k.push({name:f,lat:l/b,lng:s/b})}catch(w){if(!w.message.match("Unexpected end of line while unpacking number"))throw w;u=["CORRUPT"]}var x={name:n||"Text encoded track",tracks:y,error:u,points:k,color:p,measureTicksShown:v,trackHidden:_};return[x]}function b(e){var t=e.indexOf("track://");return t===-1?null:y(e.substring(t+8),!0)}function k(e){var t=e.indexOf("#");if(t===-1)return null;if(t=e.indexOf("nktk=",t+1),t===-1)return null;e=e.substring(t+5).split("/");var n=[];for(t=0;t<e.length;t++)e[t]&&n.push.apply(n,y(e[t]));return n}function _(e,t,n){for(var i=[b,k,c,p,o,s,u,d,f],r=0;r<i.length;r++){var a=i[r](t,e,n);if(null!==a)return a}return[{name:e,error:"UNSUPPORTED"}]}Object.defineProperty(t,"__esModule",{value:!0}),t.parseGeoFile=void 0;var w=n(476),x=i(w),L=n(477),S=i(L),C=n(230),M=i(C),q=n(110);g.prototype.readNumber=function(){var e=v(this._string,this.position);return this.position+=e[1],e[0]},g.prototype.readString=function(e){var t=this._string.slice(this.position,this.position+e);return this.position+=e,t},t.parseGeoFile=_},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(2),o=i(a),s=n(51),l=i(s),u=n(56),d=i(u);n(113),n(461);var c=n(177),h=n(81),f=n(60),p=i(f),m=n(24),v=n(208),g=i(v),y=n(79),b=i(y),k=n(64);n(62),n(228);var _=n(112),w=i(_);n(38);var x=n(114);n(31);var L=n(50);n(229),n(126);var S=n(23),C=i(S),M=n(35),q=n(209),T=o.default.MeasuredLine.extend({includes:o.default.Polyline.EditMixin,options:{weight:6,lineCap:"butt",opacity:.5}});T.mergeOptions(o.default.Polyline.EditMixinOptions),o.default.Control.TrackList=o.default.Control.extend({options:{position:"bottomright"},includes:o.default.Mixin.Events,colors:["#77f","#f95","#0ff","#f77","#f7f","#ee5"],initialize:function(){o.default.Control.prototype.initialize.call(this),this.tracks=l.default.observableArray(),this.url=l.default.observable(""),this.readingFiles=l.default.observable(!1),this.readProgressRange=l.default.observable(),this.readProgressDone=l.default.observable(),this._lastTrackColor=0,this.trackListHeight=l.default.observable(0),this.isPlacingPoint=!1,this.trackAddingPoint=l.default.observable(null)},onAdd:function(e){var t=this;this.map=e,this.tracks.removeAll();var n=this._container=o.default.DomUtil.create("div","leaflet-control leaflet-control-tracklist");return this._stopContainerEvents(),n.innerHTML='\n                <div class="leaflet-control-button-toggle" data-bind="click: setExpanded"\n                 title="Load, edit and save tracks"></div>\n                <div class="leaflet-control-content">\n                <div class="header">\n                    <div class="hint">\n                        GPX Ozi GoogleEarth ZIP YandexMaps GPSies\n                    </div>\n                    <div class="button-minimize" data-bind="click: setMinimized"></div>\n                </div>\n                <div class="inputs-row" data-bind="visible: !readingFiles()">\n                    <a class="button add-track" title="New track" data-bind="click: function(){this.addNewTrack()}"></a\n                    ><a class="button open-file" title="Open file" data-bind="click: loadFilesFromDisk"></a\n                    ><input type="text" class="input-url" placeholder="Track URL"\n                        data-bind="textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: onFileInputRightClick}"\n                    ><a class="button download-url" title="Download URL" data-bind="click: loadFilesFromUrl"></a\n                    ><a class="button menu-icon" data-bind="click: function(_,e){this.showMenu(e)}" title="Menu"></a>\n                </div>\n                <div style="text-align: center">\n                    <div data-bind="\n                        component: {\n                        name: \'progress-indicator\',\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\n                        },\n                        visible: readingFiles"></div>\n                </div>\n                <div class="tracks-rows-wrapper" data-bind="style: {maxHeight: trackListHeight}">\n                <table class="tracks-rows"><tbody data-bind="foreach: {data: tracks, as: \'track\'}">\n                    <tr data-bind="event: {contextmenu: $parent.showTrackMenu.bind($parent)}">\n                        <td><input type="checkbox" class="visibility-switch" data-bind="checked: track.visible"></td>\n                        <td><div class="color-sample" data-bind="style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)"></div></td>\n                        <td><div class="track-name-wrapper"><div class="track-name" data-bind="text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)"></div></div></td>\n                        <td><div class="button-length" data-bind="text: $parent.formatLength(track.length()), css: {\'ticks-enabled\': track.measureTicksShown}, click: $parent.switchMeasureTicksVisibility.bind($parent)"></div></td>\n                        <td><div class="button-add-track" title="Add track segment" data-bind="click: $parent.addSegmentAndEdit.bind($parent, track)"></div></td>\n                        <td><div class="button-add-point" title="Add point" data-bind="click: $parent.onAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}"></div></td>\n                        <td><a class="track-text-button" title="Actions" data-bind="click: $parent.showTrackMenu.bind($parent)">&hellip;</a></td>\n                    </tr>\n                </tbody></table>\n                </div>\n                </div>\n            ',l.default.applyBindings(this,n),o.default.DomEvent.addListener(e.getContainer(),"drop",this.onFileDragDrop,this),o.default.DomEvent.addListener(e.getContainer(),"dragover",this.onFileDraging,this),this.menu=new d.default([{text:"Copy all tracks to clipboard",callback:this.copyAllTracks.bind(this)},{text:"Copy visible tracks to clipboard",callback:this.copyVisibleTracks.bind(this)},"-",{text:"Delete all tracks",callback:this.deleteAllTracks.bind(this)},{text:"Delete hidden tracks",callback:this.deleteHiddenTracks.bind(this)}]),this._markerLayer=new o.default.Layer.CanvasMarkers(null,{print:!0,scaleDependent:!0,zIndex:1e3,printTransparent:!0}).addTo(e),this._markerLayer.on("markerclick markercontextmenu",this.onMarkerClick,this),e.on("resize",this._setAdaptiveHeight,this),setTimeout(function(){return t._setAdaptiveHeight()},0),n},onFileInputRightClick:function(e,t){return o.default.DomEvent.stopPropagation(t),!0},_setAdaptiveHeight:function(){var e=this._map.getSize().y,t=void 0;t=e-this._container.offsetTop-(this._container.parentNode.offsetHeight-this._container.offsetTop-this._container.offsetHeight)-105,this.trackListHeight(t+"px")},setExpanded:function(){o.default.DomUtil.removeClass(this._container,"minimized")},setMinimized:function(){o.default.DomUtil.addClass(this._container,"minimized")},onFileDraging:function(e){o.default.DomEvent.stopPropagation(e),o.default.DomEvent.preventDefault(e),e.dataTransfer.dropEffect="copy"},onFileDragDrop:function(e){o.default.DomEvent.stopPropagation(e),o.default.DomEvent.preventDefault(e);var t=e.dataTransfer.files;t&&t.length&&this.loadFilesFromFilesObject(t)},onEnterPressedInInput:function(e,t){return 13!==t.keyCode||(e.loadFilesFromUrl(),void o.default.DomEvent.stop(t))},getTrackPolylines:function(e){return e.feature.getLayers().filter(function(e){return e instanceof o.default.Polyline})},getTrackPoints:function(e){return e.markers},addNewTrack:function(e){e||(e=this.url().slice(0,50),e.length?this.url(""):e="New track");var t=this.addTrack({name:e}),n=this.addTrackSegment(t);return this.startEditTrackSegement(t,n),n.startDrawingLine(),t},loadFilesFromFilesObject:function(e){this.readProgressDone(void 0),this.readProgressRange(1),this.readingFiles(!0),(0,c.readFiles)(e).then(function(e){var t=e.map(function(e){return(0,h.parseGeoFile)(e.filename,e.data)}).reduce(function(e,t){return Array.prototype.push.apply(e,t),e},[]);this.addTracksFromGeodataArray(t)}.bind(this))},loadFilesFromDisk:function(){C.default.captureBreadcrumb({message:"load track from disk"}),(0,c.selectFiles)(!0).then(this.loadFilesFromFilesObject.bind(this))},loadFilesFromUrl:function(){var e=this.url().trim();C.default.captureBreadcrumb({message:"load track from url",data:{url:e}});try{e=decodeURIComponent(e)}catch(t){}var n;if(e.length>0)if(this.readingFiles(!0),this.readProgressDone(void 0),this.readProgressRange(1),n=(0,h.parseGeoFile)("",e),0===n.length||n.length>1||"UNSUPPORTED"!==n[0].error)this.addTracksFromGeodataArray(n);else{var i=e.split("#")[0].split("?")[0].replace(/\/*$/,"").split("/").pop(),a=void 0,o=void 0,s=void 0;if((0,q.isGpsiesUrl)(e)){var l=(0,q.gpsiesXhrOptions)(e),u=r(l,2);a=u[0],o=u[1],s=!0}else a=(0,p.default)(e),o={responseType:"binarystring"},s=!1;(0,m.fetch)(a,o).then(function(e){var t=(0,h.parseGeoFile)(i,e.responseBinaryText,s);this.addTracksFromGeodataArray(t)}.bind(this),function(){var t=[{name:e,error:"NETWORK"}];this.addTracksFromGeodataArray(t)}.bind(this))}this.url("")},addTracksFromGeodataArray:function(e){var t=!1,n=[];return 0===e.length&&n.push("No tracks loaded"),e.forEach(function(e){var i=!(e.tracks&&e.tracks.length||e.points&&e.points.length);i||(e.tracks&&(e.tracks=e.tracks.map(function(e){return o.default.LineUtil.simplifyLatlngs(e,360/(1<<24))})),t=!0,this.addTrack(e));var r,a={CORRUPT:'File "{name}" is corrupt',UNSUPPORTED:'File "{name}" has unsupported format or is badly corrupt',NETWORK:'Could not download file from url "{name}"'};e.error&&(r=a[e.error]||e.error,r+=i?", no data could be loaded":", loaded data can be invalid or incomplete"),r&&(r=o.default.Util.template(r,{name:e.name}),n.push(r))}.bind(this)),this.readingFiles(!1),n.length&&(C.default.captureMessage("errors in loaded tracks",{extra:{message:n.join("\n")}}),(0,M.notify)(n.join("\n"))),t},onTrackColorChanged:function(e){var t=this.colors[e.color()];this.getTrackPolylines(e).forEach(function(e){e.setStyle({color:t})});var n=this.getTrackPoints(e);n.forEach(this.setMarkerIcon.bind(this)),this._markerLayer.updateMarkers(n)},onTrackVisibilityChanged:function(e){e.visible()?(this.map.addLayer(e.feature),this._markerLayer.addMarkers(e.markers)):(this.map.removeLayer(e.feature),this.stopPlacingPoint(),this._markerLayer.removeMarkers(e.markers))},onTrackLengthChanged:function(e){var t=this.getTrackPolylines(e),n=0,i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=o.value;n+=l.getLength()}}catch(u){r=!0,a=u}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}e.length(n)},formatLength:function(e){var t=0;return e<1e4?t=2:e<1e5&&(t=1),(e/1e3).toFixed(t)+" km"},setTrackMeasureTicksVisibility:function(e){var t=e.measureTicksShown(),n=this.getTrackPolylines(e);n.forEach(function(e){return e.setMeasureTicksVisible(t)})},switchMeasureTicksVisibility:function(e){e.measureTicksShown(!e.measureTicksShown())},onColorSelectorClicked:function(e,t){e._contextmenu.show(t)},setViewToTrack:function(e){var t=this.getTrackPolylines(e),n=this.getTrackPoints(e);if(t.length||n.length){var i=o.default.latLngBounds([]);t.forEach(function(e){e.getLatLngs().length>1&&i.extend(e.getBounds())}),n.forEach(function(e){i.extend([e.latlng.lat,e.latlng.lng])}),i.isValid()&&(o.default.Browser.mobile?this.map.fitBounds(i):this.map.flyToBounds(i))}},attachColorSelector:function(e){var t=this.colors.map(function(t,n){return{text:'<div style="display: inline-block; vertical-align: middle; width: 50px; height: 0; border-top: 4px solid '+t+'"></div>',callback:e.color.bind(null,n)}});e._contextmenu=new d.default(t)},attachActionsMenu:function(e){var t=[function(){return{text:""+e.name(),header:!0}},"-",{text:"Rename",callback:this.renameTrack.bind(this,e)},{text:"Duplicate",callback:this.duplicateTrack.bind(this,e)},{text:"Reverse",callback:this.reverseTrack.bind(this,e)},{text:"Show elevation profile",callback:this.showElevationProfileForTrack.bind(this,e)},"-",{text:"Delete",callback:this.removeTrack.bind(this,e)},"-",{text:"Save as GPX",callback:this.saveTrackAsFile.bind(this,e,g.default.saveGpx,".gpx")},{text:"Save as KML",callback:this.saveTrackAsFile.bind(this,e,g.default.saveKml,".kml")},{text:"Copy link to clipboard",callback:this.copyLinkToClipboard.bind(this,e)}];e._actionsMenu=new d.default(t)},addSegmentAndEdit:function(e){if(e.visible()){this.stopPlacingPoint();var t=this.addTrackSegment(e,[]);this.startEditTrackSegement(e,t),t.startDrawingLine(1)}},duplicateTrack:function(e){for(var t,n,i=[],r=this.getTrackPolylines(e),a=0;a<r.length;a++){t=[],n=r[a].getLatLngs();for(var o=0;o<n.length;o++)t.push([n[o].lat,n[o].lng]);i.push(t)}this.addTrack({name:e.name(),tracks:i})},reverseTrackSegment:function(e){e.stopDrawingLine();var t=e.getLatLngs();t=t.map(function(e){return[e.lat,e.lng]}),t.reverse();var n=this._editedLine===e;this.deleteTrackSegment(e);var i=this.addTrackSegment(e._parentTrack,t);n&&this.startEditTrackSegement(e._parentTrack,i)},reverseTrack:function(e){var t=this;this.getTrackPolylines(e).forEach(function(e){t.reverseTrackSegment(e)})},copyLinkToClipboard:function(e,t){this.stopActiveDraw();var n=this.trackToString(e,!0),i=window.location+"&nktk="+n;(0,b.default)(i,t)},saveTrackAsFile:function(e,t,n){this.stopActiveDraw();var i=this.getTrackPolylines(e).map(function(e){return e.getLatLngs()}),r=this.getTrackPoints(e),a=e.name(),o=a.lastIndexOf(".");if(o>-1&&o>=a.length-5&&(a=a.slice(0,o)),0===i.length&&0===r.length)return void(0,M.notify)("Track is empty, nothing to save");var s=t(i,a,r),l=a+n;(0,k.saveAs)((0,L.blobFromString)(s),l,!0)},renameTrack:function(e){var t=prompt("Enter new name",e.name());t&&t.length&&e.name(t)},showTrackMenu:function(e,t){e._actionsMenu.show(t)},showMenu:function(e){this.menu.show(e)},stopActiveDraw:function(){this._editedLine&&this._editedLine.stopDrawingLine()},stopEditLine:function(){this._editedLine&&(this.stopLineJoinSelection(),this._editedLine.stopEdit(),this._editedLine=null)},onTrackSegmentClick:function(e,t,n){this.isPlacingPoint||(this._lineJoinCursor?(o.default.DomEvent.stopPropagation(n),this.joinTrackSegments(t)):(this.startEditTrackSegement(e,t),o.default.DomEvent.stopPropagation(n)))},startEditTrackSegement:function(e,t){this._editedLine&&this._editedLine!==t&&this.stopEditLine(),t.startEdit(),this._editedLine=t,t.once("editend",function(n){setTimeout(this.onLineEditEnd.bind(this,n,e,t),0)}.bind(this)),this.fire("startedit")},onAddPointClicked:function(e){this.trackAddingPoint()===e?this.stopPlacingPoint():this.beginPointCreate(e)},_beginPointEdit:function(){this.stopPlacingPoint(),this.stopEditLine(),o.default.DomUtil.addClass(this._map._container,"leaflet-point-placing"),this.isPlacingPoint=!0,o.default.DomEvent.on(document,"keydown",this.stopPlacingPointOnEscPressed,this),this.fire("startedit")},beginPointMove:function(e){this._beginPointEdit(),this._movingMarker=e,this.map.on("click",this.movePoint,this)},beginPointCreate:function(e){this._beginPointEdit(),this.map.on("click",this.createNewPoint,this),this.trackAddingPoint(e)},movePoint:function(e){var t=this._movingMarker;this._markerLayer.setMarkerPosition(t,e.latlng),this.stopPlacingPoint()},createNewPoint:function(e){var t=this;if(this.isPlacingPoint){var n=this.trackAddingPoint();n._pointAutoInc+=1;for(var i=n._pointAutoInc.toString();i.length<3;)i="0"+i;var r=this.addPoint(n,{name:i,lat:e.latlng.lat,lng:e.latlng.lng});this._markerLayer.addMarker(r),setTimeout(function(){t.renamePoint(r),t.beginPointCreate(n)},10)}},stopPlacingPointOnEscPressed:function(e){27===e.keyCode&&this.stopPlacingPoint()},stopPlacingPoint:function(){this.isPlacingPoint=!1,this.trackAddingPoint(null),o.default.DomUtil.removeClass(this._map._container,"leaflet-point-placing"),o.default.DomEvent.off(document,"keydown",this.stopPlacingPointOnEscPressed,this),this.map.off("click",this.createNewPoint,this),this.map.off("click",this.movePoint,this)},joinTrackSegments:function(e){this.stopLineJoinSelection();var t=this._editedLine,n=t.getLatLngs(),i=e.getLatLngs();this._lineJoinToStart===this._lineJoinFromStart&&i.reverse(),this._lineJoinFromStart?n.unshift.apply(n,i):n.push.apply(n,i),n=n.map(function(e){return[e.lat,e.lng]}),this.deleteTrackSegment(t),t._parentTrack===e._parentTrack&&this.deleteTrackSegment(e),this.addTrackSegment(t._parentTrack,n)},onLineEditEnd:function(e,t,n){n.getLatLngs().length<2&&t.feature.removeLayer(n),this.onTrackLengthChanged(t),this._editedLine===n&&(this._editedLine=null),this.getTrackPolylines(t).length||this.getTrackPoints(t).length||!e.userCancelled||this.removeTrack(t)},addTrackSegment:function(e,t){var n=new T(t||[],{color:this.colors[e.color()],print:!0});return n._parentTrack=e,n.setMeasureTicksVisible(e.measureTicksShown()),n.on("click",this.onTrackSegmentClick.bind(this,e,n)),n.on("nodeschanged",this.onTrackLengthChanged.bind(this,e)),n.on("noderightclick",this.onNodeRightClickShowMenu,this),n.on("segmentrightclick",this.onSegmentRightClickShowMenu,this),n.on("mousemove",this.onMouseMoveOnSegmentUpdateLineJoinCursor,this),e.feature.addLayer(n),n},onNodeRightClickShowMenu:function(e){var t=[];e.nodeIndex>0&&e.nodeIndex<e.line.getLatLngs().length-1&&t.push({text:"Cut",callback:this.splitTrackSegment.bind(this,e.line,e.nodeIndex,null)}),0!==e.nodeIndex&&e.nodeIndex!==e.line.getLatLngs().length-1||t.push({text:"Join",callback:this.startLineJoinSelection.bind(this,e)}),t.push({text:"Reverse",callback:this.reverseTrackSegment.bind(this,e.line)}),t.push({text:"Delete segment",callback:this.deleteTrackSegment.bind(this,e.line)}),t.push({text:"New track from segment",callback:this.newTrackFromSegment.bind(this,e.line)}),t.push({text:"Show elevation profile for segment",callback:this.showElevationProfileForSegment.bind(this,e.line)});var n=new d.default(t);n.show(e.mouseEvent)},onSegmentRightClickShowMenu:function(e){var t=new d.default([{text:"Cut",callback:this.splitTrackSegment.bind(this,e.line,e.nodeIndex,e.mouseEvent.latlng)},{text:"Reverse",callback:this.reverseTrackSegment.bind(this,e.line)},{text:"Delete segment",callback:this.deleteTrackSegment.bind(this,e.line)},{text:"New track from segment",callback:this.newTrackFromSegment.bind(this,e.line)},{text:"Show elevation profile for segment",callback:this.showElevationProfileForSegment.bind(this,e.line)}]);t.show(e.mouseEvent)},startLineJoinSelection:function(e){this.stopLineJoinSelection(),this._editedLine.stopDrawingLine(),this._lineJoinFromStart=0===e.nodeIndex;var t=this._editedLine.getLatLngs()[e.nodeIndex];t=[t.lat,t.lng],this._lineJoinCursor=o.default.polyline([t,e.mouseEvent.latlng],{interactive:!1,color:"red",weight:1.5,opacity:1,dashArray:"7,7"}).addTo(this.map),this.map.on("mousemove",this.onMouseMoveUpdateLineJoinCursor,this),this.map.on("click",this.stopLineJoinSelection,this),o.default.DomUtil.addClass(this.map.getContainer(),"join-line-selecting"),o.default.DomEvent.on(document,"keyup",this.onEscPressedStopLineJoinSelection,this);var n=this;setTimeout(function(){n._editedLine.preventStopEdit=!0},0)},onMouseMoveUpdateLineJoinCursor:function(e){this._lineJoinCursor&&(this._lineJoinCursor.getLatLngs().splice(1,1,e.latlng),this._lineJoinCursor.redraw(),this._lineJoinCursor.setStyle({color:"red"}))},onMouseMoveOnSegmentUpdateLineJoinCursor:function(e){if(this._lineJoinCursor){var t=e.target,n=t.getLatLngs(),i=e.latlng.distanceTo(n[0]),r=e.latlng.distanceTo(n[n.length-1]);this._lineJoinToStart=i<r;var a=this._lineJoinToStart?n[0]:n[n.length-1];this._lineJoinCursor.setStyle({color:"green"}),this._lineJoinCursor.getLatLngs().splice(1,1,a),this._lineJoinCursor.redraw(),o.default.DomEvent.stopPropagation(e)}},onEscPressedStopLineJoinSelection:function(e){if("input"!==e.target.tagName.toLowerCase())switch(e.keyCode){case 27:case 13:this.stopLineJoinSelection(),o.default.DomEvent.stop(e)}},stopLineJoinSelection:function(){if(this._lineJoinCursor){this.map.off("mousemove",this.onMouseMoveUpdateLineJoinCursor,this),this.map.off("click",this.stopLineJoinSelection,this),o.default.DomUtil.removeClass(this.map.getContainer(),"join-line-selecting"),o.default.DomEvent.off(document,"keyup",this.onEscPressedStopLineJoinSelection,this),this.map.removeLayer(this._lineJoinCursor),this._lineJoinCursor=null;var e=this;setTimeout(function(){e._editedLine.preventStopEdit=!1},0)}},splitTrackSegment:function(e,t,n){var i=e.getLatLngs();i=i.map(function(e){return[e.lat,e.lng]});var r=i.slice(0,t+1),a=i.slice(t+1);if(n){var s=this.map.project(n),l=this.map.project(i[t]),u=this.map.project(i[t+1]),d=o.default.LineUtil.closestPointOnSegment(s,l,u);n=this.map.unproject(d),r.push(n),n=[n.lat,n.lng]}else n=i[t];a.unshift(n),this.deleteTrackSegment(e);var c=this.addTrackSegment(e._parentTrack,r);this.addTrackSegment(e._parentTrack,a),this.startEditTrackSegement(e._parentTrack,c)},deleteTrackSegment:function(e){e._parentTrack.feature.removeLayer(e)},newTrackFromSegment:function(e){var t,n=e.getLatLngs(),i=[];for(t=0;t<n.length;t++)i.push([n[t].lat,n[t].lng]);this.addTrack({name:"New track",tracks:[i]})},addTrack:function(e){var t;t=e.color,t>=0&&t<this.colors.length||(t=this._lastTrackColor,this._lastTrackColor=(this._lastTrackColor+1)%this.colors.length);var n={name:l.default.observable(e.name),color:l.default.observable(t),visible:l.default.observable(!e.trackHidden),length:l.default.observable("empty"),measureTicksShown:l.default.observable(e.measureTicksShown||!1),feature:o.default.featureGroup([]),_pointAutoInc:0,markers:[]};return(e.tracks||[]).forEach(this.addTrackSegment.bind(this,n)),(e.points||[]).forEach(this.addPoint.bind(this,n)),this.tracks.push(n),n.visible.subscribe(this.onTrackVisibilityChanged.bind(this,n)),n.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this,n)),n.color.subscribe(this.onTrackColorChanged.bind(this,n)),this.onTrackVisibilityChanged(n),this.attachColorSelector(n),this.attachActionsMenu(n),this.onTrackLengthChanged(n),n},setMarkerIcon:function(e){var t="marker",n=e._parentTrack.color()+1,i="symbol-"+t+"-"+n;e.icon=(0,w.default)("track-waypoint "+i)},setMarkerLabel:function(e,t){if(t.match(/\d{3,}/)){var n=parseInt(t,10);e._parentTrack._pointAutoInc=Math.max(n,0|e._parentTrack._pointAutoInc)}e.label=t},addPoint:function(e,t){var n={latlng:o.default.latLng([t.lat,t.lng]),_parentTrack:e};return this.setMarkerIcon(n),this.setMarkerLabel(n,t.name),e.markers.push(n),n._parentTrack=e,n},onMarkerClick:function(e){new d.default([{text:"Rename",callback:this.renamePoint.bind(this,e.marker)},{text:"Move",callback:this.beginPointMove.bind(this,e.marker)},{text:"Delete",callback:this.removePoint.bind(this,e.marker)}]).show(e)},removePoint:function(e){this.stopPlacingPoint(),this._markerLayer.removeMarker(e);var t=e._parentTrack.markers,n=t.indexOf(e);t.splice(n,1)},renamePoint:function(e){this.stopPlacingPoint();var t=prompt("New point name",e.label);null!==t&&(this.setMarkerLabel(e,t),this._markerLayer.updateMarker(e))},removeTrack:function(e){e.visible(!1),this.tracks.remove(e),this.stopPlacingPoint()},deleteAllTracks:function(){var e,t=this.tracks().slice(0);for(e=0;e<t.length;e++)this.removeTrack(t[e])},deleteHiddenTracks:function(){var e,t,n=this.tracks().slice(0);for(e=0;e<n.length;e++)t=n[e],t.visible()||this.removeTrack(n[e])},trackToString:function(e,t){var n=this.getTrackPolylines(e).map(function(e){var t=e.getLatLngs();return t=o.default.LineUtil.simplifyLatlngs(t,360/(1<<24))});return g.default.saveToString(n,e.name(),e.color(),e.measureTicksShown(),this.getTrackPoints(e),!t&&!e.visible())},copyAllTracks:function(e){this.stopActiveDraw();var t,n,i,r=this.tracks(),a=[];for(t=0;t<r.length;t++)n=r[t],i=this.trackToString(n),a.push(i);var o=window.location+"&nktk="+a.join("/");(0,b.default)(o,e)},copyVisibleTracks:function(e){this.stopActiveDraw();var t,n,i,r=this.tracks(),a=[];for(t=0;t<r.length;t++)n=r[t],n.visible()&&(i=this.trackToString(n),a.push(i));var o=window.location+"&nktk="+a.join("/");(0,b.default)(o,e)},exportTracks:function(e){var t=this;return this.tracks().filter(function(e){return t.getTrackPolylines(e).length}).map(function(t){var n=t.feature.getLayers().map(function(e){return e.getLatLngs().map(function(e){return[e.lat,e.lng]})}),i=t.feature.getBounds(),r=[[i.getSouth(),i.getWest()],[i.getNorth(),i.getEast()]];return{color:t.color(),visible:t.visible(),segments:n,bounds:r,measureTicksShown:t.measureTicksShown(),measureTicks:[].concat.apply([],t.feature.getLayers().map(function(t){return t.getTicksPositions(e)}))}})},showElevationProfileForSegment:function(e){this.hideElevationProfile(),this.stopEditLine(),this._elevationControl=new x.ElevationProfile(this._map,e.getLatLngs(),{samplingInterval:(0,x.calcSamplingInterval)(e.getLength())}),this.fire("elevation-shown")},showElevationProfileForTrack:function(e){var t,n=this.getTrackPolylines(e),i=[];for(t=0;t<n.length;t++)n[t]===this._editedLine&&this.stopEditLine(),i=i.concat(n[t].getLatLngs());this.hideElevationProfile(),this._elevationControl=new x.ElevationProfile(this._map,i,{samplingInterval:(0,x.calcSamplingInterval)(new o.default.MeasuredLine(i).getLength())}),this.fire("elevation-shown")},hideElevationProfile:function(){this._elevationControl&&this._elevationControl.removeFrom(this._map),this._elevationControl=null},hasTracks:function(){return!!this.tracks().length}})},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.TiledDataLoader=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(176),o=n(24),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;i(this,e),this._cache=new a.Cache(t),this._pendingRequests={},this._xhrQueue=new o.XHRQueue}return r(e,[{key:"makeTileKey",value:function(e){return e.x+":"+e.y+":"+e.z}},{key:"getFromCache",value:function(e){var t=this.makeTileKey(e),n=this._cache.get(t);return n.coords=e,n}},{key:"layerTileToDataTileCoords",value:function(e){return Object.assign({},e)}},{key:"makeRequestData",value:function(e){throw new Error("Not implemented")}},{key:"processResponse",value:function(e,t){throw new Error("Not implemented")}},{key:"calcAdjustment",value:function(e,t){if(e.x===t.x&&e.y===t.y&&e.z===t.z)return null;if(t.z>e.z){var n=1<<t.z-e.z;return{multiplier:1/n,offsetX:0,offsetY:0}}var i=1<<e.z-t.z;return{multiplier:i,offsetX:e.x-t.x*i,offsetY:e.y-t.y*i}}},{key:"requestTileData",value:function(e){var t=this,n=this.layerTileToDataTileCoords(e),i=this.getFromCache(n);if(i.found)return{dataPromise:Promise.resolve({coords:i.coords,tileData:i.value,adjustment:this.calcAdjustment(e,i.coords)}),abortLoading:function(){}};var r=this.makeTileKey(n);if(!(r in this._pendingRequests)){var a=this.makeRequestData(n),o=a.url,s=a.options,l=this._xhrQueue.put(o,s),u=l.then(function(e){return t.processResponse(e,n)}).then(function(e){var n=e.tileData,i=e.coords;return t._cache.put(t.makeTileKey(i),n),delete t._pendingRequests[r],{tileData:n,coords:i}}),d=this._pendingRequests[r]={dataPromise:u,refCount:0};d.abortLoading=function(){d.refCount-=1,d.refCount<1&&(l.abort(),delete t._pendingRequests[r])}}var c=this._pendingRequests[r];return c.refCount+=1,{dataPromise:c.dataPromise.then(function(n){return{coords:n.coords,tileData:n.tileData,adjustment:t.calcAdjustment(e,n.coords)}}),abortLoading:function(){return c.abortLoading()}}}}]),e}();t.TiledDataLoader=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(){return u?Promise.resolve(u):(d||(d=new Promise(function(e,t){(0,o.default)(l.default.googleApiUrl,function(n){n&&t(n),u=window.google,e(u)})})),d)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(478),o=i(a),s=n(34),l=i(s),u=null,d=null;t.default=r},function(e,t){"use strict";function n(e){var t={};return function(n){return n in t||(t[n]=e(n)),t[n]}}function i(e){var t=document.createElement("div");t.style.position="absolute",document.body.appendChild(t);var n=document.createElement("div");n.className=e,t.appendChild(n);var i=window.getComputedStyle(n),r=i.backgroundImage.replace(/^url\("?/,"").replace(/"?\)$/,""),a={url:r,center:[-n.offsetLeft,-n.offsetTop]};return document.body.removeChild(t),t.removeChild(n),a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n(i)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(51),a=i(r);n(444),n(38),a.default.components.register("progress-indicator",{template:'\n        <div class="ko-progress-unknown icon-spinner-nuclear" data-bind="visible: progress() === undefined"></div>\n        <div class="ko-progress" data-bind="visible: progress() !== undefined">\n            <div class="ko-progress-bkg">\n                <div class="ko-progress-bar"  data-bind="style: {width: progress() + \'%\'}"></div>\n            </div>\n        </div>',viewModel:function(e){this.progress=a.default.pureComputed(function(){var t=e.progressRange(),n=e.progressDone();return void 0===n?void 0:100*n/t})}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=2e3,n=9999,i=e/t;return i<10&&(i=10),i>50&&(i=50),e/i>n&&(i=e/n),i}function a(e,t,n){var i=document.createElementNS("http://www.w3.org/2000/svg",e);if(t)for(var r,a,o=Object.keys(t),s=0;s<o.length;s++)r=o[s],a=t[r],i.setAttribute(r,a);return n&&n.appendChild(i),i}function o(e,t,n){var i=n/e.distanceTo(t),r=e.lng+(t.lng-e.lng)*i,a=e.lat+(t.lat-e.lat)*i;return h.default.latLng(a,r)}function s(e){return Math.round(180*Math.atan(e)/Math.PI)}function l(e,t){if(!e.length)return[];var n,i,r=[],a=0,s=0,l=0;for(r.push(e[0]),i=1;i<e.length;i++){if(n=e[i].distanceTo(e[i-1]),l=s+n,l>=a+t)for(;a+t<=l;)a+=t,r.push(o(e[i-1],e[i],a-s));s=l}return r.length<2&&r.push(e[e.length-1]),r}function u(e){if(void 0===e.offsetX){var t=e.target.getBoundingClientRect();return{offsetX:e.clientX-t.left,offestY:e.clientY-t.top}}return{offsetX:e.offsetX,offestY:e.offsetY}}function d(e,t){return{movementX:t.clientX-e.clientX,movementY:t.clientY-e.clientY}}Object.defineProperty(t,"__esModule",{value:!0}),t.calcSamplingInterval=t.ElevationProfile=void 0;var c=n(2),h=i(c);n(448);var f=n(24),p=n(34),m=i(p);n(31);var v=n(35),g=n(23),y=i(g),b=h.default.Class.extend({options:{dragTolerance:2,dragButtons:[0]},includes:h.default.Mixin.Events,initialize:function(e,t,n){n=h.default.setOptions(this,n),t?this.eventsTarget=t:this.eventsTarget=this,this.dragStartPos=[],this.prevEvent=[],this.isDragging=[],h.default.DomEvent.on(e,"mousemove",this.onMouseMove,this),h.default.DomEvent.on(e,"mouseup",this.onMouseUp,this),h.default.DomEvent.on(e,"mousedown",this.onMouseDown,this),h.default.DomEvent.on(e,"mouseleave",this.onMouseLeave,this)},onMouseDown:function(e){this.options.dragButtons.includes(e.button)&&(e._offset=u(e),this.dragStartPos[e.button]=e,this.prevEvent[e.button]=e,h.default.DomUtil.disableImageDrag(),h.default.DomUtil.disableTextSelection())},onMouseUp:function(e){h.default.DomUtil.enableImageDrag(),h.default.DomUtil.enableTextSelection(),this.options.dragButtons.includes(e.button)&&(this.dragStartPos[e.button]=null,
this.isDragging[e.button]?(this.isDragging[e.button]=!1,this.fire("dragend",h.default.extend({dragButton:e.button,origEvent:e},u(e),d(this.prevEvent[e.button],e)))):this.fire("click",h.default.extend({dragButton:e.button,origEvent:e},u(e))))},onMouseMove:function(e){function t(t){var n=r.options.dragTolerance;return Math.abs(e.clientX-r.dragStartPos[t].clientX)>n||Math.abs(e.clientY-r.dragStartPos[t].clientY)>n}var n,i,r=this,a=this.options.dragButtons;for(n=0;n<a.length;n++)i=a[n],this.isDragging[i]?this.eventsTarget.fire("drag",h.default.extend({dragButton:i,origEvent:e},u(e),d(this.prevEvent[i],e))):this.dragStartPos[i]&&t(i)&&(this.isDragging[i]=!0,this.eventsTarget.fire("dragstart",h.default.extend({dragButton:i,origEvent:this.dragStartPos[i]},this.dragStartPos[i]._offset)),this.eventsTarget.fire("drag",h.default.extend({dragButton:i,origEvent:e,startEvent:r.dragStartPos[i]},u(e),d(this.prevEvent[i],e)))),this.prevEvent[i]=e},onMouseLeave:function(e){var t,n,i=this.options.dragButtons;for(t=0;t<i.length;t++)n=i[t],this.isDragging[n]&&(this.isDragging[n]=!1,this.fire("dragend",h.default.extend({dragButton:n,origEvent:e},u(e),d(this.prevEvent[n],e))));this.dragStartPos={}}}),k=h.default.Class.extend({options:{elevationsServer:m.default.elevationsServer,samplingInterval:50,sightLine:!1},includes:h.default.Mixin.Events,initialize:function(e,t,n){h.default.setOptions(this,n),this.path=t;var i=this.samples=l(this.path,this.options.samplingInterval);if(!i.length)return void(0,v.notify)("Track is empty");var r=this;this.horizZoom=1,this.dragStart=null,this._getElevation(i).then(function(t){r.values=t,r._addTo(e)}).catch(function(t){y.default.captureException(t,{extra:{description:"while getting elevation"}}),(0,v.notify)("Failed to get elevation data: "+t.message),r._addTo(e)}),this.values=null},_addTo:function(e){this._map=e;var t=this._container=h.default.DomUtil.create("div","elevation-profile-container");return h.default.Control.prototype._stopContainerEvents.call(this),this._map._controlContainer.appendChild(t),this.setupContainerLayout(),this.updateGraph(),this.trackMarker=h.default.marker([1e3,0],{clickable:!1,icon:h.default.divIcon()}),this.polyline=h.default.polyline(this.path,{weight:30,opacity:0}).addTo(e),this.polyline.on("mousemove",this.onLineMouseMove,this),this.polyline.on("mouseover",this.onLineMouseEnter,this),this.polyline.on("mouseout",this.onLineMouseLeave,this),this.polyLineSelection=h.default.polyline([],{weight:20,opacity:.5,color:"yellow",lineCap:"butt"}),this},setupContainerLayout:function(){var e=this.horizZoom=1,t=this._container;this.propsContainer=h.default.DomUtil.create("div","elevation-profile-properties",t),this.leftAxisLables=h.default.DomUtil.create("div","elevation-profile-left-axis",t),this.closeButton=h.default.DomUtil.create("div","elevation-profile-close",t),h.default.DomEvent.on(this.closeButton,"click",this.onCloseButtonClick,this),this.drawingContainer=h.default.DomUtil.create("div","elevation-profile-drawingContainer",t),this.graphCursor=h.default.DomUtil.create("div","elevation-profile-cursor elevation-profile-cursor-hidden",this.drawingContainer),this.graphCursorLabel=h.default.DomUtil.create("div","elevation-profile-cursor-label elevation-profile-cursor-hidden",this.drawingContainer),this.graphSelection=h.default.DomUtil.create("div","elevation-profile-selection elevation-profile-cursor-hidden",this.drawingContainer);var n=this.svgWidth=this.drawingContainer.clientWidth*e,i=this.svgHeight=this.drawingContainer.clientHeight,r=this.svg=a("svg",{width:n,height:i},this.drawingContainer);h.default.DomEvent.on(r,"mousemove",this.onSvgMouseMove,this),h.default.DomEvent.on(r,"mouseenter",this.onSvgEnter,this),h.default.DomEvent.on(r,"mouseleave",this.onSvgLeave,this),h.default.DomEvent.on(r,"mousewheel",this.onSvgMouseWheel,this),this.svgDragEvents=new b(this.drawingContainer,null,{dragButtons:[0,2]}),this.svgDragEvents.on("dragstart",this.onSvgDragStart,this),this.svgDragEvents.on("dragend",this.onSvgDragEnd,this),this.svgDragEvents.on("drag",this.onSvgDrag,this),this.svgDragEvents.on("click",this.onSvgClick,this),h.default.DomEvent.on(r,"dblclick",this.onSvgDblClick,this)},removeFrom:function(e){if(this.abortLoading&&this.abortLoading(),this._map)return this._map._controlContainer.removeChild(this._container),e.removeLayer(this.polyline),e.removeLayer(this.trackMarker),e.removeLayer(this.polyLineSelection),this._map=null,this.fire("remove"),this},onSvgDragStart:function(e){0===e.dragButton&&(this.polyLineSelection.addTo(this._map).bringToBack(),this.dragStart=e.offsetX)},xToIndex:function(e){return e/(this.svgWidth-1)*(this.values.length-1)},updateGraphSelection:function(e){if(null!==this.dragStart){var t,n;if(e){var i=e.offsetX;t=Math.min(i,this.dragStart),n=Math.max(i,this.dragStart),this.selStartInd=Math.round(this.xToIndex(t)),this.selEndInd=Math.round(this.xToIndex(n)),this.selStartInd<0&&(this.selStartInd=0),this.selEndInd>this.values.length-1&&(this.selEndInd=this.values.length-1)}else t=this.selStartInd*(this.svgWidth-1)/(this.values.length-1),n=this.selEndInd*(this.svgWidth-1)/(this.values.length-1);this.graphSelection.style.left=t+"px",this.graphSelection.style.width=n-t+"px",h.default.DomUtil.removeClass(this.graphSelection,"elevation-profile-cursor-hidden")}},onSvgDragEnd:function(e){if(0===e.dragButton){this.cursorShow(),this.updateGraphSelection(e);var t=this.calcProfileStats(this.values.slice(this.selStartInd,this.selEndInd+1),!0);this.updatePropsDisplay(t),h.default.DomUtil.addClass(this.propsContainer,"elevation-profile-properties-selected")}2===e.dragButton&&(this.drawingContainer.scrollLeft-=e.movementX)},onSvgDrag:function(e){0===e.dragButton&&(this.updateGraphSelection(e),this.polyLineSelection.setLatLngs(this.samples.slice(this.selStartInd,this.selEndInd+1))),2===e.dragButton&&(this.drawingContainer.scrollLeft-=e.movementX)},onSvgClick:function(e){0===e.dragButton&&(this.dragStart=null,h.default.DomUtil.addClass(this.graphSelection,"elevation-profile-cursor-hidden"),h.default.DomUtil.removeClass(this.propsContainer,"elevation-profile-properties-selected"),this._map.removeLayer(this.polyLineSelection),this.stats&&this.updatePropsDisplay(this.stats)),2===e.dragButton&&this.setMapPositionAtIndex(Math.round(this.xToIndex(e.offsetX)))},onSvgDblClick:function(e){this.setMapPositionAtIndex(Math.round(this.xToIndex(e.offsetX)))},setMapPositionAtIndex:function(e){var t=this.samples[e];t&&this._map.panTo(t)},onSvgMouseWheel:function(e){var t=this.horizZoom;this.horizZoom+=h.default.DomEvent.getWheelDelta(e)>0?1:-1,this.horizZoom<1&&(this.horizZoom=1),this.horizZoom>10&&(this.horizZoom=10);var n=u(e).offsetX,i=this.xToIndex(n),r=this.drawingContainer.scrollLeft+u(e).offsetX*(this.horizZoom/t-1);r<0&&(r=0),this.svgWidth=this.drawingContainer.clientWidth*this.horizZoom,this.svg.setAttribute("width",this.svgWidth+"px"),this.setupGraph(),r>this.svgWidth-this.drawingContainer.clientWidth&&(r=this.svgWidth-this.drawingContainer.clientWidth),this.drawingContainer.scrollLeft=r,this.cursorHide(),this.setCursorPosition(i),this.cursorShow(),this.updateGraphSelection()},updateGraph:function(){this._map&&this.values&&(this.stats=this.calcProfileStats(this.values),this.updatePropsDisplay(this.stats),this.setupGraph())},updatePropsDisplay:function(e){if(this._map){this.propsContainer.innerHTML="";var t=isNaN(e.angleAvgAscent)?"-":h.default.Util.template("{avg} / {max}&deg;",{avg:e.angleAvgAscent,max:e.angleMaxAscent}),n=isNaN(e.angleAvgDescent)?"-":h.default.Util.template("{avg} / {max}&deg;",{avg:e.angleAvgDescent,max:e.angleMaxDescent});this.propsContainer.innerHTML="<table><tr><td>Max elevation:</td><td>"+Math.round(e.max)+"</td></tr><tr><td>Min elevation:</td><td>"+Math.round(e.min)+'</td></tr><tr class="start-group"><td>Start elevation:</td><td>'+Math.round(e.start)+"</td></tr><tr><td>Finish elevation:</td><td>"+Math.round(e.end)+"</td></tr><tr><td>Start to finish elevation change:</td><td>"+Math.round(e.finalAscent)+'</td></tr><tr class="start-group"><td>Avg / Max ascent inclination:</td><td>'+t+"</td></tr><tr><td>Avg / Max descent inclination:</td><td>"+n+'</td></tr><tr class="start-group"><td>Total ascent:</td><td>'+Math.round(e.ascent)+"</td></tr><tr><td>Total descent:</td><td>"+Math.round(e.descent)+'</td></tr><tr class="start-group"><td>Distance:</td><td>'+(e.distance/1e3).toFixed(1)+" km</td></tr></table>"}},calcGridValues:function(e,t){var n,i,r,a,o,s,l,u=[3,4,5],d=[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4],c=[],h=!1;for(n=0;n<d.length;n++){for(o=d[n],i=0;i<u.length;i++)if(a=u[i],s=Math.floor(e/o),l=Math.ceil(t/o),l-s<a){h=!0;break}if(h)break}for(r=s;r<s+a;r++)c.push(r*o);return c},filterElevations:function(e,t){var n=e.slice(0);if(n.length<3)return n;for(var i,r,a,o,s,l,u,d,c,h=[[0,n.length-1]];h.length;){for(a=h.pop(),i=a[0],r=a[1],o=n[i],s=(n[r]-n[i])/(r-i),l=null,u=null,d=i+1;d<r;d++)o+=s,c=Math.abs(n[d]-o),(null===c||c>l)&&(l=c,u=d);l>t?r>i+2&&(h.push([i,u]),h.push([u,r])):n.splice(i+1,r-i-1)}return n},calcProfileStats:function(e,t){function n(e,t){return e+t}var i,r,a={};a.min=Math.min.apply(null,e),a.max=Math.max.apply(null,e),a.finalAscent=e[e.length-1]-e[0];var o=[],l=[];for(r=1;r<e.length;r++)i=e[r]-e[r-1],i>0?o.push(i):i<0&&l.push(-i);a.gradientAvgAscent=o.reduce(n,0)/o.length/this.options.samplingInterval,a.gradientMinAscent=Math.min.apply(null,o)/this.options.samplingInterval,a.gradientMaxAscent=Math.max.apply(null,o)/this.options.samplingInterval,a.gradientAvgDescent=l.reduce(n,0)/l.length/this.options.samplingInterval,a.gradientMinDescent=Math.min.apply(null,l)/this.options.samplingInterval,a.gradientMaxDescent=Math.max.apply(null,l)/this.options.samplingInterval,a.angleAvgAscent=s(a.gradientAvgAscent),a.angleMinAscent=s(a.gradientMinAscent),a.angleMaxAscent=s(a.gradientMaxAscent),a.angleAvgDescent=s(a.gradientAvgDescent),a.angleMinDescent=s(a.gradientMinDescent),a.angleMaxDescent=s(a.gradientMaxDescent),a.start=e[0],a.end=e[e.length-1],a.distance=(e.length-1)*this.options.samplingInterval;var u,d=5,c=this.filterElevations(e,d),h=0,f=0;for(r=1;r<c.length;r++)u=c[r]-c[r-1],u<0?f+=-u:h+=u;return a.ascent=h,a.descent=f,a},setCursorPosition:function(e){if(this._map&&this.values){var t=this.options.samplingInterval*e;t=(t/1e3).toFixed(2);var n=(this.values[Math.ceil(e)]-this.values[Math.floor(e)])/this.options.samplingInterval,i=Math.round(180*Math.atan(n)/Math.PI);n=Math.round(100*n);var r=Math.round(e/(this.values.length-1)*(this.svgWidth-1)),a=Math.round(e),o=this.values[a];this.graphCursorLabel.innerHTML=h.default.Util.template("{ele} m<br>{dist} km<br>{angle}&deg;",{ele:Math.round(o),dist:t,grad:n,angle:i}),this.graphCursor.style.left=r+"px",this.graphCursorLabel.style.left=r+"px",this.drawingContainer.getBoundingClientRect().left-this.drawingContainer.scrollLeft+r+this.graphCursorLabel.offsetWidth>=this._container.getBoundingClientRect().right?h.default.DomUtil.addClass(this.graphCursorLabel,"elevation-profile-cursor-label-left"):h.default.DomUtil.removeClass(this.graphCursorLabel,"elevation-profile-cursor-label-left");var s;if(e<=0)s=this.samples[0];else if(e>=this.samples.length-1)s=this.samples[this.samples.length-1];else{var l=this.samples[Math.floor(e)],u=this.samples[Math.ceil(e)],d=e-Math.floor(e);s=[l.lat+(u.lat-l.lat)*d,l.lng+(u.lng-l.lng)*d]}this.trackMarker.setLatLng(s);var c=h.default.Util.template("{ele} m<br>{dist} km<br>{angle}&deg;",{ele:Math.round(o),dist:t,grad:n,angle:i}),f=h.default.divIcon({className:"elevation-profile-marker",html:'<div class="elevation-profile-marker-icon"></div><div class="elevation-profile-marker-label">'+c+"</div>"});this.trackMarker.setIcon(f)}},onSvgMouseMove:function(e){if(this.values){var t=u(e).offsetX,n=t/(this.svgWidth-1)*(this.values.length-1);this.setCursorPosition(n)}},cursorShow:function(){h.default.DomUtil.removeClass(this.graphCursor,"elevation-profile-cursor-hidden"),h.default.DomUtil.removeClass(this.graphCursorLabel,"elevation-profile-cursor-hidden"),this._map.addLayer(this.trackMarker)},cursorHide:function(){h.default.DomUtil.addClass(this.graphCursor,"elevation-profile-cursor-hidden"),h.default.DomUtil.addClass(this.graphCursorLabel,"elevation-profile-cursor-hidden"),this._map.removeLayer(this.trackMarker)},onSvgEnter:function(){this.cursorShow()},onSvgLeave:function(){this.cursorHide()},onLineMouseEnter:function(){this.cursorShow()},onLineMouseLeave:function(){this.cursorHide()},onLineMouseMove:function(e){function t(e,t){var n=e.lng-t.lng,i=e.lat-t.lat;return n*n+i*i}var n,i,r,a,o,s=null,l=null,u=e.latlng;for(i=0;i<this.samples.length;i++)r=this.samples[i],a=t(r,u),(null===s||a<l)&&(s=i,l=a);if(null!==s){if(n=s,s>0)var d=t(u,this.samples[s-1]),c=t(this.samples[s],this.samples[s-1]);if(s<this.samples.length-1)var h=t(u,this.samples[s+1]),f=t(this.samples[s],this.samples[s+1]);o=0===s?h<l+f?(l-h)/2/f+.5:.001:s===this.samples.length-1?d<l+c?-((l-d)/2/c+.5):-.001:d<h?-((l-d)/2/c+.5):(l-h)/2/f+.5,o<-1&&(o=-1),o>1&&(o=1),this.setCursorPosition(n+o)}},setupGraph:function(){var e=this;if(this._map&&this.values){for(;this.svg.hasChildNodes();)this.svg.removeChild(this.svg.lastChild);for(;this.leftAxisLables.hasChildNodes();)this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);var t,n,i,r,o,s,l,u,d=Math.max.apply(null,this.values),c=Math.min.apply(null,this.values),f=this.svg,p=24,m=8;l=this.calcGridValues(c,d);var v=(this.svgHeight-p-m)/(l.length-1);for(n=0;n<l.length;n++)s=Math.round(n*v-.5)+.5+m,t=h.default.Util.template("M{x1} {y} L{x2} {y}",{x1:0,x2:this.svgWidth*this.horizZoom,y:s}),a("path",{d:t,"stroke-width":"1px",stroke:"green",fill:"none","stroke-opacity":"0.5"},f),u=h.default.DomUtil.create("div","elevation-profile-grid-label",this.leftAxisLables),u.innerHTML=l[l.length-n-1],u.style.top=v*n+m+"px";i=this.svgWidth/(this.values.length-1),r=(this.svgHeight-m-p)/(l[l.length-1]-l[0]),t=[];var g=function(t){var n=(t-l[0])*r;return e.svgHeight-n-p},y=!0;for(n=0;n<this.values.length;n++){var b=this.values[n];null!==b?(t.push(y?"M":"L"),o=n*i,s=g(b),t.push(o+" "+s+" "),y=!1):y=!0}t=t.join(""),a("path",{d:t,"stroke-width":"1px",stroke:"brown",fill:"none"},f),this.options.sightLine&&(t=h.default.Util.template("M{x1} {y1} L{x2} {y2}",{x1:0,x2:this.svgWidth*this.horizZoom,y1:g(this.values[0]),y2:g(this.values[this.values.length-1])}),a("path",{d:t,"stroke-width":"3px",stroke:"#94b1ff",fill:"none","stroke-opacity":"0.5"},f))}},_getElevation:function(e){function t(e){var t,n=[];e=e.split("\n");for(var i=0;i<e.length;i++)e[i]&&(t="NULL"===e[i]?null:parseFloat(e[i]),n.push(t));return n}for(var n=[],i=0;i<e.length;i++)n.push(e[i].lat.toFixed(6)+" "+e[i].lng.toFixed(5));n=n.join("\n");var r=(0,f.fetch)(this.options.elevationsServer,{method:"POST",data:n});return this.abortLoading=r.abort.bind(r),r.then(function(e){return t(e.responseText)})},onCloseButtonClick:function(){this.removeFrom(this._map)}});t.ElevationProfile=k,t.calcSamplingInterval=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(t.options){var n=t.options.code;n&&1===n.length&&(e+='<span class="layers-control-hotkey">'+n+"</span>")}return e}function o(e){var t=e.onAdd,n=e.onRemove,i=e._addItem;if(e._hotKeysEnabled)return e;l.default.Util.extend(e,{_hotKeysEnabled:!0,_addItem:function(e){return e=l.default.Util.extend({},e),e.name=a(e.name,e.layer),i.call(this,e)},onAdd:function(e){var n=t.call(this,e);return this._addHotketEvents(),n},onRemove:function(e){l.default.DomEvent.off(document,"keyup",this._onHotkeyUp,this),l.default.DomEvent.off(document,"keydown",this.onKeyDown,this),n.call(this,e)},_addHotKetEvents:function(){l.default.DomEvent.on(document,"keyup",this._onHotkeyUp,this),l.default.DomEvent.on(document,"keydown",this.onKeyDown,this)},onKeyDown:function(e){e.altKey||e.ctrlKey||e.shiftKey||(this._keyDown=e.keyCode)},_onHotkeyUp:function(e){var t=this._keyDown;this._keyDown=null;var n=e.target.tagName.toLowerCase();if(("input"!==n||"text"!==e.target.type)&&"textarea"!==n&&t===e.keyCode){var i=String.fromCharCode(e.keyCode),a=!0,o=!1,s=void 0;try{for(var u,d=this._layers[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var c=u.value,h=l.default.stamp(c.layer);if(c.layer.options&&c.layer.options.code&&c.layer.options.code.toUpperCase()===i){for(var f=this._form.getElementsByTagName("input"),p=[].concat(r(f)),m=0;m<p.length;m++){var v=p[m];if(v.layerId===h){v.click();break}}break}}}catch(g){o=!0,s=g}finally{try{!a&&d.return&&d.return()}finally{if(o)throw s}}}}});var o=!0,s=!1,u=void 0;try{for(var d,c=e._layers[Symbol.iterator]();!(o=(d=c.next()).done);o=!0){var h=d.value;h.name=a(h.name,h.layer)}}catch(f){s=!0,u=f}finally{try{!o&&c.return&&c.return()}finally{if(s)throw u}}return e._addHotKetEvents(),e._update(),e}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),l=i(s);n(452),t.default=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.onAdd;e._topRowEnabled||(o.default.Util.extend(e,{_topRowEnabled:!0,onAdd:function(e){var n=this,i=t.call(this,e);return setTimeout(function(){return n.__injectTopRow()},0),i},__injectTopRow:function(){this._topRow=o.default.DomUtil.create("div","leaflet-control-layers-top-row"),this._form.parentNode.insertBefore(this._topRow,this._form)}}),e._map&&e.__injectTopRow())}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=i(a);n(454),t.default=r},function(e,t){"use strict";function n(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r={_listeners:[],_state:{},addEventListener:function(e,t){var n=!0,r=!1,a=void 0;try{for(var o,s=this._listeners[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=i(o.value,2),u=l[0],d=l[1];if(u===e&&d===t)return}}catch(c){r=!0,a=c}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}this._listeners.push([e,t])},removeEventListener:function(e,t){var n=this;this._listeners.forEach(function(r,a){var o=i(r,2),s=o[0],l=o[1];if(s===e&&l===t)return void n._listeners.splice(a,1)})},updateState:function(e,t){t?this._state[e]=t:delete this._state[e],this._saveStateToHash()},getState:function(e){return this._state[e]},_parseHash:function(){var e=location.hash,t={},n=e.indexOf("#");if(n>=0){e=e.substr(n+1).trim();var r=void 0,a=void 0,o=void 0,s=!0,l=!1,u=void 0;try{for(var d,c=e.split("&")[Symbol.iterator]();!(s=(d=c.next()).done);s=!0){var h=d.value;if(r=/^([^=]+?)(?:=(.*))?$/.exec(h)){var f=r,p=i(f,3);a=p[1],o=p[2],o?(o=o.split("/"),o=o.map(decodeURIComponent)):o=[],t[a]=o}}}catch(m){l=!0,u=m}finally{try{!s&&c.return&&c.return()}finally{if(l)throw u}}}return t},_saveStateToHash:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var r,a=Object.keys(this._state)[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;if(this._state[o])if(this._state[o].length){var s=this._state[o].join("/");e.push(o+"="+s)}else e.push(o)}}catch(l){n=!0,i=l}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}location.hash=e.join("&")},onHashChanged:function(){var e=this._parseHash(),t={},r=!0,a=!1,o=void 0;try{for(var s,l=Object.keys(e)[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;u in this._state&&n(e[u],this._state[u])||(t[u]=1)}}catch(d){a=!0,o=d}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}var c=!0,h=!1,f=void 0;try{for(var p,m=Object.keys(this._state)[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var v=p.value;v in e||(t[v]=1)}}catch(d){h=!0,f=d}finally{try{!c&&m.return&&m.return()}finally{if(h)throw f}}var g=!0,y=!1,b=void 0;try{for(var k,_=this._listeners[Symbol.iterator]();!(g=(k=_.next()).done);g=!0){var w=i(k.value,2),x=w[0],L=w[1];x in t&&L(e[x])}}catch(d){y=!0,b=d}finally{try{!g&&_.return&&_.return()}finally{if(y)throw b}}this._state=e}};window.addEventListener("hashchange",r.onHashChanged.bind(r)),r.onHashChanged(),t.default=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);a.default.BingLayer=a.default.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:""},initialize:function(e,t){a.default.Util.setOptions(this,t),this._key=e,this._url=null,this._providers=[],this.metaRequested=!1},tile2quad:function(e,t,n){for(var i="",r=n;r>0;r--){var a=0,o=1<<r-1;0!==(e&o)&&(a+=1),0!==(t&o)&&(a+=2),i+=a}return i},getTileUrl:function(e){var t=this._getZoomForUrl(),n=this.options.subdomains,i=this.options.subdomains[Math.abs((e.x+e.y)%n.length)];return this._url.replace("{subdomain}",i).replace("{quadkey}",this.tile2quad(e.x,e.y,t)).replace("{culture}",this.options.culture)},loadMetadata:function(){if(!this.metaRequested){this.metaRequested=!0;var e=this,t="_bing_metadata_"+a.default.Util.stamp(this);window[t]=function(n){window[t]=void 0;var i=document.getElementById(t);if(i.parentNode.removeChild(i),n.errorDetails)throw new Error(n.errorDetails);e.initMetadata(n)};var n="file:"===document.location.protocol?"http":document.location.protocol.slice(0,-1),i=n+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+t+"&key="+this._key+"&UriScheme="+n,r=document.createElement("script");r.type="text/javascript",r.src=i,r.id=t,document.getElementsByTagName("head")[0].appendChild(r)}},initMetadata:function(e){var t=e.resourceSets[0].resources[0];if(this.options.subdomains=t.imageUrlSubdomains,this._url=t.imageUrl,t.imageryProviders)for(var n=0;n<t.imageryProviders.length;n++)for(var i=t.imageryProviders[n],r=0;r<i.coverageAreas.length;r++){var o=i.coverageAreas[r],s={zoomMin:o.zoomMin,zoomMax:o.zoomMax,active:!1},l=new a.default.LatLngBounds(new a.default.LatLng(o.bbox[0]+.01,o.bbox[1]+.01),new a.default.LatLng(o.bbox[2]-.01,o.bbox[3]-.01));s.bounds=l,s.attrib=i.attribution,this._providers.push(s)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),a.default.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var e=a.default.latLngBounds(this._map.getBounds().getSouthWest().wrap(),this._map.getBounds().getNorthEast().wrap()),t=this._map.getZoom(),n=0;n<this._providers.length;n++){var i=this._providers[n];t<=i.zoomMax&&t>=i.zoomMin&&e.intersects(i.bounds)?(!i.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(i.attrib),i.active=!0):(i.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(i.attrib),i.active=!1)}},onAdd:function(e){this.loadMetadata(),a.default.TileLayer.prototype.onAdd.apply(this,[e])},onRemove:function(e){for(var t=0;t<this._providers.length;t++){var n=this._providers[t];n.active&&this._map.attributionControl&&(this._map.attributionControl.removeAttribution(n.attrib),n.active=!1)}a.default.TileLayer.prototype.onRemove.apply(this,[e])}}),a.default.bingLayer=function(e,t){return new a.default.BingLayer(e,t)}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var a=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(2),s=i(o),l=n(111),u=i(l);s.default.Layer.Google=s.default.GridLayer.extend({options:{},initialize:function(e,t){s.default.GridLayer.prototype.initialize.call(this,t),this.mapType=e},onAdd:function(e){var t=this;this._clearTiles(),s.default.GridLayer.prototype.onAdd.call(this,e),this._googleMapContainer=s.default.DomUtil.create("div","",e.getContainer()),this._googleMapContainer.style.width="100%",this._googleMapContainer.style.height="100%",this._googleMapContainer.style.visibility="hidden",this._googleMapContainer.style.pointerEvents="none",(0,u.default)().then(function(n){var i=void 0,r=void 0;e?(i=e.getZoom(),r=e.getCenter,r=new n.maps.LatLng(r.lat,r.lng)):(i=0,r=new n.maps.LatLng(0,0)),t.google=n,t._googleMap=new n.maps.Map(t._googleMapContainer,{center:r,zoom:i,tilt:0,mapTypeId:n.maps.MapTypeId[t.mapType],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,clickableIcons:!1}),n.maps.event.addListener(t._googleMap,"tilesloaded",t._onTilesLoaded.bind(t)),setTimeout(t._syncPosition.bind(t),0)}),e.on({viewreset:this._syncPosition,resize:this._onResize,move:this._syncPosition,zoomanim:this._onZoom},this)},onRemove:function(e){this.google&&this.google.maps.event.clearInstanceListeners(this._googleMap),this._googleMap=null,this._clearTiles(),s.default.DomUtil.remove(this._googleMapContainer),e.off({viewreset:this._clearTiles,resize:this._onResize,move:this._syncPosition,zoomanim:this._onZoom},this),s.default.GridLayer.prototype.onRemove.call(this,e)},_clearTiles:function(){this._pendingTiles={},this._readyTiles={}},_onResize:function(){this.google&&this.google.maps.event.trigger(this._googleMap,"resize")},_syncPosition:function(){var e=this;if(this.google&&this._map){var t=this._map.getCenter(),n=new this.google.maps.LatLng(t.lat,t.lng);setTimeout(function(){e._googleMap&&(e._googleMap.setCenter(n),e._googleMap.setZoom(e._map.getZoom()))},0)}},_onZoom:function(e){var t=this;if(this.google){var n=e.center,i=new this.google.maps.LatLng(n.lat,n.lng);setTimeout(function(){t._googleMap&&(t._googleMap.setCenter(i),t._googleMap.setZoom(Math.round(e.zoom)))},0)}},_roadRegexp:/!1i(\d+)!2i(\d+)!3i(\d+)!/,_satRegexp:/x=(\d+)&y=(\d+)&z=(\d+)/,_onTilesLoaded:function(){this._readyTiles=this._collectMapImageElements(),this._fullfillPendingTiles()},_collectMapImageElements:function(){for(var e=this._googleMapContainer.getElementsByTagName("img"),t={},n=[].concat(r(e)),i=0;i<n.length;i++){var a=n[i],o=a.src,s=void 0,l=void 0;s=o.match(this._roadRegexp),s?l={z:s[1],x:s[2],y:s[3]}:(s=o.match(this._satRegexp),s&&(l={x:s[1],y:s[2],z:s[3]})),l&&(t[this._tileCoordsToKey(l)]=o)}return t},_fullfillPendingTiles:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=Object.keys(this._readyTiles)[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;if(o in this._pendingTiles){var l=!0,u=!1,d=void 0;try{for(var c,h=this._pendingTiles[o][Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var f=a(c.value,2),p=f[0],m=f[1];s.default.DomEvent.on(p,"load",s.default.bind(this._tileOnLoad,this,m,p)),s.default.DomEvent.on(p,"error",s.default.bind(this._tileOnError,this,m,p)),p.alt="",p.src=this._readyTiles[o]}}catch(v){u=!0,d=v}finally{try{!l&&h.return&&h.return()}finally{if(u)throw d}}delete this._pendingTiles[o]}}}catch(v){t=!0,n=v}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}},_tileOnLoad:function(e,t){s.default.Browser.ielt9?setTimeout(s.default.bind(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){e(n,t)},createTile:function(e,t){var n=s.default.DomUtil.create("img"),i=this._tileCoordsToKey(e);return i in this._pendingTiles||(this._pendingTiles[i]=[]),this._pendingTiles[i].push([n,t]),setTimeout(this._fullfillPendingTiles.bind(this),0),n}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}var a=n(2),o=i(a);n(62),o.default.Layer.CanvasMarkers.include({_printProgressWeight:.1,cloneMarkers:function(){function e(e){return{latlng:{lat:e.latlng.lat,lng:e.latlng.lng},label:e.label,icon:e.icon}}var t=this.rtree.all(),n=t.map(e);return n},cloneForPrint:function(e){return e=o.default.Util.extend({},this.options),void 0!==e.printIconsOpacity&&(e.iconsOpacity=e.printIconsOpacity),new o.default.Layer.CanvasMarkers(this.cloneMarkers(),e)},getTilesInfo:function(){function e(e){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t){var n,i,r,a,s,l,u,d,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.options.iconScale=t.resolution/90*.75,n=t.pixelBounds.getSize().x/t.destPixelSize.x,i={tileN:t.pixelBounds.getTopRight().y/n,tileS:t.pixelBounds.getBottomLeft().y/n,tileE:t.pixelBounds.getTopRight().x/n,tileW:t.pixelBounds.getBottomLeft().x/n},r=o.default.CRS.EPSG3857,this._map||(a={project:r.latLngToPoint.bind(r),unproject:r.pointToLatLng.bind(r)},this._map=a),s=r.zoom(1/n*r.scale(t.zoom)),l=this.selectMarkersForDraw(i,s,!0),u=l.iconUrls,d=l.markerJobs,c=l.pointsForLabels,e.next=9,this.preloadIcons(u);case 9:return e.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{tilePromise:Promise.resolve({draw:function(e){t.resetLabels(),t.drawSelectedMarkers(e,i,d,c,s,!0)},isOverlay:!0,overlaySolid:!this.options.printTransparent}),abortLoading:function(){}};case 2:case"end":return e.stop()}},e,this)}).bind(this),count:1});case 10:case"end":return e.stop()}},e,this)}));return e}()})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(){}Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasLayerGrabMixin=t.GridLayerGrabMixin=t.TileLayerGrabMixin=void 0;var o=n(2),s=i(o),l=n(60),u=i(l),d=n(223),c={tileImagePromiseFromCoords:function(e){throw new Error("Method not implemented")},waitTilesReadyToGrab:function(){return Promise.resolve(null)},getTilesInfo:function(){function e(e){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t){var n,i,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitTilesReadyToGrab();case 2:return n=t.pixelBounds,i=this._pxBoundsToTileRange(n),r=n.min,a=regeneratorRuntime.mark(function e(){var n,a,o,l,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=i.min.y;case 1:if(!(n<=i.max.y)){e.next=15;break}a=regeneratorRuntime.mark(function e(i){var a,o,l,d,c,h,f,p,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new s.default.Point(i,n),a.z=u._tileZoom,u._isValidTile(a)){e.next=4;break}return e.abrupt("return","continue");case 4:return o=u._getTilePos(a),l=a.add(s.default.point(1,1)),l.z=a.z,d=u._getTilePos(l),c=d.subtract(o),h=s.default.latLngBounds(u._map.unproject(o.add(u._level.origin)),u._map.unproject(d.add(u._level.origin))),o=o.add(u._level.origin).subtract(r),f=u.tileImagePromiseFromCoords(u._wrapCoords(a),t),p=f.tilePromise,m=f.abortLoading,e.next=14,{tilePromise:p.then(function(e){return{image:e,tilePos:o,tileSize:c,latLngBounds:h}}),abortLoading:m};case 14:case"end":return e.stop()}},e,u)}),o=i.min.x;case 4:if(!(o<=i.max.x)){e.next=12;break}return e.delegateYield(a(o),"t0",6);case 6:if(l=e.t0,"continue"!==l){e.next=9;break}return e.abrupt("continue",9);
case 9:o++,e.next=4;break;case 12:n++,e.next=1;break;case 15:case"end":return e.stop()}},e,this)}).bind(this),e.abrupt("return",{iterateTilePromises:a,count:(i.max.x-i.min.x+1)*(i.max.y-i.min.y+1)});case 7:case"end":return e.stop()}},e,this)}));return e}()},h=s.default.Util.extend({},c,{cloneForPrint:function(e){return s.default.tileLayer(this._url,s.default.Util.extend({},this.options,e))},tileImagePromiseFromCoords:function(e,t){var n=t.xhrOptions,i=this.getTileUrl(e);if(!i)return{tilePromise:Promise.resolve(null),abortLoading:a};this.options.noCors&&(i=(0,u.default)(i));var r=this.options.xhrQueue.put(i,n);return{tilePromise:t.rawData?r:r.then(d.imgFromDataString),abortLoading:function(){return r.abort()}}}}),f=s.default.Util.extend({},c,{getCanvasFromTile:function(e){return e},tileImagePromiseFromCoords:function(e){var t=this,n=void 0;if(this.createTile.length<2){var i=this.createTile(e);n=Promise.resolve(i)}else n=new Promise(function(n){t.createTile(e,function(e,t){return n(t)})});return{tilePromise:n.then(this.getCanvasFromTile),abortLoading:a}}});s.default.TileLayer.include(h),t.TileLayerGrabMixin=h,t.GridLayerGrabMixin=c,t.CanvasLayerGrabMixin=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var i=s.default.DomUtil.create("div","",document.body),r=void 0,a=void 0,o=void 0;if(t){var l=n.getSize();r=l.x,a=l.y,o=n.min.add(l.divideBy(2)),o=s.default.CRS.EPSG3857.pointToLatLng(o,e)}else r=100,a=100,o=s.default.latLng(0,0);Object.assign(i.style,{width:r+"px",height:a+"px",position:"absolute",left:"0",top:"0",visibility:"hidden"});var u=s.default.map(i,{fadeAnimation:!1,zoomAnimation:!1,inertia:!1,maxZoom:18});return u.setView(o,e),u}function a(e){var t=e._container;e.remove(),s.default.DomUtil.remove(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.disposeMap=t.getTempMap=void 0;var o=n(2),s=i(o);n(121),n(218),n(222),n(219),n(221),n(120),n(220),t.getTempMap=r,t.disposeMap=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(466),n(216);var o=n(124);a.default.Layer.WestraPasses=a.default.Layer.extend({options:{fileRegions1:"westra_regions_geo1.json",fileRegions2:"westra_regions_geo2.json",scaleDependent:!0},initialize:function(e,t){a.default.setOptions(this,t),this.markers=new o.WestraPassesMarkers(e),this.regions1=new a.default.Layer.GeoJSONAjax(e+this.options.fileRegions1,{className:"westra-region-polygon",onEachFeature:this._setRegionLabel.bind(this,"regions1")}),this.regions2=new a.default.Layer.GeoJSONAjax(e+this.options.fileRegions2,{className:"westra-region-polygon",onEachFeature:this._setRegionLabel.bind(this,"regions2")})},_setRegionLabel:function(e,t,n){function i(){this._map.fitBounds(n.getBounds())}var r=n.getBounds().getCenter(),o=a.default.divIcon({className:"westra-region-label",html:"<span>"+t.properties.name+"</span>"}),s=a.default.marker(r,{icon:o});this[e].addLayer(s),n.on("click",i,this),s.on("click",i,this)},setLayersVisibility:function(e){if(this._map){var t,n=!e||"zoomanim"!==e.type;t=e&&void 0!==e.zoom?e.zoom:this._map.getZoom(),t<2?(this._map.removeLayer(this.markers),this._map.removeLayer(this.regions1),this._map.removeLayer(this.regions2)):t<7?(this._map.removeLayer(this.markers),this._map.addLayer(this.regions1),this._map.removeLayer(this.regions2)):t<10?(this._map.removeLayer(this.regions1),this._map.addLayer(this.regions2),this._map.removeLayer(this.markers)):(n&&this._map.addLayer(this.markers),this._map.removeLayer(this.regions1),this._map.removeLayer(this.regions2))}},onAdd:function(e){this._map=e,this.markers.loadData(),this.regions1.loadData(),this.regions2.loadData(),this.setLayersVisibility(),e.on("zoomend",this.setLayersVisibility,this),e.on("zoomanim",this.setLayersVisibility,this)},onRemove:function(){this._map.removeLayer(this.markers),this._map.removeLayer(this.regions1),this._map.removeLayer(this.regions2),this._map.off("zoomend",this.setLayersVisibility,this),this._map.off("zoomanim",this.setLayersVisibility,this),this._map=null}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WestraPassesMarkers=void 0;var r=n(2),a=i(r);n(62);var o=n(128),s=n(164),l=i(s),u=n(64),d=n(112),c=i(d),h=n(24),f=n(35),p=n(23),m=i(p),v=a.default.Layer.CanvasMarkers.extend({options:{filePasses:"westra_passes.json",scaleDependent:!0},initialize:function(e,t){a.default.Layer.CanvasMarkers.prototype.initialize.call(this,null,t),this.on("markerclick",this.showPassDescription,this),this._baseUrl=e,this.url=e+this.options.filePasses},loadData:function(){var e=this;this._downloadStarted||(this._downloadStarted=!0,(0,h.fetch)(this.url).then(function(t){return e._loadMarkers(t)},function(t){e._downloadStarted=!1,m.default.captureException(t,{extra:{description:"failed to get westra passes",url:e.url,status:t.xhr.status}}),(0,f.notify)("Failed to get Westra passes data")}))},onAdd:function(e){a.default.Layer.CanvasMarkers.prototype.onAdd.call(this,e),this.loadData()},_makeTooltip:function(e){var t=e.properties,n=t.grade||"";return n&&t.elevation&&(n+=", "),n+=t.elevation||"",n&&(n=" ("+n+")"),n=(t.name||" ")+n,n=(t.is_summit?" ":" ")+n},_passToGpx:function(e){var t=e.tooltip;"function"==typeof t&&(t=t(e)),t=(0,l.default)(t);var n='\n                <?xml version="1.0" encoding="UTF-8" standalone="no" ?>\n                <gpx xmlns="http://www.topografix.com/GPX/1/1" creator="http://nakarte.tk" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">\n                    <wpt lat="'+e.latlng.lat.toFixed(6)+'" lon="'+e.latlng.lng.toFixed(6)+'">\n                        <name>'+t+"</name>\n                    </wpt>\n                </gpx>\n            ",i=e.properties.name||" ";(0,u.saveAs)(new Blob([n],{type:"application/gpx+xml"}),i+".gpx",!0)},_passToKml:function(e){var t=e.tooltip;"function"==typeof t&&(t=t(e)),t=(0,l.default)(t);var n='\n                <?xml version="1.0" encoding="UTF-8"?>\n                <kml xmlns="http://www.opengis.net/kml/2.2">\n                    <Placemark>\n                        <name>'+t+"</name>\n                        <Point>\n                            <coordinates>\n                                "+e.latlng.lng.toFixed(6)+","+e.latlng.lat.toFixed(6)+",0\n                            </coordinates>\n                        </Point>\n                    </Placemark>\n                </kml>\n            ",i=e.properties.name||" ";(0,u.saveAs)(new Blob([n],{type:"application/vnd.google-earth.kml+xml"}),i+".kml",!0)},_makeIcon:function(e){var t;return t="westra-pass-marker ",t+=e.properties.is_summit?"westra-pass-marker-summit":"westra-pass-marker-"+e.properties.grade_eng,(0,c.default)(t)},_loadMarkers:function(e){var t,n,i,r=[],a=JSON.parse(e.response);for(n=0;n<a.length;n++)t=a[n],i={latlng:{lat:t.latlon[0],lng:t.latlon[1]},label:t.name||"",icon:this._makeIcon,tooltip:this._makeTooltip.bind(this),properties:t},r.push(i);this.addMarkers(r),this._dataLoaded=!0,this.fire("data-loaded")},showPassDescription:function(e){if(this._map){var t=e.marker.properties,n=e.marker.latlng,i="http://westra.ru/passes/Passes/"+t.id,r="",a="",s="";if(t.altnames&&(r="\n                    <tr>\n                        <td> </td>\n                        <td>"+t.altnames+"</td>\n                    </tr>"),t.is_summit||(a="\n                    <tr>\n                        <td></td>\n                        <td>"+(t.connects||"o")+"</td>\n                    </tr>"),t.comments){var l=!0,u=!1,d=void 0;try{for(var c,h=t.comments[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var f=c.value,p="";f.user&&(p='<span class="westra-passes-description-comment-author">'+f.user+":</span>"),s+='<p class="westra-passes-description-comment">'+p+f.content+"</p>"}}catch(m){u=!0,d=m}finally{try{!l&&h.return&&h.return()}finally{if(u)throw d}}s="\n                    <tr>\n                        <td></td>\n                        <td>"+s+"</td>\n                    </tr>"}var v='\n                <table class="pass-details">\n                    <tr>\n                        <td>'+(t.is_summit?" ":" ")+"</td>\n                        <td>"+(t.name||" ")+"</td>\n                    </tr>\n                    "+r+"\n                    <tr>\n                        <td></td>\n                        <td>"+(t.grade||"")+"</td>\n                    </tr>\n                    <tr>\n                        <td></td>\n                        <td>"+(t.elevation?t.elevation+" ":"")+"</td>\n                    </tr>\n                    "+a+"\n                    <tr>\n                        <td> </td>\n                        <td>"+(t.slopes||"")+'</td>\n                    </tr>\n                    <tr>\n                        <td></td>\n                        <td>\n                            <table class="westra-passes-description-coords">\n                                <tr>\n                                    <td></td>\n                                    <td></td>\n                                </tr>\n                                <tr>\n                                    <td>'+n.lat.toFixed(5)+"</td>\n                                    <td>"+n.lng.toFixed(5)+'</td>\n                                    <td><a id="westra-pass-gpx" title="">gpx</a></td>\n                                    <td><a id="westra-pass-kml" title="">kml</a></td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>  </td>\n                        <td><a id="westra-pass-link" href="'+i+'">'+i+"</a></td></tr>\n                    <tr>\n                        <td></td>\n                        <td>"+(t.author||"")+"</td>\n                    </tr>\n                    "+s+"\n                </table>";this._map.openPopup(v,n,{maxWidth:500}),document.getElementById("westra-pass-link").onclick=function(){return(0,o.openPopupWindow)(i,780,"westra-details"),!1},document.getElementById("westra-pass-gpx").onclick=function(){return this._passToGpx(e.marker),!1}.bind(this),document.getElementById("westra-pass-kml").onclick=function(){return this._passToKml(e.marker),!1}.bind(this)}}});t.WestraPassesMarkers=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(468);var o=a.default.CRS.EPSG3395;a.default.Layer.Yandex=a.default.TileLayer.extend({options:{subdomains:"1234",className:a.default.Browser.retina?"":"yandex-tile-layer",yandexScale:a.default.Browser.retina?2:1},initialize:function(e,t){var n=void 0;this._mapType=e,n="sat"===e?"https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}":"https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}",a.default.TileLayer.prototype.initialize.call(this,n,t)},_getTilePos:function(e){var t=o.pointToLatLng(e.scaleBy(this.getTileSize()),e.z);return this._map.project(t,e.z).subtract(this._level.origin).round()},_pxBoundsToTileRange:function(e){var t=this._tileZoom,n=new a.default.Bounds(o.latLngToPoint(this._map.unproject(e.min,t),t),o.latLngToPoint(this._map.unproject(e.max,t),t));return a.default.TileLayer.prototype._pxBoundsToTileRange.call(this,n)},createTile:function(e,t){var n=a.default.TileLayer.prototype.createTile.call(this,e,t),i=a.default.point(e).add([0,1]);return i.z=e.z,n._adjustHeight=this._getTilePos(i).y-this._getTilePos(e).y,n},_initTile:function(e){a.default.TileLayer.prototype._initTile.call(this,e),e.style.height=e._adjustHeight+"px"}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var i=n/e.distanceTo(t),r=e.lng+(t.lng-e.lng)*i,a=e.lat+(t.lat-e.lat)*i;return s.default.latLng(a,r)}function a(e){var t=s.default.CRS.EPSG3857.project(e[0]),n=s.default.CRS.EPSG3857.project(e[1]),i=n.x-t.x,r=t.y-n.y,a=Math.sqrt(i*i+r*r),o=r/a,l=i/a;return[o,l]}var o=n(2),s=i(o);n(470),s.default.MeasuredLine=s.default.Polyline.extend({options:{minTicksIntervalMm:15},onAdd:function(e){s.default.Polyline.prototype.onAdd.call(this,e),this._ticks={},this.updateTicks(),this._map.on("zoomend",this.updateTicks,this),this._map.on("dragend",this.updateTicks,this),this.on("nodeschanged",this.updateTicksLater,this)},updateTicksLater:function(){setTimeout(this.updateTicks.bind(this),0)},onRemove:function(e){this._map.off("zoomend",this.updateTicks,this),this._map.off("dragend",this.updateTicks,this),this.off("nodeschanged",this.updateTicks,this),this._clearTicks(),s.default.Polyline.prototype.onRemove.call(this,e)},_clearTicks:function(){var e=this;this._map&&(Object.values(this._ticks).forEach(function(t){return e._map.removeLayer(t)}),this._ticks={})},_addTick:function(e,t){var n="matrix("+e.transformMatrix.join(",")+")";if(t)t._icon.childNodes[0].style.transform=n,t.setLatLng(e.position);else{var i=Math.round(e.distanceValue/10)/100+" km",r=s.default.divIcon({html:'<div class="measure-tick-icon-text" style="transform:'+n+'">'+i+"</div>",className:"measure-tick-icon"});t=s.default.marker(e.position,{icon:r,interactive:!1,keyboard:!1}),t.addTo(this._map)}this._ticks[e.distanceValue.toString()]=t},setMeasureTicksVisible:function(e){this.options.measureTicksShown=e,this.updateTicks()},getTicksPositions:function(e,t){function n(e,n,i){if(!t||t.contains(e)){var r,s=a(n),l=s[0],u=s[1];r=l>0?[l,-u,u,l,0,0]:[-l,u,-u,-l,0,0],o.push({position:e,distanceValue:i,transformMatrix:r})}}var i=[500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e6],o=[],s=void 0,l=!0,u=!1,d=void 0;try{for(var c,h=i[Symbol.iterator]();!(l=(c=h.next()).done)&&(s=c.value,!(s>=e));l=!0);}catch(f){u=!0,d=f}finally{try{!l&&h.return&&h.return()}finally{if(u)throw d}}var p,m,v=0,g=0,y=this._latlngs,b=y.length;if(b<2)return o;for(var k=1;k<b;k++){if(m=y[k].distanceTo(y[k-1]),p=g+m,p>=v+s)for(;v+s<=p;)v+=s,n(r(y[k-1],y[k],v-g),[y[k-1],y[k]],v);g=p}return g>e/2&&(n(y[0],[y[0],y[1]],0),n(y[b-1],[y[b-2],y[b-1]],g)),o},updateTicks:function(){var e=this;if(this._map){if(!this.options.measureTicksShown)return void this._clearTicks();var t=this._map.getBounds().pad(1),n=Math.PI/180,i=96,r=20003931/this._map.project([180,0]).x,a=this.getLatLngs().length?this.getBounds().getCenter():this._map.getCenter(),o=r*Math.cos(a.lat*n),s=1/i*2.54/100/o,l=this.options.minTicksIntervalMm/s/1e3,u=this.getTicksPositions(l,t),d=this._ticks;this._ticks={},u.forEach(function(e){var t=d[e.distanceValue.toString()];this._addTick(e,t),t&&delete d[e.distanceValue.toString()]}.bind(this)),Object.values(d).forEach(function(t){return e._map.removeLayer(t)})}},getLength:function(){for(var e=this._latlngs,t=e.length,n=0,i=1;i<t;i++)n+=e[i].distanceTo(e[i-1]);return n}}),s.default.measuredLine=function(e,t){return new s.default.MeasuredLine(e,t)}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return(e%t+t)%t}function a(){for(var e=new Uint8Array((0,d.stringToArrayBuffer)(atob(u.default.array))),t=new Float32Array(e.length),n=u.default.valueScale,i=u.default.valueOffset,r=0;r<e.length;r++)t[r]=e[r]/n-i;return t}function o(e,t){if(e<0||t<0||t>=u.default.colsCount||e>=u.default.rowsCount)throw new Error("Invalid col/row value col="+t+" row="+e);var n=e*u.default.colsCount+t;if(n>=c.length)throw new Error("Index value out of range");return c[n]}function s(e,t){if(e<u.default.minLat||e>u.default.maxLat)return null;t=r(t+180,360)-180;var n=Math.floor((e-u.default.minLat)/u.default.step),i=n+1,a=(e-(n*u.default.step+u.default.minLat))/u.default.step,s=Math.floor((t+180)/u.default.step),l=s+1,d=(t-(s*u.default.step-180))/u.default.step;s%=u.default.colsCount,l%=u.default.colsCount;var c=o(n,s),h=o(n,l),f=c*(1-d)+h*d;if(i>=u.default.rowsCount)return f;c=o(i,s),h=o(i,l);var p=c*(1-d)+h*d,m=f*(1-a)+p*a;return m}Object.defineProperty(t,"__esModule",{value:!0}),t.getDeclination=void 0;var l=n(473),u=i(l),d=n(50),c=void 0;c=a(),t.getDeclination=s},function(e,t){"use strict";function n(e,t){var n,i,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=screen.availLeft||0,s=8;window.screenX-o-1.5*s>t?n=window.screenX-t-1.5*s:window.screenX+window.outerWidth+t+1.5*s<o+screen.availWidth?n=window.screenX+window.outerWidth+s:(n=window.screenX+window.outerWidth/2-t/2,n<0&&(n=0)),i=window.screenY,r=window.innerHeight;var l="width="+t+",height="+r+",left="+n+",top="+i;l+=",resizable,scrollbars",window.open(e,a,l).focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.openPopupWindow=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,437,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(){(0,c.fixAll)();var e=o.default.map("map",{zoomControl:!1,fadeAnimation:!1,attributionControl:!1,inertiaMaxSpeed:1500,worldCopyJump:!0,maxZoom:18});e.enableHashState("m",[10,55.75185,37.61856]);var t=new o.default.Control.TrackList;new o.default.Control.Caption('<a href="'+l.default.newsUrl+'">News</a> | <a href="mailto:'+l.default.email+'">nakarte@nakarte.tk</a>',{position:"topleft"}).addTo(e),new o.default.Control.Scale({imperial:!1,position:"topleft"}).addTo(e),o.default.control.zoom().addTo(e),new o.default.Control.TrackList.Ruler(t).addTo(e);var n=new o.default.Control.Panoramas(document.getElementById("street-view")).addTo(e).enableHashState("n2");o.default.Control.Panoramas.hashStateUpgrader(n).enableHashState("n"),new o.default.Control.Coordinates({position:"topleft"}).addTo(e);var i=new o.default.Control.Azimuth({position:"topleft"}).addTo(e),r=o.default.control.layers(null,null,{collapsed:!1}).addTo(e);(0,d.default)(r),(0,f.default)(r),(0,m.default)(r),(0,g.default)(r,(0,x.default)()),r.enableHashState("l");var a=new o.default.Control.PrintPages({position:"bottomleft"}).addTo(e).enableHashState("p");a.hasPages()||a.setMinimized(),new o.default.Control.JNX(r,{position:"bottomleft"}).addTo(e).enableHashState("j"),t.addTo(e),b.default.getState("nktk")||t.loadTracksFromStorage(),t.enableHashState("nktk"),o.default.Browser.mobile&&(r.setMinimized(),t.hasTracks()||t.setMinimized()),o.default.Browser.mobile&&e.on("mousedown dragstart",function(){return r.setMinimized()}),(0,_.default)(e),o.default.DomEvent.on(window,"beforeunload",function(){return t.saveTracksToStorage()}),t.on("startedit",function(){return i.setEnabled(!1)}),t.on("elevation-shown",function(){return i.hideProfile()}),i.on("enabled",function(){t.stopEditLine()}),i.on("elevation-shown",function(){return t.hideElevationProfile()})}Object.defineProperty(t,"__esModule",{value:!0}),n(438),n(441);var a=n(2),o=i(a);n(437),n(200),n(179);var s=n(34),l=i(s);n(180);var u=n(115),d=i(u);n(215),n(214);var c=n(213);n(439),n(191),n(82),n(207),n(210),n(211);var h=n(187),f=i(h),p=n(190),m=i(p),v=n(188),g=i(v),y=n(117),b=i(y),k=n(212),_=i(k),w=n(175),x=i(w);n(189),n(183),n(182),n(178),t.default={setUp:r}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(169),a=i(r);n(440);var o=n(173),s=i(o),l=n(34),u=i(l);u.default.sentryDSN.length>0&&a.default.config(u.default.sentryDSN,{release:"2017-10-11_17:37:31-master-a0e3125-dirty\n"}).install();var d=window.onunhandledrejection;window.onunhandledrejection=function(e){var t=!0;d&&(t=d(e)),console.error("Uncaught in promise:",e.reason);var n=e.reason;return n&&n.name&&(n.name="Uncaught in promise: "+n.name),a.default.captureException(n),t},console.log("Version:","2017-10-11_17:37:31-master-a0e3125-dirty\n"),s.default.setUp()},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(){var e=[{group:"Default layers",layers:[{title:"OpenStreetMap",description:"OSM default style",order:10,isOverlay:!1,isDefault:!0,layer:o.default.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{code:"O",scaleDependent:!0,print:!0,jnx:!0})},{title:"ESRI Sat",order:20,isOverlay:!1,isDefault:!0,layer:o.default.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{code:"E",scaleDependent:!1,maxNativeZoom:17,print:!0,jnx:!0})},{title:"Yandex map",order:30,isOverlay:!1,isDefault:!0,layer:new o.default.Layer.Yandex("map",{scaleDependent:!0,code:"Y",print:!0,jnx:!0})},{title:"Yandex Satellite",order:40,isOverlay:!1,isDefault:!0,layer:new o.default.Layer.Yandex("sat",{scaleDependent:!1,code:"S",print:!0,jnx:!0})},{title:"Google",order:50,isOverlay:!1,isDefault:!0,layer:new o.default.Layer.Google("ROADMAP",{code:"G",scaleDependent:!0,print:!0,jnx:!0})},{title:"Google Satellite",order:60,isOverlay:!1,isDefault:!0,layer:new o.default.Layer.Google("SATELLITE",{code:"L",scaleDependent:!1,print:!0,jnx:!0})},{title:"Google Terrain",order:65,isOverlay:!1,isDefault:!0,layer:new o.default.Layer.Google("TERRAIN",{code:"P",scaleDependent:!1,print:!0,jnx:!0})},{title:"Bing Sat",order:70,isOverlay:!1,isDefault:!0,layer:o.default.bingLayer(l.default.bingKey,{code:"I",scaleDependent:!1,print:!0,jnx:!0})},{title:"marshruty.ru",order:80,isOverlay:!1,isDefault:!0,layer:o.default.tileLayer("http://maps.marshruty.ru/ml.ashx?x={x}&y={y}&z={z}&i=1&al=1",{code:"M",maxNativeZoom:18,noCors:!0,scaleDependent:!0,print:!0,jnx:!0})},{title:"Topomapper 1km",order:90,isOverlay:!1,isDefault:!0,layer:o.default.tileLayer("http://144.76.234.108/cgi-bin/tapp/tilecache.py/1.0.0/topomapper_v2/{z}/{x}/{y}.jpg",{code:"T",scaleDependent:!1,maxNativeZoom:13,noCors:!0,print:!0,jnx:!0})},{title:"Topo 10km",order:1010,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/topo001m/{z}/{x}/{y}",{code:"D",tms:!0,scaleDependent:!1,maxNativeZoom:9,print:!0,jnx:!0})},{title:"GGC 2 km",order:1020,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/ggc2000/{z}/{x}/{y}",{code:"N",tms:!0,scaleDependent:!1,maxNativeZoom:12,print:!0,jnx:!0})},{title:"ArbaletMO",order:1030,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/ArbaletMO/{z}/{x}/{y}",{code:"A",tms:!0,scaleDependent:!1,maxNativeZoom:13,print:!0,jnx:!0})},{title:"Slazav mountains",order:1040,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/map_hr/{z}/{x}/{y}",{code:"Q",tms:!0,scaleDependent:!1,maxNativeZoom:13,print:!0,jnx:!0})},{title:"GGC 1km",order:1050,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/ggc1000/{z}/{x}/{y}",{code:"J",tms:!0,scaleDependent:!1,maxNativeZoom:13,print:!0,jnx:!0})},{title:"Topo 1km",order:1060,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/topo1000/{z}/{x}/{y}",{code:"C",tms:!0,scaleDependent:!1,maxNativeZoom:13,print:!0,jnx:!0})},{title:"GGC 500m",order:1070,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/ggc500/{z}/{x}/{y}",{code:"F",tms:!0,scaleDependent:!1,maxNativeZoom:14,print:!0,jnx:!0})},{title:"Topo 500m",order:1080,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/topo500/{z}/{x}/{y}",{code:"B",tms:!0,scaleDependent:!1,maxNativeZoom:14,print:!0,jnx:!0})},{title:"GGC 250m",order:1090,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/ggc250/{z}/{x}/{y}",{code:"K",tms:!0,scaleDependent:!1,maxNativeZoom:15,print:!0,jnx:!0})},{title:"Slazav map",order:1100,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/map_podm/{z}/{x}/{y}",{code:"Z",tms:!0,scaleDependent:!1,maxNativeZoom:14,print:!0,jnx:!0})},{title:"O-sport",order:1110,isOverlay:!0,isDefault:!0,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/osport/{z}/{x}/{y}",{code:"R",tms:!0,scaleDependent:!1,maxNativeZoom:17,print:!0,jnx:!0})},{title:"Soviet topo maps grid",order:1120,isOverlay:!0,isDefault:!0,layer:new o.default.Layer.SovietTopoGrid({code:"Ng"})},{title:"Wikimapia",order:1130,isOverlay:!0,isDefault:!0,layer:new o.default.Wikimapia({code:"W"})},{title:"Mountain passes (Westra)",order:1140,isOverlay:!0,isDefault:!0,layer:new o.default.Layer.WestraPasses(l.default.westraDataBaseUrl,{code:"Wp",print:!0,scaleDependent:!0})}]},{group:"OpenStreetMap alternatives",layers:[{title:"OpenTopoMap",order:11,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{code:"Otm",maxNativeZoom:17,scaleDependent:!0,print:!0,jnx:!0,noCors:!0})},{title:"OpenCycleMap",description:'<a href="https://www.opencyclemap.org/docs/">(Info and key)</a>',order:12,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("http://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey="+l.default.thunderforestKey,{code:"Ocm",scaleDependent:!0,print:!0,jnx:!0})},{title:"OSM Outdoors",order:13,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("http://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey="+l.default.thunderforestKey,{code:"Oso",scaleDependent:!0,print:!0,jnx:!0})}]},{group:"Topo maps",layers:[{title:"Eurasia 25km",description:"1975-80",order:1009,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/eurasia25km/{z}/{x}/{y}",{code:"E25m",tms:!0,maxNativeZoom:9,print:!0,jnx:!0,scaleDependent:!1})},{title:"Caucasus 1km",order:1061,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/new_gsh_100k/{z}/{x}/{y}",{code:"NT1",tms:!0,maxNativeZoom:14,print:!0,jnx:!0,scaleDependent:!1})},{title:"Caucasus 500m",order:1081,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/new_gsh_050k/{z}/{x}/{y}",{code:"NT5",tms:!0,maxNativeZoom:15,print:!0,jnx:!0,scaleDependent:!1})},{title:"Topo 250m",order:1095,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/topo250/{z}/{x}/{y}",{code:"T25",tms:!0,maxNativeZoom:15,print:!0,jnx:!0,scaleDependent:!1})},{title:"Montenegro topo 250m",description:"1970-72",order:1096,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("http://{s}.tiles.nakarte.tk/montenegro250m/{z}/{x}/{y}",{code:"MN25",tms:!0,maxNativeZoom:15,print:!0,jnx:!0,scaleDependent:!1})}]},{group:"Mountains maps",layers:[{title:"Mountains by Aleksey Tsvetkov",description:'Tian Shan, Dzungaria, <a href="http://pereval.g-utka.ru/">http://pereval.g-utka.ru/</a>',order:1039,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("http://map.g-utka.ru/{z}/{x}/{y}.png",{code:"Mt",tms:!1,minZoom:7,minNativeZoom:7,maxNativeZoom:15,print:!0,jnx:!0,scaleDependent:!1,noCors:!0})}]},{group:'Norway <a href="https://www.ut.no/kart/">https://www.ut.no/kart/</a>',layers:[{title:"Norway UT map",order:500,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("https://tilesprod.ut.no/tilestache/ut_topo_light/{z}/{x}/{y}.jpg",{code:"Nu",tms:!1,maxNativeZoom:16,print:!0,jnx:!0,scaleDependent:!0,noCors:!0})},{title:"Norway paper map",order:1031,isOverlay:!0,isDefault:!1,layer:new o.default.TileLayer.Nordeskart("http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=toporaster3&zoom={z}&x={x}&y={y}&gkt={baatToken}",{code:"Np",maxNativeZoom:16,tms:!1,print:!0,jnx:!0,scaleDependent:!0})},{title:"Norway map",order:1032,isOverlay:!0,isDefault:!1,layer:new o.default.TileLayer.Nordeskart("http://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=topo2&zoom={z}&x={x}&y={y}&gkt={baatToken}",{code:"Nm",tms:!1,print:!0,jnx:!0,scaleDependent:!0})},{title:"Norway summer trails",order:2e3,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("https://tilesprod.ut.no/tilestache/dnt_sommer/{z}/{x}/{y}.png",{code:"Ns",tms:!1,print:!0,jnx:!0,scaleDependent:!0,noCors:!0})},{title:"Norway winter trails",order:2001,isOverlay:!0,isDefault:!1,layer:o.default.tileLayer("https://tilesprod.ut.no/tilestache/dnt_vinter/{z}/{x}/{y}.png",{code:"Nw",tms:!1,print:!0,jnx:!0,scaleDependent:!0,noCors:!0})},{title:"Norway roads",description:'<a href="http://kart.finn.no/">http://kart.finn.no/</a>',order:503,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("http://maptiles1.finncdn.no/tileService/1.0.3/normap/{z}/{x}/{y}.png",{code:"Nr",tms:!1,print:!0,jnx:!0,scaleDependent:!0,noCors:!0})}]},{group:'Czech <a href="http://mapy.cz">http://mapy.cz</a>',layers:[{title:"Czech basic",order:504,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("https://m{s}.mapserver.mapy.cz/base-m/{z}-{x}-{y}",{code:"Czb",tms:!1,print:!0,jnx:!0,subdomains:"1234",scaleDependent:!0})},{title:"Czhch tourist",order:505,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("https://m{s}.mapserver.mapy.cz/wturist-m/{z}-{x}-{y}",{code:"Czt",tms:!1,print:!0,jnx:!0,subdomains:"1234",scaleDependent:!0})},{title:"Czech summer",order:506,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("https://m{s}.mapserver.mapy.cz/turist_aquatic-m/{z}-{x}-{y}",{code:"Czs",tms:!1,print:!0,jnx:!0,subdomains:"1234",scaleDependent:!0})},{title:"Czech winter",order:507,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("https://m{s}.mapserver.mapy.cz/wturist_winter-m/{z}-{x}-{y}",{code:"Czw",tms:!1,print:!0,jnx:!0,subdomains:"1234",scaleDependent:!0})},{title:"Czech geographical",order:508,isOverlay:!1,isDefault:!1,layer:o.default.tileLayer("https://m{s}.mapserver.mapy.cz/zemepis-m/{z}-{x}-{y}",{code:"Czg",tms:!1,print:!0,jnx:!0,subdomains:"1234",scaleDependent:!0})}]}],t={},n={},i=!0,r=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var d=s.value,c=!0,h=!1,f=void 0;try{for(var p,m=d.layers[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var v=p.value;if(!v.layer.options)throw new Error("Layer without options: "+v.title);var g=v.layer.options.code;if(!g)throw new Error("Layer without code: "+v.title);if(g in t)throw new Error('Duplicate layer code "'+g+'"');t[g]=1;var y=v.order;if(!y)throw new Error("Layer without order: "+v.title);if(y in n)throw new Error('Duplicate layer order "'+y+'"');n[y]=1}}catch(b){h=!0,f=b}finally{try{!c&&m.return&&m.return()}finally{if(h)throw f}}}}catch(b){r=!0,a=b}finally{try{!i&&u.return&&u.return()}finally{if(r)throw a}}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=n(2),o=i(a);n(125),n(119),n(118);var s=n(34),l=i(s);n(224),n(123),n(217),n(225)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){n(this,e),this._maxSize=t,this._store={},this._size=0}return i(e,[{key:"get",value:function(e){if(e in this._store){var t=this._store[e];return delete this._store[e],this._store[e]=t,{value:t,found:!0}}return{found:!1}}},{key:"put",value:function(e,t){e in this._store?delete this._store[e]:this._size+=1,this._store[e]=t,this._size>this._maxSize&&(delete this._store[Object.keys(this._store)[0]],this._size-=1)}}]),e}();t.Cache=r},function(e,t,n){"use strict";function i(e){return new Promise(function(t){var n=new FileReader;n.onload=function(n){t({data:(0,a.arrayBufferToString)(n.target.result),filename:e.name})},n.readAsArrayBuffer(e)})}function r(e){return e=Array.prototype.slice.apply(e),Promise.all(e.map(i))}Object.defineProperty(t,"__esModule",{value:!0}),t.readFiles=t.readFile=t.selectFiles=void 0;var a=n(50),o=function(){var e=void 0;return function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&document.body.removeChild(e),e=document.createElement("input"),document.body.appendChild(e),e.type="file",e.multiple=!!t,e.style.display="none";var n=new Promise(function(t){e.addEventListener("change",function(){t(e.files)})});return e.click(),n}}();t.selectFiles=o,t.readFile=i,t.readFiles=r;
},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return e/180*Math.PI}function o(e){return e/Math.PI*180}function s(e,t){var n=a(e.lat),i=a(t.lat),r=a(e.lng),s=a(t.lng),l=Math.sin(s-r)*Math.cos(i),u=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(s-r),d=Math.atan2(l,u);return d=o(d)}function l(e,t){var n=c.default.Projection.SphericalMercator.project(e),i=c.default.Projection.SphericalMercator.project(t),r=i.subtract(n),a=Math.atan2(r.x,r.y);return o(a)}function u(e){return(Math.round(e)+360)%360}var d=n(2),c=i(d),h=n(474),f=i(h);n(31);var p=n(486),m=i(p);n(38),n(445);var v=n(127);n(232);var g=n(505),y=i(g),b=n(504),k=i(b),_=n(503),w=i(_),x=n(114);c.default.Control.Azimuth=c.default.Control.extend({options:{position:"bottomleft"},includes:c.default.Mixin.Events,initialize:function(e){c.default.Control.prototype.initialize.call(this,e),this._enabled=f.default.observable(!1),this.trueAzimuth=f.default.observable(null),this.magneticAzimuth=f.default.observable(null),this.distance=f.default.observable(null),this.points={start:null,end:null};var t=c.default.icon({iconUrl:y.default,iconSize:[30,30]}),n=c.default.icon({iconUrl:k.default,iconSize:[40,40]}),i=c.default.icon({iconUrl:w.default,iconSize:[40,40]});this.markers={single:c.default.marker([0,0],{icon:t,draggable:!0,which:"start"}).on("drag",this.onMarkerDrag,this).on("click",c.default.DomEvent.stopPropagation),start:c.default.marker([0,0],{icon:n,draggable:!0,which:"start",rotationOrigin:"center center"}).on("drag",this.onMarkerDrag,this).on("click",c.default.DomEvent.stopPropagation).on("dragend",this.onMarkerDragEnd,this),end:c.default.marker([0,0],{icon:i,draggable:!0,which:"end",rotationOrigin:"center center"}).on("drag",this.onMarkerDrag,this).on("click",c.default.DomEvent.stopPropagation).on("dragend",this.onMarkerDragEnd,this)},this.azimuthLine=c.default.polyline([],{interactive:!1,weight:1.5})},onAdd:function(e){this._map=e;var t=this._container=c.default.DomUtil.create("div","leaflet-control leaflet-control-button leaflet-control-azimuth");return this._stopContainerEvents(),t.innerHTML=m.default,t.title="Measure bearing, display line of sight",f.default.applyBindings(this,t),c.default.DomEvent.on(t,"click",this.onClick,this),t},onClick:function(){this.setExpanded(!0)},onMinimizeButtonClick:function(e){var t=this;setTimeout(function(){return t.setExpanded(!1)},0)},onMarkerDrag:function(e){var t=e.target;this.setPoints(r({},t.options.which,t.getLatLng()))},onMarkerDragEnd:function(){this.elevationControl&&this.showProfile()},setExpanded:function(e){!!e!==this.isExpanded()&&(e?c.default.DomUtil.addClass(this._container,"expanded"):(c.default.DomUtil.removeClass(this._container,"expanded"),this.hideProfile(),this.setPoints({start:null,end:null})),this.setEnabled(e))},setEnabled:function(e){!!e!==this.isEnabled()&&(e?(c.default.DomUtil.addClass(this._map._container,"azimuth-control-active"),this._map.on("click",this.onMapClick,this),this.fire("enabled")):(c.default.DomUtil.removeClass(this._map._container,"azimuth-control-active"),this._map.off("click",this.onMapClick,this)),this._map.clickLocked=e,this._enabled(!!e))},isEnabled:function(){return!!this._enabled()},onEnableButtonClick:function(){this.setEnabled(!this.isEnabled())},isExpanded:function(){return c.default.DomUtil.hasClass(this._container,"expanded")},setPoints:function(e){if(Object.assign(this.points,e),e=this.points,e.start&&!e.end?this.markers.single.setLatLng(e.start).addTo(this._map):this.markers.single.removeFrom(this._map),e.start&&e.end){var t=l(e.start,e.end);this.markers.start.setLatLng(e.start).addTo(this._map).setRotationAngle(t),this.markers.end.setLatLng(e.end).addTo(this._map).setRotationAngle(t),this.azimuthLine.setLatLngs([[e.start,e.end]]).addTo(this._map)}else this.markers.start.removeFrom(this._map),this.markers.end.removeFrom(this._map),this.azimuthLine.removeFrom(this._map);this.updateValuesDisplay()},updateValuesDisplay:function(){if(this.points.start&&this.points.end){var e=this.points,t=s(e.start,e.end);this.trueAzimuth(u(t));var n=(0,v.getDeclination)(e.start.lat,e.start.lng);null!==n?this.magneticAzimuth(u(t-n)):this.magneticAzimuth(null),this.distance(e.start.distanceTo(e.end))}else this.distance(null),this.trueAzimuth(null),this.magneticAzimuth(null)},onMapClick:function(e){this.points.start||this.points.end?this.points.start&&!this.points.end?this.setPoints({end:e.latlng}):this.points.start&&this.points.end&&(this.hideProfile(),this.setPoints({start:e.latlng,end:null})):this.setPoints({start:e.latlng})},showProfile:function(){var e=this;if(this.points.end){this.elevationControl&&this.elevationControl.removeFrom(this._map);var t=this.points.start.distanceTo(this.points.end);this.elevationControl=new x.ElevationProfile(this._map,[this.points.start,this.points.end],{samplingInterval:(0,x.calcSamplingInterval)(t),sightLine:!0}),this.elevationControl.on("remove",function(){return e.elevationControl=null}),this.fire("elevation-shown")}},hideProfile:function(){this.elevationControl&&this.elevationControl.removeFrom(this._map),this.elevationControl=null},onProfileButtonClick:function(){this.showProfile()},onReverseButtonClick:function(){this.points.end&&this.points.start&&(this.setPoints({start:this.points.end,end:this.points.start}),this.elevationControl&&this.showProfile())}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(446),n(31),a.default.Control.Caption=a.default.Control.extend({options:{position:"bottomright",className:"leaflet-control-caption"},initialize:function(e,t){a.default.setOptions(this,t),this._contents=e},onAdd:function(e){return this._map=e,this._container=a.default.DomUtil.create("div",this.options.className),this._stopContainerEvents(),this._container.innerHTML=this._contents,a.default.DomEvent.on(this._container,"contextmenu",function(e){return a.default.DomEvent.stopPropagation(e),e.returnValue=!0,!0}),this._container},setContents:function(e){this._contents=e,this._map&&(this._container.innerHTML=this._contents)}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=e.indexOf(".");n===-1&&(n=e.length);var i=t-n;return i>0&&(e=Array(i+1).join("0")+e),e}function a(e,t){return(e%t+t)%t}function o(e){return a(e+180,360)-180}var s=n(2),l=i(s);n(447);var u=n(79),d=i(u),c=n(56),h=i(c);n(31);var f=n(63),p=i(f);n(38),l.default.Control.Coordinates=l.default.Control.extend({options:{position:"bottomleft"},formatNames:{d:"ddd.ddddd",D:"ddd.ddddd&deg",DM:"ddd&deg;mm.mmm'",DMS:"ddd&deg;mm'ss.s\""},onAdd:function(e){this._map=e;var t=this._container=l.default.DomUtil.create("div","leaflet-control leaflet-control-button leaflet-control-coordinates");return t.title="Show coordinates at cursor",this._stopContainerEvents(),this._field_lat=l.default.DomUtil.create("div","leaflet-control-coordinates-text",t),this._field_lon=l.default.DomUtil.create("div","leaflet-control-coordinates-text",t),l.default.DomEvent.on(t,{click:this.onClick},this),this.menu=new h.default([{text:"Click map to copy coordinates to clipboard",callback:this.prepareForClickOnMap.bind(this)},"-",{text:"&plusmn;ddd.ddddd",callback:this.onMenuSelect.bind(this,"d")},{text:"ddd.ddddd&deg;",callback:this.onMenuSelect.bind(this,"D")},{text:"ddd&deg;mm.mmm'",callback:this.onMenuSelect.bind(this,"DM")},{text:"ddd&deg;mm'ss.s\"",callback:this.onMenuSelect.bind(this,"DMS")}]),this.loadStateFromStorage(),this.onMouseMove(),l.default.DomEvent.on(t,"contextmenu",this.onRightClick,this),t},loadStateFromStorage:function(){var e=!1,t="D";e="1"===p.default.leafletCoordinatesActive,t=p.default.leafletCoordinatesFmt||t,this.setEnabled(e),this.setFormat(t)},saveStateToStorage:function(){p.default.leafletCoordinatesActive=this.isEnabled()?"1":"0",p.default.leafletCoordinatesFmt=this.fmt},formatCoodinate:function(e,t,n){if(void 0===e||isNaN(e))return"-------";n=n||this.fmt;var i,a,o,s;return i=t?e<0?"S":"N":e<0?"W":"E","d"===n?(a=e.toFixed(5),a=r(a,t?2:3)):(e=Math.abs(e),"D"===n?(a=e.toFixed(5),a=r(a,t?2:3),i+" "+a+"&deg;"):"DM"===n?(a=Math.floor(e).toString(),a=r(a,t?2:3),o=(60*(e-a)).toFixed(3),o=r(o,2),i+" "+a+"&deg;"+o+"'"):"DMS"===n?(a=Math.floor(e).toString(),a=r(a,t?2:3),o=Math.floor(60*(e-a)).toString(),o=r(o,2),s=(3600*(e-a-o/60)).toFixed(2),s=r(s,2),i+" "+a+"&deg;"+o+"'"+s+'"'):void 0)},onMenuSelect:function(e){this.setFormat(e),this.saveStateToStorage()},setFormat:function(e){this.fmt=e,this.onMouseMove()},onMouseMove:function(e){var t,n;if(e){var i=e.latlng;t=i.lat,n=i.lng}n=o(n),this._field_lat.innerHTML=this.formatCoodinate(t,!0),this._field_lon.innerHTML=this.formatCoodinate(n,!1)},setEnabled:function(e){!!e!==this.isEnabled()&&(e?(l.default.DomUtil.addClass(this._container,"expanded"),l.default.DomUtil.addClass(this._map._container,"coordinates-control-active"),this._map.on("mousemove",this.onMouseMove,this),this._map.on("contextmenu",this.onMapRightClick,this)):(l.default.DomUtil.removeClass(this._container,"expanded"),l.default.DomUtil.removeClass(this._map._container,"coordinates-control-active"),this._map.off("contextmenu",this.onMapRightClick,this),this._map.off("mousemove",this.onMouseMove,this)))},onMapRightClick:function(e){for(var t=this,n=[{text:"<b>Copy coordinates to clipboard</b>",header:!0},"-"],i=e.latlng.lat,r=o(e.latlng.lng),a=["d","D","DM","DMS"],s=function(){var o=a[l],s=t.formatCoodinate(i,!0,o),u=t.formatCoodinate(r,!1,o),c=s+" "+u;n.push({text:c+' <span class="leaflet-coordinates-menu-fmt">'+t.formatNames[o]+"</span>",callback:function(){(0,d.default)(c.replace(/&deg;/g,""),e.originalEvent)}})},l=0;l<a.length;l++)s();var u=new h.default(n);u.show(e)},isEnabled:function(){return l.default.DomUtil.hasClass(this._container,"expanded")},onClick:function(e){this.setEnabled(!this.isEnabled()),this.saveStateToStorage(),this.onMouseMove()},onRightClick:function(e){this.menu.show(e)},onMapClick:function(e){var t=this.formatCoodinate(e.latlng.lat,!0)+" "+this.formatCoodinate(e.latlng.lng,!1);t=t.replace(/&deg;/g,""),(0,d.default)(t,e.originalEvent)},prepareForClickOnMap:function(){this._map.once("click",this.onMapClick,this)}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.BinStream=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(110),s=i(o),l=function(){function e(t,n){r(this,e),this.maxSize=1024,this.dv=new DataView(new ArrayBuffer(this.maxSize)),this._pos=0,this.size=0,this.littlEndian=n}return a(e,[{key:"grow",value:function(){this.maxSize*=2;var e=this.dv.buffer;this.dv=new DataView(new ArrayBuffer(this.maxSize));for(var t=new Uint8Array(this.dv.buffer),n=new Uint8Array(e),i=0;i<n.length;i++)t[i]=n[i]}},{key:"checkSize",value:function(e){this._pos+e>=this.maxSize&&this.grow();var t=this._pos+e;this.size=t>this.size?t:this.size}},{key:"writeUint8",value:function(e){this.checkSize(1),this.dv.setUint8(this._pos,e),this._pos+=1}},{key:"writeInt8",value:function(e){this.checkSize(1),this.dv.setInt8(this._pos,e),this._pos+=1}},{key:"writeInt16",value:function(e){this.checkSize(2),this.dv.setInt16(this._pos,e,this.littlEndian),this._pos+=2}},{key:"writeUint16",value:function(e){this.checkSize(2),this.dv.setUint16(this._pos,e,this.littlEndian),this._pos+=2}},{key:"writeInt32",value:function(e){this.checkSize(4),this.dv.setInt32(this._pos,e,this.littlEndian),this._pos+=4}},{key:"writeUint32",value:function(e){this.checkSize(4),this.dv.setUint32(this._pos,e,this.littlEndian),this._pos+=4}},{key:"writeString",value:function(e,t){e=s.default.encode(e);for(var n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));t&&this.writeUint8(0)}},{key:"tell",value:function(){return this._pos}},{key:"seek",value:function(e){this._pos=e}},{key:"getBuffer",value:function(){return this.dv.buffer.slice(0,this.size)}}]),e}();t.BinStream=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(115),n(61),a.default.Control.JNX.include(a.default.Mixin.HashState),a.default.Control.JNX.include({stateChangeEvents:["selectionchange"],serializeState:function(){var e=void 0;if(this._selector){var t=this._selector.getBounds();e=[t.getSouth().toFixed(5),t.getWest().toFixed(5),t.getNorth().toFixed(5),t.getEast().toFixed(5)]}return e},unserializeState:function(e){function t(e,t,n){if(e=parseFloat(e),isNaN(e)||e<t||e>n)throw new Error("INVALID VALUE");return e}if(e&&4===e.length){try{var n=t(e[0],-86,86),i=t(e[1],-180,180),r=t(e[2],-86,86),a=t(e[3],-180,180)}catch(o){if("INVALID VALUE"===o.message)return!1;throw o}return this.removeSelector(),this.addSelector([[n,i],[r,a]]),!0}return!1}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r),o=n(51),s=i(o);n(449),n(31);var l=n(186),u=n(56),d=i(u),c=n(185),h=n(64),f=n(35),p=n(23),m=i(p);a.default.Control.JNX=a.default.Control.extend({includes:a.default.Mixin.Events,initialize:function(e,t){var n=this;a.default.Control.prototype.initialize.call(this,t),this._layersControl=e,this.makingJnx=s.default.observable(!1),this.downloadProgressRange=s.default.observable(1),this.downloadProgressDone=s.default.observable(0),this.contextMenu=new d.default(function(){return n.makeMenuItems()})},getLayerForJnx:function(){var e={},t=!0,n=!1,i=void 0;try{for(var r,a=this._layersControl._layers[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value,s=o.layer;this._map.hasLayer(s)&&s.options&&s.options.jnx&&(e={layer:s,layerName:o.name})}}catch(l){n=!0,i=l}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}return e},estimateTilesCount:function(e){for(var t=0,n=this._selector.getBounds(),i=(0,c.minZoom)(e);i<=e;i++){var r=this._map.project(n.getNorthWest(),i).divideBy(256).floor(),a=this._map.project(n.getSouthEast(),i).divideBy(256).ceil();t+=Math.ceil((a.x-r.x)*(a.y-r.y))}return t},makeMenuItems:function(){var e=this,t=this.getLayerForJnx(),n=t.layer,i=t.layerName;if(!n)return[{text:"No supported layer"}];for(var r=n.options.maxNativeZoom||n.options.maxZoom||18,a=Math.max(0,r-6),o=40075016,s=this._selector.getBounds().getCenter().lat,l=o/Math.pow(2,r)/256*Math.cos(s/180*Math.PI),u=[{text:i,header:!0}],d=function(t){var r=e.estimateTilesCount(t),a=.02*r,o=r>5e4?"jnx-menu-warning":"",s=l.toFixed(2),d=a.toFixed(a>1?0:1),c={text:'<span class="'+o+'">Zoom '+t+" ("+s+" m/pixel) &mdash; "+r+" tiles (~"+d+" Mb)</span>",callback:function(){return e.makeJnx(n,i,t)},disabled:e.makingJnx()};u.push(c),l*=2},c=r;c>=a;c-=1)d(c);return u},notifyProgress:function(e,t){this.downloadProgressDone(this.downloadProgressDone()+e),this.downloadProgressRange(t)},makeJnx:function(e,t,n){var i=this;m.default.captureBreadcrumbWithUrl({message:"start making jnx"}),this.makingJnx(!0),this.downloadProgressDone(0);var r=this._selector.getBounds(),a=t.toLowerCase().replace(/[ ()]+/,"_"),o="nakarte.tk_"+a+"_z"+n+".jnx";(0,c.makeJnxFromLayer)(e,t,n,r,this.notifyProgress.bind(this)).then(function(e){return(0,h.saveAs)(e,o,!0)}).catch(function(e){m.default.captureException(e),(0,f.notify)("Failed to create JNX: "+e.message)}).then(function(){return i.makingJnx(!1)})},onAdd:function(e){this._map=e;var t=this._container=a.default.DomUtil.create("div","leaflet-control leaflet-control-jnx");return t.innerHTML='\n                <a class="button" data-bind="visible: !makingJnx(), click: onButtonClicked"\n                 title="Make JNX for Garmin receivers">JNX</a>\n                <div data-bind="\n                    component:{\n                        name: \'progress-indicator\',\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                    },\n                    visible: makingJnx()"></div>',s.default.applyBindings(this,t),this._stopContainerEvents(),t},removeSelector:function(){this._selector&&(this._map.removeLayer(this._selector),this._selector=null,this.fire("selectionchange"))},addSelector:function(e){var t=this;e||(e=this._map.getBounds().pad(-.25)),this._selector=new l.RectangleSelect(e).addTo(this._map).on("change",function(){return t.fire("selectionchange")}).on("click contextmenu",function(e){return t.contextMenu.show(e)}),this.fire("selectionchange")},onButtonClicked:function(){this._selector?this._selector.getBounds().intersects(this._map.getBounds().pad(-.05))?this.removeSelector():(this.removeSelector(),this.addSelector()):this.addSelector()}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){function t(e){return Math.round(e/180*2147483647)}return[t(e.north),t(e.east),t(e.south),t(e.west)]}Object.defineProperty(t,"__esModule",{value:!0}),t.JnxWriter=void 0;var a=n(2),o=i(a),s=n(181),l=o.default.Class.extend({initialize:function(e,t,n){this.tiles={},this.productName=e||"Raster map",this.productId=t||0,this.zOrder=n},addTile:function(e,t,n){this.tiles[t]=this.tiles[t]||[],e=new Blob([e]).slice(2);var i={west:n.getWest(),north:n.getNorth(),south:n.getSouth(),east:n.getEast()};this.tiles[t].push({data:e,extents:i})},getJnx:function(){var e=52,t=17,n=28,i=0,a=!0,o=!1,l=void 0;try{for(var u,d=Object.values(this.tiles)[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var c=u.value;i+=c.length}}catch(h){o=!0,l=h}finally{try{!a&&d.return&&d.return()}finally{if(o)throw l}}if(0===i)throw new Error("No tiles collected, JNX is empty");if(i>5e4)throw new Error("Too many tiles found (more then 50000)");var f=1e10,p=-1e10,m=-1e10,v=1e10,g=Object.keys(this.tiles).length,y=void 0,b=void 0,k=void 0,_=void 0,w=void 0,x=!0,L=!1,S=void 0;try{for(var C,M=Object.values(this.tiles)[Symbol.iterator]();!(x=(C=M.next()).done);x=!0){var q=C.value,T=!0,P=!1,I=void 0;try{for(var D,O=q[Symbol.iterator]();!(T=(D=O.next()).done);T=!0){var E=D.value;f=f<E.extents.west?f:E.extents.west,p=p>E.extents.east?p:E.extents.east,m=m>E.extents.north?m:E.extents.north,v=v<E.extents.south?v:E.extents.south}}catch(h){P=!0,I=h}finally{try{!T&&O.return&&O.return()}finally{if(P)throw I}}}}catch(h){L=!0,S=h}finally{try{!x&&M.return&&M.return()}finally{if(L)throw S}}var z=new s.BinStream(1024,(!0));z.writeInt32(4),z.writeInt32(0),k=r({south:v,north:m,west:f,east:p}),z.writeInt32(k[0]),z.writeInt32(k[1]),z.writeInt32(k[2]),z.writeInt32(k[3]),z.writeInt32(g),z.writeInt32(0),z.writeInt32(this.productId),z.writeInt32(0),z.writeInt32(0),z.writeUint32(0),z.writeInt32(this.zOrder),z.seek(e+t*g),z.writeInt32(9),z.writeString("12345678-1234-1234-1234-123456789ABC",!0),z.writeString(this.productName,!0),z.writeString("",!0),z.writeInt16(this.productId),z.writeString(this.productName,!0),z.writeInt32(g);var j=!0,Z=!1,N=void 0;try{for(var W,R=Object.keys(this.tiles)[Symbol.iterator]();!(j=(W=R.next()).done);j=!0)y=W.value,z.writeString("",!0),z.writeString("",!0),z.writeString("",!0),z.writeInt32(y)}catch(h){Z=!0,N=h}finally{try{!j&&R.return&&R.return()}finally{if(Z)throw N}}var K=z.tell(),U=void 0;z.seek(e);var A=!0,G=!1,B=void 0;try{for(var F,J=Object.keys(this.tiles)[Symbol.iterator]();!(A=(F=J.next()).done);A=!0)y=F.value,y=parseInt(y,10),z.writeInt32(this.tiles[y].length),z.writeUint32(K),U=34115555/Math.pow(2,y)*Math.cos((m+v)/2/180*Math.PI)/1.1,z.writeInt32(U),z.writeInt32(2),z.writeUint8(0),K+=n*this.tiles[y].length}catch(h){G=!0,B=h}finally{try{!A&&J.return&&J.return()}finally{if(G)throw B}}z.seek(z.size);var H=K,X=!0,Y=!1,V=void 0;try{for(var Q,$=Object.keys(this.tiles)[Symbol.iterator]();!(X=(Q=$.next()).done);X=!0)for(y=Q.value,b=this.tiles[y],_=0;_<b.length;_++)w=b[_],k=r(w.extents),z.writeInt32(k[0]),z.writeInt32(k[1]),z.writeInt32(k[2]),z.writeInt32(k[3]),z.writeInt16(256),z.writeInt16(256),z.writeInt32(w.data.size),z.writeUint32(H),H+=w.data.size}catch(h){Y=!0,V=h}finally{try{!X&&$.return&&$.return()}finally{if(Y)throw V}}var ee=[];ee.push(z.getBuffer());var te=!0,ne=!1,ie=void 0;try{for(var re,ae=Object.keys(this.tiles)[Symbol.iterator]();!(te=(re=ae.next()).done);te=!0)for(y=re.value,b=this.tiles[y],_=0;_<b.length;_++)w=b[_],ee.push(w.data)}catch(h){ne=!0,ie=h}finally{try{!te&&ae.return&&ae.return()}finally{if(ne)throw ie}}return ee.push("BirdsEye"),new Blob(ee)}});t.JnxWriter=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e){return Math.max(e-4,0)}function o(e){var t="data:image/png;base64,"+btoa((0,m.arrayBufferToString)(e)),n=new Image;return new Promise(function(e,i){n.onload=function(){return e(n)},n.onerror=function(){return i(new Error("Tile image corrupt"))},n.src=t})}function s(e){return e?"PNG"===(0,m.arrayBufferToString)(e.slice(0,4))&&"IENDB`"===(0,m.arrayBufferToString)(e.slice(-8))?l(e):""===(0,m.arrayBufferToString)(e.slice(0,2))&&""===(0,m.arrayBufferToString)(e.slice(-2))?Promise.resolve(e):null:null}Object.defineProperty(t,"__esModule",{value:!0}),t.minZoom=t.makeJnxFromLayer=void 0;var l=function(){var e=r(regeneratorRuntime.mark(function e(t){var n,i,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o(t);case 3:t=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:return n=document.createElement("canvas"),n.width=t.width,n.height=t.height,i=n.getContext("2d"),i.drawImage(t,0,0),r=n.toDataURL("image/jpeg"),a=atob(r.replace(/^data:image\/jpeg;base64,/,"")),e.abrupt("return",(0,m.stringToArrayBuffer)(a));case 17:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=r(regeneratorRuntime.mark(function e(t,n,i,r,o){var l,u,d,m,g,y,b,k,_,w,x,L,S,C,M,q,T,P,I,D,O,E,z,j,Z,N,W,R,K,U,A;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l=c.default.stamp(t),u=Math.min(l,100),d=new h.JnxWriter(n,l,u),m=new p.XHRQueue,g=!1,y=void 0,b=a(i),k=1,_=i;case 9:if(!(_>=b)){e.next=95;break}return w=c.default.bounds(c.default.CRS.EPSG3857.latLngToPoint(r.getNorthWest(),_).round(),c.default.CRS.EPSG3857.latLngToPoint(r.getSouthEast(),_).round()),x=[],L=t.cloneForPrint({xhrQueue:m}),S=(0,f.getTempMap)(_,L._rasterizeNeedsFullSizeMap,w),S.addLayer(L),e.next=17,L.getTilesInfo({xhrOptions:v,pixelBounds:w,rawData:!0});case 17:for(C=e.sent,M=C.iterateTilePromises,q=C.count,T=!0,P=!1,I=void 0,e.prev=23,D=M()[Symbol.iterator]();!(T=(O=D.next()).done);T=!0)E=O.value,x.push(E);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),P=!0,I=e.t0;case 31:e.prev=31,e.prev=32,!T&&D.return&&D.return();case 34:if(e.prev=34,!P){e.next=37;break}throw I;case 37:return e.finish(34);case 38:return e.finish(31);case 39:z=!0,j=!1,Z=void 0,e.prev=42,N=x[Symbol.iterator]();case 44:if(z=(W=N.next()).done){e.next=73;break}return R=W.value.tilePromise,K=void 0,e.prev=47,e.next=50,R;case 50:K=e.sent,e.next=58;break;case 53:return e.prev=53,e.t1=e.catch(47),y=e.t1,g=!0,e.abrupt("break",73);case 58:if(U=K.image,null!==U&&200===U.status&&U.response&&U.response.byteLength){e.next=61;break}return e.abrupt("continue",70);case 61:return e.next=63,s(U.response);case 63:if(A=e.sent){e.next=68;break}return y=new Error("Tile image invalid"),g=!0,e.abrupt("break",73);case 68:d.addTile(A,_,K.latLngBounds),o(k/q,4/3);case 70:z=!0,e.next=44;break;case 73:e.next=79;break;case 75:e.prev=75,e.t2=e.catch(42),j=!0,Z=e.t2;case 79:e.prev=79,e.prev=80,!z&&N.return&&N.return();case 82:if(e.prev=82,!j){e.next=85;break}throw Z;case 85:return e.finish(82);case 86:return e.finish(79);case 87:if((0,f.disposeMap)(S),!g){e.next=91;break}throw x.forEach(function(e){return e.abortLoading()}),y;case 91:k/=4;case 92:_--,e.next=9;break;case 95:return e.abrupt("return",d.getJnx());case 96:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38],[42,75,79,87],[47,53],[80,,82,86]])}));return function(t,n,i,r,a){return e.apply(this,arguments)}}(),d=n(2),c=i(d),h=n(184),f=n(122),p=n(24),m=n(50),v={responseType:"arraybuffer",timeout:2e4,isResponseSuccess:function(e){return 200===e.status||404===e.status}};t.makeJnxFromLayer=u,t.minZoom=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleSelect=void 0;var r=n(2),a=i(r),o=a.default.Rectangle.extend({includes:a.default.Mixin.Events,options:{opacity:1,weight:.5,fillOpacity:.2,color:"#3388ff",fillColor:"#3388ff"},onAdd:function(e){a.default.Rectangle.prototype.onAdd.call(this,e),this.markers=[];for(var t=["top","right","bottom","left"],n=0;n<t.length;n++){var i=t[n],r=a.default.marker([0,0],{icon:a.default.divIcon({className:"leaflet-rectangle-select-edge edge-"+i}),draggable:!0}).addTo(e);r.on({drag:this.onMarkerDrag,dragend:this.onMarkerDragEnd},this),this.markers[i]=r}this.placeMarkers(),e.on("zoomend",this.placeMarkers,this)},placeMarkers:function(){var e=this.getBounds(),t=this._map.project(e.getNorthWest()),n=this._map.project(e.getSouthEast()),i=n.subtract(t),r=t.add(i.divideBy(2));r=this._map.unproject(r),this.markers.top.setLatLng([e.getNorth(),r.lng]),this.markers.top._icon.style.width=i.x+"px",this.markers.top._icon.style.marginLeft="-"+i.x/2+"px",this.markers.right.setLatLng([r.lat,e.getEast()]),this.markers.right._icon.style.height=i.y+"px",this.markers.right._icon.style.marginTop="-"+i.y/2+"px",this.markers.bottom.setLatLng([e.getSouth(),r.lng]),this.markers.bottom._icon.style.width=i.x+"px",this.markers.bottom._icon.style.marginLeft="-"+i.x/2+"px",this.markers.left.setLatLng([r.lat,e.getWest()]),this.markers.left._icon.style.height=i.y+"px",this.markers.left._icon.style.marginTop="-"+i.y/2+"px"},onRemove:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=Object.values(this.markers)[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;this._map.removeLayer(s)}}catch(l){n=!0,i=l}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}this.markers=null,e.off("zoomend",this.placeMarkers,this),a.default.Rectangle.prototype.onRemove.call(this,e)},setBoundsFromMarkers:function(){this.setBounds([[this.markers.top.getLatLng().lat,this.markers.left.getLatLng().lng],[this.markers.bottom.getLatLng().lat,this.markers.right.getLatLng().lng]])},onMarkerDrag:function(){this.setBoundsFromMarkers()},onMarkerDragEnd:function(){this.setBoundsFromMarkers(),this.placeMarkers(),this.fire("change")}});t.RectangleSelect=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(!e._adaptiveHeightEnabled){var t=e.onAdd;return o.default.Util.extend(e,{_adaptiveHeightEnabled:!0,onAdd:function(e){var n=this,i=t.call(this,e);return this.__setupResizeEventsHandler(),setTimeout(function(){return n.__setAdaptiveHeight()},0),i},__setupResizeEventsHandler:function(){this._map.on("resize",this.__setAdaptiveHeight,this)},__setAdaptiveHeight:function(){var e=this._map.getSize().y,t=void 0;t=e-this._container.offsetTop-(this._container.parentNode.offsetHeight-this._container.offsetTop-this._container.offsetHeight)-70,this._form.style.maxHeight=t+"px"}}),e._map&&(e.__setupResizeEventsHandler(),setTimeout(function(){return e.__setAdaptiveHeight()},0)),e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=i(a);n(450),t.default=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){var n,i=e.onAdd,a=e.unserializeState,s=e._addItem;e._configEnabled||((0,d.default)(e),l.default.Util.extend(e,{_configEnabled:!0,_allLayersGroups:t,_allLayers:(n=[]).concat.apply(n,r(t.map(function(e){return e.layers}))),_customLayers:h.default.observableArray(),onAdd:function(e){var t=i.call(this,e);return this.__injectConfigButton(),t},__injectConfigButton:function(){var e=l.default.DomUtil.create("div","button icon-settings");e.title="Configure layers",this._topRow.appendChild(e),l.default.DomEvent.on(e,"click",this._onConfigButtonClick,this);var t=l.default.DomUtil.create("div","button icon-edit");t.title="Add custom layer",this._topRow.appendChild(t),l.default.DomEvent.on(t,"click",this.onCustomLayerCreateClicked,this)},_initializeLayersState:function(){var e=this,t={},n=g.default.getItem("layersEnabled");if(n)try{t=JSON.parse(n)}catch(i){m.default.captureMessage("Failed to load enabled layers from localstorage - invalid json",{extra:{"localstorage.layersEnabled":n.slice(0,1e3)}})}Object.keys(t).forEach(function(t){return e.loadCustomLayerFromString(t)});for(var a=[].concat(r(this._allLayers),r(this._customLayers())),o=0;o<a.length;o++){var s=a[o],l=t[s.layer.options.code];"undefined"==typeof l&&(l=s.isDefault),s.enabled=l,s.checked=h.default.observable(l),s.description=s.description||""}this.updateEnabledLayers()},_onConfigButtonClick:function(){this.showLayersSelectWindow()},_initLayersSelectWindow:function(){if(!this._configWindow){var e=this._configWindow=l.default.DomUtil.create("div","leaflet-layers-dialog-wrapper");l.default.DomEvent.disableClickPropagation(e).disableScrollPropagation(e),e.innerHTML='\n<div class="leaflet-layers-select-window">\n    <form>\n        <!-- ko foreach: _allLayersGroups -->\n            <div class="section-header" data-bind="html: group"></div>\n            <!-- ko foreach: layers -->\n                <label>\n                    <input type="checkbox" data-bind="checked: checked"/>\n                    <span data-bind="text: title">\n                    </span><!--  ko if: description -->\n                    <span data-bind="html: description || \'\'"></span>\n                    <!-- /ko -->\n                </label>\n            <!-- /ko -->\n        <!-- /ko -->\n        <div data-bind="if: _customLayers().length" class="section-header">Custom layers</div>\n        <!-- ko foreach: _customLayers -->\n                <label>\n                    <input type="checkbox" data-bind="checked: checked"/>\n                    <span data-bind="text: title"></span>\n                </label>\n        <!-- /ko -->\n    </form>\n    <div class="buttons-row">\n        <div href="#" class="button" data-bind="click: onSelectWindowOkClicked">Ok</div>\n        <div href="#" class="button" data-bind="click: onSelectWindowCancelClicked">Cancel</div>\n        <div href="#" class="button" data-bind="click: onSelectWindowResetClicked">Reset</div>\n    </div>            \n</div>\n                ',h.default.applyBindings(this,e)}},showLayersSelectWindow:function(){this._configWindowVisible||([].concat(r(this._allLayers),r(this._customLayers())).forEach(function(e){return e.checked(e.enabled)}),this._initLayersSelectWindow(),this._map._controlContainer.appendChild(this._configWindow),this._configWindowVisible=!0)},hideSelectWindow:function(){this._configWindowVisible&&(this._map._controlContainer.removeChild(this._configWindow),this._configWindowVisible=!1)},onSelectWindowCancelClicked:function(){this.hideSelectWindow()},onSelectWindowResetClicked:function(){this._configWindow&&[].concat(r(this._allLayers),r(this._customLayers())).forEach(function(e){return e.checked(e.isDefault)})},onSelectWindowOkClicked:function(){[].concat(r(this._allLayers),r(this._customLayers())).forEach(function(e){return e.enabled=e.checked()}),this.updateEnabledLayers(),this.hideSelectWindow()},onCustomLayerCreateClicked:function(){var e=this;this.showCustomLayerForm([{caption:"Add layer",callback:function(t){
return e.onCustomLayerAddClicked(t)}},{caption:"Cancel",callback:function(){return e.onCustomLayerCancelClicked()}}],{name:"Custom layer",url:"",tms:!1,maxZoom:18,isOverlay:!1,scaleDependent:!1})},updateEnabledLayers:function(){var e=this,t=[].concat(r(this._allLayers),r(this._customLayers())).filter(function(e){return!e.enabled});t.forEach(function(t){return e._map.removeLayer(t.layer)}),[].concat(r(this._layers)).forEach(function(t){return e.removeLayer(t.layer)});var n=!1,i=[].concat(r(this._allLayers),r(this._customLayers())).filter(function(e){return e.enabled});if(i.sort(function(e,t){return e.order-t.order}),i.forEach(function(t){t.isOverlay?e.addOverlay(t.layer,t.title):e.addBaseLayer(t.layer,t.title),!t.isOverlay&&e._map.hasLayer(t.layer)&&(n=!0)}),!n){var a=!0,o=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value;if(!d.isOverlay){this._map.addLayer(d.layer);break}}}catch(c){o=!0,s=c}finally{try{!a&&u.return&&u.return()}finally{if(o)throw s}}}this.storeEnabledLayers()},storeEnabledLayers:function(){for(var e={},t=[].concat(r(this._allLayers),r(this._customLayers())),n=0;n<t.length;n++){var i=t[n];(i.isDefault||i.enabled||i.isCustom)&&(e[i.layer.options.code]=i.enabled)}var a=JSON.stringify(e);g.default.setItem("layersEnabled",a)},unserializeState:function(e){var t=this;if(e){e=e.map(function(e){var n=t.loadCustomLayerFromString(e);return n||e});for(var n=[].concat(r(this._allLayers),r(this._customLayers())),i=0;i<n.length;i++){var o=n[i];o.layer.options&&e.includes(o.layer.options.code)&&(o.enabled=!0)}this.updateEnabledLayers()}return this.storeEnabledLayers(),a.call(this,e)},showCustomLayerForm:function(e,t){function n(e){var t={name:r.name.value.trim(),url:r.url.value.trim(),tms:r.tms.checked,scaleDependent:r.scaleDependent.checked,maxZoom:r.maxZoom.value,isOverlay:"yes"===r.querySelector('input[name="overlay"]:checked').value};e(t)}if(!this._customLayerWindow){this._customLayerWindow=l.default.DomUtil.create("div","leaflet-layers-dialog-wrapper",this._map._controlContainer),l.default.DomEvent.disableClickPropagation(this._customLayerWindow).disableScrollPropagation(this._customLayerWindow);var i=l.default.DomUtil.create("div","custom-layers-window",this._customLayerWindow),r=l.default.DomUtil.create("form","",i),a="",s=!0,u=!1,d=void 0;try{for(var c,h=e.entries()[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var f=o(c.value,2),p=f[0],m=f[1];a+='<a class="button" name="btn-'+p+'">'+m.caption+"</a>"}}catch(v){u=!0,d=v}finally{try{!s&&h.return&&h.return()}finally{if(u)throw d}}l.default.DomEvent.on(r,"submit",l.default.DomEvent.preventDefault),r.innerHTML='\n<p><a href="http://leafletjs.com/reference-1.0.2.html#tilelayer" target="_blank">See Leaflet TileLayer documentation for url format</a></p>\n<label>Layer name<br/>\n<input name="name"/></label><br/>\n<label>Tile url template<br/>\n<textarea name="url" style="width: 100%"></textarea></label><br/>\n<label><input type="radio" name="overlay" value="no">Base layer</label><br/>\n<label><input type="radio" name="overlay" value="yes">Overlay</label><br/>\n<label><input type="checkbox" name="scaleDependent"/>Content depends on scale(like OSM or Google maps)</label><br/>\n<label><input type="checkbox" name="tms" />TMS rows order</label><br />\n\n<label>Max zoom<br>\n<select name="maxZoom">\n<option value="9">9</option>\n<option value="10">10</option>\n<option value="11">11</option>\n<option value="12">12</option>\n<option value="13">13</option>\n<option value="14">14</option>\n<option value="15">15</option>\n<option value="16">16</option>\n<option value="17">17</option>\n<option value="18" selected>18</option>\n</select></label>\n<br />\n'+a,r.name.value=t.name,r.url.value=t.url,r.tms.checked=t.tms,r.scaleDependent.checked=t.scaleDependent,r.maxZoom.value=t.maxZoom,r.overlay[t.isOverlay?1:0].checked=!0;var g=!0,y=!1,b=void 0;try{for(var k,_=e.entries()[Symbol.iterator]();!(g=(k=_.next()).done);g=!0){var w=o(k.value,2),p=w[0],m=w[1],x=r.querySelector('[name="btn-'+p+'"]');l.default.DomEvent.on(x,"click",n.bind(this,m.callback))}}catch(v){y=!0,b=v}finally{try{!g&&_.return&&_.return()}finally{if(y)throw b}}}},_addItem:function(e){var t=this,n=s.call(this,e);if(e.layer.__customLayer){var i=l.default.DomUtil.create("div","custom-layer-edit-button icon-edit",n.children[0]);i.title="Edit layer",l.default.DomEvent.on(i,"click",function(n){return t.onCustomLayerEditClicked(e.layer.__customLayer,n)})}return n},serializeCustomLayer:function(e){function t(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_")}var n=JSON.stringify(e);return n=n.replace(/[\u007f-\uffff]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}),"-cs"+t(n)},customLayerExists:function(e,t){var n=this.serializeCustomLayer(e),i=!0,r=!1,a=void 0;try{for(var o,s=this._customLayers()[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=o.value;if(l!==t&&l.serialized===n)return l}}catch(u){r=!0,a=u}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return!1},checkCustomLayerValues:function(e){return e.url?e.name?{}:{error:"Name is empty"}:{error:"Url is empty"}},onCustomLayerAddClicked:function(e){var t=this.checkCustomLayerValues(e).error;if(t)return void(0,f.notify)(t);var n=this.customLayerExists(e);if(n){var i="Same layer already exists";return n.enabled||(i+=" but it is hidden. You can enable it in layers setting."),void(0,f.notify)(i)}var r=this.createCustomLayer(e);r.enabled=!0,r.checked=h.default.observable(!0),this._customLayers.push(r),this.hideCustomLayerForm(),this.updateEnabledLayers()},createCustomLayer:function(e,t,n){var i=this.serializeCustomLayer(e),r=l.default.tileLayer(e.url,{tms:e.tms,maxNativeZoom:e.maxZoom,scaleDependent:e.scaleDependent,print:!0,jnx:!0,code:i,noCors:!0}),a={title:e.name,isOverlay:e.isOverlay,isDefault:!1,isCustom:!0,serialized:i,layer:r,order:1e4,fieldValues:e,enabled:!0,checked:h.default.observable(!0)};return r.__customLayer=a,a},onCustomLayerCancelClicked:function(){this.hideCustomLayerForm()},hideCustomLayerForm:function(){this._customLayerWindow&&(this._customLayerWindow.parentNode.removeChild(this._customLayerWindow),this._customLayerWindow=null)},onCustomLayerEditClicked:function(e,t){var n=this;l.default.DomEvent.stop(t),this.showCustomLayerForm([{caption:"Save",callback:function(t){return n.onCustomLayerChangeClicked(e,t)}},{caption:"Delete",callback:function(t){return n.onCustomLayerDeletelClicked(e)}},{caption:"Cancel",callback:function(){return n.onCustomLayerCancelClicked()}}],e.fieldValues)},onCustomLayerChangeClicked:function(e,t){var n=this.checkCustomLayerValues(t).error;if(n)return void(0,f.notify)(n);var i=this.customLayerExists(t,e);if(i){var r="Same layer already exists";return i.enabled||(r+=" but it is hidden. You can enable it in layers setting."),void(0,f.notify)(r)}var a=this._customLayers.indexOf(e);this._customLayers.remove(e);var o=this.createCustomLayer(t);this._customLayers.splice(a,0,o),!this._map.hasLayer(e.layer)||e.isOverlay&&!o.isOverlay||this._map.addLayer(o.layer),this._map.removeLayer(e.layer),this.updateEnabledLayers(),this.hideCustomLayerForm()},onCustomLayerDeletelClicked:function(e){this._map.removeLayer(e.layer),this._customLayers.remove(e),this.updateEnabledLayers(),this.hideCustomLayerForm()},loadCustomLayerFromString:function(e){var t=void 0,n=e.match(/^-cs(.+)$/);if(n){e=n[1].replace(/-/g,"+").replace(/_/g,"/");try{e=atob(e),t=JSON.parse(e)}catch(i){}if(t)return this.customLayerExists(t)||this._customLayers.push(this.createCustomLayer(t)),this.serializeCustomLayer(t)}}}),e._map&&e.__injectConfigButton(),e._initializeLayersState())}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=n(2),l=i(s);n(451);var u=n(116),d=i(u),c=n(51),h=i(c),f=n(35),p=n(23),m=i(p),v=n(63),g=i(v);t.default=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(31);var o=a.default.Control.Layers.prototype.onAdd;a.default.Control.Layers.include({onAdd:function(e){var t=o.call(this,e);return this._stopContainerEvents(),t}});var s=a.default.Control.Zoom.prototype.onAdd;a.default.Control.Zoom.include({onAdd:function(e){var t=s.call(this,e);return this._container=t,this._stopContainerEvents(),t}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.onAdd;e._minimizeEnabled||((0,l.default)(e),o.default.Util.extend(e,{_minimizeEnabled:!0,onAdd:function(e){var n=this,i=t.call(this,e);return setTimeout(function(){return n.__injectMinimizeButtons()},0),i},__injectMinimizeButtons:function(){for(var e=this._container,t=o.default.DomUtil.create("div","leaflet-control-content");e.childNodes.length;)t.appendChild(e.childNodes[0]);e.appendChild(t);var n=o.default.DomUtil.create("div","button-minimize");this._topRow.appendChild(n);var i=o.default.DomUtil.create("div","leaflet-control-button-toggle",e);i.title="Select layers",o.default.DomEvent.on(i,"click",this.setExpanded,this),o.default.DomEvent.on(n,"click",this.setMinimized,this)},setExpanded:function(){o.default.DomUtil.removeClass(this._container,"minimized")},setMinimized:function(){o.default.DomUtil.addClass(this._container,"minimized")}}),e._map&&e.__injectMinimizeButtons())}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=i(a);n(453),n(38);var s=n(116),l=i(s);t.default=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function o(){var e=document.createEvent("HTMLEvents");e.initEvent("resize",!0,!1),window.dispatchEvent(e)}var s=n(2),l=i(s);n(457),n(38);var u=n(51),d=i(u),c=n(192),h=i(c),f=n(193),p=i(f),m=n(199),v=i(m),g=l.default.Marker.extend({options:{zIndexOffset:1e4},initialize:function(){var e=l.default.divIcon({className:"leaflet-panorama-marker-wraper",html:'<div class="leaflet-panorama-marker"></div>'});l.default.Marker.prototype.initialize.call(this,[0,0],{icon:e,interactive:!1})},getIcon:function(){var e=this.getElement();return e=e.children[0]},setHeading:function(e){var t=this.getIcon();t.style.transform="rotate("+(e||0)+"deg)"},setType:function(e){var t={slim:"leaflet-panorama-marker-circle",normal:"leaflet-panorama-marker-binocular"}[e];this.getIcon().className=t}});l.default.Control.Panoramas=l.default.Control.extend({includes:l.default.Mixin.Events,options:{position:"topleft"},getProviders:function(){return[{name:"google",title:"Google street view",provider:h.default,layerOptions:{zIndex:10},code:"g",selected:d.default.observable(!0),mapMarkerType:"normal"},{name:"wikimedia",title:"Wikimedia commons",provider:v.default,layerOptions:{opacity:.7,zIndex:9},code:"w",selected:d.default.observable(!1),mapMarkerType:"slim"},{name:"mapillary",title:"Mapillary",provider:p.default,layerOptions:{opacity:.7,zIndex:8},code:"m",selected:d.default.observable(!1),mapMarkerType:"normal"}]},initialize:function(e,t){l.default.Control.prototype.initialize.call(this,t),this._panoramaContainer=e,this.providers=this.getProviders();var n=!0,i=!1,r=void 0;try{for(var a,o=this.providers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.selected.subscribe(this.updateCoverageVisibility,this),s.container=l.default.DomUtil.create("div","panorama-container",e)}}catch(u){i=!0,r=u}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}this.nearbyPoints=[]},onAdd:function(e){this._map=e;var t=this._container=l.default.DomUtil.create("div","leaflet-control leaflet-contol-panoramas");return t.innerHTML='\n                <a name="button" class="panoramas-button leaflet-control-button icon-panoramas" title="Show panoramas"\n                    data-bind="click: onButtonClick"></a>\n                <div class="panoramas-list control-form" data-bind="foreach: providers">\n                    <div><label><input type="checkbox" data-bind="checked: selected"><span data-bind="text: title"></span></label></div>\n                </div>\n            ',this._stopContainerEvents(),d.default.applyBindings(this,t),e.createPane("rasterOverlay").style.zIndex=300,t},onButtonClick:function(){this.controlEnabled?this.disableControl():this.enableControl()},enableControl:function(){this.controlEnabled||(this.controlEnabled=!0,l.default.DomUtil.addClass(this._container,"enabled"),this.updateCoverageVisibility(),this._map.on("click",this.onMapClick,this),l.default.DomUtil.addClass(this._map._container,"panoramas-control-active"),this.notifyChanged())},disableControl:function(){this.controlEnabled&&(this.controlEnabled=!1,l.default.DomUtil.removeClass(this._container,"enabled"),this.updateCoverageVisibility(),this._map.off("click",this.onMapClick,this),this.hidePanoViewer(),l.default.DomUtil.removeClass(this._map._container,"panoramas-control-active"),this.notifyChanged())},updateCoverageVisibility:function(){if(this._map){var e=!0,t=!1,n=void 0;try{for(var i,r=this.providers[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var a=i.value;if(this.controlEnabled&&a.selected()){if(!a.coverageLayer){var o=l.default.extend({pane:"rasterOverlay"},a.layerOptions);a.coverageLayer=a.provider.getCoverageLayer(o)}a.coverageLayer.addTo(this._map)}else a.coverageLayer&&this._map.removeLayer(a.coverageLayer)}}catch(s){t=!0,n=s}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}this.notifyChanged()}},showPanoramaContainer:function(){l.default.DomUtil.addClass(this._panoramaContainer,"enabled"),o()},panoramaVisible:function(){if(l.default.DomUtil.hasClass(this._panoramaContainer,"enabled")){var e=!0,t=!1,n=void 0;try{for(var i,r=this.providers[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var a=i.value;if(l.default.DomUtil.hasClass(a.container,"enabled"))return a}}catch(o){t=!0,n=o}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}}return!1},setupNearbyPoints:function(e){var t=!0,n=!1,i=void 0;try{for(var r,a=this.nearbyPoints[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;this._map.removeLayer(o)}}catch(s){n=!0,i=s}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}if(this.nearbyPoints=[],e){var u=l.default.divIcon({className:"leaflet-panorama-marker-point"}),d=!0,c=!1,h=void 0;try{for(var f,p=e[Symbol.iterator]();!(d=(f=p.next()).done);d=!0){var m=f.value;this.nearbyPoints.push(l.default.marker(m,{icon:u}).addTo(this._map))}}catch(s){c=!0,h=s}finally{try{!d&&p.return&&p.return()}finally{if(c)throw h}}}},hidePano:function(e){l.default.DomUtil.removeClass(e.container,"enabled"),e.viewer&&e.viewer.deactivate(),this.setupNearbyPoints()},showPano:function(){function e(e,n){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(t,n){var i,r,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(this.showPanoramaContainer(),i=!0,r=!1,a=void 0,e.prev=4,o=this.providers[Symbol.iterator]();!(i=(s=o.next()).done);i=!0)u=s.value,u!==t&&this.hidePano(u);e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),r=!0,a=e.t0;case 12:e.prev=12,e.prev=13,!i&&o.return&&o.return();case 15:if(e.prev=15,!r){e.next=18;break}throw a;case 18:return e.finish(15);case 19:return e.finish(12);case 20:if(l.default.DomUtil.addClass(t.container,"enabled"),t.viewer){e.next=26;break}return e.next=24,t.provider.getViewer(t.container);case 24:t.viewer=e.sent,this.setupViewerEvents(t);case 26:n&&l.default.Util.requestAnimFrame(function(){return t.viewer.showPano(n)}),t.viewer.activate(),this.notifyChanged();case 29:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return e}(),setupViewerEvents:function(e){e.viewer.on({change:this.onPanoramaChangeView.bind(this,e),closeclick:this.onPanoramaCloseClick},this)},hidePanoViewer:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=this.providers[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var a=i.value;this.hidePano(a)}}catch(s){t=!0,n=s}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}l.default.DomUtil.removeClass(this._panoramaContainer,"enabled"),this.hideMarker(),o(),this.notifyChanged()},placeMarker:function(e,t){this.panoramaVisible()&&(this.marker||(this.marker=new g),this._map.addLayer(this.marker),this.marker.setLatLng(e),this.marker.setHeading(t))},hideMarker:function(){this.marker&&this._map.removeLayer(this.marker)},notifyChanged:function(){this.fire("panoramachanged")},onPanoramaChangeView:function(e,t){this._map.getBounds().pad(-.05).contains(t.latlng)||this._map.panTo(t.latlng),this.placeMarker(t.latlng,t.heading),this.marker.setType(e.mapMarkerType),this.setupNearbyPoints(t.latlngs),this.notifyChanged()},onPanoramaCloseClick:function(e){this.hidePanoViewer()},onMapClick:function(){function e(e){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(t){var n,i,r,a,o,s,l,u,d,c,h,f,p,m,v,g,y,b,k;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=24,i=this._map.project(t.latlng).add([n,0]),r=t.latlng.distanceTo(this._map.unproject(i)),a=[],o=!0,s=!1,l=void 0,e.prev=4,u=this.providers[Symbol.iterator]();!(o=(d=u.next()).done);o=!0)c=d.value,c.selected()&&a.push({promise:c.provider.getPanoramaAtPos(t.latlng,r),provider:c});e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),s=!0,l=e.t0;case 12:e.prev=12,e.prev=13,!o&&u.return&&u.return();case 15:if(e.prev=15,!s){e.next=18;break}throw l;case 18:return e.finish(15);case 19:return e.finish(12);case 20:h=!0,f=!1,p=void 0,e.prev=23,m=a[Symbol.iterator]();case 25:if(h=(v=m.next()).done){e.next=36;break}return g=v.value,y=g.promise,b=g.provider,e.next=29,y;case 29:if(k=e.sent,!k.found){e.next=33;break}return this.showPano(b,k.data),e.abrupt("return");case 33:h=!0,e.next=25;break;case 36:e.next=42;break;case 38:e.prev=38,e.t1=e.catch(23),f=!0,p=e.t1;case 42:e.prev=42,e.prev=43,!h&&m.return&&m.return();case 45:if(e.prev=45,!f){e.next=48;break}throw p;case 48:return e.finish(45);case 49:return e.finish(42);case 50:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19],[23,38,42,50],[43,,45,49]])}));return e}()}),l.default.Control.Panoramas.include(l.default.Mixin.HashState),l.default.Control.Panoramas.include({stateChangeEvents:["panoramachanged"],serializeState:function(){var e=null;if(this.controlEnabled){e=[];var t="_",n=!0,i=!1,a=void 0;try{for(var o,s=this.providers[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;l.selected()&&(t+=l.code)}}catch(u){i=!0,a=u}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}e.push(t);var d=this.panoramaVisible();if(d&&d.viewer){var c=d.viewer.getState();if(c){var h;e.push(d.code),(h=e).push.apply(h,r(c))}}}return e},unserializeState:function(e){var t=this;if(!e)return this.disableControl(),!0;var n=e[0];if(!n||"_"!==n[0])return!1;this.enableControl();var i=!0,r=!1,a=void 0;try{for(var o,s=this.providers[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=o.value;l.selected(n.includes(l.code))}}catch(u){r=!0,a=u}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}if(e.length>2){var d=e[1],c=!0,h=!1,f=void 0;try{for(var p,m=function(){var n=p.value;if(d===n.code)return t.showPano(n).then(function(){var i=n.viewer.setState(e.slice(2));i||t.hidePanoViewer()}),"break"},v=this.providers[Symbol.iterator]();!(c=(p=v.next()).done);c=!0){var g=m();if("break"===g)break}}catch(u){h=!0,f=u}finally{try{!c&&v.return&&v.return()}finally{if(h)throw f}}}return!0}}),l.default.Control.Panoramas.hashStateUpgrader=function(e){return l.default.Util.extend({},l.default.Mixin.HashState,{unserializeState:function(t){if(t){console.log("Upgrading");var n=["_g"];t.length&&n.push.apply(n,["g"].concat(r(t))),setTimeout(function(){return e.unserializeState(n)},0)}return!1},serializeState:function(){return null}})}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e){return d.default.tileLayer("https://maps.googleapis.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m8!1e2!2ssvv!4m2!1scb_client!2sapiv3!4m2!1scc!2s*211m3*211e3*212b1*213e2*211m3*211e2*212b1*213e2!3m5!3sUS!12m1!1e40!12m1!1e18!4e0",e)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){var e=r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.default)();case 2:return t=e.sent,e.abrupt("return",new t.maps.StreetViewService);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),s=function(){var e=r(regeneratorRuntime.mark(function e(t,n){var i,r,a,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.default)();case 2:return i=e.sent,e.next=5,o();case 5:return r=e.sent,e.next=8,new Promise(function(e){r.getPanorama({location:t,radius:n,preference:i.maps.StreetViewPreference.NEAREST},function(t,n){return e({data:t,status:n})})});case 8:if(a=e.sent,s=a.data,l=a.status,l!==i.maps.StreetViewStatus.OK){e.next=15;break}return e.abrupt("return",{found:!0,data:s});case 15:return e.abrupt("return",{found:!1});case 16:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=r(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.default)();case 2:return n=e.sent,e.abrupt("return",new f(n,t));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),u=n(2),d=i(u),c=n(111),h=i(c),f=d.default.Evented.extend({initialize:function(e,t){var n=this,i=this.panorama=new e.maps.StreetViewPanorama(t,{enableCloseButton:!0,imageDateControl:!0});i.addListener("position_changed",function(){return n.onPanoramaChangeView()}),i.addListener("pov_changed",function(){return n.onPanoramaChangeView()}),i.addListener("closeclick",function(){return n.onCloseClick()})},showPano:function(e){this.panorama.setPosition(e.location.latLng),this.panorama.setZoom(1)},onPanoramaChangeView:function(){if(this._active){var e=this.panorama.getPosition();e=d.default.latLng(e.lat(),e.lng());var t=this.panorama.getPov();this.fire("change",{latlng:e,heading:t.heading,zoom:t.zoom,pitch:t.pitch})}},onCloseClick:function(){this.fire("closeclick")},activate:function(){this._active=!0,this.panorama.setVisible(!0)},deactivate:function(){this._active=!1,this.panorama.setVisible(!1)},getState:function(){var e=this.panorama.getPosition(),t=this.panorama.getPov();return e&&t?[e.lat().toFixed(6),e.lng().toFixed(6),(t.heading||0).toFixed(1),(t.pitch||0).toFixed(1),(t.zoom||1).toFixed(1)]:null},setState:function(e){var t=parseFloat(e[0]),n=parseFloat(e[1]),i=parseFloat(e[2]),r=parseFloat(e[3]),a=parseFloat(e[4]);return!(isNaN(t)||isNaN(n)||isNaN(i)||isNaN(r)||isNaN(a))&&(this.panorama.setPosition({lat:t,lng:n}),this.panorama.setPov({heading:i,pitch:r,zoom:a}),!0)}});t.default={getCoverageLayer:a,getPanoramaAtPos:s,getViewer:l}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e){return new h.MapillaryCoverage(e)}function o(){return new Promise(function(e){n.e(1,function(){n(165),e(n(168))})})}function s(e){var t=new Date(e),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return t.getDate()+" "+n[t.getMonth()]+" "+t.getFullYear()}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){var e=r(regeneratorRuntime.mark(function e(t,n){var i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="https://a.mapillary.com/v3/images?client_id="+m.default.mapillary+"&closeto="+t.lng+","+t.lat+"&radius="+n,e.next=3,(0,f.fetch)(i,{responseType:"json",timeout:1e4});case 3:if(r=e.sent,200!==r.status||!r.responseJSON.features.length){e.next=6;break}return e.abrupt("return",{found:!0,data:r.responseJSON.features[0].properties.key});case 6:return e.abrupt("return",{found:!1});case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=r(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:return n=e.sent,e.abrupt("return",new v(n,t));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),d=n(2),c=i(d),h=n(194),f=n(24),p=n(34),m=i(p);n(455),n(166);var v=c.default.Evented.extend({initialize:function(e,t){var n="container-"+c.default.stamp(t);t.id=n;var i=this.viewer=new e.Viewer(n,m.default.mapillary,null,{component:{cover:!1,bearing:!1}});window.addEventListener("resize",function(){i.resize()}),i.on("nodechanged",this.onNodeChanged.bind(this)),i.on("bearingchanged",this.onBearingChanged.bind(this)),this.dateLabel=c.default.DomUtil.create("div","mapillary-viewer-date-overlay",t),this.closeButton=c.default.DomUtil.create("div","photo-viewer-button-close",t),c.default.DomEvent.on(this.closeButton,"click",this.onCloseClick,this),this._bearing=0,this._zoom=0,this._center=[0,0]},showPano:function(e){var t=this;this.deactivate(),this.activate(),this.viewer.moveToKey(e).then(function(){t.viewer.setZoom(0),t.updateZoomAndCenter()})},onNodeChanged:function(e){this._node&&e.key===this._node.key||(this._node=e,this.fireChangeEvenet(),this.dateLabel.innerHTML=s(e.capturedAt))},getBearingCorrection:function(){return this._node&&"computedCA"in this._node?this._node.computedCA-this._node.originalCA:0},onBearingChanged:function(e){e-=this.getBearingCorrection(),this._bearing!==e&&(this._bearing=e,this.fireChangeEvenet())},onCloseClick:function(){this.fire("closeclick")},fireChangeEvenet:function(){if(this._node){var e=this._node.originalLatLon;this.fire("change",{latlng:c.default.latLng(e.lat,e.lon),heading:this._bearing,pitch:this._pitch,zoom:this._zoom})}},deactivate:function(){this.viewer.activateCover(),this._updateHandler&&(clearInterval(this._updateHandler),this._updateHandler=null)},updateZoomAndCenter:function(){var e=this;this.viewer.getZoom().then(function(t){e._zoom=t}),this.viewer.getCenter().then(function(t){e._center=t}),this.viewer.getBearing().then(function(t){e.onBearingChanged(t)})},activate:function(){var e=this;this.viewer.resize(),this.viewer.deactivateCover(),this._updateHandler||(this._updateHandler=setInterval(function(){return e.updateZoomAndCenter()},200))},getState:function(){if(!this._node)return[];var e=this._node.originalLatLon,t=e.lat,n=e.lon;return[t.toFixed(6),n.toFixed(6),this._center[0].toFixed(4),this._center[1].toFixed(4),this._zoom.toFixed(2)]},setState:function(e){var t=this,n=parseFloat(e[0]),i=parseFloat(e[1]),r=parseFloat(e[2]),a=parseFloat(e[3]),o=parseFloat(e[4]);return!(isNaN(n)||isNaN(i)||isNaN(r)||isNaN(a)||isNaN(o))&&(this.viewer.moveCloseTo(n,i).then(function(){t.viewer.setCenter([r,a]),t.viewer.setZoom(o)}),!0)}});t.default={getCoverageLayer:a,getPanoramaAtPos:l,getViewer:u}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MapillaryCoverage=void 0;var r=n(2),a=i(r),o=n(195),s=a.default.GridLayer.extend({options:{tileSize:1024,updateWhenIdle:!0,color:"#00cfb1"},initialize:function(e){a.default.GridLayer.prototype.initialize.call(this,e),this.loader=new o.MapillaryLoader(this.options.url,12)},onAdd:function(e){a.default.GridLayer.prototype.onAdd.call(this,e),this.on("tileunload",this.onTileUnload,this)},onRemove:function(e){a.default.GridLayer.prototype.onRemove.call(this,e),this.off("tileunload",this.onTileUnload,this)},onTileUnload:function(e){var t=e.tile;t._abortLoading(),delete t._tileData,delete t._adjustment},drawOverview:function(e){var t=e._tileData;if(t["mapillary-sequence-overview"]){var n=e._adjustment,i=n.multiplier,r=n.offsetX,a=n.offsetY,o=e.getContext("2d");o.fillStyle=this.options.color;var s=!0,l=!1,u=void 0;try{for(var d,c=t["mapillary-sequence-overview"][Symbol.iterator]();!(s=(d=c.next()).done);s=!0){var h=d.value;if("Point"!==h.geometry.type)throw new Error('Invalid sequence overview geometry type "'+h.geometry.type+'"');o.beginPath();var f=h.geometry.coordinates[0]*i-r,p=h.geometry.coordinates[1]*i-a;o.arc(f,p,5,0,2*Math.PI),o.fill()}}catch(m){l=!0,u=m}finally{try{!s&&c.return&&c.return()}finally{if(l)throw u}}}},drawSequences:function(e,t){var n=e._tileData,i=e._adjustment;if(n["mapillary-sequences"]){var r=e.getContext("2d");r.beginPath(),r.strokeStyle=this.options.color,r.lineWidth=t,r.lineCap="round",r.lineJoin="bevel";var a=!0,o=!1,s=void 0;try{for(var l,u=n["mapillary-sequences"][Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value;if("MultiLineString"!==d.geometry.type)throw new Error('Invalid sequence geometry type "'+d.geometry.type+'"');for(var c=i.multiplier,h=i.offsetX,f=i.offsetY,p=d.geometry.coordinates,m=0;m<p.length;m++){var v=p[m];if(v.length){var g=v[0][0]*c-h,y=v[0][1]*c-f;r.moveTo(g,y),1===v.length&&r.lineTo(g,y);for(var b=0;b<v.length;b++){var k=v[b][0]*c-h,_=v[b][1]*c-f;r.lineTo(k,_)}}}}}catch(w){o=!0,s=w}finally{try{!a&&u.return&&u.return()}finally{if(o)throw s}}r.stroke()}},drawImages:function(e){var t=e._tileData,n=e._adjustment;if(t["mapillary-images"]){var i=n.multiplier,r=n.offsetX,a=n.offsetY,o=e.getContext("2d");o.beginPath(),o.fillStyle=this.options.color;var s=!0,l=!1,u=void 0;try{for(var d,c=t["mapillary-images"][Symbol.iterator]();!(s=(d=c.next()).done);s=!0){var h=d.value;if("Point"!==h.geometry.type)throw new Error('Invalid image geometry type "'+h.geometry.type+'"');o.beginPath();var f=h.geometry.coordinates[0]*i-r,p=h.geometry.coordinates[1]*i-a;o.arc(f,p,4,0,2*Math.PI),o.fill()}}catch(m){l=!0,u=m}finally{try{!s&&c.return&&c.return()}finally{if(l)throw u}}}},drawTile:function(e,t){if(this._map&&e._tileData)if(t.z<8)this.drawOverview(e);else if(t.z<16){var n=t.z<14?10:5;this.drawSequences(e,n)}else this.drawSequences(e,2),this.drawImages(e)},createTile:function(e,t){var n=this,i=a.default.DomUtil.create("canvas","leaflet-tile");i.width=this.options.tileSize,i.height=this.options.tileSize;var r=this.loader.requestTileData(e),o=r.dataPromise,s=r.abortLoading;return o.then(function(r){i._tileData=r.tileData,i._adjustment=r.adjustment||{multiplier:1,offsetX:0,offsetY:0},setTimeout(function(){n.drawTile(i,e),t(null,i)},1)}),i._abortLoading=s,i}});t.MapillaryCoverage=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MapillaryLoader=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(i)},d=n(2),c=i(d),h=n(83),f=n(196),p=function(e){function t(){var e,n,i,r;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=i=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.url="https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt",i.maxZoom=14,r=n,o(i,r)}return s(t,e),l(t,[{key:"getTileUrl",value:function(e){var t={x:e.x,z:e.z,y:e.y};return c.default.Util.template(this.url,t)}},{key:"layerTileToDataTileCoords",value:function(e){var t=e.z-2,n=null;if(t>6&&t<=10)n=6;else if(t>=11&&t<14)n=t-4;else if(t<0)n=0;else{if(!(t>this.maxZoom))return{z:t,x:e.x,y:e.y};n=this.maxZoom}var i=1<<t-n;return{x:Math.floor(e.x/i),y:Math.floor(e.y/i),z:n}}},{key:"makeRequestData",value:function(e){return{url:this.getTileUrl(e),options:{responseType:"arraybuffer",timeout:1e4,isResponseSuccess:function(e){return 200===e.status||403===e.status}}}}},{key:"calcAdjustment",value:function(e,n){var i=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"calcAdjustment",this).call(this,{x:e.x,y:e.y,z:e.z-2},n);return i&&(i.offsetX*=1024,i.offsetY*=1024),i}},{key:"processResponse",value:function(){function e(e,n){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._processResponse(t,n));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"_processResponse",value:function(){function e(e,n){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t,n){var i,r,a,o,s,l,u,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=void 0,200!==t.status||!t.response){e.next=25;break}for(r=(0,f.decodeMvt)(t.response,1024),i={},a=!0,o=!1,s=void 0,e.prev=7,l=r[Symbol.iterator]();!(a=(u=l.next()).done);a=!0)d=u.value,i[d.name]=d.features;e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),o=!0,s=e.t0;case 15:e.prev=15,e.prev=16,!a&&l.return&&l.return();case 18:if(e.prev=18,!o){e.next=21;break}throw s;case 21:return e.finish(18);case 22:return e.finish(15);case 23:e.next=26;break;case 25:i=null;case 26:return e.abrupt("return",{tileData:i,coords:n});case 27:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));return e}()}]),t}(h.TiledDataLoader);t.MapillaryLoader=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return e>>1^-(1&e)}function a(e,t,n){if(e!==d.Tile.GeomType.POINT&&e!==d.Tile.GeomType.LINESTRING&&e!==d.Tile.GeomType.POLYGON)throw new Error("Unknown feature geometry type "+e);for(var i=t.length,a=0,o=[],s=void 0,l=0,u=0;a<i;){var c=t[a],h=7&c,f=c>>3;switch(h){case 1:if(1!==f)throw new Error("repeat="+f+" for command MoveTo");if(a+2>i)throw new Error("Not enough elements for MoveTo arguments");s&&o.push(s),l+=r(t[a+1]),u+=r(t[a+2]),s=[[l*n,u*n]],a+=3;break;case 2:if(f<1)throw new Error("repeat="+f+" for command LineTo");if(!s)throw new Error("LineTo with empty linestring");a+=1;for(var p=0;p<f;p++){if(a+2>i)throw new Error("Not enough elements for LineTo arguments");l+=r(t[a]),u+=r(t[a+1]),s.push([l*n,u*n]),a+=2}break;case 7:if(e!==d.Tile.GeomType.POLYGON)throw new Error("ClosePath command for non-polygon type "+e);if(!s)throw new Error("ClosePath with empty linestring");if(1!==f)throw new Error("ClosePath repeats "+f+" times");s.push(s[0]),a+=1;break;default:throw new Error("Unknown command "+c+" & 0x7 = "+h)}}s&&o.push(s);var m={};switch(e){case d.Tile.GeomType.POINT:if(1!==o.length||1!==o[0].length)throw new Error("Invalid coordinates number for point");m.type="Point",m.coordinates=o[0][0];break;case d.Tile.GeomType.LINESTRING:m.type="MultiLineString",m.coordinates=o;break;case d.Tile.GeomType.POLYGON:m.type="Polygon",m.coordinates=o}return m}function o(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var s,l=e.features[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,d=a(u.type,u.geometry,t);n.push({geometry:d})}}catch(c){r=!0,o=c}finally{try{!i&&l.return&&l.return()}finally{if(r)throw o}}return n}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=new u.default(new Uint8Array(e)),i=d.Tile.read(n),r=[],a=!0,s=!1,l=void 0;try{for(var c,h=i.layers[Symbol.iterator]();!(a=(c=h.next()).done);a=!0){var f=c.value,p=t/f.extent;r.push({name:f.name,features:o(f,p)})}}catch(m){s=!0,l=m}finally{try{!a&&h.return&&h.return()}finally{if(s)throw l}}return r}Object.defineProperty(t,"__esModule",{value:!0}),t.decodeMvt=void 0;var l=n(479),u=i(l),d=n(197);t.decodeMvt=s},function(e,t){"use strict";var n=t.Tile={};n.read=function(e,t){return e.readFields(n._readField,{layers:[]},t)},n._readField=function(e,t,i){3===e&&t.layers.push(n.Layer.read(i,i.readVarint()+i.pos))},n.GeomType={UNKNOWN:0,POINT:1,LINESTRING:2,POLYGON:3},n.Feature={},n.Feature.read=function(e,t){return e.readFields(n.Feature._readField,{id:0,tags:[],type:0,geometry:[]},t)},n.Feature._readField=function(e,t,n){3===e?t.type=n.readVarint():4===e&&n.readPackedVarint(t.geometry)},n.Layer={},n.Layer.read=function(e,t){return e.readFields(n.Layer._readField,{version:0,name:"",features:[],keys:[],values:[],extent:0},t)},n.Layer._readField=function(e,t,i){15===e?t.version=i.readVarint():1===e?t.name=i.readString():2===e?t.features.push(n.Feature.read(i,i.readVarint()+i.pos)):5===e&&(t.extent=i.readVarint())}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WikimediaVectorCoverage=t.MultiLayer=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(2),d=i(u),c=n(83),h=d.default.Layer.extend({initialize:function(e){this.layers=e},setLayersVisibility:function(e){if(this._map){var t=void 0;t=e&&void 0!==e.zoom?e.zoom:this._map.getZoom();var n=!0,i=!1,r=void 0;try{for(var a,o=this.layers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.minZoom<=t&&t<=s.maxZoom?this._map.addLayer(s.layer):this._map.removeLayer(s.layer)}}catch(l){i=!0,r=l}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}}},onAdd:function(e){this._map=e,this.setLayersVisibility(),e.on("zoomend",this.setLayersVisibility,this)},onRemove:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=this.layers[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var a=i.value;this._map.removeLayer(a.layer)}}catch(o){t=!0,n=o}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}this._map.off("zoomend",this.setLayersVisibility,this),this._map.off("zoomanim",this.setLayersVisibility,this),this._map=null}}),f=function(e){function t(e,n){a(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.url=e,i.maxZoom=n,i}return s(t,e),l(t,[{key:"getTileUrl",value:function(e){var t={x:e.x,z:e.z,y:Math.pow(2,e.z)-1-e.y};return d.default.Util.template(this.url,t)}},{key:"layerTileToDataTileCoords",value:function(e){var t=e.z,n=null;if(!(t>this.maxZoom))return{z:t,x:e.x,y:e.y};n=this.maxZoom;var i=1<<t-n;return{x:Math.floor(e.x/i),y:Math.floor(e.y/i),z:n}}},{key:"makeRequestData",value:function(e){return{url:this.getTileUrl(e),options:{responseType:"arraybuffer",timeout:5e3,isResponseSuccess:function(e){return 200===e.status||404===e.status}}}}},{key:"processResponse",value:function(){function e(e,n){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t,n){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=void 0,i=n.z>=this.maxZoom&&200===t.status&&t.response?new Uint16Array(t.response):null,e.abrupt("return",{tileData:i,coords:n});case 3:case"end":return e.stop()}},e,this)}));return e}()}]),t}(c.TiledDataLoader),p=d.default.GridLayer.extend({options:{tileSize:256,color:"#ff00ff"},initialize:function(e,t){d.default.GridLayer.prototype.initialize.call(this,t),this.loader=new f(e,11)},onAdd:function(e){d.default.GridLayer.prototype.onAdd.call(this,e),this.on("tileunload",this.onTileUnload,this)},onRemove:function(e){d.default.GridLayer.prototype.onRemove.call(this,e),this.off("tileunload",this.onTileUnload,this)},onTileUnload:function(e){var t=e.tile;t._abortLoading(),delete t._tileData,delete t._adjustment},drawTile:function(e,t){if(this._map&&e._tileData){var n=5e3,i=65535-2*n,r=e._tileData,a=e._adjustment,o=a.multiplier,s=a.offsetX,l=a.offsetY,u=e.getContext("2d"),d=256*o/i;u.fillStyle=this.options.color;for(var c=0,h=r.length;c<h;c+=2){var f=(r[c]-n)*d-256*s,p=(r[c+1]-n)*d-256*l;u.beginPath(),u.arc(f,p,5,0,2*Math.PI),u.fill()}}},createTile:function(e,t){var n=this,i=d.default.DomUtil.create("canvas","leaflet-tile");i.width=this.options.tileSize,i.height=this.options.tileSize;var r=this.loader.requestTileData(e),a=r.dataPromise,o=r.abortLoading;return a.then(function(r){i._tileData=r.tileData,i._adjustment=r.adjustment||{multiplier:1,offsetX:0,offsetY:0},setTimeout(function(){n.drawTile(i,e),t(null,i)},1)}),i._abortLoading=o,i}});t.MultiLayer=h,t.WikimediaVectorCoverage=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e){var t=g.default.wikimediaCommonsCoverageUrl;return new p.MultiLayer([{layer:f.default.tileLayer(t,f.default.extend({},e,{tms:!0})),minZoom:0,maxZoom:10},{layer:new p.WikimediaVectorCoverage(t,e),minZoom:11,maxZoom:18}])}function o(e){var t=[];if(e&&e.query&&e.query.pages&&e.query.pages){var n=!0,i=!1,r=void 0;try{for(var a,o=Object.values(e.query.pages)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=s.imageinfo[0],u=l.extmetadata.ImageDescription?l.extmetadata.ImageDescription.value:null,d=l.extmetadata.ObjectName?l.extmetadata.ObjectName.value:null;u&&/^<table (.|\n)+<\/table>$/.test(u)&&(u=null),u&&(u=u.replace(/<[^>]+>/g,""),u=u.replace(/[\n\r]/g,"")),u&&d&&d.toLowerCase().includes(u.toLowerCase())&&(u=null),d&&u&&u.toLowerCase().includes(d.toLowerCase())&&(d=null);var c="Wikimedia commons";(d||u)&&(c="",d&&(c=d),u&&(d&&(c+="</br>"),c+=u));var h=l.extmetadata.Artist?l.extmetadata.Artist.value:null;h&&/^<table (.|\n)+<\/table>$/.test(h)&&(h='See author info at <a href="'+l.descriptionurl+'">Wikimedia commons</a>');var f=l.thumburl.replace("134px",l.width+"px");t.push({url:f,width:l.width,height:l.height,lat:s.coordinates[0].lat,lng:s.coordinates[0].lon,author:h,timeOriginal:l.extmetadata.DateTimeOriginal?l.extmetadata.DateTimeOriginal.value:null,time:l.extmetadata.DateTime?l.extmetadata.DateTime.value:null,description:c,pageUrl:l.descriptionurl,pageId:s.pageid.toString()})}}catch(p){i=!0,r=p}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}if(t.length)return t}return null}function s(e,t,n){var i=e.distanceTo(t),r=e.distanceTo(n);return i<r?-1:i===r?0:1}function l(e){var t=/^(\d+)-(\d+)-(\d+)/.exec(e),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(t){var i=t.slice(1),r=d(i,3),a=r[0],o=r[1],s=r[2];return s+" "+n[o-1]+" "+a}return e}function u(e){return new y(e)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){var e=r(regeneratorRuntime.mark(function e(t,n){var i,r,a,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=10,r="https://commons.wikimedia.org/w/api.php?origin=*&format=json&action=query&generator=geosearch&ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&ggsradius={radius}&ggscoord={lat}|{lng}&iiurlwidth=134&prop=imageinfo|coordinates&iiprop=url|mime|size|extmetadata|commonmetadata|metadata",n+=i,n<10&&(n=10),n>1e4&&(n=1e4),a=f.default.Util.template(r,{lat:t.lat,lng:t.lng,radius:n}),e.next=8,(0,m.fetch)(a,{responseType:"json",timeout:1e4});case 8:if(l=e.sent,200!==l.status){e.next=20;break}if(u=o(l.responseJSON),!u){e.next=19;break}return t=f.default.latLng(t.lat,t.lng),u.sort(s.bind(null,t)),t=f.default.latLng(u[0].lat,u[0].lng),u=u.filter(function(e){return t.distanceTo(f.default.latLng(e.lat,e.lng))<=i},t),e.abrupt("return",{found:!0,data:u});case 19:return e.abrupt("return",{found:!1});case 20:return e.abrupt("return",{found:!1});case 21:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),h=n(2),f=i(h),p=n(198),m=n(24);n(456),n(166);var v=n(34),g=i(v),y=f.default.Evented.extend({initialize:function(e){var t=this;e=f.default.DomUtil.create("div","wikimedia-viewer-container",e);var n=this.mapContainer=f.default.DomUtil.create("div","wikimedia-viewer-map-container",e);this.pageButtonContainer=f.default.DomUtil.create("div","wikimedia-viewer-page-buttons-container",e),this.map=f.default.map(n,{maxBoundsViscosity:1,crs:f.default.CRS.Simple,zoomControl:!1,attributionControl:!1,zoomSnap:0}),this.map.on("zoomend",this.notifyChange,this),this.map.on("moveend",this.notifyChange,this),this.infoLabel=f.default.DomUtil.create("div","wikimedia-viewer-info-overlay",n),this.closeButton=f.default.DomUtil.create("div","photo-viewer-button-close",e),this.prevPhotoButton=f.default.DomUtil.create("div","wikimedia-viewer-button-prev",n),this.nextPhotoButton=f.default.DomUtil.create("div","wikimedia-viewer-button-next",n),f.default.DomEvent.on(this.prevPhotoButton,"click",function(){t.switchPhoto(t._imageIdx-1)}),f.default.DomEvent.on(this.nextPhotoButton,"click",function(){t.switchPhoto(t._imageIdx+1)}),f.default.DomEvent.on(this.closeButton,"click",this.onCloseClick,this)},setupPageButtons:function(e){var t=this;if(this._buttons){var n=!0,i=!1,r=void 0;try{for(var a,o=this._buttons[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;this.pageButtonContainer.removeChild(s)}}catch(l){i=!0,r=l}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}}if(this._buttons=[],e>1){f.default.DomUtil.addClass(this.pageButtonContainer,"enabled");for(var u=function(e){var n=f.default.DomUtil.create("div","wikimedia-viewer-page-button",t.pageButtonContainer);n.innerHTML=""+(e+1),t._buttons.push(n),f.default.DomEvent.on(n,"click",function(){return t.switchPhoto(e)})},d=0;d<e;d++)u(d)}else f.default.DomUtil.removeClass(this.pageButtonContainer,"enabled")},switchPhoto:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._imageIdx=e,this.imageLayer&&this.map.removeLayer(this.imageLayer);var i=this.images[e],r=this.map.getSize();r.x&&r.y||(r={x:500,y:500});var a=Math.log2(Math.max(i.width/r.x,i.height/r.y))+2;a<1&&(a=1);var o=this.map.unproject([0,i.height],a-2),s=this.map.unproject([i.width,0],a-2),u=new f.default.LatLngBounds(o,s);this.map.setMaxZoom(a),this.map.setMaxBounds(u),n?this.map.setView(n.center,n.zoom,{animate:!1}):this.map.fitBounds(u,{animate:!1}),this.imageLayer=f.default.imageOverlay(null,u),f.default.DomUtil.addClass(this.mapContainer,"loading"),this.imageLayer.on("load",function(){f.default.DomUtil.removeClass(t.mapContainer,"loading")}),this.imageLayer.setUrl(i.url),this.imageLayer.addTo(this.map);var c=[];i.timeOriginal&&c.push(l(i.timeOriginal)),i.author&&c.push(i.author),c.push('<a href="'+i.pageUrl+'">'+i.description+"</a>"),c=c.join("</br>"),this.infoLabel.innerHTML=c,e>0?f.default.DomUtil.addClass(this.prevPhotoButton,"enabled"):f.default.DomUtil.removeClass(this.prevPhotoButton,"enabled"),e<this.images.length-1?f.default.DomUtil.addClass(this.nextPhotoButton,"enabled"):f.default.DomUtil.removeClass(this.nextPhotoButton,"enabled");var h=!0,p=!1,m=void 0;try{for(var v,g=this._buttons.entries()[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=d(v.value,2),b=y[0],k=y[1];(b===e?f.default.DomUtil.addClass:f.default.DomUtil.removeClass)(k,"active")}}catch(_){p=!0,m=_}finally{try{!h&&g.return&&g.return()}finally{if(p)throw m}}this.notifyChange()},notifyChange:function(){if(this.images&&this._active){var e=this.images[this._imageIdx];this.fire("change",{latlng:f.default.latLng(e.lat,e.lng),latlngs:this.images.map(function(e){return f.default.latLng(e.lat,e.lng)})})}},_showPano:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.images=e,this.setupPageButtons(e.length),this.switchPhoto(t,n)},showPano:function(e){this._showPano(e)},onCloseClick:function(){this.fire("closeclick")},activate:function(){this._active=!0},deactivate:function(){this._active=!1},setState:function(e){var t=this,n=parseFloat(e[0]),i=parseFloat(e[1]),r=e[2],a=parseFloat(e[3]),o=parseFloat(e[4]),s=parseFloat(e[5]);if(!(isNaN(n)||isNaN(i)||isNaN(o)||isNaN(a)||isNaN(s))){var l=-1;return c({lat:n,lng:i},0).then(function(e){if(!e.found)return!1;var n=!0,i=!1,u=void 0;try{for(var c,h=e.data.entries()[Symbol.iterator]();!(n=(c=h.next()).done);n=!0){var p=d(c.value,2),m=p[0],v=p[1];if(v.pageId===r){l=m;break}}}catch(g){i=!0,u=g}finally{try{!n&&h.return&&h.return()}finally{if(i)throw u}}l>-1&&t._showPano(e.data,l,{center:f.default.latLng(a,o),zoom:s})}),!0}return!1},getState:function(){if(!this.images)return[];var e=this.map.getCenter();return[this.images[0].lat.toFixed(6),this.images[0].lng.toFixed(6),this.images[this._imageIdx].pageId,e.lat.toFixed(2),e.lng.toFixed(2),this.map.getZoom().toFixed(1)]}});t.default={getCoverageLayer:a,getPanoramaAtPos:c,getViewer:u}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){var n=(0,k.makePdf)(e,t);n=(0,w.blobFromString)(n),(0,_.saveAs)(n,"map.pdf",!0)}function o(e){(0,_.saveAs)((0,w.blobFromString)(e.data),"map.jpg",!0)}var s=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=n(2),u=i(l),d=n(51),c=i(d);n(113),n(38),n(458);var h=n(205),f=i(h),p=n(56),m=i(p),v=n(204),g=n(487),y=i(g),b=n(35),k=n(206),_=n(64),w=n(50);n(61),n(31);var x=n(23),L=i(x),S=n(202),C=n(203),M=n(201);c.default.extenders.checkNumberRange=function(e,t){return c.default.pureComputed({read:e,write:function(n){n=parseFloat(n),n>=t[0]&&n<=t[1]?e(n):e.notifySubscribers(e())}}).extend({notify:"always"})},u.default.Control.PrintPages=u.default.Control.extend({options:{position:"bottomleft"},includes:[u.default.Mixin.Events,u.default.Mixin.HashState],stateChangeEvents:["change"],pageSizes:[{name:"A1",width:594,height:841},{name:"A2",width:420,height:594},{name:"A3",width:297,height:420},{name:"A4",width:210,height:297},{name:"A5",width:148,height:210}],initialize:function(e){u.default.Control.prototype.initialize.call(this,e),this.pages=[],this.scale=c.default.observable(500).extend({checkNumberRange:[1,1e6]}),this.resolution=c.default.observable(300).extend({checkNumberRange:[10,9999]}),this.zoomLevel=c.default.observable("auto"),this.pageWidth=c.default.observable(210).extend({checkNumberRange:[10,9999]}),this.pageHeight=c.default.observable(297).extend({checkNumberRange:[10,9999]}),this.settingsExpanded=c.default.observable(!1),this.makingPdf=c.default.observable(!1),this.downloadProgressRange=c.default.observable(),this.downloadProgressDone=c.default.observable(),this.marginLeft=c.default.observable(3).extend({checkNumberRange:[0,99]}),this.marginRight=c.default.observable(3).extend({checkNumberRange:[0,99]}),this.marginTop=c.default.observable(3).extend({checkNumberRange:[0,99]}),this.marginBottom=c.default.observable(3).extend({checkNumberRange:[0,99]}),this.autoZoomLevels=c.default.observable({}),this.printSize=c.default.pureComputed(this._printSize,this),this.printSize.subscribe(this.onPageSizeChanged,this),this.scale.subscribe(this.onPageSizeChanged,this),this.resolution.subscribe(this.onPageSizeChanged,this),this.pageSizeDescription=c.default.pureComputed(this._displayPageSize,this),this.pagesNum=c.default.observable(0),this.pagesNumLabel=c.default.pureComputed(this._pagesNumLabel,this),this.gridOn=c.default.observable(!1),this.magneticMerisiansdOn=c.default.observable(!1),this.scale.subscribe(this.notifyChange,this),this.printSize.subscribe(this.notifyChange,this),this.resolution.subscribe(this.notifyChange,this),this.zoomLevel.subscribe(this.notifyChange,this),this.gridOn.subscribe(this.notifyChange,this),this.magneticMerisiansdOn.subscribe(this.notifyChange,this)},onAdd:function(e){this._map=e;var t=this._container=u.default.DomUtil.create("div","leaflet-control control-form control-print-pages");return this._stopContainerEvents(),e.on("move",this.updateFormZooms,this),t.innerHTML=y.default,c.default.applyBindings(this,t),this.updateFormZooms(),t},setExpanded:function(){u.default.DomUtil.removeClass(this._container,"minimized")},setMinimized:function(){u.default.DomUtil.addClass(this._container,"minimized")},addPage:function(e,t){var n=this.printSize(),i=s(n,2),r=i[0],a=i[1];if(e){var o=[a,r];r=o[0],a=o[1]}t||(t=this._map.getCenter());var l=new f.default(t,[r,a],this.scale(),(this.pages.length+1).toString());l._rotated=e,l.addTo(this._map),this.pages.push(l),this.pagesNum(this.pages.length);var u=new m.default(this.makePageContexmenuItems.bind(this,l));return l.on("contextmenu",u.show,u),l.on("click",this.rotatePage.bind(this,l)),l.on("move",this.updateFormZooms,this),l.on("moveend",this.notifyChange,this),this.updateFormZooms(),this.notifyChange(),l},addLandscapePage:function(){this.addPage(!0)},addPortraitPage:function(){this.addPage(!1)},removePage:function(e){var t=this.pages.indexOf(e);for(this.pages.splice(t,1),this.pagesNum(this.pages.length),this._map.removeLayer(e);t<this.pages.length;t++)this.pages[t].setLabel((t+1).toString());this.notifyChange(),this.updateFormZooms()},removePages:function(){var e=this;this.pages.forEach(function(t){return t.removeFrom(e._map)}),this.pages=[],this.pagesNum(this.pages.length),this.notifyChange(),this.updateFormZooms()},onSavePdfClicked:function(){return this.pages.length?void this.savePdf():void(0,b.notify)("Add some pages to print")},zoomForPrint:function(){var e=this.zoomLevel();return e="auto"===e?this.suggestZooms():{mapZoom:e,satZoom:e}},incrementProgress:function(e,t){this.downloadProgressRange(t),this.downloadProgressDone((this.downloadProgressDone()||0)+e)},savePdf:function(){var e=this;if(L.default.captureBreadcrumbWithUrl({message:"start save pdf"}),this._map){this.downloadProgressRange(1e3),this.downloadProgressDone(void 0),this.makingPdf(!0);var t=this.pages.map(function(e){return{latLngBounds:e.getLatLngBounds(),printSize:e.getPrintSize(),label:e.getLabel()}}),n=this.resolution(),i=[];this.gridOn()&&i.push(new M.Grid),this.magneticMerisiansdOn()&&i.push(new S.MagneticMeridians),i.push(new C.OverlayScale),(0,v.renderPages)({map:this._map,pages:t,zooms:this.zoomForPrint(),resolution:n,scale:this.scale(),decorationLayers:i,progressCallback:this.incrementProgress.bind(this)}).then(function(e){e&&a(e,n)}).catch(function(e){L.default.captureException(e),(0,b.notify)("Failed to create PDF: "+e.message)}).then(function(){return e.makingPdf(!1)})}},savePageJpg:function(e){var t=this;L.default.captureBreadcrumbWithUrl({message:"start save page jpg",data:{pageNumber:e.getLabel()}});var n=[{latLngBounds:e.getLatLngBounds(),printSize:e.getPrintSize(),label:e.getLabel()}],i=[];this.gridOn()&&i.push(new M.Grid),this.magneticMerisiansdOn()&&i.push(new S.MagneticMeridians),i.push(new C.OverlayScale),this.downloadProgressRange(1e3),this.downloadProgressDone(void 0),this.makingPdf(!0),(0,v.renderPages)({map:this._map,pages:n,zooms:this.zoomForPrint(),resolution:this.resolution(),scale:this.scale(),decorationLayers:i,progressCallback:this.incrementProgress.bind(this)}).then(function(e){return o(e[0])}).catch(function(e){L.default.captureException(e),(0,b.notify)("Failed to create JPEG from page: "+e.message)}).then(function(){return t.makingPdf(!1)})},onPageSizeChanged:function(){var e=this,t=this.printSize(),n=s(t,2),i=n[0],r=n[1];this.pages.forEach(function(t){var n=i,a=r;if(t._rotated){var o=[a,n];n=o[0],a=o[1]}t.setSize([n,a],e.scale())}),this.updateFormZooms()},makePageContexmenuItems:function(e){var t=this,n=[{text:"Rotate",callback:this.rotatePage.bind(this,e)},"-",{text:"Delete",callback:this.removePage.bind(this,e)},"-",{text:"Save image",callback:this.savePageJpg.bind(this,e),disabled:this.makingPdf()}];return this.pages.length>1&&(n.push({text:"Change order",separator:!0}),this.pages.forEach(function(i,r){i!==e&&n.push({text:(r+1).toString(),callback:t.renumberPage.bind(t,e,r)})})),n},rotatePage:function(e){e._rotated=!e._rotated,e.rotate(),this.notifyChange()},renumberPage:function(e,t){var n=this.pages.indexOf(e);this.pages.splice(n,1),this.pages.splice(t,0,e);for(var i=Math.min(n,t);i<this.pages.length;i++)this.pages[i].setLabel((i+1).toString());this.notifyChange()},_printSize:function(){return[this.pageWidth()-this.marginLeft()-this.marginRight(),this.pageHeight()-this.marginTop()-this.marginBottom()]},suggestZooms:function(){var e=this.scale(),t=this.resolution(),n=void 0;if(this.pages.length>0){var i=this.pages.map(function(e){return Math.abs(e.getLatLngBounds().getCenter().lat)});n=Math.min.apply(Math,r(i))}else{if(!this._map)return[null,null];n=this._map.getCenter().lat}var a=e/(t/2.54),o=a/Math.cos(n*Math.PI/180),s=Math.ceil(Math.log(156543.0328125/o)/Math.LN2);a=e/(90/2.54)/1.5,o=a/Math.cos(n*Math.PI/180);var l=Math.round(Math.log(156543.0328125/o)/Math.LN2);return l=Math.min(l,18),s=Math.min(s,18),l=Math.max(l,0),s=Math.max(s,0),{mapZoom:l,satZoom:s}},updateFormZooms:function(){this.autoZoomLevels(this.suggestZooms())},_displayPageSize:function(){var e=this.pageWidth(),t=this.pageHeight(),n=!0,i=!1,r=void 0;try{for(var a,o=this.pageSizes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.width===e&&s.height===t)return s.name}}catch(l){i=!0,r=l}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}return e+" x "+t+" mm"},notifyChange:function(){this.fire("change")},hasPages:function(){return!!this.pages.length},_pagesNumLabel:function(){var e=this.pagesNum(),t="";return e?t+=e:t="No",t+=" page",(0===e||e>1)&&(t+="s"),t},serializeState:function(){var e=this.pages,t=null;if(e.length){t=[],t.push(this.scale().toString()),t.push(this.resolution().toString()),t.push(this.zoomLevel().toString()),t.push(this.pageWidth().toString()),t.push(this.pageHeight().toString()),t.push(this.marginLeft().toString()),t.push(this.marginRight().toString()),t.push(this.marginTop().toString()),t.push(this.marginBottom().toString());var n=!0,i=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=s.getLatLng();t.push(l.lat.toFixed(5)),t.push(l.lng.toFixed(5)),t.push(s._rotated?"1":"0")}}catch(u){i=!0,r=u}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}var d=(this.magneticMerisiansdOn()?1:0)|(this.gridOn()?2:0);t.push(d)}return t},unserializeState:function(e){if(!e||!e.length)return!1;this.removePages(),e=[].concat(r(e)),this.scale(e.shift()),this.resolution(e.shift()),this.zoomLevel(e.shift()),this.pageWidth(e.shift()),this.pageHeight(e.shift()),this.marginLeft(e.shift()),this.marginRight(e.shift()),this.marginTop(e.shift()),this.marginBottom(e.shift());for(var t=void 0,n=void 0,i=void 0;e.length>=3&&(t=parseFloat(e.shift()),n=parseFloat(e.shift()),i=parseInt(e.shift(),10),!(isNaN(t)||isNaN(n)||t<-85||t>85||n<-180||n>180));)this.addPage(!!i,u.default.latLng(t,n));if(e.length){var a=parseInt(e.shift(),10);a>=0&&a<=3&&(this.magneticMerisiansdOn(!!(1&a)),this.gridOn(!!(2&a)))}return!0}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){return e*Math.PI/180}Object.defineProperty(t,"__esModule",{value:!0}),t.Grid=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(80),c=n(2),h=i(c),f=function(e){function t(){var e,n,i,r;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=i=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.minGridIntervalMm=15,i.fontSizeMm=3,i.font="verdana",i.paddingMm=1,i.intervals=[1,1.5,2,3.3,5,7.5,10,15,20,33,50,75,100,150,200,333,500,750,1e3,1500,2e3,4e3,5e3,7500,1e4,15e3,2e4,4e4,5e4,75e3,1e5,15e4,2e5,4e5,5e5,75e4,1e6,15e5,2e6,4e6,5e6,75e5],r=n,o(i,r)}return s(t,e),u(t,[{key:"getGridInterval",value:function(e){
var t=this.minGridIntervalMm/10*e.scale,n=void 0,i=!0,r=!1,a=void 0;try{for(var o,s=this.intervals[Symbol.iterator]();!(i=(o=s.next()).done)&&(n=o.value,!(n>t));i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}},{key:"formatDistance",value:function(e){var t=void 0;return e<1e3?t="m":(e/=1e3,t="km"),e%1&&(e=e.toFixed(1)),e+" "+t}},{key:"_drawGrid",value:function(e,t){var n=h.default.Projection.SphericalMercator.R*Math.PI/180,i=e.getContext("2d");i.beginPath();for(var r=1/25.4*t.resolution,a=this.getGridInterval(t),o=t.destPixelSize.x,s=t.destPixelSize.y,u=h.default.bounds(h.default.Projection.SphericalMercator.project(t.latLngBounds.getNorthWest()),h.default.Projection.SphericalMercator.project(t.latLngBounds.getSouthEast())),d=u.getSize().unscaleBy(t.destPixelSize),c=[],f=s;;){var p=u.max.y-f*d.y,m=h.default.Projection.SphericalMercator.unproject(h.default.point(0,p)).lat;if(c.push({lat:m,y:f}),f<0)break;var v=m+a/n,g=h.default.Projection.SphericalMercator.project(h.default.latLng(v,0)).y;f=(u.max.y-g)/d.y}for(var y=.15,b=y*r,k=[{color:"#D9D9D9",offset:b/2},{color:"#8C8C8C",offset:-b/2}],_=0;_<k.length;_++){var w=k[_],x=w.color,L=w.offset;i.beginPath(),i.lineWidth=b,i.strokeStyle=x;var S=!0,C=!1,M=void 0;try{for(var q,T=c[Symbol.iterator]();!(S=(q=T.next()).done);S=!0)f=q.value.y,i.moveTo(0,f+L),i.lineTo(o,f+L)}catch(P){C=!0,M=P}finally{try{!S&&T.return&&T.return()}finally{if(C)throw M}}for(var I=t.destPixelSize.x/2,D=[-1,1],O=0;O<D.length;O++)for(var E=D[O],z=0;;){var j=!0,Z=!1,N=!0,W=!1,R=void 0;try{for(var K,U=c[Symbol.iterator]();!(N=(K=U.next()).done);N=!0){var A=K.value,G=A.lat,B=A.y,F=z*a/Math.cos(l(G))/d.x;F<I&&(Z=!0),j?i.moveTo(I+F*E+L,B):i.lineTo(I+F*E+L,B),j=!1}}catch(P){W=!0,R=P}finally{try{!N&&U.return&&U.return()}finally{if(W)throw R}}if(!Z)break;z+=1}i.stroke()}}},{key:"_drawLabel",value:function(e,t){var n=this.getGridInterval(t),i=t.destPixelSize.y,r=e.getContext("2d"),a="Grid "+this.formatDistance(n),o=this.fontSizeMm/25.4*t.resolution,s=this.paddingMm/25.4*t.resolution;r.font=o+"px "+this.font;var l=r.measureText(a).width;r.textBaseline="bottom",r.fillStyle="rgba(255, 255, 255, 0.7)",r.fillRect(0,i-o-2*s,l+2*s,o+2*s),r.fillStyle="#000000",r.fillText(a,s,i-s)}},{key:"getTilesInfo",value:function(){function e(e){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{tilePromise:Promise.resolve({draw:function(e){return n._drawGrid(e,t)},isOverlay:!0,overlaySolid:!1}),abortLoading:function(){}};case 2:return e.next=4,{tilePromise:Promise.resolve({draw:function(e){return n._drawLabel(e,t)},isOverlay:!0,overlaySolid:!0}),abortLoading:function(){}};case 4:case"end":return e.stop()}},e,this)}).bind(this),count:2});case 1:case"end":return e.stop()}},e,this)}));return e}()}]),t}(d.PrintStaticLayer);t.Grid=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return e*Math.PI/180}function l(e,t,n){return t=s(t),new c.default.point(e.x+Math.sin(t)*n,e.y-Math.cos(t)*n)}Object.defineProperty(t,"__esModule",{value:!0}),t.MagneticMeridians=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(2),c=i(d),h=n(127),f=n(80),p=function(e){function t(){var e,n,i,o;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=i=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.lineThicknessMm=.2,i.lineIntervalMm=50,i.samplingIntervalMm=15,i.color="#66c2ff",i.overlaySolid=!1,o=n,a(i,o)}return o(t,e),u(t,[{key:"_makeCanvasToLatLngTransformer",value:function(e){var t=e.pixelBounds,n=t.getSize().unscaleBy(e.destPixelSize),i=t.min;return function(t){return c.default.CRS.EPSG3857.pointToLatLng(t.scaleBy(n).add(i),e.zoom)}}},{key:"_drawRaster",value:function(e,t){function n(e,t){r.moveTo(e.x,e.y);for(var n=0;n<=u;n++){var a=i(e),s=(0,h.getDeclination)(a.lat,a.lng);if(null===s)break;t&&(s+=180),e=l(e,s,o),r.lineTo(e.x,e.y)}}var i=this._makeCanvasToLatLngTransformer(t),r=e.getContext("2d");r.beginPath(),r.strokeStyle=this.color,r.lineWidth=this.lineThicknessMm/25.4*t.resolution;var a=this.lineIntervalMm/25.4*t.resolution,o=this.samplingIntervalMm/25.4*t.resolution,s=Math.sqrt(t.destPixelSize.x*t.destPixelSize.x+t.destPixelSize.y*t.destPixelSize.y),u=s/2/o,d=t.destPixelSize.divideBy(2),c=s/2/a;n(d),n(d,!0);for(var f=d,p=0;p<=c;p++){var m=i(f),v=(0,h.getDeclination)(m.lat,m.lng);null===v&&(v=0),f=l(f,v+90,a),n(f),n(f,!0)}f=d;for(var g=0;g<=c;g++){var y=i(f),b=(0,h.getDeclination)(y.lat,y.lng);null===b&&(b=0),f=l(f,b-90,a),n(f),n(f,!0)}r.stroke()}}]),t}(f.PrintStaticLayer);t.MagneticMeridians=p},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){var t=e.destPixelSize.divideBy(e.resolution/25.4),n=e.latLngBounds,i=n.getSouthEast().distanceTo(n.getSouthWest()),r=n.getNorthEast().distanceTo(n.getNorthWest()),a=Math.round(r/t.x*10),o=Math.round(i/t.x*10);return{min:Math.min(a,o,e.scale),max:Math.max(a,o,e.scale)}}function s(e,t){var n=.05;if(Math.abs(e-t.min)/e>n||Math.abs(e-t.max)/e>n){var i=void 0;return t=Object.assign({},t),t.min>=1e3?(t.min/=1e3,t.max/=1e3,i="km"):i="m",t.min+"  "+t.max+" "+i+" in 1 cm"}var r=void 0;return e>=1e3?(e/=1e3,r="km"):r="m",e+" "+r+" in 1 cm"}Object.defineProperty(t,"__esModule",{value:!0}),t.OverlayScale=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(80),d=function(e){function t(){var e,n,a,o;i(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.fontSizeMm=3,a.font="verdana",a.paddingMm=1,a.overlaySolid=!0,o=n,r(a,o)}return a(t,e),l(t,[{key:"_drawRaster",value:function(e,t){var n=e.getContext("2d"),i=s(t.scale,o(t));t.pagesCount>1&&(i+=" | Page "+t.pageLabel+" / "+t.pagesCount);var r=this.fontSizeMm/25.4*t.resolution,a=this.paddingMm/25.4*t.resolution;n.font=r+"px "+this.font;var l=n.measureText(i).width;n.textBaseline="bottom",n.fillStyle="rgba(255, 255, 255, 0.7)",n.fillRect(0,0,l+2*a,r+2*a),n.fillStyle="#000000",n.fillText(i,a,r+a)}}]),t}(u.PrintStaticLayer);t.OverlayScale=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){function n(e){return parseInt(window.getComputedStyle(e).zIndex,10)||0}function i(e,t){return e<t?-1:e>t?1:0}function r(e,t){return o(a(e),a(t))}function a(e){var t=e._container||e._path;if(!t)throw TypeError("Unsupported layer type");for(var i=[];t!==e._map._container;)i.push(n(t)),t=t.parentNode;return i.reverse()}function o(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var a=i(e[r],t[r]);if(a)return a}return i(e.length,t.length)}var s=[];return e.eachLayer(function(e){e.options.print&&s.push(e)}),s.sort(r),s=s.map(function(e){return e.cloneForPrint({xhrQueue:t})})}function l(e,t){if(e.width!==t.width||e.height!==t.height)throw new Error("Canvas size mismatch");var n=e.getContext("2d").getImageData(0,0,e.width,e.height).data;e.width=0,e.height=0;for(var i,r,a,o,s,l,u,d,c,h=t.getContext("2d").getImageData(0,0,t.width,t.height),f=h.data,p=n.length,m=0;m<p;m+=4)o=n[m+3]/255,o&&(i=n[m],r=n[m+1],a=n[m+2],l=f[m],u=f[m+1],d=f[m+2],c=(l+u+d)/3,c=c/255*.5+.5,s=1-o,l=i*c*o+s*l,u=r*c*o+s*u,d=a*c*o+s*d,f[m]=l,f[m+1]=u,f[m+2]=d);n=null,t.getContext("2d").putImageData(h,0,0)}Object.defineProperty(t,"__esModule",{value:!0}),t.renderPages=void 0;var u=function(){function e(e){this.value=e}function t(t){function n(e,t){return new Promise(function(n,r){var s={key:e,arg:t,resolve:n,reject:r,next:null};o?o=o.next=s:(a=o=s,i(e,t))})}function i(n,a){try{var o=t[n](a),s=o.value;s instanceof e?Promise.resolve(s.value).then(function(e){i("next",e)},function(e){i("throw",e)}):r(o.done?"return":"normal",o.value)}catch(l){r("throw",l)}}function r(e,t){switch(e){case"return":a.resolve({value:t,done:!0});break;case"throw":a.reject(t);break;default:a.resolve({value:t,done:!1})}a=a.next,a?i(a.key,a.arg):o=null}var a,o;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function(){var e=u.wrap(regeneratorRuntime.mark(function e(t,n,i,r,a,o,s,l){var d,c,h,f,p,g,y,b,k,_=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d={responseType:"blob",timeout:2e4,isResponseSuccess:function(e){return 200===e.status||404===e.status}},c=void 0,h=!0,f=!1,p=void 0,e.prev=5,g=regeneratorRuntime.mark(function e(){var t,h,f,p,g,y,k,w,x,L,S,C,M,q,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=b.value,h=void 0,h=t.options&&t.options.scaleDependent?o.mapZoom:o.satZoom,f=m.default.bounds(m.default.CRS.EPSG3857.latLngToPoint(n.getNorthWest(),h).round(),m.default.CRS.EPSG3857.latLngToPoint(n.getSouthEast(),h).round()),p=void 0,t._layerDummy||(p=(0,v.getTempMap)(h,t._rasterizeNeedsFullSizeMap,f),p.addLayer(t)),e.next=8,u.await(t.getTilesInfo({xhrOptions:d,pixelBounds:f,latLngBounds:n,destPixelSize:i,resolution:r,scale:a,zoom:h,pageLabel:s,pagesCount:l}));case 8:g=e.sent,y=g.iterateTilePromises,k=g.count,w=[],x=!0,L=!1,S=void 0,e.prev=15,C=regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=q.value,w.push(n.tilePromise),i=(t._printProgressWeight||1)/k,n.tilePromise=n.tilePromise.then(function(e){return Object.assign({zoom:h,progressInc:i},e)}),e.next=6,n;case 6:if(c=e.sent,!c){e.next=10;break}return n.abortLoading(),e.abrupt("return","break");case 10:case"end":return e.stop()}},e,_)}),M=y()[Symbol.iterator]();case 18:if(x=(q=M.next()).done){e.next=26;break}return e.delegateYield(C(),"t0",20);case 20:if(T=e.t0,"break"!==T){e.next=23;break}return e.abrupt("break",26);case 23:x=!0,e.next=18;break;case 26:e.next=32;break;case 28:e.prev=28,e.t1=e.catch(15),L=!0,S=e.t1;case 32:e.prev=32,e.prev=33,!x&&M.return&&M.return();case 35:if(e.prev=35,!L){e.next=38;break}throw S;case 38:return e.finish(35);case 39:return e.finish(32);case 40:if(t._layerDummy){e.next=47;break}if(!c){e.next=46;break}return(0,v.disposeMap)(p),e.abrupt("return","break");case 46:Promise.all(w).then(function(){return(0,v.disposeMap)(p)});case 47:case"end":return e.stop()}},e,_,[[15,28,32,40],[33,,35,39]])}),y=t[Symbol.iterator]();case 8:if(h=(b=y.next()).done){e.next=16;break}return e.delegateYield(g(),"t0",10);case 10:if(k=e.t0,"break"!==k){e.next=13;break}return e.abrupt("break",16);case 13:h=!0,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(5),f=!0,p=e.t1;case 22:e.prev=22,e.prev=23,!h&&y.return&&y.return();case 25:if(e.prev=25,!f){e.next=28;break}throw p;case 28:return e.finish(25);case 29:return e.finish(22);case 30:case"end":return e.stop()}},e,this,[[5,18,22,30],[23,,25,29]])}));return function(t,n,i,r,a,o,s,l){return e.apply(this,arguments)}}(),h=function(){var e=u.wrap(regeneratorRuntime.mark(function e(t,n){var i,r,a,o,s,l,d,c,h,f,p,m,v,g,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=[];case 1:if(!(i.length<n)){e.next=12;break}return e.next=4,u.await(t.next());case 4:if(r=e.sent,a=r.value,o=r.done,!o){e.next=9;break}return e.abrupt("break",12);case 9:i.push(a),e.next=1;break;case 12:if(!i.length){e.next=51;break}return e.next=15,i.shift();case 15:if(s=e.sent,!s){e.next=43;break}return e.next=19,u.await(t.next(!0));case 19:for(l=e.sent,d=l.value,c=l.done,c||i.push(d),h=!0,f=!1,p=void 0,e.prev=26,m=i[Symbol.iterator]();!(h=(v=m.next()).done);h=!0)(g=v.value.abortLoading)();e.next=34;break;case 30:e.prev=30,e.t0=e.catch(26),f=!0,p=e.t0;case 34:e.prev=34,e.prev=35,!h&&m.return&&m.return();case 37:if(e.prev=37,!f){e.next=40;break}throw p;case 40:return e.finish(37);case 41:return e.finish(34);case 42:return e.abrupt("return");case 43:return e.next=45,u.await(t.next());case 45:y=e.sent,a=y.value,o=y.done,o||i.push(a),e.next=12;break;case 51:case"end":return e.stop()}},e,this,[[26,30,34,42],[35,,37,41]])}));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=a(regeneratorRuntime.mark(function e(t){var n,i,a,o,l,u,d,f,p,v,b,k,_,w,x,L,S,C,M,q,T,P,I,D,O,E,z,j=t.map,Z=t.pages,N=t.zooms,W=t.resolution,R=t.scale,K=t.progressCallback,U=t.decorationLayers;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=new g.XHRQueue,i=s(j,n),i.push.apply(i,r(U)),a=0,o=!0,l=!1,u=void 0,e.prev=7,d=i[Symbol.iterator]();!(o=(f=d.next()).done);o=!0)p=f.value,a+=p._printProgressWeight||1;e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),l=!0,u=e.t0;case 15:e.prev=15,e.prev=16,!o&&d.return&&d.return();case 18:if(e.prev=18,!l){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:a*=Z.length,v=[],b=!0,k=!1,_=void 0,e.prev=28,w=Z[Symbol.iterator]();case 30:if(b=(x=w.next()).done){e.next=69;break}return L=x.value,S=L.printSize.multiplyBy(W/25.4).round(),C=m.default.bounds(j.project(L.latLngBounds.getNorthWest(),24).round(),j.project(L.latLngBounds.getSouthEast(),24).round()),M=new y(S,C),e.next=37,c(i,L.latLngBounds,S,W,R,N,L.label,Z.length);case 37:q=e.sent,T=h(q,20);case 39:return e.next=42,T.next();case 42:if(P=e.sent,I=P.value,D=P.done,!D){e.next=47;break}return e.abrupt("break",62);case 47:return O=void 0,e.prev=48,e.next=51,I.tilePromise;case 51:O=e.sent,e.next=58;break;case 54:throw e.prev=54,e.t1=e.catch(48),T.next(!0),e.t1;case 58:K(O.progressInc,a),M.putTile(O),e.next=39;break;case 62:E=M.getDataUrl(),z=E.substring(E.indexOf(",")+1),z=atob(z),v.push({data:z,width:S.x,height:S.y});case 66:b=!0,e.next=30;break;case 69:e.next=75;break;case 71:e.prev=71,e.t2=e.catch(28),k=!0,_=e.t2;case 75:e.prev=75,e.prev=76,!b&&w.return&&w.return();case 78:if(e.prev=78,!k){e.next=81;break}throw _;case 81:return e.finish(78);case 82:return e.finish(75);case 83:return e.abrupt("return",v);case 84:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22],[28,71,75,83],[48,54],[76,,78,82]])}));return function(t){return e.apply(this,arguments)}}(),p=n(2),m=i(p),v=n(122),g=n(24),y=function(){function e(t,n){o(this,e),this.destSize=t,this.projectedBounds=n,this.currentCanvas=null,this.currentZoom=null,this.targetCanvas=this.createCanvas(t)}return d(e,[{key:"createCanvas",value:function(e){var t=m.default.DomUtil.create("canvas");return t.width=e.x,t.height=e.y,t}},{key:"putTile",value:function(e){if(e.isOverlay||e.image){var t=void 0;if(t=e.isOverlay?e.overlaySolid?"solidOverlay":"overlay":e.zoom,t!==this.currentZoom&&(this.mergeCurrentCanvas(),this.setupCurrentCanvas(t)),e.isOverlay)e.draw(this.currentCanvas);else{var n=this.currentCanvas.getContext("2d"),i=e.tilePos,r=e.tileSize;n.drawImage(e.image,i.x,i.y,r.x,r.y)}}}},{key:"setupCurrentCanvas",value:function(e){var t=void 0;if("overlay"===e||"solidOverlay"===e)t=this.destSize;else{var n=1<<24-e,i=this.projectedBounds.min.divideBy(n).round(),r=this.projectedBounds.max.divideBy(n).round();t=r.subtract(i)}this.currentCanvas=this.createCanvas(t),this.currentZoom=e}},{key:"mergeCurrentCanvas",value:function(){this.currentCanvas&&("overlay"===this.currentZoom?l(this.currentCanvas,this.targetCanvas):this.targetCanvas.getContext("2d").drawImage(this.currentCanvas,0,0,this.destSize.x,this.destSize.y),this.currentCanvas.width=0,this.currentCanvas.height=0,this.currentCanvas=null)}},{key:"getDataUrl",value:function(){this.mergeCurrentCanvas();var e=this.targetCanvas.toDataURL("image/jpeg");return this.targetCanvas.width=0,this.targetCanvas.height=0,this.targetCanvas=null,e}}]),e}();t.renderPages=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=i(a);n(459);var s=o.default.Marker.extend({initialize:function(e,t,n,i){this.paperSize=t,this.scale=n;var r=o.default.divIcon({className:"print-page-marker",html:i});o.default.Marker.prototype.initialize.call(this,e,{icon:r,draggable:!0,title:"Left click to rotate, right click for menu"}),this.on("drag",this.updateView.bind(this,void 0))},onAdd:function(e){var t=this;o.default.Marker.prototype.onAdd.call(this,e),e.on("viewreset",function(){return t.updateView()}),this.rectangle=o.default.rectangle([[0,0],[0,0]],{color:"#ff7800",weight:2,opacity:.7,fillOpacity:.2}).addTo(e),this.updateView()},onRemove:function(e){e.off("viewreset",this.updateView,this),o.default.Marker.prototype.onRemove.call(this,e),this.rectangle.removeFrom(e)},getLatLngBounds:function(){return this.latLngBounds},_getLatLngBounds:function(){var e=this.getLatLng(),t=o.default.Projection.SphericalMercator.project(e),n=Math.cos(e.lat*Math.PI/180)*o.default.CRS.Earth.R/o.default.Projection.SphericalMercator.R,i=o.default.point.apply(o.default,r(this.paperSize)).multiplyBy(this.scale/10/n),a=t.subtract(i.divideBy(2)),s=t.add(i.divideBy(2));return a=o.default.Projection.SphericalMercator.unproject(a),s=o.default.Projection.SphericalMercator.unproject(s),o.default.latLngBounds([a,s])},_animateZoom:function(e){o.default.Marker.prototype._animateZoom.call(this,e),this.updateView(e.zoom)},updateView:function(e){if(this._map){void 0===e&&(e=this._map.getZoom());var t=this.latLngBounds=this._getLatLngBounds(),n=this._map.project(t.getSouthWest(),e),i=this._map.project(t.getNorthEast(),e),r=this._map.project(this.getLatLng(),e),a=this._icon.style,o=i.x-n.x,s=n.y-i.y;a.width=o+"px",a.height=s+"px",a.marginLeft=n.x-r.x+"px",a.marginTop=i.y-r.y+"px",a.fontSize=Math.min(o,s,500)/2+"px",a.lineHeight=s+"px",this.rectangle.setBounds(t)}},setLabel:function(e){this._icon.innerHTML=e},getLabel:function(){return this._icon.innerHTML},setSize:function(e,t){this.paperSize=e,this.scale=t,this.updateView()},getPrintSize:function(){return o.default.point.apply(o.default,r(this.paperSize))},rotate:function(e){this.paperSize=[this.paperSize[1],this.paperSize[0]],this.updateView()}});t.default=s},function(e,t){"use strict";function n(){return"%PDF-1.3"}function i(){return"%%EOF\n"}function r(){return"1 0 obj\n<< /Type /Catalog\n/Pages 2 0 R\n>>\nendobj"}function a(e){for(var t=[],n=0;n<e;n++)t.push(3*n+3+" 0 R");return t=t.join(" "),"2 0 obj\n<< /Type /Pages        \n/Kids [ "+t+" ]\n/Count "+e+"\n>>\nendobj"}function o(e,t,n){var i=3*e+3,r=i+1,a=i+2;return i+" 0 obj\n<< /Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 "+t+" "+n+"]\n/Contents "+r+" 0 R\n/Resources <<\n    /XObject << /Im"+e+" "+a+" 0 R >>\n    /ProcSet [ /PDF /Text /ImageC ] \n    >>\n>>\nendobj"}function s(e,t,n){var i=3*e+3,r=i+1,a="q\n"+t+" 0 0 "+n+" 0 0 cm\n/Im"+e+" Do\nQ   ";return r+" 0 obj\n<<\n/Length "+(a.length+1)+"\n>>\nstream\n"+a+"   \nendstream\nendobj"}function l(e,t,n,i){var r=3*e+3,a=r+2;return a+" 0 obj\n<< /Type /XObject\n/Subtype /Image\n/Name /Im"+e+"\n/Filter [ /DCTDecode ]\n/Width "+t+"\n/Height "+n+"\n/ColorSpace /DeviceRGB\n/BitsPerComponent 8\n/Length "+i.length+"\n>>\nstream\n"+i+"\nendstream\nendobj"}function u(e,t){var n=[];n.push("xref\n0 "+(e.length+1)+"\n0000000000 65535 f ");var i="0000000000",r=!0,a=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;u=u.toString();var d=i.substr(u.length);n.push(""+d+u+" 00000 n ")}}catch(c){a=!0,o=c}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}return n.push("trailer\n<< /Root 1 0 R\n/Size "+(e.length+1)+"\n>>\nstartxref\n"+t),n.join("\n")}function d(e,t){function d(e,t){p.push(e),t||f.push(h),h+=e.length}var h=0,f=[],p=[];d(n(),!0),d(r()),d(a(e.length));var m=!0,v=!1,g=void 0;try{for(var y,b=e.entries()[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var k=c(y.value,2),_=k[0],w=k[1],x=w.data,L=w.width,S=w.height,C=L/t*72,M=S/t*72;d(o(_,C,M)),d(s(_,C,M)),d(l(_,L,S,x))}}catch(q){v=!0,g=q}finally{try{!m&&b.return&&b.return()}finally{if(v)throw g}}return d(u(f,h),!0),d(i(),!0),p=p.join("\n")}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.makePdf=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(82),n(460),n(38),n(31),a.default.Control.TrackList.Ruler=a.default.Control.extend({options:{position:"topleft"},initialize:function(e,t){a.default.Control.prototype.initialize.call(this,t),this._trackList=e},onAdd:function(e){this._map=e;var t=this._container=a.default.DomUtil.create("div","leaflet-control leaflet-control-button leaflet-control-ruler");return t.title="Measure distance",this._stopContainerEvents(),a.default.DomEvent.on(t,"click",this.onClick,this),t},onClick:function(){this._trackList.setExpanded(),this._trackList.addNewTrack("Ruler").measureTicksShown(!0)}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var i,r,a=[];return a.push('<?xml version="1.0" encoding="UTF-8" standalone="no" ?>'),a.push('<gpx xmlns="http://www.topografix.com/GPX/1/1" creator="http://nakarte.tk" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">'),e.length&&(t=t||"Track",t=(0,h.default)(t),t=d.default.encode(t),a.push("\t<trk>"),a.push("\t\t<name>"+t+"</name>"),e.forEach(function(e){e.length>1&&(a.push("\t\t<trkseg>"),e.forEach(function(e){i=e.lng.toFixed(6),r=e.lat.toFixed(6),a.push('\t\t\t<trkpt lat="'+r+'" lon="'+i+'"></trkpt>')}),a.push("\t\t</trkseg>"))}),a.push("\t</trk>")),n.forEach(function(e){var t=e.label;t=(0,h.default)(t),t=d.default.encode(t),a.push('\t<wpt lat="'+e.latlng.lat.toFixed(6)+'" lon="'+e.latlng.lng.toFixed(6)+'">'),a.push("\t\t<name>"+t+"</name>"),a.push("\t</wpt>")}),a.push("</gpx>"),a=a.join("\n")}function a(e,t,n){var i,r,a=[];return t=t||"Track",t=(0,h.default)(t),t=d.default.encode(t),a.push('<?xml version="1.0" encoding="UTF-8"?>'),a.push('<kml xmlns="http://earth.google.com/kml/2.2">'),a.push("\t<Document>"),a.push("\t\t<name>"+t+"</name>"),e.forEach(function(e,t){e.length>1&&(a.push("\t\t<Placemark>","\t\t\t<name>Line "+(t+1)+"</name>","\t\t\t<LineString>","\t\t\t\t<tessellate>1</tessellate>","\t\t\t\t<coordinates>"),e.forEach(function(e){i=e.lng.toFixed(6),r=e.lat.toFixed(6),a.push("\t\t\t\t\t"+i+","+r)}),a.push("\t\t\t\t</coordinates>","\t\t\t</LineString>","\t\t</Placemark>"))}),n.forEach(function(e){var t=e.label;t=(0,h.default)(t),t=d.default.encode(t);var n=e.latlng.lng.toFixed(6)+","+e.latlng.lat.toFixed(6)+",0";a.push("\t\t<Placemark>"),a.push("\t\t\t<name>"+t+"</name>"),a.push("\t\t\t<Point>"),a.push("\t\t\t\t<coordinates>"+n+"</coordinates>"),a.push("\t\t\t</Point>"),a.push("\t\t</Placemark>")}),a.push("\t</Document>"),a.push("\t</kml>"),a=a.join("\n")}function o(e){var t=[];if(e>=-64&&e<=63)e+=64,t.push(e);else if(e>=-8192&&e<=8191)e+=8192,t.push(127&e|128),t.push(e>>7);else if(e>=-1048576&&e<=1048575)e+=1048576,t.push(127&e|128),t.push(e>>7&127|128),t.push(e>>14);else{if(!(e>=-268435456&&e<=268435455))throw new Error("Number "+e+" too big to pack in 29 bits");e+=268435456,t.push(127&e|128),t.push(e>>7&127|128),t.push(e>>14&127|128),t.push(e>>21)}return String.fromCharCode.apply(null,t)}function s(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function l(e,t,n,i,r,a){var l=[];l.push(o(3)),t=d.default.encode(t),l.push(o(t.length)),l.push(t);var u=46603.375;if(e=e.filter(function(e){return e.length>1}),l.push(o(e.length)),e.forEach(function(e){var t,n,i,r,a,s=0,d=0;l.push(o(e.length));for(var c=0,h=e.length;c<h;c++)a=e[c],t=Math.round(a.lng*u),n=Math.round(a.lat*u),i=t-s,r=n-d,l.push(o(i)),l.push(o(r)),s=t,d=n}),l.push(o(+n||0)),l.push(o(i?1:0)),l.push(o(a?1:0)),l.push(o(r.length)),r.length){var c=0,h=0;r.forEach(function(e){c+=e.latlng.lng,h+=e.latlng.lat}),c=Math.round(c*u/r.length),h=Math.round(h*u/r.length),l.push(o(c)),l.push(o(h)),r.forEach(function(e){var t=Math.round(e.latlng.lng*u)-c,n=Math.round(e.latlng.lat*u)-h,i=1,r=d.default.encode(e.label);l.push(o(r.length)),l.push(r),l.push(o(i)),l.push(o(t)),l.push(o(n))})}return s(l.join(""))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(110),d=i(u),c=n(164),h=i(c);t.default={saveGpx:r,saveKml:a,saveToString:l}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return Object.entries(e).map(function(e){var t=s(e,2),n=t[0],i=t[1];return n+"="+encodeURIComponent(i)}).join("&")}function a(e){return d.test(e)}function o(e,t){var n=d.exec(e);if(!n)throw new Error("Invalid gpsies url");var i=n[1],a=(0,u.default)("http://www.gpsies.com/download.do");return[a,{method:"POST",data:r({fileId:i,speed:"10",dataType:"3",filetype:"gpxTrk",submitButton:"",inappropriate:""}),headers:[["Content-type","application/x-www-form-urlencoded"]],responseType:"binarystring"}]}Object.defineProperty(t,"__esModule",{value:!0}),t.isGpsiesUrl=t.gpsiesXhrOptions=void 0;var s=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=n(60),u=i(l),d=/^https?:\/\/www\.gpsies\.com\/map\.do\?fileId=([a-z]+)/;t.gpsiesXhrOptions=o,t.isGpsiesUrl=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r),o=n(81);a.default.Control.TrackList.include(a.default.Mixin.HashState),a.default.Control.TrackList.include({stateChangeEvents:[],serializeState:function(e){return null},unserializeState:function(e){if(e&&e.length){var t=(0,o.parseGeoFile)("",window.location.href),n=this.addTracksFromGeodataArray(t);n&&this.setExpanded()}return!1}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}n(82);var r=n(2),a=i(r),o=n(81),s=n(63),l=i(s);a.default.Control.TrackList.include({maxLocalStorageSessions:5,saveTracksToStorage:function(){var e,t,n,i,r,a=this.tracks(),o=[],s=-1,u=[];for(e=0;e<l.default.length;e++)i=l.default.key(e),r=i.match(/^trackList_(\d+)$/),r&&void 0!==r[1]&&+r[1]>s&&(s=+r[1]);if(i="trackList_"+(s+1),0===a.length)return void l.default.setItem(i,"");for(e=0;e<a.length;e++)t=a[e],n=this.trackToString(t),o.push(n);if(0!==o.length){for(n="#nktk="+o.join("/"),l.default.setItem(i,n),e=0;e<l.default.length;e++)i=l.default.key(e),r=i.match(/^trackList_(\d+)$/),r&&void 0!==r[1]&&u.push(+r[1]);if(u.length>this.maxLocalStorageSessions)for(u.sort(function(e,t){return e-t}),e=0;e<u.length-this.maxLocalStorageSessions;e++)i="trackList_"+u[e],l.default.removeItem(i)}},loadTracksFromStorage:function(){var e,t,n,i,r,a=-1;for(e=0;e<l.default.length;e++)t=l.default.key(e),n=t.match(/^trackList_(\d+)$/),n&&void 0!==n[1]&&+n[1]>a&&(a=+n[1]);a>-1&&(t="trackList_"+a,i=l.default.getItem(t),l.default.removeItem(t),i&&(r=(0,o.parseGeoFile)("",i),this.addTracksFromGeodataArray(r)))}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){function t(e){var t=!0,n=!1,r=void 0;try{for(var a,o=i[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var l=a.value;l===e?s.default.DomUtil.addClass(l,"leaflet-controls-corner-raised"):s.default.DomUtil.removeClass(l,"leaflet-controls-corner-raised")}}catch(u){n=!0,r=u}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}var n=[".leaflet-top.leaflet-right",".leaflet-bottom.leaflet-right",".leaflet-top.leaflet-left",".leaflet-bottom.leaflet-left"],i=e._container.querySelectorAll(n.join(","));[].concat(r(i)).forEach(function(e){return s.default.DomEvent.on(e,"mouseenter",t.bind(null,e))})}Object.defineProperty(t,"__esModule",{value:!0}),n(462);var o=n(2),s=i(o);t.default=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(){a(),o(),s()}function a(){if(u.default.Browser.chrome&&!u.default.PosAnimation.prototype.__panAnimationFixed){var e=u.default.PosAnimation.prototype._step;u.default.PosAnimation.prototype._step=function(){return e.call(this,!0)},u.default.PosAnimation.prototype.__panAnimationFixed=!0}}function o(){u.default.Browser.touch&=navigator.pointerEnabled&&!u.default.Browser.ie||navigator.maxTouchPoints}function s(){var e=u.default.Map.prototype._handleDOMEvent;u.default.Map.prototype._handleDOMEvent=function(t){"keypress"===t.type&&13===t.keyCode?this._fireDOMEvent(t,t.type):e.call(this,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.fixAll=void 0;var l=n(2),u=i(l);n(463),t.fixAll=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(61),a.default.Control.Layers.include(a.default.Mixin.HashState),
a.default.Control.Layers.include({stateChangeEvents:["baselayerchange","overlayadd","overlayremove"],stateChangeEventsSource:"_map",serializeState:function(e){var t=[];this._map.eachLayer(function(e){var n=e.options.code;n&&t.push([n,e.options.zIndex])}),t.sort(function(e,t){return e[1]-t[1]});var n=t.map(function(e){return e[0]});return n},unserializeState:function(e){if(!e||0===e.length)return!1;var t=void 0,n=!0,i=!1,r=void 0;try{for(var a,o=this._layers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.layer.options&&e.includes(s.layer.options.code)&&!s.overlay){t=!0;break}}}catch(l){i=!0,r=l}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}if(!t)return!1;var u=!0,d=!1,c=void 0;try{for(var h,f=this._layers[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;p.layer.options&&e.includes(p.layer.options.code)?this._map.addLayer(p.layer):this._map.removeLayer(p.layer)}}catch(l){d=!0,c=l}finally{try{!u&&f.return&&f.return()}finally{if(d)throw c}}return!0}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(61),a.default.Map.include(a.default.Mixin.HashState),a.default.Map.include({stateChangeEvents:["moveend"],serializeState:function(){var e=this.getCenter(),t=this.getZoom(),n=5,i=[t.toString(),e.lat.toFixed(n),e.lng.toFixed(n)];return i},unserializeState:function(e){if(!e||3!==e.length)return!1;var t=parseInt(e[0],10),n=parseFloat(e[1]),i=parseFloat(e[2]);return!(isNaN(t)||isNaN(n)||isNaN(i)||t<0||t>32||n<-90||n>90)&&(this.setView([n,i],t),!0)}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r),o=n(24),s=n(35),l=n(23),u=i(l);a.default.Layer.GeoJSONAjax=a.default.GeoJSON.extend({options:{requestTimeout:3e4},initialize:function(e,t){a.default.GeoJSON.prototype.initialize.call(this,null,t),this.url=e},loadData:function(){var e=this;this._loadStarted||(this._loadStarted=!0,(0,o.fetch)(this.url,{timeout:this.options.requestTimeout}).then(function(t){e.addData(JSON.parse(t.response))},function(t){u.default.captureException(t,{extra:{description:"failed to get geojson",url:e.url,status:t.xhr.status}}),(0,s.notify)("Failed to get GeoJSON data from "+e.url+": "+t.message)}))},onAdd:function(e){a.default.GeoJSON.prototype.onAdd.call(this,e),this.loadData()}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=void 0;if(t=JSON.parse(e),!t.token)throw new Error("no token in response");return t.token}function a(){return(0,l.fetch)("https://www.ut.no/kart/HentBaatToken/",{timeout:1e4}).then(function(e){try{return{token:r(e.responseText)}}catch(t){return c.default.captureException(t,{extra:{description:"Invalid baat token",response:e.responseText.toString().slice(0,100)}}),{error:"Server returned invalid token for Norway map"}}},function(e){return c.default.captureException(e,{extra:{description:"failed to download baat token"}}),{error:"Failed to token for Norway map: "+e.message}})}var o=n(2),s=i(o),l=n(24),u=n(35),d=n(23),c=i(d),h=n(63),f=i(h);s.default.TileLayer.Nordeskart=s.default.TileLayer.extend({options:{tokenUpdateInterval:3e5},initialize:function(e,t){this.__url=e,s.default.TileLayer.prototype.initialize.call(this,"",t)},baatTokenUpToDate:function(){var e=0;return e=parseInt(f.default.getItem("baatTokenNextUpdate"),10)||0,Date.now()<e&&f.default.getItem("baatToken")},storeBaatToken:function(e){f.default.setItem("baatToken",e),f.default.setItem("baatTokenNextUpdate",Date.now().toString()+this.options.tokenUpdateInterval)},periodicTokenUpdate:function(){var e=this;this._map&&a().then(function(t){t.error?(0,u.notify)(t.error):(t.token!==e.options.baatToken&&(e.options.baatToken=t.token,e._url||e.setUrl(e.__url)),e.storeBaatToken(t.token)),setTimeout(function(){return e.periodicTokenUpdate()},e.options.tokenUpdateInterval)})},onAdd:function(e){var t=this.baatTokenUpToDate();return t&&(this.options.baatToken=t,this.setUrl(this.__url)),this.periodicTokenUpdate(),s.default.TileLayer.prototype.onAdd.call(this,e)}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(118),a.default.BingLayer.include({waitTilesReadyToGrab:function(){var e=this;return this._url?Promise.resolve():new Promise(function(t){var n=setInterval(function(){e._url&&(clearInterval(n),t())},50)})},cloneForPrint:function(e){return new a.default.BingLayer(this._key,a.default.Util.extend({},this.options,e))}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(119);var o=n(121),s=a.default.Layer.Google.extend({includes:o.TileLayerGrabMixin,_rasterizeNeedsFullSizeMap:!0,_dummyTile:a.default.DomUtil.create("div"),onAdd:function(e){var t=this;this._waitTilesReadyToGrab=new Promise(function(e){t._tilesReadyToGrab=e}),a.default.Layer.Google.prototype.onAdd.call(this,e)},waitTilesReadyToGrab:function(){return this._waitTilesReadyToGrab},createTile:function(){return this._dummyTile},_fullfillPendingTiles:function(){Object.keys(this._readyTiles).length&&this._tilesReadyToGrab()},getTileUrl:function(e){return this._readyTiles[this._tileCoordsToKey(e)]||null}});a.default.Layer.Google.include({cloneForPrint:function(e){return new s(this.mapType,a.default.Util.extend({},this.options,e))}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}var a=n(2),o=i(a);n(126),o.default.Polyline.include({_printProgressWeight:.1,printWidthMm:1,cloneForPrint:function(e){e=o.default.Util.extend({},this.options,e);var t=this.getLatLngs().map(function(e){return e.clone()});return new o.default.Polyline(t,e)},_makelatLngToCanvasPixelTransformer:function(e){var t=e.pixelBounds,n=t.getSize().unscaleBy(e.destPixelSize),i=t.min;return function(t){return o.default.CRS.EPSG3857.latLngToPoint(t,e.zoom).subtract(i).unscaleBy(n)}},_drawRaster:function(e,t){var n=this.getLatLngs();if(n.length&&this.getBounds().intersects(t.latLngBounds)){var i=e.getContext("2d");i.lineWidth=this.printWidthMm/25.4*t.resolution,i.lineJoin="round",i.strokeStyle=this.options.color;var r=this._makelatLngToCanvasPixelTransformer(t),a=void 0;i.beginPath(),a=r(n[0]),i.moveTo(a.x,a.y);for(var o=1;o<n.length;o++)a=r(n[o]),i.lineTo(a.x,a.y);return i.stroke(),!0}},getTilesInfo:function(){function e(e){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{tilePromise:Promise.resolve({draw:function(e){return n._drawRaster(e,t)},isOverlay:!0}),abortLoading:function(){}};case 2:case"end":return e.stop()}},e,this)}).bind(this),count:1});case 1:case"end":return e.stop()}},e,this)}));return e}()}),o.default.MeasuredLine.include({tickFontSizeMm:2.5,cloneForPrint:function(e){e=o.default.Util.extend({},this.options,e);var t=this.getLatLngs().map(function(e){return e.clone()});return new o.default.MeasuredLine(t,e)},_drawRaster:function(e,t){if(o.default.Polyline.prototype._drawRaster.call(this,e,t)&&this.options.measureTicksShown){var n=1.5*t.scale,i=e.getContext("2d"),r=this.getTicksPositions(n),a=this.tickFontSizeMm/25.4*t.resolution,s=this._makelatLngToCanvasPixelTransformer(t);i.font="bold "+a+"px verdana",i.fillStyle=this.options.color;var l=!0,u=!1,d=void 0;try{for(var c,h=r[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var f=c.value,p=f.transformMatrix,m=" "+Math.round(f.distanceValue/10)/100+" km",v=s(f.position);i.setTransform(p[0],p[1],p[2],p[3],v.x,v.y),i.fillText(m,0,.3*a),i.setTransform(1,0,0,1,0,0)}}catch(g){u=!0,d=g}finally{try{!l&&h.return&&h.return()}finally{if(u)throw d}}}}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}var a=n(2),o=i(a);n(123);var s=n(124);n(62),n(120),o.default.Layer.WestraPasses.addInitHook(function(){this.markers.options.print=this.options.print,this.options.print=!1}),s.WestraPassesMarkers.include({waitDataReady:function(){var e=this;return this._dataLoaded?Promise.resolve():new Promise(function(t){e.on("data-loaded",t)})},cloneForPrint:function(e){return e=o.default.Util.extend({},e),new s.WestraPassesMarkers(this._baseUrl,e)},getTilesInfo:function(){function e(e){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitDataReady();case 2:return e.next=4,o.default.Layer.CanvasMarkers.prototype.getTilesInfo.call(this,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return e}()})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(125),a.default.Layer.Yandex.include({cloneForPrint:function(e){return new a.default.Layer.Yandex(this._mapType,a.default.Util.extend({},this.options,e))}})},function(e,t){"use strict";function n(e){if(200===e.status&&e.response.size){var t=new Image,n=window.URL.createObjectURL(e.response),i=new Promise(function(e,i){t.onload=function(){e(t),window.URL.revokeObjectURL(n)},t.onerror=function(){i(new Error("Image corrupt"))}});return t.src=n,i}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.imgFromDataString=n},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}var a=n(2),o=i(a);n(465);var s=n(56),l=i(s),u=n(79),d=i(u),c=[{1:"",2:"",3:"",4:""},{1:"A",2:"B",3:"C",4:"D"}],h={getQuadName1m:function(e,t,n){var i="";t<0&&(t=-t-1,i+="x"),e+=31,i+="ABCDEFGHIJKLMNOPQRSTUV"[t]+"-"+r(e,2);for(var a=1;a<=n-1;a++)i+=","+r(e+a,2);return[i]},getQuadName500k:function(e,t,n){var i=this.getQuadName1m(Math.floor(e/2),Math.floor(t/2),1)[0],r=2-2*(1&t)+(1&e)+1,a="-"+r;n>1&&(a+=","+(r+1)),4===n&&(a+=","+this.getQuadName1m(Math.floor((e+2)/2),Math.floor(t/2),1)+"-"+r+","+(r+1));var o=[i+a],s=!0,l=!1,u=void 0;try{for(var d,h=function(){var e=d.value,t=a.replace(/\b[1-4]\b/g,function(t){return e[t]});o.push(i+t)},f=c[Symbol.iterator]();!(s=(d=f.next()).done);s=!0)h()}catch(p){l=!0,u=p}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}return o},getQuadName100k:function(e,t,n){var i=this.getQuadName1m(Math.floor(e/12),Math.floor(t/12),1),a=t-12*Math.floor(t/12),o=e-12*Math.floor(e/12),s=132-12*a+o+1;return i=i+"-"+r(s,3),n>1&&(i+=","+r(s+1,3)),4===n&&(i+=","+r(s+2,3)+","+r(s+3,3)),[i]},getQuadName050k:function(e,t,n){var i=this.getQuadName100k(Math.floor(e/2),Math.floor(t/2),1),r=2-2*(1&t)+(1&e)+1,a="-"+r;n>1&&(a+=","+(r+1)),4===n&&(a+=","+this.getQuadName100k(Math.floor((e+2)/2),Math.floor(t/2),1)+"-"+r+","+(r+1));var o=[i+a],s=!0,l=!1,u=void 0;try{for(var d,h=function(){var e=d.value,t=a.replace(/\b[1-4]\b/g,function(t){return e[t]});o.push(i+t)},f=c[Symbol.iterator]();!(s=(d=f.next()).done);s=!0)h()}catch(p){l=!0,u=p}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}return o},_getQuads:function(e,t,n,i){e=o.default.latLngBounds(e);for(var r=[],a=Math.max(e.getSouth(),-84),s=Math.min(e.getNorth(),84),l=Math.floor(a/t),u=l;u*t<s;u++){var d,c=u*t,h=c+t;d=c>=76||h<=-76?4:c>=60||h<=-60?2:1;for(var f=Math.max(e.getWest(),-180),p=Math.min(e.getEast(),180),m=Math.floor((f+180)/n/d)*d-Math.round(180/n),v=m;v*n<p;v+=d){var g=v*n,y=g+n*d,b=o.default.latLngBounds([[c,g],[h,y]]),k=i(v,u,d);r.push({names:k,bounds:b})}}return r},getQuads1m:function(e){return this._getQuads(e,4,6,this.getQuadName1m)},getQuads500k:function(e){return this._getQuads(e,2,3,this.getQuadName500k.bind(this))},getQuads100k:function(e){return this._getQuads(e,4/12,.5,this.getQuadName100k.bind(this))},getQuads050k:function(e){return this._getQuads(e,4/12/2,.25,this.getQuadName050k.bind(this))}};o.default.Layer.SovietTopoGrid=o.default.LayerGroup.extend({options:{},initialize:function(e){o.default.LayerGroup.prototype.initialize.call(this),o.default.Util.setOptions(this,e),this.renderer=o.default.svg({padding:.5}),this._quads={},this._updateRenderer=o.default.Util.throttle(this._updateRenderer,100,this)},onAdd:function(e){this._map=e,e.on("zoomend",this._reset,this),e.on("move",this._update,this),e.on("move",this._updateRenderer,this),this._update()},onRemove:function(e){e.off("zoomend",this._reset,this),e.off("move",this._update,this),this._cleanupQuads(!0)},_addQuad:function(e,t,n,i,r,a){if(!(t in this._quads)){var s={smoothFactor:0,noClip:!0,clickable:!1,fill:!1,opacity:{1:.7,2:.4}[r],color:i,weight:{1:1,2:3}[r],renderer:this.renderer},l=o.default.rectangle(e,s);this.addLayer(l),1===r&&l.bringToBack();var u=[l],d=n[0].replace(/-/g," &ndash; "),c=o.default.Util.template('<span style="color:{color}">{title}</span>',{color:i,title:d}),h=o.default.divIcon({html:c,className:"leaflet-sovietgrid-quadtitle-"+r,iconSize:null}),f=o.default.marker(o.default.latLngBounds(e).getCenter(),{icon:h});this.addLayer(f),u.push(f),this._quads[t]=u,f.on("click contextmenu",this._showContextMenu.bind(this,a,n))}},_showContextMenu:function(e,t,n){var i={"1m":"1:1 000 000","500k":"1:500 000","100k":"1:100 000","050k":"1:50 000"}[e],r=[{text:i,disabled:!0},{text:"Click name to copy to clibpoard",disabled:!0},{text:t[0],callback:function(){(0,d.default)(t[0],n.originalEvent)}}];t.length>1&&(r.push({text:t[1]+' <span class="leaflet-sovietgrid-lang">RUS</span>',callback:function(){(0,d.default)(t[1],n.originalEvent)}}),r.push({text:t[2]+' <span class="leaflet-sovietgrid-lang">LAT</span>',callback:function(){(0,d.default)(t[2],n.originalEvent)}}));var a=new l.default(r);a.show(n)},_removeQuad:function(e){this._quads[e].forEach(this.removeLayer.bind(this)),delete this._quads[e]},_addQuads:function(e,t,n,i){e.forEach(function(e){var r=t+e.names[0];this._addQuad(e.bounds,r,e.names,n,i,t)}.bind(this))},_addGrid:function(){var e,t,n=this._map.getBounds(),i=this._map.getZoom();i>=10&&(e=h.getQuads050k(n),t=i>=12?2:1,this._addQuads(e,"050k","#50d",t)),i>=8&&i<12&&(e=h.getQuads100k(n),t=i>=10?2:1,this._addQuads(e,"100k","#d50",t)),i>=6&&i<10&&(e=h.getQuads500k(n),t=i>=8?2:1,this._addQuads(e,"500k","#099",t)),i>=4&&i<8&&(t=i>=6?2:1,e=h.getQuads1m(n),this._addQuads(e,"1m","blue",t))},_reset:function(){this._update(!0)},_cleanupQuads:function(e){if(e===!0)this.clearLayers(),this._quads={};else{var t=this._map.getBounds(),n=!0,i=!1,r=void 0;try{for(var a,o=Object.keys(this._quads)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=this._quads[s][0];t.intersects(l.getBounds())||this._removeQuad(s)}}catch(u){i=!0,r=u}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}}},_updateRenderer:function(){this.renderer._map&&this.renderer._update()},_update:function(e){this._cleanupQuads(e),this._addGrid()}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n,i,r=!1,a=e[e.length-1];for(i=0;i<e.length;i++)n=e[i],(n[0]<=t[0]&&t[0]<a[0]||a[0]<=t[0]&&t[0]<n[0])&&t[1]<(a[1]-n[1])*(t[0]-n[0])/(a[0]-n[0])+n[1]&&(r=!r),a=n;return r}var a=n(2),o=i(a),s=n(226);n(467);var l=n(128);o.default.Wikimapia=o.default.GridLayer.extend({options:{tileSize:1024,updateWhenIdle:!0},initialize:function(e){o.default.GridLayer.prototype.initialize.call(this,e),this.loader=null},onAdd:function(e){this.loader||(this.loader=new s.WikimapiaLoader(e)),o.default.GridLayer.prototype.onAdd.call(this,e),this.on("tileunload",this.onTileUnload,this),e.on("mousemove",this.onMouseMove,this),e.on("click",this.onClick,this)},onRemove:function(e){e.off("mousemove",this.onMouseMove,this),e.off("click",this.onClick,this),this.highlightedPlace&&(this._map.removeLayer(this.highlightedPlace.polygon),this._map.removeLayer(this.highlightedPlace.label),this.highlightedPlace=null),o.default.TileLayer.prototype.onRemove.call(this,e),this.off("tileunload",this.onTileUnload,this)},drawTile:function(e){if(this._map){var t=e._tileData,n=e._adjustment;if(t){var i=e.getContext("2d");i.beginPath(),i.strokeStyle="#CFA600",i.lineWidth=1;var r=!0,a=!1,o=void 0;try{for(var s,l=t.places[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value,d=u.localPolygon;if(d){if(n){for(var c=n.multiplier,h=n.offsetX,f=n.offsetY,p=[],m=0;m<d.length;m++){var v=d[m];p.push({x:v.x*c-h,y:v.y*c-f})}d=p}i.moveTo(d[0].x,d[0].y);for(var g=void 0,y=1;y<d.length;y++)g=d[y],i.lineTo(g.x,g.y);i.lineTo(d[0].x,d[0].y)}}}catch(b){a=!0,o=b}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}i.stroke()}}},createTile:function(e,t){var n=this,i=o.default.DomUtil.create("canvas","leaflet-tile");i.width=this.options.tileSize,i.height=this.options.tileSize;var r=this.loader.requestTileData(e),a=r.dataPromise,s=r.abortLoading;return a.then(function(e){i._tileData=e.tileData,i._adjustment=e.adjustment,n.drawTile(i),n._tileOnLoad(t,i)}),i._abortLoading=s,i},_tileOnLoad:function(e,t){o.default.Browser.ielt9?setTimeout(o.default.bind(e,this,null,t),0):e(null,t)},onTileUnload:function(e){var t=e.tile;t._abortLoading(),delete t._tileData,delete t._adjustment},_tileCoordsFromEvent:function(e){var t=this._map.getPixelOrigin().add(e.layerPoint),n=this.options.tileSize,i={x:Math.floor(t.x/n),y:Math.floor(t.y/n),z:this._map.getZoom()};return i},getPlaceAtMousePos:function(e){var t=this._tileCoordsFromEvent(e),n=this._tiles[this._tileCoordsToKey(t)];if(!n)return null;var i=n.el._tileData;return i?this.getPlaceAtLatlng(e.latlng,i.places):null},onMouseMove:function(e){var t=this.getPlaceAtMousePos(e);!this.highlightedPlace||t&&this.highlightedPlace.id===t.id||(this._map.removeLayer(this.highlightedPlace.polygon),this._map.removeLayer(this.highlightedPlace.label),this.highlightedPlace=null),t&&!this.highlightedPlace&&(this.highlightedPlace={id:t.id,polygon:o.default.polygon(t.polygon,{weight:0,color:"#E6B800"}),label:o.default.tooltip({className:"wikimapia-tooltip-wrapper"},null)},this.highlightedPlace.label.setLatLng(e.latlng),this.highlightedPlace.polygon.addTo(this._map).bringToBack(),this.highlightedPlace.label.setContent('<div class="wikimapia-tooltip">'+t.title+"</div>"),this._map.addLayer(this.highlightedPlace.label)),this.highlightedPlace&&this.highlightedPlace.label.setLatLng(e.latlng)},onClick:function(e){if(!this._map.clickLocked){var t=this.getPlaceAtMousePos(e);if(t){var n="http://wikimapia.org/"+t.id+"/ru/";(0,l.openPopupWindow)(n,564,"wikimapia-details")}}},getPlaceAtLatlng:function(e,t){for(var n=e.lat,i=e.lng,a=void 0,o=void 0,s=t.length-1;s>=0;s--)if(o=t[s],a=o.boundsWESN,i>=a[0]&&i<=a[1]&&n>=a[2]&&n<=a[3]&&r(o.polygon,[n,i]))return o}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WikimapiaLoader=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(i)},u=n(83),d=n(227),c=i(d),h=n(60),f=i(h),p=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.maxZoom=15,n.tileSize=1024,n._projectObj=e,n}return o(t,e),s(t,[{key:"getFromCache",value:function(e){e=Object.assign({},e);for(var t=!0;e.z>=0;){var n=this.makeTileKey(e),i=this._cache.get(n);if(i.found){if(t||!i.value.hasChildren)return i.coords=e,i;break}e.z-=1,e.x=Math.floor(e.x/2),e.y=Math.floor(e.y/2),t=!1}return{found:!1}}},{key:"layerTileToDataTileCoords",value:function(e){var t=e.z-2;if(t>this.maxZoom){var n=this.maxZoom,i=1<<t-n;return{x:Math.floor(e.x/i),y:Math.floor(e.y/i),z:n}}return t<0?{z:0,x:0,y:0}:{z:t,x:e.x,y:e.y}}},{key:"makeRequestData",value:function(e){var t=c.default.makeTileUrl(e);return t=(0,f.default)(t),{url:t,options:{timeout:2e4}}}},{key:"processResponse",value:function(e){return c.default.parseTile(e.response,this._projectObj).then(function(e){return{tileData:e,coords:e.coords}})}},{key:"calcAdjustment",value:function(e,n){var i=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"calcAdjustment",this).call(this,{x:e.x,y:e.y,z:e.z-2},n);return i&&(i.offsetX*=1024,i.offsetY*=1024),i}}]),t}(u.TiledDataLoader);t.WikimapiaLoader=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(l){return void n(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(e){var t=e.x,n=e.y,i=e.z,r=[];for(n=(1<<i)-n-1,i+=1;i;)r.push((1&t)+2*(1&n)),t>>=1,n>>=1,i--;return r.reverse().join("")}function o(e){var t=a(e),n=t.replace(/(\d{3})(?!$)/g,"$1/");return"http://wikimapia.org/z1/itiles/"+n+".xy?342342"}function s(e){for(var t=e.length-1,n=0,i=0,r=0;r<e.length;r++){var a=parseInt(e[r],10);n<<=1,i<<=1,n+=1&a,i+=a>>1}return i=(1<<t)-i-1,{x:n,y:i,z:t}}function l(e,t){var n=e.z-2;n<0&&(n=0),n>15&&(n=15);var i=Math.pow(2,n-e.z+Math.log2(t/256)),r=Math.floor(e.x*i),a=Math.floor(e.y*i);return{x:r,y:a,z:n}}function u(e){var t={},n=!0,i=!1,r=void 0;try{for(var a,o=e.split("")[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.length>2){var l=s.charCodeAt(0)-32;t[l.toString()]=s.substring(1)}}}catch(u){i=!0,r=u}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}return t}function d(e){var t=["1","0","3","2","5","4","9","28","17","27"],n=!0,i=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s in e)return e[s]}}catch(l){i=!0,r=l}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}var u=!0,d=!1,c=void 0;try{for(var h,f=Object.keys(e)[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;return e[p]}}catch(l){d=!0,c=l}finally{try{!u&&f.return&&f.return()}finally{if(d)throw c}}}function c(e){for(var t=0,n=[],i=0,r=0;t<e.length;){var a,o=0,s=0;do a=e.charCodeAt(t++)-63,s|=(31&a)<<o,o+=5;while(a>=32);r+=1&s?~(s>>1):s>>1,o=0,s=0;do a=e.charCodeAt(t++)-63,s|=(31&a)<<o,o+=5;while(a>=32);i+=1&s?~(s>>1):s>>1,n.push([i/1e6,r/1e6])}return n}function h(e,t,n){for(var i=t.x,r=t.y,a=t.z,o=1024*i,s=1024*r,l=[],u=void 0,d=void 0,c=0;c<e.length;c++)u=e[c],d=n.project(u,a+2),d.x-=o,d.y-=s,l.push(d);return l}function f(){return new Promise(function(e){return setTimeout(e,0)})}function p(e,t,n,i){var r=1024*t.x,a=1024*t.y,o=i.unproject([r,a]),s=i.unproject([r+1,a+1]),l=o.lat-s.lat;!n&&t.z<15&&(l/=1<<15-t.z);for(var u=[],d=0;d<e.length;d++){var c=e[d];u.push({x:c[0],y:c[1]})}u=g.default.LineUtil.simplify(u,2*l),e=[];for(var h=0;h<u.length;h++){var f=u[h];e.push([f.x,f.y])}return e}Object.defineProperty(t,"__esModule",{value:!0});var m=function(){var e=r(regeneratorRuntime.mark(function e(t,n){var i,r,a,o,l,m,v,g,y,b,k,_,w,x,L,S,C,M,q;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i={},r=i.places=[],a=t.split("\n"),!(a.length<1)){e.next=5;break}throw new Error("No data in tile");case 5:if(o=a[0].split("|"),l=o[0],l&&l.match(/^[0-3]+$/)){e.next=9;break}throw new Error("Invalid tile header");case 9:i.tileId=l,i.coords=s(l),i.hasChildren="1"===o[1],m=Date.now(),v=!0,g=!1,y=void 0,e.prev=16,b=a.slice(2)[Symbol.iterator]();case 18:if(v=(k=b.next()).done){e.next=51;break}if(_=k.value,w=Date.now(),!(w-m>20)){e.next=25;break}return e.next=24,f();case 24:m=Date.now();case 25:if(x={},L=_.split("|"),!(L.length<6)){e.next=29;break}return e.abrupt("continue",48);case 29:if(S=L[0],S.match(/^\d+$/)){e.next=32;break}return e.abrupt("continue",48);case 32:if(x.id=parseInt(S,10),x.title=d(u(L[5])),"1"===L[6]){e.next=36;break}throw new Error('Unknown wikimapia polygon encoding type: "'+L[6]+'"');case 36:if(C=L[2].match(/^([-\d]+),([-\d]+),([-\d]+),([-\d]+)$/)){e.next=39;break}throw new Error("Invalid place bounds");case 39:if(x.boundsWESN=C.slice(1).map(function(e){return parseInt(e,10)/1e7}),M=L.slice(7).join("|"),M=c(M),!(M.length<3)){e.next=44;break}throw new Error("Polygon has "+M.length+" points");case 44:q=p(M,i.coords,i.hasChildren,n),x.polygon=q,x.localPolygon=h(q,i.coords,n),r.push(x);case 48:v=!0,e.next=18;break;case 51:e.next=57;break;case 53:e.prev=53,e.t0=e.catch(16),g=!0,y=e.t0;case 57:e.prev=57,e.prev=58,!v&&b.return&&b.return();case 60:if(e.prev=60,!g){e.next=63;break}throw y;case 63:return e.finish(60);case 64:return e.finish(57);case 65:return e.abrupt("return",i);case 66:case"end":return e.stop()}},e,this,[[16,53,57,65],[58,,60,64]])}));return function(t,n){return e.apply(this,arguments)}}(),v=n(2),g=i(v);t.default={getTileId:a,getWikimapiaTileCoords:l,parseTile:m,makeTileUrl:o}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);a.default.LineUtil.simplifyLatlngs=function(e,t){function n(e){return{x:e.lng,y:e.lat}}function i(e){return{lat:e.y,lng:e.x}}return e=e.map(n),e=a.default.LineUtil.simplify(e,t),e=e.map(i)}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(2),a=i(r);n(469),a.default.Polyline.EditMixinOptions={className:"leaflet-editable-line"},a.default.Polyline.EditMixin={_nodeMarkersZOffset:1e4,startEdit:function(){this._map&&!this._editing&&(this._editing=!0,this._drawingDirection=0,this.setupMarkers(),this.on("remove",this.stopEdit.bind(this)),this._map.on("click",this.onMapClick,this).on("dragend",this.onMapEndDrag,this),a.default.DomEvent.on(document,"keyup",this.onKeyPress,this),this._storedStyle={weight:this.options.weight,opacity:this.options.opacity},this.setStyle({weight:1.5,opacity:1}),a.default.DomUtil.addClass(this._map._container,"leaflet-line-editing"))},stopEdit:function(e){this._editing&&(this.stopDrawingLine(),this._editing=!1,this.removeMarkers(),a.default.DomEvent.off(document,"keyup",this.onKeyPress,this),this.off("remove",this.stopEdit.bind(this)),this._map.off("click",this.onMapClick,this).off("dragend",this.onMapEndDrag,this),this.setStyle(this._storedStyle),a.default.DomUtil.removeClass(this._map._container,"leaflet-line-editing"),this.fire("editend",{target:this,userCancelled:e}))},removeMarkers:function(){this.getLatLngs().forEach(function(e){e._nodeMarker&&(this._map.removeLayer(e._nodeMarker),delete e._nodeMarker._lineNode,delete e._nodeMarker),e._segmentOverlay&&(this._map.removeLayer(e._segmentOverlay),delete e._segmentOverlay._lineNode,delete e._segmentOverlay)}.bind(this))},onNodeMarkerDragEnd:function(e){var t=e.target,n=this.getLatLngs().indexOf(t._lineNode);this.replaceNode(n,t.getLatLng())},onNodeMarkerMovedChangeNode:function(e){var t=e.target,n=t.getLatLng(),i=t._lineNode;i.lat=n.lat,i.lng=n.lng,this.redraw(),this.fire("nodeschanged")},onNodeMarkerDblClickedRemoveNode:function(e){if(!(this.getLatLngs().length<2||this._drawingDirection&&2===this.getLatLngs().length)){var t=e.target,n=this.getLatLngs().indexOf(t._lineNode);this.removeNode(n),this.fire("nodeschanged")}},onMapClick:function(e){if(this._drawingDirection){var t=this._drawingDirection===-1?1:this.getLatLngs().length-1;this.addNode(t,e.latlng)}else this.preventStopEdit||this.stopEdit(!0)},onMapEndDrag:function(e){if(e.distance<15){var t=e.target.dragging._draggable,n=t._startPoint.add(t._newPos).subtract(t._startPos),i=e.target.mouseEventToLatLng({clientX:n.x,clientY:n.y});this.onMapClick({latlng:i})}},startDrawingLine:function(e,t){if(this._editing&&(void 0===e&&(e=1),this._drawingDirection!==e)){if(this.stopDrawingLine(),this._drawingDirection=e,t){var n=this._drawingDirection===-1?0:this.getLatLngs().length;this.spliceLatLngs(n,0,t.latlng),this.fire("nodeschanged")}this._map.on("mousemove",this.onMouseMoveFollowEndNode,this),a.default.DomUtil.addClass(this._map._container,"leaflet-line-drawing"),this._map.clickLocked=!0}},stopDrawingLine:function(){if(this._drawingDirection){this._map.off("mousemove",this.onMouseMoveFollowEndNode,this);var e=this._drawingDirection===-1?0:this.getLatLngs().length-1;this.spliceLatLngs(e,1),this.fire("nodeschanged"),this._drawingDirection=0,a.default.DomUtil.removeClass(this._map._container,"leaflet-line-drawing"),this._map.clickLocked=!1,this.fire("drawend")}},onKeyPress:function(e){if("input"!==e.target.tagName.toLowerCase()){var t=e.keyCode;switch(t){case 27:case 13:this._drawingDirection?this.stopDrawingLine():this.preventStopEdit||this.stopEdit(!0),a.default.DomEvent.stop(e);break;case 8:case 46:if(this._drawingDirection&&this.getLatLngs().length>2){var n=1===this._drawingDirection?this.getLatLngs().length-2:1;this.removeNode(n),this.fire("nodeschanged"),a.default.DomEvent.preventDefault(e)}}}},onMouseMoveFollowEndNode:function(e){var t=this._drawingDirection===-1?0:this.getLatLngs().length-1;this.spliceLatLngs(t,1,e.latlng),this.fire("nodeschanged")},makeNodeMarker:function(e){var t=this.getLatLngs()[e],n=a.default.marker(t.clone(),{icon:a.default.divIcon({className:"line-editor-node-marker-halo",html:'<div class="line-editor-node-marker"></div>'}),draggable:!0,zIndexOffset:this._nodeMarkersZOffset});n.on("drag",this.onNodeMarkerMovedChangeNode,this).on("dragend",this.onNodeMarkerDragEnd,this).on("dblclick",this.onNodeMarkerDblClickedRemoveNode,this).on("click",this.onNodeMarkerClickStartStopDrawing,this).on("contextmenu",function(e){this.stopDrawingLine(),this.fire("noderightclick",{nodeIndex:this.getLatLngs().indexOf(n._lineNode),line:this,mouseEvent:e})},this),n._lineNode=t,t._nodeMarker=n,n.addTo(this._map)},onNodeMarkerClickStartStopDrawing:function(e){var t=e.target,n=this.getLatLngs(),i=n.length,r=n.indexOf(t._lineNode);this._drawingDirection===-1&&1===r||1===this._drawingDirection&&r===i-2?this.stopDrawingLine():0===r?this.startDrawingLine(-1,e):r===this.getLatLngs().length-1&&this.startDrawingLine(1,e)},makeSegmentOverlay:function(e){var t=this.getLatLngs(),n=t[e],i=t[e+1];if(i){var r=a.default.polyline([n,i],{weight:10,opacity:0});r.on("mousedown",this.onSegmentMouseDownAddNode,this),r.on("contextmenu",function(e){this.stopDrawingLine(),this.fire("segmentrightclick",{nodeIndex:this.getLatLngs().indexOf(r._lineNode),mouseEvent:e,line:this})},this),r._lineNode=n,n._segmentOverlay=r,r.addTo(this._map)}},onSegmentMouseDownAddNode:function(e){if(0===e.originalEvent.button){var t=e.target,n=this.getLatLngs(),i=n.indexOf(t._lineNode)+1;this.addNode(i,e.latlng),a.default.Draggable._dragging&&a.default.Draggable._dragging.finishDrag(),n[i]._nodeMarker.dragging._draggable._onDown(e.originalEvent),this.fire("nodeschanged")}},addNode:function(e,t){var n=this.getLatLngs(),i=1===e&&this._drawingDirection===-1,r=e===n.length-1&&1===this._drawingDirection;if(t=t.clone(),this.spliceLatLngs(e,0,t),
this.makeNodeMarker(e),!i&&e>=1){if(!r){var a=n[e-1];this._map.removeLayer(a._segmentOverlay),delete a._segmentOverlay._lineNode,delete a._segmentOverlay}this.makeSegmentOverlay(e-1)}r||this.makeSegmentOverlay(e)},removeNode:function(e){var t=this.getLatLngs(),n=t[e],i=n._nodeMarker;delete n._nodeMarker,delete i._lineNode,this.spliceLatLngs(e,1),this._map.removeLayer(i),n._segmentOverlay&&(this._map.removeLayer(n._segmentOverlay),delete n._segmentOverlay._lineNode,delete n._segmentOverlay);var r=t[e-1];r&&r._segmentOverlay&&(this._map.removeLayer(r._segmentOverlay),delete r._segmentOverlay._lineNode,delete r._segmentOverlay,(e<t.length-1||e<t.length&&1!==this._drawingDirection)&&this.makeSegmentOverlay(e-1))},replaceNode:function(e,t){var n=this.getLatLngs(),i=n[e],r=i._nodeMarker;this._map.removeLayer(i._nodeMarker),delete i._nodeMarker,delete r._lineNode,t=t.clone(),this.spliceLatLngs(e,1,t),this.makeNodeMarker(e),i._segmentOverlay&&(this._map.removeLayer(i._segmentOverlay),delete i._segmentOverlay._lineNode,delete i._segmentOverlay,this.makeSegmentOverlay(e));var a=n[e-1];a&&a._segmentOverlay&&(this._map.removeLayer(a._segmentOverlay),delete a._segmentOverlay._lineNode,delete a._segmentOverlay,this.makeSegmentOverlay(e-1))},setupMarkers:function(){this.removeMarkers();var e=this.getLatLngs(),t=0,n=e.length-1;this._drawingDirection===-1&&(t+=1),1===this._drawingDirection&&(n-=1);for(var i=t;i<=n;i++)this.makeNodeMarker(i),i<n&&this.makeSegmentOverlay(i)},spliceLatLngs:function(){var e=this.getLatLngs(),t=e.splice.apply(e,arguments);return this.setLatLngs(e),t}}},function(e,t){"use strict";function n(e){return""===e.substr(0,3)&&(e=e.substr(3)),e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={bingKey:"ArTkP-DmMk_eLjH_bqre-RDkN7_9JZ2QikvOTgD7NcePeL4ARw3CLRnzalMJQn32",thunderforestKey:"00000000000000000000000000000000",sentryDSN:"",mapillary:"azJWOG1CVHUtUjdlSkVTMUF2WG91dzoyZmNhZmFjMzMyMmU2YzNi"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,437,,,function(e,t){e.exports={minLat:-58,step:2,rowsCount:69,maxLat:78,valueOffset:76,array:"7u7t7e3s7Ozr6+rq6unp6Ojn5+fm5ubl5eTk5OPj4uHh4N/e3dzb2djW1dPRz83LycbEwb+8ube0sa+sqaekop+dm5mXlZORj42MiomHhoSCgX9+fHp4dnRyb21raGVjYF1aV1RRTktIRUI/PDk2MzEuKyknJCIgHhwaGBYVExIRDw4ODQwMDAwMDA0OEBEUFxsfJSw0PklWZHSDkqGtuMLK0Nbb3uLk5+jq6+zt7e7u7u7u5ubm5ubm5eXl5OTk5OPj4+Li4uHh4eHg4ODg39/f3t7d3dzb2tnY19bU09HPzcvJx8TCv726t7Wyr6ypp6Shn5yamJaTkpCOjIuJiIaFg4KBf358e3l3dXNxb21qaGVjYF1aV1RRTktIRUI/PDo3NDIvLSooJiQiIB4dGxoZFxYWFRQUFBQUFBUWFxkbHiElKS40O0NMVWBrd4OOmaOttbzDyM3R1djb3d/g4uPk5eXm5ubm4ODg4ODg4N/f39/e3t7e3t3d3d3c3Nzc3Nzc29vb29ra2dnY19fW1dPS0c/Ny8nHxcPAvbu4tbKvraqnpKGenJmXlZKQjoyLiYeGhYOCgYB+fXx6eXh2dHNxb2xqaGVjYF1aV1RRT0xJRkNAPTo4NTMwLiwqKCYkIyEgHx4dHBsbGhoaGxscHR8gIyUoLDA0OT9GTVVeZ3B5g4yVnaWss7i+wsfKztHT1dfZ2tzd3d7f39/g2tvb29vb29ra2tra2tnZ2dnZ2NjY2NjY2NjY2NfX19fX1tbV1dTT0tHQz83LycfFw8G+u7m2s7CtqqekoZ6bmZaUkY+Ni4mHhoSDgoB/fn18e3p5d3Z1c3JwbmxqaGVjYF1bWFVST0xJRkNBPjs5NjQyMC4sKignJSQjIiEhICAgICEhIiMlJigrLjE1OT1DSE5VXGNrc3uDipKZn6arsba6vsLFyMvNz9HT1NXX19jZ2dra1tbW1tbW1tbW1tbW1dXV1dXV1NTU1NTU1NTU1NTU1NTU09PT0tLR0M/OzMvJyMbEwb+8ure0sa6rqKShnpuYlpOQjoyJh4aEgoGAfn18e3p6eXh3dnVzcnFvbWxqZ2VjYF5bWFVSUE1KR0RCPz06ODYzMTAuLCsqKCgnJiYlJSUmJicoKistLzI1ODxARUpPVVthaG91fIOJj5aboaarr7O3u77BxMbIyszOz9DR0tPU1NXV0dLS0tLS0tLS0tLS0tHR0dHR0dHR0dHR0dHR0dHR0dHQ0NDQz8/Ozs3MysnHxsTCv726uLWyr6uopaKfm5iVkpCNioiGhIKAf358e3p5eHh3dnV1dHNycXBubWtpZ2VjYF5bWVZTUE5LSEVDQD48OTc1NDIwLy4tLCsrKioqKissLS4vMTM2ODw/Q0dLUFVaYGZrcXd9g4iOk5idoqaqrrG1uLu+wMLExsjJy8zNzs/Q0NHRzs7Ozs7Pz8/Pzs7Ozs7Ozs7Ozs3Nzc3Nzc3Nzc3Nzs7Nzc3NzczMy8rJyMfFxMLAvbu4trOwrKmmop+cmJWSj4yKh4WCgX99fHp5eHd2dnV0dHNycnFwb25tbGtpZ2VjYV5cWVdUUU9MSUdEQkA9Ozk4NjQzMjEwLy8vLy8vMDEyMzU3OTs+QUVITFFVWl9kaW50eX6DiI2RlpqeoqaprbCztri7vb/Bw8TGx8jJysvMzM3NysvLy8vLy8vLy8vLy8vLy8vLy8rKysrKysrKysrKy8vLy8rKysrJycjHxsXDwsC+vLm2tLGtqqejoJyZlZKPjImGhIF/fXt6eHd2dXRzc3JycXFwcG9vbm1sa2ppZ2VjYV9dWlhVU1BNS0hGREJAPjw6OTc2NTQ0MzMzNDQ1Njc4Ojw+QUNGSk1RVVpeY2hscXZ6f4SIjJCUmJyfoqaprK6xs7a4ury+wMHCxMXGx8jIycnKx8jIyMjIyMjIyMjIyMjIyMjIyMjIx8fHx8fHx8jIyMjIyMjIx8fHxsbFxMPBwL68ube0sa6rqKShnZqWk4+MiYaDgX58enh3dXRzcnFxcG9vb25ubm1tbGxra2ppZ2ZkYmBeXFlXVFJPTUtIRkRCQD89PDs6OTg4ODg4OTk6PD0/QUNFSEtOUlZaXmJma29zeHyAhIiMj5OWmZ2goqWoq62vsrS2uLq7vb7AwcLDxMXFxsbHxMXFxcXGxsbGxsbGxsbGxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXExMPCwsC/vby6t7Wyr6yppaKem5eTkIyJhoOAfnt5d3V0cnFwb29ubW1sbGxsbGtra2tqamlpaGZlY2JgXVtZVlRST01LSUdFREJBQD8+PT09PT09Pj9AQkNFSEpNUFNWWl1hZWltcXV5fYGFiIyPkpWYm52goqWnqqyusLK0tre5ury9vr/AwcLDw8TEwsLCw8PDw8PDw8PDw8PDw8PDw8PDwsLCwsLCwsLCwsLCwsLCwsLCwcHAv769u7q4tbOwraqno5+cmJSRjYqGg4B9e3h2dHNxcG9ubWxsa2tqampqampqampqamlpaGdmZWNiYF5bWVdVU1BOTEtJR0ZFRENCQkJCQkJDREVGSEpMTlFUV1pdYWRobHB0d3t/goWJjI6RlJeZm56goqSnqautrrCytLW3uLm7vL2+v7/AwcHCwMDAwMDBwcHBwcHBwcHBwcHBwcDAwMDAwMDAwMDAwMDAwMDAwMC/v76+vby7ube1s7Guq6ikoZ2ZlpKOi4eEgX57eHZ0cnBvbm1sa2pqaWloaGhoaGhpaWlpaWlpaWhoZ2VkYmFfXVpYVlRSUE9NTEpJSEhHR0dHR0hJSktNTlBTVVhaXWFkZ2tucnZ5fYCDhomMjpGTlpianJ6goqSmqKqrra+wsrO1tre5uru8vL2+vr+/vb6+vr6+v7+/v7+/v7+/v7+/v76+vr6+vr6+vr6+vr6+vr69vb29vby8u7q4t7Wzsa6sqaWinpuXk4+MiIWBfnt5dnRycG5tbGtqaWhoZ2dnZ2dnZ2doaGlpampqampqaWhnZmRiYV9dW1lXVVNSUE9OTU1MTExNTU5PUFFTVVdZW15hZGdqbXF0d3t+gYSHioyPkZOVl5mbnZ6goqSlp6mqrK2vsLKztLa3uLm6uru8vL29u7y8vLy8vb29vb29vb29vb29vby8vLy8vLy8vLu7u7u7u7u7u7u7urq5uLe2tbOxr6yqpqOgnJmVkY2KhoJ/fHl3dHJwbm1ramloaGdmZmZmZmZmZmdnaGlpamtsbGxsbGtramhnZWNiYF5cWllXVlVUU1JSUlJSU1RVVldZW11fYmRnam1wc3Z5fH+ChYiKjY+Rk5WWmJqbnZ6goqOlpqipq6yur7Cys7S1tre4uLm6uru7urq6urq6u7u7u7u7u7u7u7u7u7u7urq6urq6urm5ubm5ubm5ubm5uLi3trW0s7GvraqnpKGempaTj4uHhIB9end1cnBubWtqaWhnZ2ZmZWVlZWVlZmZnaGlqa2xtbm9vb29vbm1samlnZWNiYF5dXFtaWVhYWFhYWVpbXF1fYWNlZ2psb3J1eHt+gIOGiIuNj5GTlJaYmZqcnZ6goaOkpqeoqqusrq+wsbKztLW2t7e4uLm5uLi4uLm5ubm5ubm5ubm5ubm5ubm5ubm4uLi4uLi4t7e3t7e3t7e3tra1tLOysa+tq6ilop+cmJSRjYmFgn97eHZzcW9tbGppaGdmZmVlZWVkZWVlZmdoaWprbW5vcXJzc3Nzc3JxcG5ta2poZmVjYmFgX15eXl5eX2BhYmNlZ2hqbW9xdHd5fH+BhIeJi42PkZOUlpeYmpucnZ6goaKkpaanqaqrra6vsLGys7S0tba2t7e4tra3t7e3t7e3t7e4uLi4uLi4uLe3t7e3t7a2tra2tra1tbW1tbW1tLSzsrGwr62rqaajoJ2alpKPi4eEgH16d3RycG5sa2loZ2dmZWVlZWVlZWVmZ2hpamttb3BydHV2d3h4eHd3dnRzcXBubWtpaGdmZWRkZGRkZWVmZ2lqbG5vcXR2eHt9gIKFh4qMjpCRk5SWl5iZmpucnZ6foaKjpKWnqKmqq62ur7CxsbKztLS1tba2tbW1tbW1tra2tra2tra2tra2tra2trW1tbW1tbS0tLS0tLSzs7OzsrKxsbCuraupp6Sin5uYlJGNiYaCf3x5dnNxb21ramloZ2ZmZWVlZWVlZmZnaGlqbG1vcXN1d3h6e3x8fXx8e3p5eHZ0c3Fwbm1sa2pqampqamtsbW5vcXJ0dnh6fH6Bg4WIioyOkJKTlZaXmJmam5ucnZ6foKGipKWmp6ipqqytrq+vsLGysrOztLS1s7S0tLS0tLS0tLS0tbW1tbW1tbW0tLS0tLSzs7Ozs7KysrKysrKxsbCwr66tq6mnpaOgnZqWk4+LiISBfXp3dXJwbmxraWhnZ2ZmZmVlZWZmZ2doaWtsbnBydHZ4enx9f4CBgYGBgIB/fXx6eXd2dHNycXBwb29vcHBxcnN0dXd4enx+gIKEhoiKjI6QkpOVlpeYmZmam5ycnZ6foKGio6Slpqeoqqusra2ur7CxsbKys7OzsrKzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsrKysrKxsbGxsbGwsLCwr6+urayrqqimo6Gem5iVkY6KhoOAfHl2dHJvbWxqaWhnZ2ZmZmZmZmdnaGlqbG1vcHJ0d3l7fX+BgoSFhYaGhYWEg4GAfn17enl3dnV1dHR0dHV1dnd4eXp8fX+Bg4WHiYuNjpCSk5WWl5iZmZqam5ycnZ6fn6ChoqOlpqeoqaqrrKytrq+wsLGxsbKysbGxsbGysrKysrKysrKysrKysrKysrKxsbGxsbCwsLCwr6+vr6+urq2trKuqqKakop+dmpaTkIyJhYJ/e3h2c3FvbWxqaWhoZ2dnZ2dnaGhpamtsbnBxc3V3enx+gIKEhoeIiYqKiomIh4aFg4KBf358e3p6eXl5eXl6ent8fX5/gYKEhYeJi42OkJKTlZaXmJiZmpqbm5ycnZ2en6ChoqOkpaanqKmqq6ysra6vr7CwsLGxsLCwsLCwsLCwsbGxsbGxsbGxsbGxsbCwsLCwr6+vr6+urq6urq6traysq6qop6WjoJ6bmJWSjouIhIF+e3h1c3FvbWxqaWloaGhoaGhpaWprbG5vcXJ0dnh6fH+Bg4WHiYqLjI2NjY2MjIuJiIeFhIKBgH9+fn19fX19fn9/gIGCg4WGiImLjY6QkpOUlpeYmJmZmpqbm5ucnJ2en5+goaKjpKWmp6ipqqusrK2urq+vsLCwr6+vr6+vr6+vr6+wsLCwsLCwsLCwr6+vr6+vrq6urq6tra2traysrKuqqainpaShn52al5SRjYqHg4B9end1cnBubWxramlpaWlpaWpqa2xtb3Byc3V3eXt9f4GEhoiJi42Oj5CQkJCQj46NjIuJiIaFhIOCgYGBgYGBgYKCg4SFhoeIiouNjpCRk5SVlpeYmZmampqbm5ucnJ2dnp+goaKjpKWmp6eoqaqrrKytra6ur6+vrq+vr6+urq6urq6ur6+vr6+vr6+vrq6urq6ura2tra2srKysrKurq6qpqKempKKgnpuZlpOPjImGgn98eXd0cnBvbWxramppaWpqa2tsbW5wcXN0dnh6fH6AgoSGiIqMjY+QkZKSk5OTkpGQj46Ni4qJiIeGhYSEhISEhIWFhoaHiImKi42OkJGSlJWWl5iZmZqampqbm5ubnJydnp6foKGio6Slpqeoqamqq6ysra2urq6urq6urq6urq6urq6urq6urq6urq6urq2tra2traysrKysq6urq6uqqqmop6alo6GfnZqYlZKOi4iFgn98eXd0cnBvbWxra2pqamtrbG1ub3FydHV3eXt9foCChIaIioyOj5GSk5SUlZWVlJSTkpGQjo2Mi4qJiIeHh4eHh4eHiIiJiouMjY6PkZKTlJaXmJiZmZqampqam5ubm5ycnZ6foKGhoqOkpaanqKmqqqusrK2tra6ura2tra2tra2tra2tra2tra2tra2tra2srKysrKyrq6urq6uqqqqpqainpqWkoqCenJmWlJGOioeEgX57eXZ0cnBvbm1sbGtrbGxtbm9wcXN0dnh6e31/gYOFh4mKjI6PkZKTlZWWl5eXlpaVlJOSkZCOjYyLi4qKiYmJiYmKioqLjIyNjo+QkpOUlZaXmJmZmZqampqampqbm5ucnZ2en6ChoqOkpaamp6ipqqqrrKysra2tra2traysrKysrKysrKysrKysrKysrKysrKurq6urq6qqqqqqqampqKenpqSjoZ+dm5iWk5CNioeEgX57eXZ0cnFvbm1tbGxtbW5ub3Fyc3V3eHp8foCCg4WHiYqMjo+RkpSVlpeXmJiYmJiXlpWUk5KRkI+OjYyMjIuLi4uLjIyNjY6Pj5CRkpSVlpeXmJmZmZqampqampqam5ubnJ2enp+goaKjpKWmp6ioqaqqq6usrKytrKysrKysrKyrq6urq6urrKysrKysq6urq6urq6qqqqqqqqmpqaiop6empaOioJ6cmpeVko+MiYaDgH17eHZ0cnFwb25ubW1ubm9wcXJ0dnd5e31+gIKEhoeJi4yOj5GSk5WWl5iYmZmZmZmYmJeWlZSTkpGQj46Ojo2NjY2NjY6Oj4+QkJGSk5SVlpeYmJmZmZmampmZmZqampqbnJydnp+goaKio6SlpqeoqamqqqurrKysrKysrKurq6urq6urq6urq6urq6urq6urq6qqqqqqqqmpqampqKinp6alpKOhn52bmZaUkY6LiIWDgH17eHZ0c3Fwb29ubm9vcHFyc3R2eHl7fX+BgoSGiImLjI6PkZKTlZaXmJmZmpqampqamZiXlpWUk5KSkZCQj4+Pj4+Pj4+PkJCRkZKTlJWVlpeYmJmZmZmZmZmZmZmZmZqam5ycnZ6foKGio6SlpaanqKmpqqurq6ysq6urq6urq6urqqqqqqqqq6urq6urq6uqqqqqqqqpqampqamoqKenpqWko6Kgn52amJaTkI2LiIWCgH17eHZ1c3JxcHBvb3BwcXJzdXZ4eXt9f4GDhIaIiYuMjo+RkpOUlZeYmZmam5ubm5ubmpmZmJeWlZSTkpKRkZCQkJCQkJCQkZGSkpOTlJWWlpeYmJmZmZmZmZmZmZmZmZmampucnZ2en6ChoqOkpaanp6ipqqqrq6urq6urq6urqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqampqKioqKempqWko6Ggnpyal5WSkI2Kh4WCf317eHd1c3JxcXBwcHFycnN1dnh5e31/gYOEhoiJi4yOj5CSk5SVlpeYmZqbm5ycnJycm5qamZiXlpWUlJOTkpKSkZGRkZGRkpKSk5OUlZWWl5eYmJiZmZmZmJiYmJiYmJmZmpqbnJ2en5+goaKjpKWmp6ioqaqqqqurq6urq6uqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqampqKiop6empaSjoqGfnZuZlpSRj4yJh4SCf317eXd1dHNycnFxcnJzdHV2eHl7fX+BgoSGiImLjI6PkJKTlJWWl5iZmpubnJydnZ2cnJubmpmYl5aWlZSUk5OTkpKSkpKSk5OTk5SUlZaWl5eYmJiYmJiYmJiYl5eXmJiYmZmam5ydnp+goaKjpKSlpqeoqamqqqqrqqurqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqamoqKinp6ampaSjoaCenJqYlpORjoyJhoSBf317eXd2dHNzcnJyc3N0dXZ4eXt9foCChIaHiYuMjo+QkZOUlZaXmJmZmpucnJ2dnZ2dnJybm5qZmJeXlpWVlJSUk5OTk5OTk5OUlJSVlZaWl5eXmJiYmJiYl5eXl5eXl5eYmJmZmpucnZ6foKGio6SlpqenqKmpqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqamoqKinp6alpaOioZ+enJqXlZOQjouIhoOBf3x7eXd2dXRzc3NzdHR1dnh5e3x+gIKDhYeJioyNj5CRkpOUlZaXmJmam5ucnZ2dnp6dnZ2cm5qamZiXl5aWlZWVlJSUlJSUlJSUlZWVlpaWl5eXmJiYmJeXl5eWlpaWlpaXl5iZmZqbnJ2en6ChoqOkpaanqKipqaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpqampqKinp6alpKOioJ+dm5mXlJKPjYqIhYOBfnx7eXd2dXV0dHR0dXZ3eHl6fH5/gYOFhoiKjI2OkJGSk5SVlpeYmZqam5ycnZ2enp6enZ2cnJuampmYl5eWlpaVlZWVlZWVlZWVlZWWlpaWl5eXl5eXl5eXlpaWlZWVlZaWlpeYmJmam5ydnp+goaKjpKWmp6ioqamqqqqqqqqqqqqqqqqqqqqqqqqqq6urq6urq6qqqqqqqampqKinp6alpKOhoJ6cmpiWlJGPjIqHhYOAfnx7eXh3dnV1dXV1dnd4eXp8fX+BgoSGiImLjY6PkZKTlJWWl5iYmZqbm5ydnZ6enp6enp2dnJybmpmZmJiXl5aWlpaWlZWVlZWVlpaWlpaXl5eXl5eXl5aWlpWVlZWUlZWVlZaXl5iZmpucnZ6foKGio6SlpqeoqKmpqaqqqqqqqqqqqqqqqqqqqqurq6urq6urq6urq6qqqqmpqainp6alpKOhn56cmpiVk5GOjImHhIKAfnx7eXh3dnZ2dnZ2d3h5ent9foCCg4WHiYqMjY+QkpOUlZaXl5iZmpqbnJydnp6en5+enp6dnZybm5qZmZiYl5eXl5aWlpaWlpaWlpaWlpaXl5eXl5eWlpaVlZWUlJSUlJSUlJWWlpeYmZqbnJ2en6Cho6SlpqanqKmpqamqqqqqqqqqqqqqqqqrq6urq6usrKysrKurq6urqqqpqaiop6alpKKhn52bmZeVkpCNi4mGhIKAfnx7eXh3d3Z2dnd3eHl6e3x+f4GDhIaIiYuNjpCRkpOUlZaXmJmZmpubnJ2dnp6fn5+fn56enZ2cm5uamZmZmJiXl5eXl5eXlpaWlpaWl5eXl5eXl5aWlpWVlJSUk5OTk5OTk5SUlZaXmJmam5ydnp+goqOkpaanp6ipqampqqqqqqqqqqqqq6urq6usrKysrKysrKysrKurq6qqqamop6alpKKhn52bmZaUko+NioiGg4F/fnx7eXh4d3d3d3d4eXp7fH1/gIKEhYeJioyNj5CSk5SVlpeYmJmampucnJ2enp6fn5+fn5+enp2cnJubmpqZmZiYmJiYl5eXl5eXl5eXl5eXl5eWlpaWlZWUlJOTkpKSkpKSkpOTlJWWlpeYmpucnZ6foaKjpKWmp6eoqKmpqaqqqqqqqqurq6urrKysrK2tra2tra2trKysq6uqqqmop6alpKKgnp2amJaTkY+MioeFg4F/fXx7eXl4eHd4eHh5ent8fX6AgYOEhoiJi4yOj5GSk5SWlpeYmZqam5ucnZ2enp+fn5+fn5+fnp6dnJybm5qamZmZmZiYmJiYmJeXl5eXl5eXl5eWlpaVlZSUk5OSkpGRkZGRkZKSk5OUlZaXmJmbnJ2eoKGio6SlpqeoqKipqamqqqqqq6urq6ysrKytra2trq6urq6tra2srKyrqqmpqKalpKKgnpyamJWTkI6MiYeFgoB/fXx7enl4eHh4eHl6ent9fn+AgoOFh4iKi42PkJGTlJWWl5iZmZqbm5ycnZ6en5+foKCgoJ+fn56dnZycm5uampqZmZmZmZiYmJiYmJiXl5eXl5aWlpWVlJSTkpKRkZCQkJCQkJCRkZKTlJWWl5iZm5ydnqChoqOkpaanp6ioqamqqqqrq6urrKysra2trq6urq6urq6urq6traysq6qpqKelpKKgnpyal5WSkI2LiIaEgoB+fXt6enl4eHh5eXp6e3x9foCBg4SGh4mKjI2PkJKTlJWWl5iZmpqbnJydnZ6en5+goKCgoKCfn56enZ2cnJybm5qampqamZmZmZmYmJiYmJeXl5aWlpWUlJOSkpGQkI+Pj4+Pj4+QkJGSk5SVlpeYmZucnZ+goaKjpKWmpqeoqKmqqqqrq6ysrK2tra6urq+vr6+vr6+vr66ura2sq6qpqKelpKKgnpyZl5SSj42KiIaDgYB+fHt6eXl5eXl5eXp7fH1+f4CCg4WGiImLjI6PkZKTlZaXmJiZmpubnJydnp6fn5+goKCgoKCgn5+fnp6dnZycnJubm5qampqamZmZmZiYmJiXl5aWlZWUk5OSkZCQj46Ojo6Ojo6Oj5CQkZKTlJWXmJmbnJ2foKGipKWmpqenqKmpqqqrq6ysra2urq6vr7CwsLCwsLCwsK+vrq6trKuqqaempKKgnpuZl5SRj4yKh4WDgX99fHt6eXl5eXl5enp7fH1+gIGChIWHiIqLjY6QkZKUlZaXmJmampucnJ2dnp6fn6CgoKGhoaCgoKCfn56enZ2dnJycnJubm5uampqamZmZmJiXl5aWlZSUk5KRkJCPjo6NjY2MjY2Njo6PkJGSk5SVl5iZm5yen6Cho6SlpaanqKmpqqqrrKytra6ur6+wsLCxsbGxsbGxsLCwr66urayqqaimpKKgnpuZlpSRjoyJh4SCgH99fHt6eXl5eXl5ent8fH5/gIGDhIWHiIqLjY6QkZOUlZaXmJmam5ucnZ2enp+foKCgoaGhoaGhoKCgn5+fnp6enZ2dnJycnJubm5uampmZmZiYl5aWlZSTkpGRkI+OjY2MjIuLi4uMjI2Ojo+QkpOUlZeYmpucnp+goqOkpKWmp6ipqqurrK2trq6vr7CwsbGxsrKysrKysbGwsK+urayrqqimpKKgnpuZlpOQjouIhoSCgH58e3p5eXl5eXl5ent8fX5/gIGDhIaHiYqMjY+QkZOUlZaXmJmam5ycnZ2enp+goKChoaGhoaGhoaGhoKCgn5+fnp6enZ2dnZycnJubm5qamZiYl5aWlZSTkpGQj46NjIyLi4qKioqLi4yMjY6PkJGTlJWXmJqbnZ6foaKjpKWmp6ipqqurrK2urq+wsLGxsrKys7Ozs7OysrKxsbCvrq2rqqinpaKgnpuYlZOQjYqIhYOBf318e3p5eXh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkpOUlZaYmZmam5ycnZ6en5+goKGhoaKioqKioqKhoaGgoKCgn5+fnp6enp2dnZycm5uamZmYl5aVlZOSkZCPjo2Mi4uKiYmJiYmJioqLjI2Oj5CRk5SWl5mam52eoKGio6SlpqipqqurrK2ur6+wsbGysrOzs7S0tLSzs7OysbGwr62sqqmnpaKgnZuYlZKPjYqHhYKAfn17enl4eHh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkZOUlZeYmZqam5ydnZ6fn6CgoaGhoqKioqOjo6KioqKioaGhoKCgoJ+fn56enp2dnJubmpmYl5aVlJOSkZCOjYyLiomJiIiIiIiIiImKiouMjo+QkZOUlpeZmpydn6CioqOlpqeoqausra2ur7CxsbKzs7S0tLW1tbW0tLSzsrGwr66tq6mnpaOgnZuYlZKPjImGhIJ/fnx6eXh4eHd3eHh5eXp7fH5/gIGDhIaHiYqMjY+QkZOUlZeYmZqbm5ydnp6fn6CgoaGioqOjo6Ojo6Ojo6Ojo6KioqKhoaGgoKCfn56dnZybmpqZmJaVlJOSkI+OjYuKiYiIh4eGhoaHh4iIiYqLjI6PkJKTlZaYmZucnp+hoaOkpqeoqausra6vsLGxsrOztLW1tbW2trW1tbS0s7KxsK+tq6qnpaOgnZqXlJGOi4iGg4F/fXt6eXh3d3d3d3h4eXp7fH1+gIGChIWHiIqLjY6QkZOUlZaYmZqbm5ydnp6foKChoaKio6OkpKSkpKSkpKSkpKSjo6OjoqKioaGgoJ+enp2cm5qZmJeVlJORkI6NjIqJiIeHhoaFhYWFhoaHiImKi4yOj5CSlJWXmJqbnZ6goaKkpaeoqaqsra6vsLGys7S0tbW2tra2t7a2trW1tLOysa+urKqopaOgnZqXlJGOioiFgoB+fHp5eHd2dnZ2dnd4eHl6e31+f4GCg4WGiImLjI6PkZKUlZaXmZqbm5ydnp+foKGhoqKjo6SkpaWlpaWmpqalpaWlpaWkpKSjo6KioaCgn56dnJuZmJeVlJKRj46Mi4qIh4aFhYSEhISEhYWGh4iJiouMjo+RkpSWl5mbnJ6foKKjpaaoqaqsra6vsLKzs7S1tra3t7e3t7e3t7a2tbSzsbCurKqopaOgnZqXk5CNioeEgX98e3l4d3Z1dXV1dXZ3eHh6e3x9f4CBg4SGh4mKjI6PkZKTlZaXmJmbm5ydnp+goKGioqOkpKWlpqamp6enp6enp6enp6ampqWlpKSjoqKhoJ+enJuamJeVlJKQj42MiomHhoWEhIODg4ODg4SFhYaHiYqLjY6QkZOVlpiam52foKGjpaaoqaqsra6wsbKztLW2tre4uLi4uLi4uLe3trW0srGvrauopqOgnZmWk4+MiYaDgH17eXh2dXV0dHR0dHV2d3h5ent8fn+BgoSFh4iKi42PkJKTlJaXmJmam5ydnp+goaKio6Skpaamp6enqKioqampqampqaioqKenpqalpKOioaCfnZyamZeVk5KQjoyLiYiGhYSDgoKCgYKCgoODhIWGiImKjI2PkJKUlpeZm5yen6GjpKanqaqsra+wsbK0tba2t7i4ubm5ubm5ubi4t7a0s7GvrauppqOgnJmVko6LiISBf3x6eHZ1dHNzc3Nzc3R1dXZ3eXp7fX6AgYOEhoeJi4yOj5GSlJWXmJmam5ydnp+goaKjpKSlpqenqKipqaqqqqqrq6urq6qqqqmpqKenpqWkoqGgnpybmZeVk5GPjoyKiIeFhIOCgYGAgICBgYKCg4SFh4iJi4yOkJGTlZaYmpydn6GipKanqausrq+wsrO0tba3uLm5urq6urq6urm4uLe1tLKwrquppqOfnJiVkY2KhoOAfXt4dnVzcnJxcXFxcnJzdHV2d3l6e31+gIKDhYeIiouNj5CSk5WWmJmam5ydn6ChoqKjpKWmp6ioqaqqq6usrKytra2tra2srKyrqqqpqKelpKKhn52bmZeVk5GPjYuJh4aEg4KBgIB/f39/gICBgoOEhoeIiouNj5GSlJaYmZudnqCipKanqausrq+xsrO1tre4ubm6u7u7u7u7u7q5ube2tbOxrqyppqOfm5iUkIyIhYF+e3l3dXNycXBwb29wcHFycnR1dnd5enx9f4CChIWHiYuMjpCRk5SWl5iam5yen6ChoqOkpaanqKmqqqusra2urq+vr6+vr6+vrq6trayrqqinpqSioJ6cmpiWk5GPjIqIhoWDgoGAf35+fn5+f3+AgYKDhYaIiYuMjpCSk5WXmZudnqCipKWnqausrrCxsrS1tre4ubq7u7y8vLy8vLu7uri3tbOxr6yppqKfm5eTj4uHg4B8eXd0c3Fwb25ubW1ubm9wcXJzdHZ3eXp8fX+Bg4SGiIqLjY+QkpSVl5iam5yen6Cho6SlpqeoqaqrrK2urq+wsLGxsrKysrKxsbGwr66trKupp6akop+dm5iWk5GOjIqIhoSCgYB/fn19fX19fn5/gIGChIWHiIqMjY+Rk5WXmZqcnqCipKWnqautrrCxs7S2t7i5uru8vL29vb29vby8u7m4trSyr6yppqKempaRjYmFgX16d3RycG9tbGxra2tsbG1ub3BxcnR1d3h6fH5/gYOFh4iKjI6PkZOVlpiZm5yen6Cio6Smp6ipqqytrq+wsLGys7O0tLS1tbW0tLSzsrGwr62rqqilo6GenJmWk5GOjImHhYOBgH59fXx8fHx8fX1+f4CCg4SGiImLjY+RkpSWmJqcnqCipKWnqautrrCys7W2t7m6u7y9vb6+vr6+vr29vLq5t7WysK2ppaGdmZSQi4eDf3t3dHJvbWxramlpaWlpamtrbG5vcHJzdXd4enx+gIGDhYeJi42PkJKUlpeZm5yen6GipKWnqKmrrK2ur7Gys7S0tba2t7e4uLi3t7e2tbSzsbCurKqnpaKgnZqXlJGOi4mGhIKAf318fHt7e3t7fHx9fn+BgoSFh4mKjI6QkpSWmJqcnqCipKWnqautr7CytLW3uLm7vL29vr+/v8C/v7++vbu6uLWzsK2ppaGcl5OOiYSAfHh0cW9samloZ2ZmZmZnZ2hpamttbnBxc3V2eHp8foCChIaIioyOj5GTlZeZmpyeoKGjpKanqausra+wsbO0tba3uLm5urq7u7u7u7q5uLe2tbOxr6yqp6ShnpuXlJGOi4iGg4F/fnx7enp6enp6e3x8fX+AgYOFhoiKjI6QkpSWmJqcnZ+ho6Wnqautr7GytLa3ubq7vL2+v8DAwMHBwMC/vry7uLazsKyopKCblpCLhoF9eHRxbmtpZ2VkY2NjY2NkZGVmZ2lqbG1vcXN0dnh6fH6AgoSGiIuNj5GTlZaYmpyeoKKjpaepqqytr7Gys7W2t7m6u7y8vb6+vr6+vr69vLu6uLa0sq+tqqajoJyZlZGOi4iFg4B+fXt6eXl5eXl5ent8fX5/gYKEhoeJi42PkZOVl5mbnZ+ho6aoqqutr7Gztba4ubu8vb6/wMHBwsLCwcHAv727ubazsKyoo56Zk46Ig315dHBsaWdkY2FgYF9fX2BgYWJjZWZnaWttbnBydHZ4en1/gYOFh4mMjpCSlJaYmpyeoKKkpqiqq62vsbK0tre5uru9vr/AwMHCwsLCwsLBwL++vLq4trOwrammop6alpKPi4iFgoB+fHt5eXh4eHh4eXp7fH1/gIKDhYeJi42PkZOVl5mbnZ+ho6aoqqyur7Gztbe4uru9vr/AwcLCwsPDwsLBv768ubezr6umoZyWkIqEfnl0b2tnZGJgXl1cW1tbW1xdXl9gYmNlZmhqbG5wcnR2eXt9f4KEhoiLjY+RlJaYmpyeoaOlp6mrra+xs7S2uLq7vb7AwcLDxMXFxsbGxsbGxcTCwb+9ure0sK2ppaCcmJSQjIiFgn99e3p5eHd3d3d4eHl6e3x+f4GDhYaIioyOkJKVl5mbnZ+ho6aoqqyusLKztbe5ury9vsDBwsLDw8PDw8LBwL68ubazrqqkn5iSjIV/eXNuaWViX1xaWVhXV1dXV1hZWltdXmBiZGVnaWxucHJ0d3l7foCChYeKjI6Rk5WYmpyfoaOmqKqsrrCytLa4ury+v8HDxMXHyMnJysvLy8vKysnHxsTCv7y5tbGtqKOfmpaRjYmGgoB9e3l4d3d2dnZ3d3h5enx9f4CChIaIioyOkJKUlpmbnZ+ho6WoqqyusLK0tre5u7y+v8DBwsPExMTEw8PCwL68ubWxrKehm5SNhn94cmxnYl5bWFZUU1JSUlJSU1RVVlhZW11fYWNlZ2lrbnBzdXd6fH+BhIaJi46Qk5WYmp2foqSmqautsLK0tri7vb/AwsTGx8nKy83Ozs/Q0NDQz87NzMrHxcK+urayraijnpiUj4uHg4B9e3l4d3Z2dnZ2d3h5ent9foCCg4WHiYuOkJKUlpibnZ+ho6WoqqyusLK0tri5u72+v8HCw8PExMTEw8PBwL26t7OuqaOclY2FfnZwaWNeWldUUU9OTU1MTU1OT1BRU1RWWFpcXmBiZWdpbG5xc3Z4e36Ag4WIi42Qk5WYmp2goqWnqqyvsbS2uLu9v8HDxcfJy8zOz9HS09TU1dXV1dTT0tDOzMnFwb24s66oop2Xko2JhYJ/fHp4d3Z2dnZ2d3d4eXt8fn+Bg4WHiYuNj5GUlpianJ6ho6WnqqyusLK0tri5u72+v8HCw8PExMTDw8LAvru4tK+po5yUjIR7c2xlX1lVUU5LSUhHR0ZHR0hJSkxNT1FSVFdZW11gYmVnamxvcnR3enx/goWHio2QkpWYm52go6aoq66ws7W4ur2/wcTGyMrMztDS1NXW2Nna2tvb29va2djW1NHOysbBu7awqqOdl5KNiISBfnt6eHd2dnZ2d3d4eXp8fX+Bg4SGiIuNj5GTlZianJ6go6WnqauusLK0tbe5u7y+v8DBwsLDw8LCwb+9ureyraehmZGIf3ZtZV5YUk1JRkRCQUBAQEBBQkNERkdJS01PUVRWWFtdYGNlaGttcHN2eXx+gYSHio2Qk5WYm56hpKaprK+ytLe6vL/BxMbJy83Q0tTW2Nrb3d7f4OHi4uLi4eDf3dvY1NDMxsG6tK2moJmUjomFgn98enl4d3d3d3h4eXt8fX+BgoSGiIqMjpGTlZeam56goqSnqautr7Gztbe4uru9vr+/wMDAwL++vLq3s66popqSiX91bGNbU01IQ0A9Ozo5ODg4OTo7PD4/QUNFR0pMTlFTVllbXmFkZmlsb3J1eHt+gYSHio2Qk5aZnJ+ipaeqrbCztrm8vsHExsnMztHT1dja3N7g4uPl5ujp6erq6urp6Obk4d7a1dDKw7y1raafmJKNiYWBf317enl5eXl6ent9fn+Bg4SGiIqMjpCTlZeZ",colsCount:180,valueScale:2}},,,,,,,,,,,,,function(e,t){e.exports='<div class="contents">\n    <div class="left-buttons">\n        <div class="button-minimize" data-bind="click: onMinimizeButtonClick"\n             title="Minimize"></div>\n        <div class="button-minimize icon-on-off"\n             data-bind="click: onEnableButtonClick, css: {\'state-on\': _enabled()}"\n             title="Switch draw by click on/off"></div>\n    </div>\n    <table>\n        <tr>\n            <td>True azimuth</td>\n            <td data-bind="text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + \'&deg;\' : \'--\'"></td>\n        </tr>\n        <tr>\n            <td>Magnetic azimuth</td>\n            <td data-bind="text: magneticAzimuth() !== null ? magneticAzimuth() + \'&deg;\' : \'--\'"></td>\n        </tr>\n        <tr>\n            <td>Distance</td>\n            <td data-bind="text: distance() === null ? \'--\' :\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + \' km\' : Math.round(distance()) + \' m\'"></td>\n        </tr>\n    </table>\n\n    <div class="buttons">\n        <div class="button" data-bind="click: onReverseButtonClick">Reverse</div>\n        <div class="button" data-bind="click: onProfileButtonClick">Elevation / Sightline</div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="leaflet-control-button-toggle" title="Print map"\n     data-bind="click: setExpanded, css: {\'icon-spinner-nuclear\': makingPdf, \'icon-printer\': !makingPdf()}">\n    </div>\n<div class="leaflet-control-content">\n<table class="layout">\n    <tbody>\n    <tr><td colspan="2">\n        <a title="Add page in portrait orientation" class="button-add-page-vert image-button"\n           data-bind="click: addPortraitPage"></a>\n        <a title="Add page in landscape orientation" class="button-add-page-horiz image-button"\n           data-bind="click: addLandscapePage"></a>\n        <span class="pages-num" data-bind="text: pagesNumLabel"></span>\n        <a title="Remove all pages" class="button-remove-pages image-button"\n           data-bind="click: removePages"></a>\n    </td></tr>\n    <tr>\n        <td class="label">Print scale</td>\n        <td>\n            <div class="preset-values" >\n                <a data-bind="click: function() {scale(100)}, css: {selected: scale() === 100}">100 m</a>\n                <a data-bind="click: function() {scale(500)}, css: {selected: scale() === 500}">500 m</a>\n                <a data-bind="click: function() {scale(1000)}, css: {selected: scale() === 1000}">1 km</a>\n            </div>\n            <input type="text" class="scale" maxlength="6" data-bind="value: scale">&nbsp;m in 1 cm\n        </td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label">Page size</td>\n        <td>\n            <div class="preset-values" data-bind="foreach: {data: pageSizes, as: \'size\'}">\n                <a data-bind="click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\n                              text: size.name,\n                              css: {selected: size.name === $root.pageSizeDescription() }"></a>\n            </div>\n            <input type="text" maxlength="4" title="width" placeholder="width" class="page-size" data-bind="value: pageWidth">\n            x <input type="text" maxlength="4" title="height" placeholder="height" class="page-size" data-bind="value: pageHeight"> mm\n        </td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label-high">Margins</td>\n        <td>\n            <table class="margins">\n                <tr>\n                    <td></td>\n                    <td><input type="text" maxlength="2" value="3" data-bind="value: marginTop"></td>\n                    <td></td>\n                </tr>\n                <tr>\n                    <td><input type="text" maxlength="2" value="3" data-bind="value: marginLeft"></td>\n                    <td></td><td><input type="text" maxlength="2" value="3" data-bind="value: marginRight"> mm</td>\n                </tr>\n                <tr><td></td><td><input type="text" maxlength="2" value="3" data-bind="value: marginBottom"></td><td></td></tr>\n            </table>\n        </td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label">Resolution</td>\n        <td><input type="text" maxlength="4" class="resolution" data-bind="value: resolution"> dpi</td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label">Source zoom<br />level</td>\n        <td>\n            <select name="srczoom"\n                    data-bind="options: [\'auto\', 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], value: zoomLevel">\n            </select>\n        </td>\n    </tr>\n    <tr>\n        <td colspan="2">\n            <label><input type="checkbox" data-bind="checked: magneticMerisiansdOn"> Magnetic meridians</label>\n            <label><input type="checkbox" data-bind="checked: gridOn"> Kilometers grid</label>\n        </td>\n    </tr>\n    <tr><td colspan="2">\n        <a class="button-settings image-button" data-bind="click: function() {settingsExpanded(!settingsExpanded())}"\n            title="More settings"></a>\n        <div class="settings-summary">\n            <span data-bind="text: pageSizeDescription"></span><br/>\n            <span data-bind="text: resolution"></span>&nbsp;dpi,\n            zoom&nbsp;<span data-bind="text: zoomLevel"></span>\n            <!-- ko if: zoomLevel()=== "auto" -->\n            (<span title="Zoom for satellite and scanned imagery" data-bind="text: autoZoomLevels().satZoom"></span>&nbsp;\n            /&nbsp;<span title="Zoom for maps like OSM and Google" data-bind="text: autoZoomLevels().mapZoom"></span>)\n            <!-- /ko -->\n        </div>\n    </td></tr>\n    <tr><td colspan="2">\n        <div class="download-button-row">\n            <div class="button-minimize" data-bind="click: setMinimized"></div>\n            <a class="text-button button-save" data-bind="\n                                click: onSavePdfClicked,\n                                visible: !makingPdf()">Save PDF</a>\n            <div data-bind="\n                                component: { \n                                    name: \'progress-indicator\',\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                                },\n                                visible: makingPdf()"></div>\n        </div>\n    </td></tr>\n    </tbody>\n</table>\n</div>'},,,,,,,,,,,,,,,,function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDQwIDQwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiICBjeT0iMjQuNSIgY3g9IjIwIiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxsaW5lIHgxPSIyMCIgeTE9IjIwIiB4Mj0iMjUiIHkyPSIzMCIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjIiLz4KICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjE1IiB5Mj0iMzAiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMjAiIHgyPSIyMCIgeTI9IjM4IiBzdHJva2U9IiMzMzg4ZmYiIHN0cm9rZS13aWR0aD0iMS4yIi8+CiAgICA8L2c+Cjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDQwIDQwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiIGN5PSIyMiIgY3g9IjIwIiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgoKICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjIzIiB5Mj0iMjQiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KICAgICAgICA8bGluZSB4MT0iMjAiIHkxPSIyMCIgeDI9IjE3IiB5Mj0iMjQiIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KCiAgICAgICAgPGxpbmUgeDE9IjIwIiB5MT0iMjAiIHgyPSIyMCIgeTI9IjciIHN0cm9rZT0iIzMzODhmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KICAgIDwvZz4KPC9zdmc+"},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkNhcGFfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDMwIDMwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgIDxnPgogICAgICAgIDxlbGxpcHNlIHJ5PSIxNSIgcng9IjE1IiBpZD0ic3ZnXzEiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxsaW5lIHgxPSIxMiIgeTE9IjEyIiB4Mj0iMTgiIHkyPSIxOCIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjEuNSIvPgogICAgICAgIDxsaW5lIHgxPSIxMiIgeTE9IjE4IiB4Mj0iMTgiIHkyPSIxMiIgc3Ryb2tlPSIjMzM4OGZmIiBzdHJva2Utd2lkdGg9IjEuNSIvPgogICAgPC9nPgo8L3N2Zz4="}]);
//# sourceMappingURL=main.9b918799.js.map